var Xe=Object.defineProperty;var Fe=r=>{throw TypeError(r)};var Ye=(r,e,t)=>e in r?Xe(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var O=(r,e,t)=>Ye(r,typeof e!="symbol"?e+"":e,t),Le=(r,e,t)=>e.has(r)||Fe("Cannot "+t);var se=(r,e,t)=>(Le(r,e,"read from private field"),t?t.call(r):e.get(r)),Ae=(r,e,t)=>e.has(r)?Fe("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),De=(r,e,t,s)=>(Le(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t);import{r as requireReact,a as requireReactDom,g as getDefaultExportFromCjs,c as commonjsGlobal}from"./vendor-CWc6w16D.js";import{r as reactExports,u as useLocation,a as useParams,b as useNavigate,O as Outlet,R as React,N as Navigate,c as Routes,d as Route,B as BrowserRouter}from"./router-mubfmCo3.js";import{B as BrowserProvider,f as formatEther,c as commonjsRequire}from"./crypto--8Ipcbip.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();var jsxRuntime={exports:{}},reactJsxRuntime_production_min={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var r=requireReact(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,n=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,p){var g,x={},b=null,E=null;p!==void 0&&(b=""+p),l.key!==void 0&&(b=""+l.key),l.ref!==void 0&&(E=l.ref);for(g in l)s.call(l,g)&&!i.hasOwnProperty(g)&&(x[g]=l[g]);if(a&&a.defaultProps)for(g in l=a.defaultProps,l)x[g]===void 0&&(x[g]=l[g]);return{$$typeof:e,type:a,key:b,ref:E,props:x,_owner:n.current}}return reactJsxRuntime_production_min.Fragment=t,reactJsxRuntime_production_min.jsx=o,reactJsxRuntime_production_min.jsxs=o,reactJsxRuntime_production_min}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production_min()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),client={},hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var r=requireReactDom();return client.createRoot=r.createRoot,client.hydrateRoot=r.hydrateRoot,client}var clientExports=requireClient();const ReactDOM=getDefaultExportFromCjs(clientExports);class SearchService{static initializeFeeds(e){this.allFeeds=e}static async search(e){const t=Date.now();if(!e.query.trim())return{results:[],totalCount:0,searchTime:0,suggestions:[]};let s=this.allFeeds;e.dateRange&&(s=this.filterByDateRange(s,e.dateRange)),e.sources&&e.sources.length>0&&(s=s.filter(o=>e.sources.includes(o.name)||e.sources.includes(o.url)));const n=this.performTextSearch(s,e),i=Date.now()-t;return{results:n,totalCount:n.length,searchTime:i,suggestions:this.generateSuggestions(e.query)}}static getSearchSuggestions(e){if(!e||e.length<2)return[];const t=new Set,s=e.toLowerCase();return this.allFeeds.forEach(n=>{`${n.title} ${n.description||""}`.toLowerCase().split(/\s+/).forEach(a=>{a.includes(s)&&a.length>2&&t.add(a)})}),Array.from(t).slice(0,10)}static filterByDateRange(e,t){return e.filter(s=>{const n=new Date(s.pubDate);return n>=t.start&&n<=t.end})}static performTextSearch(e,t){const s=t.caseSensitive?t.query:t.query.toLowerCase(),n=this.parseSearchQuery(s,t.operators),i=[];return e.forEach(o=>{const a=this.getSearchableText(o,t.caseSensitive),l=this.matchKeywords(a,n,t.operators);l.isMatch&&i.push({feed:o,relevanceScore:l.score,matchedFields:l.fields,snippet:this.generateSnippet(o,n[0],150)})}),i.sort((o,a)=>a.relevanceScore-o.relevanceScore)}static parseSearchQuery(e,t="AND"){return e.split(/\s+/).filter(s=>s.length>1)}static getSearchableText(e,t=!1){const s=t?n=>n:n=>n.toLowerCase();return{title:s(e.title),description:s(e.description||""),content:s(e.content||""),author:s(e.author||""),categories:s((e.categories||[]).join(" ")),source:s(e.name)}}static matchKeywords(e,t,s="AND"){const n={title:3,description:2,content:1,author:1,categories:2,source:1};let i=0;const o=[];Object.entries(e).forEach(([l,p])=>{let g=0;const x=t.filter(b=>p.includes(b));x.length>0&&(o.push(l),g=x.length*n[l],x.length),i+=g});let a=!1;return s==="AND"?a=t.every(l=>Object.values(e).some(p=>p.includes(l))):s==="OR"?a=t.some(l=>Object.values(e).some(p=>p.includes(l))):a=o.length>0,{isMatch:a,score:i,fields:o}}static generateSnippet(e,t,s=150){const n=e.description||e.content||e.title;if(!n)return"";const i=n.toLowerCase(),o=t.toLowerCase(),a=i.indexOf(o);if(a===-1)return n.substring(0,s)+(n.length>s?"...":"");const l=Math.max(0,a-50),p=Math.min(n.length,a+t.length+50);let g=n.substring(l,p);return l>0&&(g="..."+g),p<n.length&&(g=g+"..."),g}static generateSuggestions(e){return["cybersecurity","breaking news","politics","technology","economy","health","climate","security","international","business","science","market","government","crisis"].filter(s=>s.toLowerCase().includes(e.toLowerCase())).slice(0,5)}static clearData(){this.allFeeds=[]}static getFeedCount(){return this.allFeeds.length}}O(SearchService,"allFeeds",[]);const SearchContext=reactExports.createContext(void 0),SearchProvider=({children:r})=>{const[e,t]=reactExports.useState(null),[s,n]=reactExports.useState(!1),[i,o]=reactExports.useState(""),[a,l]=reactExports.useState(()=>{const f=localStorage.getItem("tactical_search_history");return f?JSON.parse(f):[]}),p=reactExports.useCallback(async f=>{if(!f.query.trim()){t(null);return}n(!0);try{const j=await SearchService.search(f);t(j),o(f.query)}catch(j){console.error("Search failed:",j),t({results:[],totalCount:0,searchTime:0,suggestions:[]})}finally{n(!1)}},[]),g=reactExports.useCallback(()=>{t(null),o("")},[]),x=reactExports.useCallback(f=>{f.trim()&&l(j=>{const C=[f,...j.filter(S=>S!==f)].slice(0,10);return localStorage.setItem("tactical_search_history",JSON.stringify(C)),C})},[]),b=reactExports.useCallback(()=>{l([]),localStorage.removeItem("tactical_search_history")},[]),E={searchResults:e,isSearching:s,searchQuery:i,searchHistory:a,performSearch:p,clearSearch:g,setSearchQuery:o,addToHistory:x,clearHistory:b};return jsxRuntimeExports.jsx(SearchContext.Provider,{value:E,children:r})},useSearch=()=>{const r=reactExports.useContext(SearchContext);if(!r)throw new Error("useSearch must be used within a SearchProvider");return r};class FilterService{static applyFilters(e,t){let s=[...e];return t.activeFilters.size>0&&(s=s.filter(n=>this.matchesFilters(n,t.activeFilters))),t.timeRange&&(s=s.filter(n=>this.isWithinTimeRange(n,t.timeRange))),t.searchQuery.trim()&&(s=s.filter(n=>this.matchesSearchQuery(n,t.searchQuery))),s=this.sortFeeds(s,t.sortBy),s}static matchesFilters(e,t){for(const s of t)if(this.feedMatchesFilter(e,s))return!0;return!1}static feedMatchesFilter(e,t){return["CRITICAL","HIGH","MEDIUM","LOW"].includes(t)?e.priority===t:["INTEL","NEWS","ALERT","THREAT"].includes(t)?e.contentType===t:["GLOBAL","AMERICAS","EUROPE","ASIA_PACIFIC"].includes(t)?e.region===t:!!(e.tags&&e.tags.includes(t)||e.classification===t)}static isWithinTimeRange(e,t){if(!e.timestamp)return!1;const s=new Date(e.timestamp);return s>=t.start&&s<=t.end}static matchesSearchQuery(e,t){var n;return[e.title,e.description,e.source,(n=e.tags)==null?void 0:n.join(" "),e.classification].filter(Boolean).join(" ").toLowerCase().includes(t.toLowerCase())}static sortFeeds(e,t){return e.sort((s,n)=>{let i=0;switch(t.field){case"timestamp":const o=new Date(s.timestamp||0).getTime(),a=new Date(n.timestamp||0).getTime();i=o-a;break;case"title":i=(s.title||"").localeCompare(n.title||"");break;case"priority":const l={CRITICAL:3,HIGH:2,MEDIUM:1,LOW:0},p=l[s.priority]||0,g=l[n.priority]||0;i=p-g;break;case"source":i=(s.source||"").localeCompare(n.source||"");break;default:i=0}return t.direction==="desc"?-i:i})}static getDefaultFilterState(){return{activeFilters:new Set,timeRange:null,sortBy:{field:"timestamp",direction:"desc"},searchQuery:""}}static getFilterCounts(e){const t={};return e.forEach(s=>{s.priority&&(t[s.priority]=(t[s.priority]||0)+1),s.contentType&&(t[s.contentType]=(t[s.contentType]||0)+1),s.region&&(t[s.region]=(t[s.region]||0)+1),s.tags&&s.tags.forEach(n=>{t[n]=(t[n]||0)+1})}),t}static createTimeRangeFromPreset(e){const t=new Date,n={"1H":1,"6H":6,"24H":24,"7D":168,"30D":720}[e];if(!n)throw new Error(`Invalid time range preset: ${e}`);return{start:new Date(t.getTime()-n*60*60*1e3),end:t,label:e}}static validateFilterState(e){var t,s;return{activeFilters:new Set(Array.isArray(e.activeFilters)?e.activeFilters:[]),timeRange:e.timeRange||null,sortBy:{field:["timestamp","title","priority","source"].includes((t=e.sortBy)==null?void 0:t.field)?e.sortBy.field:"timestamp",direction:["asc","desc"].includes((s=e.sortBy)==null?void 0:s.direction)?e.sortBy.direction:"desc"},searchQuery:typeof e.searchQuery=="string"?e.searchQuery:""}}}const FilterContext=reactExports.createContext(void 0),FilterProvider=({children:r})=>{const[e,t]=reactExports.useState(()=>{try{const S=localStorage.getItem("tactical-filter-state");if(S){const R=JSON.parse(S);return FilterService.validateFilterState(R)}}catch(S){console.warn("Failed to load saved filter state:",S)}return FilterService.getDefaultFilterState()}),s=reactExports.useCallback(S=>{try{const R={...S,activeFilters:Array.from(S.activeFilters)};localStorage.setItem("tactical-filter-state",JSON.stringify(R))}catch(R){console.warn("Failed to save filter state:",R)}},[]),n=reactExports.useCallback(S=>{const R={...e,activeFilters:S};t(R),s(R)},[e,s]),i=reactExports.useCallback(S=>{const R={...e,timeRange:S};t(R),s(R)},[e,s]),o=reactExports.useCallback(S=>{const R={...e,sortBy:S};t(R),s(R)},[e,s]),a=reactExports.useCallback(S=>{const R={...e,searchQuery:S};t(R),s(R)},[e,s]),l=reactExports.useCallback(S=>{const R=new Set(e.activeFilters);R.add(S),n(R)},[e.activeFilters,n]),p=reactExports.useCallback(S=>{const R=new Set(e.activeFilters);R.delete(S),n(R)},[e.activeFilters,n]),g=reactExports.useCallback(()=>{const S={...e,activeFilters:new Set,timeRange:null,searchQuery:""};t(S),s(S)},[e,s]),x=reactExports.useCallback(()=>{const S=FilterService.getDefaultFilterState();t(S),s(S)},[s]),b=reactExports.useCallback(S=>FilterService.applyFilters(S,e),[e]),E=reactExports.useCallback(S=>FilterService.getFilterCounts(S),[]),f=reactExports.useCallback(S=>e.activeFilters.has(S),[e.activeFilters]),j=reactExports.useMemo(()=>e.activeFilters.size>0||e.timeRange!==null||e.searchQuery.trim()!=="",[e]),C={filterState:e,updateFilters:n,updateTimeRange:i,updateSort:o,updateSearch:a,addFilter:l,removeFilter:p,clearAllFilters:g,getFilteredFeeds:b,getFilterCounts:E,isFilterActive:f,hasActiveFilters:j,resetFilters:x};return jsxRuntimeExports.jsx(FilterContext.Provider,{value:C,children:r})},useFilters=()=>{const r=reactExports.useContext(FilterContext);if(!r)throw new Error("useFilters must be used within a FilterProvider");return r},useTimeRangePresets=()=>{const{updateTimeRange:r}=useFilters(),e=reactExports.useCallback(s=>{try{const n=FilterService.createTimeRangeFromPreset(s);r(n)}catch(n){console.error("Failed to apply time range preset:",n)}},[r]),t=reactExports.useCallback((s,n,i="Custom")=>{r({start:s,end:n,label:i})},[r]);return{applyPreset:e,applyCustomRange:t}};var CORSStrategy=(r=>(r.RSS2JSON="RSS2JSON",r.JSONP="JSONP",r.SERVICE_WORKER="SERVICE_WORKER",r.DIRECT="DIRECT",r.EXTENSION="EXTENSION",r))(CORSStrategy||{}),SettingsTab=(r=>(r.GENERAL="general",r.CORS="cors",r.PROTOCOLS="protocols",r.VERIFICATION="verification",r.DISPLAY="display",r.ADVANCED="advanced",r))(SettingsTab||{});const defaultSettings={version:"1.0.0",lastTab:"general",cors:{defaultStrategy:"RSS2JSON",protocolStrategies:{},services:{rss2json:["https://rss2json.vercel.app/api","https://api.rss2json.com/v1/api.json","https://feed2json.org/convert","https://rss-to-json-serverless-api.vercel.app"],corsProxies:["https://corsproxy.io/?","https://api.allorigins.win/raw?url=","https://api.codetabs.com/v1/proxy?quest="]},fallbackChain:["RSS2JSON","DIRECT","SERVICE_WORKER","JSONP","EXTENSION"]},protocols:{priority:["RSS","JSON","API","IPFS","MASTODON","SSB"],settings:{},autoDetect:!0,fallbackEnabled:!0},verification:{minimumTrustRating:60,preferredMethods:["official","community","automated"],warningThreshold:40,advancedSettings:{crossReference:!0,machineLearning:!0,highlightUnverified:!0,crossReferenceCount:2}},display:{theme:"alliance",density:"comfortable",fontSize:14},general:{refreshInterval:3e5,cacheSettings:{enabled:!0,duration:3e5},notifications:{enabled:!0,sound:!1},export:{format:"json",autoExport:!1,includeMetadata:!0,compress:!1,encrypt:!0}}},SettingsContext=reactExports.createContext(void 0),SettingsProvider=({children:r})=>{const[e,t]=reactExports.useState(defaultSettings);reactExports.useEffect(()=>{try{const i=localStorage.getItem("dashboardSettings");i&&t(JSON.parse(i))}catch(i){console.error("Failed to load settings:",i)}},[]),reactExports.useEffect(()=>{try{localStorage.setItem("dashboardSettings",JSON.stringify(e))}catch(i){console.error("Failed to save settings:",i)}},[e]);const s=i=>{t(o=>{var a;return{...o,...i,cors:{...o.cors,...i.cors||{},services:{...o.cors.services,...((a=i.cors)==null?void 0:a.services)||{}}},protocols:{...o.protocols,...i.protocols||{}},verification:{...o.verification,...i.verification||{}},display:{...o.display,...i.display||{}}}})},n=i=>{t(i?o=>{const a={...o};switch(i){case"cors":a.cors={...defaultSettings.cors};break;case"protocols":a.protocols={...defaultSettings.protocols};break;case"verification":a.verification={...defaultSettings.verification};break;case"display":a.display={...defaultSettings.display};break}return a}:defaultSettings)};return jsxRuntimeExports.jsx(SettingsContext.Provider,{value:{settings:e,updateSettings:s,resetSettings:n},children:r})},useSettings=()=>{const r=reactExports.useContext(SettingsContext);if(r===void 0)throw new Error("useSettings must be used within a SettingsProvider");return r},initialState$1={theme:"dark",compactMode:!1},themeReducer=(r,e)=>{switch(e.type){case"SET_THEME":return{...r,theme:e.payload};case"SET_COMPACT_MODE":return{...r,compactMode:e.payload};case"TOGGLE_COMPACT_MODE":return{...r,compactMode:!r.compactMode};case"SYNC_WITH_SETTINGS":return{theme:e.payload.theme,compactMode:e.payload.compactMode};default:return r}},ThemeContext=reactExports.createContext(void 0),useTheme=()=>{const r=reactExports.useContext(ThemeContext);if(!r)throw new Error("useTheme must be used within a ThemeProvider");return r},ThemeProvider=({children:r})=>{const[e,t]=reactExports.useReducer(themeReducer,initialState$1),{settings:s,updateSettings:n}=useSettings();reactExports.useEffect(()=>{const p=localStorage.getItem("tactical-theme"),g=localStorage.getItem("tactical-compact-mode")==="true";p&&t({type:"SET_THEME",payload:p}),g!==null&&t({type:"SET_COMPACT_MODE",payload:g})},[]),reactExports.useEffect(()=>{if(s!=null&&s.display){const p=s.display.density==="compact";t({type:"SYNC_WITH_SETTINGS",payload:{theme:s.display.theme,compactMode:p}})}},[s]),reactExports.useEffect(()=>{var p;localStorage.setItem("tactical-theme",e.theme),document.documentElement.setAttribute("data-theme",e.theme),((p=s==null?void 0:s.display)==null?void 0:p.theme)!==e.theme&&n({display:{...s.display,theme:e.theme}})},[e.theme,s,n]),reactExports.useEffect(()=>{if(localStorage.setItem("tactical-compact-mode",e.compactMode.toString()),document.documentElement.setAttribute("data-compact",e.compactMode.toString()),s!=null&&s.display){const p=s.display.density,g=e.compactMode?"compact":"comfortable";p!==g&&n({display:{...s.display,density:g}})}},[e.compactMode,s,n]);const i=p=>{t({type:"SET_THEME",payload:p})},o=p=>{t({type:"SET_COMPACT_MODE",payload:p})},a=()=>{t({type:"TOGGLE_COMPACT_MODE"})},l={theme:e.theme,compactMode:e.compactMode,setTheme:i,setCompactMode:o,toggleCompactMode:a};return jsxRuntimeExports.jsx(ThemeContext.Provider,{value:l,children:r})},we=class we{constructor(){O(this,"healthState");O(this,"listeners",new Set);O(this,"scanInterval");O(this,"startTime",Date.now());this.healthState={overallStatus:"OPTIMAL",connectionStatus:"ONLINE",securityStatus:"SECURE",issues:[],metrics:this.getInitialMetrics(),isScanning:!1,isCleaning:!1,isRepairing:!1}}static getInstance(){return we.instance||(we.instance=new we),we.instance}getInitialMetrics(){return{responseTime:50,errorRate:0,dataIntegrity:100,connectionStability:98,memoryUsage:45,feedHealth:95,lastScanTime:new Date,uptime:0}}notifyListeners(){this.listeners.forEach(e=>e(this.healthState))}subscribe(e){return this.listeners.add(e),e(this.healthState),()=>{this.listeners.delete(e)}}getHealthState(){return{...this.healthState}}async performScan(){const e=Date.now();this.healthState.isScanning=!0,this.notifyListeners();try{await this.delay(1500);const t=await this.identifyIssues(),s=await this.gatherMetrics(),n=this.generateRecommendations(t,s),i={timestamp:new Date,type:"scan",status:t.some(o=>o.severity==="critical")?"error":t.some(o=>o.severity==="high")?"warning":"success",issues:t,metrics:s,recommendations:n,duration:Date.now()-e};return this.healthState.lastScan=i,this.healthState.issues=t,this.healthState.metrics=s,this.healthState.overallStatus=this.determineOverallStatus(t,s),this.healthState.isScanning=!1,this.notifyListeners(),i}catch{const s={timestamp:new Date,type:"scan",status:"error",issues:[{id:"scan-error",severity:"high",category:"performance",title:"Scan Failed",description:"System scan encountered an error",autoFixable:!1,timestamp:new Date}],metrics:this.healthState.metrics,recommendations:["Retry system scan","Check system resources"],duration:Date.now()-e};return this.healthState.isScanning=!1,this.healthState.overallStatus="WARNING",this.notifyListeners(),s}}async performClean(){const e=Date.now();this.healthState.isCleaning=!0,this.notifyListeners();try{await this.delay(2e3);const t=this.healthState.issues.filter(o=>o.autoFixable&&["data","performance"].includes(o.category));let s=0;const n=[...this.healthState.issues];for(const o of t)if(Math.random()>.2){const a=n.findIndex(l=>l.id===o.id);a>=0&&(n.splice(a,1),s++)}const i={timestamp:new Date,type:"clean",status:s>0?"success":"warning",issues:n,metrics:await this.gatherMetrics(),recommendations:s>0?["System cleaning completed successfully"]:["No cleanable issues found","Consider running repair if issues persist"],duration:Date.now()-e,itemsFixed:s,itemsRemaining:n.length};return this.healthState.issues=n,this.healthState.metrics=i.metrics,this.healthState.overallStatus=this.determineOverallStatus(n,i.metrics),this.healthState.isCleaning=!1,this.notifyListeners(),i}catch(t){throw this.healthState.isCleaning=!1,this.healthState.overallStatus="WARNING",this.notifyListeners(),t}}async performRepair(){const e=Date.now();this.healthState.isRepairing=!0,this.notifyListeners();try{await this.delay(3e3);const t=this.healthState.issues.filter(o=>o.autoFixable);let s=0;const n=[...this.healthState.issues];for(const o of t)if(Math.random()>.1){const a=n.findIndex(l=>l.id===o.id);a>=0&&(n.splice(a,1),s++)}const i={timestamp:new Date,type:"repair",status:s>0?"success":"warning",issues:n,metrics:await this.gatherMetrics(),recommendations:s>0?["System repair completed successfully"]:["No repairable issues found","Manual intervention may be required"],duration:Date.now()-e,itemsFixed:s,itemsRemaining:n.length};return this.healthState.issues=n,this.healthState.metrics=i.metrics,this.healthState.overallStatus=this.determineOverallStatus(n,i.metrics),this.healthState.isRepairing=!1,this.notifyListeners(),i}catch(t){throw this.healthState.isRepairing=!1,this.healthState.overallStatus="WARNING",this.notifyListeners(),t}}async identifyIssues(){const e=[],t=[{name:"Memory Usage",probability:.3,category:"performance"},{name:"Connection Stability",probability:.2,category:"connectivity"},{name:"Data Integrity",probability:.15,category:"data"},{name:"Security Status",probability:.1,category:"security"},{name:"Feed Health",probability:.25,category:"data"}];for(const s of t)Math.random()<s.probability&&e.push({id:`issue-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,severity:this.getRandomSeverity(),category:s.category,title:`${s.name} Issue`,description:`${s.name} requires attention`,solution:`Optimize ${s.name.toLowerCase()}`,autoFixable:Math.random()>.3,component:s.name,timestamp:new Date});return e}async gatherMetrics(){const e=this.getInitialMetrics();return{responseTime:Math.round(e.responseTime+(Math.random()-.5)*20),errorRate:Math.round(Math.random()*5*100)/100,dataIntegrity:Math.round((95+Math.random()*5)*100)/100,connectionStability:Math.round((90+Math.random()*10)*100)/100,memoryUsage:Math.round((30+Math.random()*40)*100)/100,feedHealth:Math.round((85+Math.random()*15)*100)/100,lastScanTime:new Date,uptime:Math.round((Date.now()-this.startTime)/1e3)}}generateRecommendations(e,t){const s=[];if(e.length===0)s.push("System is running optimally");else{const n=e.filter(o=>o.severity==="critical"),i=e.filter(o=>o.severity==="high");n.length>0&&s.push("Address critical issues immediately"),i.length>0&&s.push("Schedule maintenance for high-priority issues"),e.some(o=>o.autoFixable)&&s.push("Run system cleanup to fix automated issues")}return t.memoryUsage>80&&s.push("Monitor memory usage"),t.errorRate>2&&s.push("Investigate error sources"),s}determineOverallStatus(e,t){const s=e.filter(i=>i.severity==="critical"),n=e.filter(i=>i.severity==="high");return s.length>0||t.errorRate>5?"CRITICAL":n.length>0||t.memoryUsage>85||t.errorRate>2?"WARNING":"OPTIMAL"}getRandomSeverity(){const e=Math.random();return e<.1?"critical":e<.3?"high":e<.7?"medium":"low"}delay(e){return new Promise(t=>setTimeout(t,e))}startMonitoring(e=3e4){this.scanInterval&&clearInterval(this.scanInterval),this.scanInterval=setInterval(()=>{this.performLightweightCheck()},e)}stopMonitoring(){this.scanInterval&&(clearInterval(this.scanInterval),this.scanInterval=void 0)}async performLightweightCheck(){this.healthState.metrics=await this.gatherMetrics(),this.healthState.connectionStatus=navigator.onLine?"ONLINE":"OFFLINE",this.healthState.overallStatus=this.determineOverallStatus(this.healthState.issues,this.healthState.metrics),this.notifyListeners()}exportHealthData(){return{timestamp:new Date,state:this.healthState,uptime:Date.now()-this.startTime,performance:{...this.healthState.metrics}}}clearIssues(){this.healthState.issues=[],this.healthState.overallStatus="OPTIMAL",this.notifyListeners()}};O(we,"instance");let DiagnosticService=we;const HealthContext=reactExports.createContext(void 0),HealthProvider=({children:r})=>{const[e,t]=reactExports.useState({overallStatus:"OPTIMAL",connectionStatus:"ONLINE",securityStatus:"SECURE",issues:[],metrics:{responseTime:50,errorRate:0,dataIntegrity:100,connectionStability:98,memoryUsage:45,feedHealth:95,lastScanTime:new Date,uptime:0},isScanning:!1,isCleaning:!1,isRepairing:!1}),[s,n]=reactExports.useState(),i=DiagnosticService.getInstance();reactExports.useEffect(()=>{const j=i.subscribe(C=>{t(C)});return i.startMonitoring(3e4),()=>{j(),i.stopMonitoring()}},[i]);const o=async()=>{const j=await i.performScan();return n(j),j},a=async()=>{const j=await i.performClean();return n(j),j},l=async()=>{const j=await i.performRepair();return n(j),j},p=j=>{i.startMonitoring(j)},g=()=>{i.stopMonitoring()},x=()=>{i.clearIssues()},b=()=>i.exportHealthData(),E=e.isScanning||e.isCleaning||e.isRepairing,f={healthState:e,performScan:o,performClean:a,performRepair:l,startMonitoring:p,stopMonitoring:g,clearIssues:x,exportHealthData:b,isOperationInProgress:E,lastResult:s};return jsxRuntimeExports.jsx(HealthContext.Provider,{value:f,children:r})},useHealth=()=>{const r=reactExports.useContext(HealthContext);if(r===void 0)throw new Error("useHealth must be used within a HealthProvider");return r};var EarthAllianceCategory=(r=>(r.MILITARY_INTELLIGENCE_WHISTLEBLOWER_PLATFORMS="MILITARY_INTELLIGENCE_WHISTLEBLOWER_PLATFORMS",r.TECHNOLOGY_DISCLOSURE_NETWORKS="TECHNOLOGY_DISCLOSURE_NETWORKS",r.INDEPENDENT_INVESTIGATIVE_JOURNALISM="INDEPENDENT_INVESTIGATIVE_JOURNALISM",r.ALTERNATIVE_HEALTH_RESEARCH="ALTERNATIVE_HEALTH_RESEARCH",r.CONSCIOUSNESS_REALITY_RESEARCH="CONSCIOUSNESS_REALITY_RESEARCH",r.POSITIVE_MILITARY_OPERATIONS_TRACKING="POSITIVE_MILITARY_OPERATIONS_TRACKING",r))(EarthAllianceCategory||{}),SourceProtocol=(r=>(r.RSS="rss",r.JSON="json",r.API="api",r.IPFS="ipfs",r.MASTODON="mastodon",r.SSB="ssb",r))(SourceProtocol||{});const EARTH_ALLIANCE_SOURCES=[{id:"veterans-today-1",name:"Veterans Today",url:"https://www.veteranstoday.com",category:"MILITARY_INTELLIGENCE_WHISTLEBLOWER_PLATFORMS",trustRating:75,allianceAlignment:79,accessMethod:"account-required",verificationMethod:"member-verification",protocol:"rss",endpoint:"https://www.veteranstoday.com/feed",format:"news"},{id:"new-energy-times-2",name:"New Energy Times",url:"https://newenergytimes.com",category:"TECHNOLOGY_DISCLOSURE_NETWORKS",trustRating:88,allianceAlignment:97,accessMethod:"direct",verificationMethod:"document-authentication",protocol:"rss",endpoint:"https://newenergytimes.com/feed",format:"research"},{id:"the-last-american-vagabond-3",name:"The Last American Vagabond",url:"https://www.thelastamericanvagabond.com",category:"INDEPENDENT_INVESTIGATIVE_JOURNALISM",trustRating:85,allianceAlignment:93,accessMethod:"direct",verificationMethod:"source-documentation",protocol:"rss",endpoint:"https://www.thelastamericanvagabond.com/feed",format:"news"},{id:"unlimited-hangout-4",name:"Unlimited Hangout",url:"https://unlimitedhangout.com",category:"INDEPENDENT_INVESTIGATIVE_JOURNALISM",trustRating:85,allianceAlignment:94,accessMethod:"direct",verificationMethod:"source-documentation",protocol:"rss",endpoint:"https://unlimitedhangout.com/feed",format:"investigation"},{id:"the-grayzone-5",name:"The Grayzone",url:"https://thegrayzone.com",category:"INDEPENDENT_INVESTIGATIVE_JOURNALISM",trustRating:82,allianceAlignment:87,accessMethod:"direct",verificationMethod:"scientific-analysis",protocol:"rss",endpoint:"https://thegrayzone.com/feed",format:"news"},{id:"the-corbett-report-6",name:"The Corbett Report",url:"https://www.corbettreport.com",category:"INDEPENDENT_INVESTIGATIVE_JOURNALISM",trustRating:81,allianceAlignment:84,accessMethod:"direct",verificationMethod:"on-the-ground-reporting",protocol:"rss",endpoint:"https://www.corbettreport.com/feed",format:"multimedia"},{id:"mintpress-news-7",name:"MintPress News",url:"https://www.mintpressnews.com",category:"INDEPENDENT_INVESTIGATIVE_JOURNALISM",trustRating:84,allianceAlignment:85,accessMethod:"direct",verificationMethod:"source-documentation",protocol:"rss",endpoint:"https://www.mintpressnews.com/feed",format:"news"},{id:"children-s-health-defense-8",name:"Children's Health Defense",url:"https://childrenshealthdefense.org",category:"ALTERNATIVE_HEALTH_RESEARCH",trustRating:83,allianceAlignment:89,accessMethod:"registration",verificationMethod:"study-based",protocol:"rss",endpoint:"https://childrenshealthdefense.org/feed",format:"news"},{id:"natural-health-research-institute-9",name:"Natural Health Research Institute",url:"https://naturalhealthresearch.org",category:"ALTERNATIVE_HEALTH_RESEARCH",trustRating:86,allianceAlignment:93,accessMethod:"direct",verificationMethod:"physician-reviewed",protocol:"rss",endpoint:"https://naturalhealthresearch.org/feed",format:"research"},{id:"the-highwire-10",name:"The Highwire",url:"https://thehighwire.com",category:"ALTERNATIVE_HEALTH_RESEARCH",trustRating:84,allianceAlignment:93,accessMethod:"direct",verificationMethod:"peer-reviewed",protocol:"rss",endpoint:"https://thehighwire.com/feed",format:"multimedia"},{id:"alliance-for-natural-health-11",name:"Alliance for Natural Health",url:"https://anh-usa.org",category:"ALTERNATIVE_HEALTH_RESEARCH",trustRating:79,allianceAlignment:81,accessMethod:"direct",verificationMethod:"expert-interviews",protocol:"rss",endpoint:"https://anh-usa.org/feed",format:"news"},{id:"international-association-for-near-death-studies-12",name:"International Association for Near-Death Studies",url:"https://iands.org",category:"CONSCIOUSNESS_REALITY_RESEARCH",trustRating:81,allianceAlignment:89,accessMethod:"direct",verificationMethod:"peer-reviewed",protocol:"rss",endpoint:"https://iands.org/feed",format:"research"},{id:"institute-of-noetic-sciences-13",name:"Institute of Noetic Sciences",url:"https://noetic.org",category:"CONSCIOUSNESS_REALITY_RESEARCH",trustRating:86,allianceAlignment:86,accessMethod:"direct",verificationMethod:"academic-standards",protocol:"rss",endpoint:"https://noetic.org/feed",format:"research"},{id:"covert-action-quarterly-14",name:"Covert Action Quarterly",url:"https://covertactionquarterly.org",category:"POSITIVE_MILITARY_OPERATIONS_TRACKING",trustRating:85,allianceAlignment:86,accessMethod:"restricted",verificationMethod:"insider-sources",protocol:"rss",endpoint:"https://covertactionquarterly.org/feed",format:"journal"}];EARTH_ALLIANCE_SOURCES.map(r=>r.endpoint);const EarthAllianceFeeds=EARTH_ALLIANCE_SOURCES.map((r,e)=>({id:`ea-${e+1}`,title:r.name,link:r.url,pubDate:new Date().toISOString(),description:`Earth Alliance aligned source: ${r.category}`,content:`Earth Alliance intelligence source with trust rating: ${r.trustRating}`,feedListId:"2",categories:[r.category]})),DefaultFeeds$1=EarthAllianceFeeds;var FeedMode=(r=>(r.EARTH_ALLIANCE="EARTH_ALLIANCE",r.MAINSTREAM="MAINSTREAM",r.HYBRID="HYBRID",r))(FeedMode||{});const FeedModeContext=reactExports.createContext({feedMode:FeedMode.EARTH_ALLIANCE,setFeedMode:()=>{}}),FeedModeProvider=({children:r})=>{const[e,t]=reactExports.useState(FeedMode.EARTH_ALLIANCE);return jsxRuntimeExports.jsx(FeedModeContext.Provider,{value:{feedMode:e,setFeedMode:t},children:r})},signMessage=async(r,e)=>{try{return await(await e.getSigner()).signMessage(r)}catch(t){throw console.error("Error signing message:",t),new Error("Failed to sign message")}};var Web3ErrorType=(r=>(r.WALLET_NOT_CONNECTED="WALLET_NOT_CONNECTED",r.WALLET_NOT_INSTALLED="WALLET_NOT_INSTALLED",r.NETWORK_UNSUPPORTED="NETWORK_UNSUPPORTED",r.TRANSACTION_REJECTED="TRANSACTION_REJECTED",r.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",r.CONTRACT_ERROR="CONTRACT_ERROR",r.PROVIDER_ERROR="PROVIDER_ERROR",r.CONNECTION_ERROR="CONNECTION_ERROR",r.SIGNATURE_ERROR="SIGNATURE_ERROR",r.NETWORK_SWITCH_ERROR="NETWORK_SWITCH_ERROR",r))(Web3ErrorType||{});class Web3Error extends Error{constructor(e,t,s,n){super(t),this.type=e,this.originalError=s,this.code=n,this.name="Web3Error"}static fromEthereumError(e){var t,s;return e.code===4001?new Web3Error("TRANSACTION_REJECTED","User rejected the request",e,4001):e.code===4100?new Web3Error("WALLET_NOT_CONNECTED","Wallet is not connected",e,4100):e.code===4200?new Web3Error("PROVIDER_ERROR","Unsupported method",e,4200):e.code===4900?new Web3Error("CONNECTION_ERROR","Chain is disconnected",e,4900):e.code===4902?new Web3Error("NETWORK_SWITCH_ERROR","Network not added to wallet",e,4902):e.code===-32002?new Web3Error("CONNECTION_ERROR","Request already pending. Please check your wallet.",e,-32002):(t=e.message)!=null&&t.includes("insufficient funds")?new Web3Error("INSUFFICIENT_FUNDS","Insufficient funds for transaction",e):(s=e.message)!=null&&s.includes("network")?new Web3Error("PROVIDER_ERROR","Network connection error",e):new Web3Error("PROVIDER_ERROR",e.message||"Unknown Web3 error",e)}getUserFriendlyMessage(){switch(this.type){case"WALLET_NOT_INSTALLED":return"Please install MetaMask or another Web3 wallet to continue.";case"WALLET_NOT_CONNECTED":return"Please connect your wallet to access this feature.";case"TRANSACTION_REJECTED":return"Transaction was cancelled. Please try again if you want to proceed.";case"NETWORK_UNSUPPORTED":return"This network is not supported. Please switch to a supported network.";case"INSUFFICIENT_FUNDS":return"Insufficient funds to complete this transaction.";case"CONNECTION_ERROR":return"Connection error. Please check your internet connection and try again.";case"NETWORK_SWITCH_ERROR":return"Unable to switch networks. Please manually switch in your wallet.";default:return this.message||"An unexpected error occurred. Please try again."}}}const NETWORKS=[{id:1,name:"Ethereum",symbol:"ETH",rpcUrl:"https://mainnet.infura.io/v3/${INFURA_KEY}"},{id:137,name:"Polygon",symbol:"MATIC",rpcUrl:"https://polygon-rpc.com"},{id:56,name:"BSC",symbol:"BNB",rpcUrl:"https://bsc-dataseed.binance.org"},{id:42161,name:"Arbitrum",symbol:"ETH",rpcUrl:"https://arb1.arbitrum.io/rpc"}];var AccessLevel=(r=>(r[r.PUBLIC=0]="PUBLIC",r[r.FIELD_OPERATIVE=1]="FIELD_OPERATIVE",r[r.ANALYST=2]="ANALYST",r[r.COMMANDER=3]="COMMANDER",r[r.DIRECTOR=4]="DIRECTOR",r))(AccessLevel||{});const defaultContext$1={isConnected:!1,walletAddress:"",ensName:null,networkName:"Ethereum",networkId:1,balance:"0.00",accessLevel:0,provider:null,signer:null,error:null,isLoading:!1,connectWallet:async()=>{},disconnectWallet:()=>{},switchNetwork:async()=>{},signMessage:async()=>"",clearError:()=>{}},Web3Context=reactExports.createContext(defaultContext$1),Web3Provider=({children:r})=>{const[e,t]=reactExports.useState(()=>{const z=localStorage.getItem("web3_connected");return z?JSON.parse(z):!1}),[s,n]=reactExports.useState(()=>localStorage.getItem("web3_address")||""),[i,o]=reactExports.useState(null),[a,l]=reactExports.useState(()=>{const z=localStorage.getItem("web3_network");return z?parseInt(z,10):1}),[p,g]=reactExports.useState("0.00"),[x,b]=reactExports.useState(0),[E,f]=reactExports.useState(null),[j,C]=reactExports.useState(null),[S,R]=reactExports.useState(null),[I,A]=reactExports.useState(!1);reactExports.useEffect(()=>{e?(localStorage.setItem("web3_connected",JSON.stringify(e)),localStorage.setItem("web3_address",s),localStorage.setItem("web3_network",a.toString())):(localStorage.removeItem("web3_connected"),localStorage.removeItem("web3_address"),localStorage.removeItem("web3_network"))},[e,s,a]);const $=async(z,J)=>{try{const W=await J.lookupAddress(z);return o(W),W}catch(W){return console.error("Error resolving ENS name:",W),o(null),null}},N=async(z,J)=>{try{const W=await J.getBalance(z),te=formatEther(W);g(parseFloat(te).toFixed(4))}catch(W){console.error("Error getting account balance:",W),g("0.00")}},k=z=>({"0x71c7656ec7ab88b098defb751b7401b5f6d8976f":4,"0x742d35cc6634c0532925a3b844bc454e4438f44e":2,"0x8626f6940e2eb28930efb4cef49b2d1f2c9c1199":1})[z.toLowerCase()]||0,P=()=>{R(null)},D=z=>{if(z instanceof Web3Error)return R(z),z;const J=Web3Error.fromEthereumError(z);return R(J),J},M=async()=>{A(!0),R(null);try{if(!window.ethereum)throw new Web3Error(Web3ErrorType.WALLET_NOT_INSTALLED,"Please install MetaMask or another Web3 wallet");const z=new BrowserProvider(window.ethereum),J=await z.send("eth_requestAccounts",[]);if(!J||!Array.isArray(J)||J.length===0)throw new Web3Error(Web3ErrorType.WALLET_NOT_CONNECTED,"No accounts available");const W=J[0];n(W);const te=await z.getNetwork(),xe=Number(te.chainId);l(xe);const me=await z.getSigner();C(me),await N(W,z),await $(W,z);const ye=k(W);b(ye),f(z),t(!0),window.ethereum.on("accountsChanged",L),window.ethereum.on("chainChanged",q),window.ethereum.on("disconnect",K)}catch(z){throw D(z)}finally{A(!1)}},L=async z=>{if(z.length===0)H();else if(z[0]!==s&&(n(z[0]),E)){await N(z[0],E),await $(z[0],E);const J=k(z[0]);b(J)}},q=z=>{window.location.reload()},K=()=>{H()},H=()=>{window.ethereum&&(window.ethereum.removeListener("accountsChanged",L),window.ethereum.removeListener("chainChanged",q),window.ethereum.removeListener("disconnect",K)),t(!1),n(""),g("0.00"),o(null),f(null),C(null),b(0)},ee=async z=>{if(!window.ethereum){alert("No Ethereum provider detected");return}const J=NETWORKS.find(W=>W.id===z);if(!J){alert("Invalid network selection");return}try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:`0x${z.toString(16)}`}]})}catch(W){if(W.code===4902)try{await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:`0x${z.toString(16)}`,chainName:J.name,nativeCurrency:{name:J.symbol,symbol:J.symbol,decimals:18},rpcUrls:[J.rpcUrl]}]}),await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:`0x${z.toString(16)}`}]})}catch(te){console.error("Error adding network:",te)}else console.error("Error switching network:",W)}},B=async z=>{if(!j)throw new Web3Error(Web3ErrorType.WALLET_NOT_CONNECTED,"No wallet connected");try{return await signMessage(z,E)}catch(J){throw console.error("Error signing message:",J),D(J)}},Q={isConnected:e,walletAddress:s,ensName:i,networkName:(()=>{const z=NETWORKS.find(J=>J.id===a);return z?z.name:"Unknown"})(),networkId:a,balance:p,accessLevel:x,provider:E,signer:j,error:S,isLoading:I,connectWallet:M,disconnectWallet:H,switchNetwork:ee,signMessage:B,clearError:P};return jsxRuntimeExports.jsx(Web3Context.Provider,{value:Q,children:r})},useWeb3=()=>{const r=reactExports.useContext(Web3Context);if(r===void 0)throw new Error("useWeb3 must be used within a Web3Provider");return r},LOAD_BASE=r=>Promise.reject(new Error(`No base found for "${r}"`));class Multibases{constructor(e){this._basesByName={},this._basesByPrefix={},this._loadBase=e.loadBase||LOAD_BASE;for(const t of e.bases)this.addBase(t)}addBase(e){if(this._basesByName[e.name]||this._basesByPrefix[e.prefix])throw new Error(`Codec already exists for codec "${e.name}"`);this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}removeBase(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}async getBase(e){if(this._basesByName[e])return this._basesByName[e];if(this._basesByPrefix[e])return this._basesByPrefix[e];const t=await this._loadBase(e);return this._basesByName[t.name]==null&&this._basesByPrefix[t.prefix]==null&&this.addBase(t),t}listBases(){return Object.values(this._basesByName)}}const LOAD_CODEC=r=>Promise.reject(new Error(`No codec found for "${r}"`));class Multicodecs{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||LOAD_CODEC;for(const t of e.codecs)this.addCodec(t)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}async getCodec(e){const t=typeof e=="string"?this._codecsByName:this._codecsByCode;if(t[e])return t[e];const s=await this._loadCodec(e);return t[e]==null&&this.addCodec(s),s}listCodecs(){return Object.values(this._codecsByName)}}const LOAD_HASHER=r=>Promise.reject(new Error(`No hasher found for "${r}"`));class Multihashes{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||LOAD_HASHER;for(const t of e.hashers)this.addHasher(t)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}async getHasher(e){const t=typeof e=="string"?this._hashersByName:this._hashersByCode;if(t[e])return t[e];const s=await this._loadHasher(e);return t[e]==null&&this.addHasher(s),s}listHashers(){return Object.values(this._hashersByName)}}function equals$b(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}function coerce$5(r){if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}function base$5(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var n=0;n<r.length;n++){var i=r.charAt(n),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=n}var a=r.length,l=r.charAt(0),p=Math.log(a)/Math.log(256),g=Math.log(256)/Math.log(a);function x(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var j=0,C=0,S=0,R=f.length;S!==R&&f[S]===0;)S++,j++;for(var I=(R-S)*g+1>>>0,A=new Uint8Array(I);S!==R;){for(var $=f[S],N=0,k=I-1;($!==0||N<C)&&k!==-1;k--,N++)$+=256*A[k]>>>0,A[k]=$%a>>>0,$=$/a>>>0;if($!==0)throw new Error("Non-zero carry");C=N,S++}for(var P=I-C;P!==I&&A[P]===0;)P++;for(var D=l.repeat(j);P<I;++P)D+=r.charAt(A[P]);return D}function b(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var j=0;if(f[j]!==" "){for(var C=0,S=0;f[j]===l;)C++,j++;for(var R=(f.length-j)*p+1>>>0,I=new Uint8Array(R);f[j];){var A=t[f.charCodeAt(j)];if(A===255)return;for(var $=0,N=R-1;(A!==0||$<S)&&N!==-1;N--,$++)A+=a*I[N]>>>0,I[N]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");S=$,j++}if(f[j]!==" "){for(var k=R-S;k!==R&&I[k]===0;)k++;for(var P=new Uint8Array(C+(R-k)),D=C;k!==R;)P[D++]=I[k++];return P}}}function E(f){var j=b(f);if(j)return j;throw new Error(`Non-${e} character`)}return{encode:x,decodeUnsafe:b,decode:E}}var src$6=base$5,_brrp__multiformats_scope_baseX$5=src$6;let Encoder$5=class{constructor(e,t,s){O(this,"name");O(this,"prefix");O(this,"baseEncode");this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Decoder$5=class{constructor(e,t,s){O(this,"name");O(this,"prefix");O(this,"baseDecode");O(this,"prefixCodePoint");this.name=e,this.prefix=t;const n=t.codePointAt(0);if(n===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n,this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return or$5(this,e)}},ComposedDecoder$5=class{constructor(e){O(this,"decoders");this.decoders=e}or(e){return or$5(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s!=null)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function or$5(r,e){return new ComposedDecoder$5({...r.decoders??{[r.prefix]:r},...e.decoders??{[e.prefix]:e}})}let Codec$5=class{constructor(e,t,s,n){O(this,"name");O(this,"prefix");O(this,"baseEncode");O(this,"baseDecode");O(this,"encoder");O(this,"decoder");this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=n,this.encoder=new Encoder$5(e,t,s),this.decoder=new Decoder$5(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function from$6({name:r,prefix:e,encode:t,decode:s}){return new Codec$5(r,e,t,s)}function baseX$5({name:r,prefix:e,alphabet:t}){const{encode:s,decode:n}=_brrp__multiformats_scope_baseX$5(t,r);return from$6({prefix:e,name:r,encode:s,decode:i=>coerce$5(n(i))})}function decode$z(r,e,t,s){let n=r.length;for(;r[n-1]==="=";)--n;const i=new Uint8Array(n*t/8|0);let o=0,a=0,l=0;for(let p=0;p<n;++p){const g=e[r[p]];if(g===void 0)throw new SyntaxError(`Non-${s} character`);a=a<<t|g,o+=t,o>=8&&(o-=8,i[l++]=255&a>>o)}if(o>=t||(255&a<<8-o)!==0)throw new SyntaxError("Unexpected end of data");return i}function encode$o(r,e,t){const s=e[e.length-1]==="=",n=(1<<t)-1;let i="",o=0,a=0;for(let l=0;l<r.length;++l)for(a=a<<8|r[l],o+=8;o>t;)o-=t,i+=e[n&a>>o];if(o!==0&&(i+=e[n&a<<t-o]),s)for(;(i.length*t&7)!==0;)i+="=";return i}function createAlphabetIdx$3(r){const e={};for(let t=0;t<r.length;++t)e[r[t]]=t;return e}function rfc4648$5({name:r,prefix:e,bitsPerChar:t,alphabet:s}){const n=createAlphabetIdx$3(s);return from$6({prefix:e,name:r,encode(i){return encode$o(i,s,t)},decode(i){return decode$z(i,n,t,r)}})}const base32$8=rfc4648$5({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});rfc4648$5({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});rfc4648$5({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});rfc4648$5({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});rfc4648$5({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});rfc4648$5({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});rfc4648$5({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});rfc4648$5({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});rfc4648$5({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});const base36$8=baseX$5({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"});baseX$5({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});const base58btc$5=baseX$5({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});baseX$5({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var encode_1$5=encode$n,MSB$5=128,MSBALL$4=-128,INT$4=Math.pow(2,31);function encode$n(r,e,t){e=e||[],t=t||0;for(var s=t;r>=INT$4;)e[t++]=r&255|MSB$5,r/=128;for(;r&MSBALL$4;)e[t++]=r&255|MSB$5,r>>>=7;return e[t]=r|0,encode$n.bytes=t-s+1,e}var decode$y=read$4,MSB$1$5=128,REST$1$4=127;function read$4(r,s){var t=0,s=s||0,n=0,i=s,o,a=r.length;do{if(i>=a)throw read$4.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=n<28?(o&REST$1$4)<<n:(o&REST$1$4)*Math.pow(2,n),n+=7}while(o>=MSB$1$5);return read$4.bytes=i-s,t}var N1$5=Math.pow(2,7),N2$5=Math.pow(2,14),N3$5=Math.pow(2,21),N4$5=Math.pow(2,28),N5$5=Math.pow(2,35),N6$5=Math.pow(2,42),N7$5=Math.pow(2,49),N8$4=Math.pow(2,56),N9$4=Math.pow(2,63),length$5=function(r){return r<N1$5?1:r<N2$5?2:r<N3$5?3:r<N4$5?4:r<N5$5?5:r<N6$5?6:r<N7$5?7:r<N8$4?8:r<N9$4?9:10},varint$6={encode:encode_1$5,decode:decode$y,encodingLength:length$5},_brrp_varint$4=varint$6;function decode$x(r,e=0){return[_brrp_varint$4.decode(r,e),_brrp_varint$4.decode.bytes]}function encodeTo$4(r,e,t=0){return _brrp_varint$4.encode(r,e,t),e}function encodingLength$5(r){return _brrp_varint$4.encodingLength(r)}function create$5(r,e){const t=e.byteLength,s=encodingLength$5(r),n=s+encodingLength$5(t),i=new Uint8Array(n+t);return encodeTo$4(r,i,0),encodeTo$4(t,i,s),i.set(e,n),new Digest$4(r,t,e,i)}function decode$w(r){const e=coerce$5(r),[t,s]=decode$x(e),[n,i]=decode$x(e.subarray(s)),o=e.subarray(s+i);if(o.byteLength!==n)throw new Error("Incorrect length");return new Digest$4(t,n,o,e)}function equals$a(r,e){if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&equals$b(r.bytes,t.bytes)}}let Digest$4=class{constructor(e,t,s,n){O(this,"code");O(this,"size");O(this,"digest");O(this,"bytes");this.code=e,this.size=t,this.digest=s,this.bytes=n}};function format$5(r,e){const{bytes:t,version:s}=r;switch(s){case 0:return toStringV0$4(t,baseCache$4(r),e??base58btc$5.encoder);default:return toStringV1$4(t,baseCache$4(r),e??base32$8.encoder)}}const cache$4=new WeakMap;function baseCache$4(r){const e=cache$4.get(r);if(e==null){const t=new Map;return cache$4.set(r,t),t}return e}var Ue;let CID$4=class de{constructor(e,t,s,n){O(this,"code");O(this,"version");O(this,"multihash");O(this,"bytes");O(this,"/");O(this,Ue,"CID");this.code=t,this.version=e,this.multihash=s,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE$4)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE$4)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return de.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,s=create$5(e,t);return de.createV1(this.code,s)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return de.equals(this,e)}static equals(e,t){const s=t;return s!=null&&e.code===s.code&&e.version===s.version&&equals$a(e.multihash,s.multihash)}toString(e){return format$5(this,e)}toJSON(){return{"/":format$5(this)}}link(){return this}[(Ue=Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"))](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;const t=e;if(t instanceof de)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){const{version:s,code:n,multihash:i,bytes:o}=t;return new de(s,n,i,o??encodeCID$5(s,n,i.bytes))}else if(t[cidSymbol$4]===!0){const{version:s,multihash:n,code:i}=t,o=decode$w(n);return de.create(s,i,o)}else return null}static create(e,t,s){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(s.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(t!==DAG_PB_CODE$4)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$4}) block encoding`);return new de(e,t,s,s.bytes)}case 1:{const n=encodeCID$5(e,t,s.bytes);return new de(e,t,s,n)}default:throw new Error("Invalid version")}}static createV0(e){return de.create(0,DAG_PB_CODE$4,e)}static createV1(e,t){return de.create(1,e,t)}static decode(e){const[t,s]=de.decodeFirst(e);if(s.length!==0)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=de.inspectBytes(e),s=t.size-t.multihashSize,n=coerce$5(e.subarray(s,s+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),o=new Digest$4(t.multihashCode,t.digestSize,i,n);return[t.version===0?de.createV0(o):de.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const s=()=>{const[x,b]=decode$x(e.subarray(t));return t+=b,x};let n=s(),i=DAG_PB_CODE$4;if(n===18?(n=0,t=0):i=s(),n!==0&&n!==1)throw new RangeError(`Invalid CID version ${n}`);const o=t,a=s(),l=s(),p=t+l,g=p-o;return{version:n,codec:i,multihashCode:a,digestSize:l,multihashSize:g,size:p}}static parse(e,t){const[s,n]=parseCIDtoBytes$4(e,t),i=de.decode(n);if(i.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return baseCache$4(i).set(s,e),i}};function parseCIDtoBytes$4(r,e){switch(r[0]){case"Q":{const t=e??base58btc$5;return[base58btc$5.prefix,t.decode(`${base58btc$5.prefix}${r}`)]}case base58btc$5.prefix:{const t=e??base58btc$5;return[base58btc$5.prefix,t.decode(r)]}case base32$8.prefix:{const t=e??base32$8;return[base32$8.prefix,t.decode(r)]}case base36$8.prefix:{const t=e??base36$8;return[base36$8.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}}function toStringV0$4(r,e,t){const{prefix:s}=t;if(s!==base58btc$5.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const n=e.get(s);if(n==null){const i=t.encode(r).slice(1);return e.set(s,i),i}else return n}function toStringV1$4(r,e,t){const{prefix:s}=t,n=e.get(s);if(n==null){const i=t.encode(r);return e.set(s,i),i}else return n}const DAG_PB_CODE$4=112,SHA_256_CODE$4=18;function encodeCID$5(r,e,t){const s=encodingLength$5(r),n=s+encodingLength$5(e),i=new Uint8Array(n+t.byteLength);return encodeTo$4(r,i,0),encodeTo$4(e,i,s),i.set(t,n),i}const cidSymbol$4=Symbol.for("@ipld/js-cid/CID"),textDecoder$2=new TextDecoder;function decodeVarint(r,e){let t=0;for(let s=0;;s+=7){if(s>=64)throw new Error("protobuf: varint overflow");if(e>=r.length)throw new Error("protobuf: unexpected end of data");const n=r[e++];if(t+=s<28?(n&127)<<s:(n&127)*2**s,n<128)break}return[t,e]}function decodeBytes(r,e){let t;[t,e]=decodeVarint(r,e);const s=e+t;if(t<0||s<0)throw new Error("protobuf: invalid length");if(s>r.length)throw new Error("protobuf: unexpected end of data");return[r.subarray(e,s),s]}function decodeKey(r,e){let t;return[t,e]=decodeVarint(r,e),[t&7,t>>3,e]}function decodeLink(r){const e={},t=r.length;let s=0;for(;s<t;){let n,i;if([n,i,s]=decodeKey(r,s),i===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(n!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,s]=decodeBytes(r,s)}else if(i===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(n!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let o;[o,s]=decodeBytes(r,s),e.Name=textDecoder$2.decode(o)}else if(i===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(n!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Tsize`);[e.Tsize,s]=decodeVarint(r,s)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${i}`)}if(s>t)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function decodeNode(r){const e=r.length;let t=0,s,n=!1,i;for(;t<e;){let a,l;if([a,l,t]=decodeKey(r,t),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(l===1){if(i)throw new Error("protobuf: (PBNode) duplicate Data section");[i,t]=decodeBytes(r,t),s&&(n=!0)}else if(l===2){if(n)throw new Error("protobuf: (PBNode) duplicate Links section");s||(s=[]);let p;[p,t]=decodeBytes(r,t),s.push(decodeLink(p))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${l}`)}if(t>e)throw new Error("protobuf: (PBNode) unexpected end of data");const o={};return i&&(o.Data=i),o.Links=s||[],o}const textEncoder$3=new TextEncoder,maxInt32=2**32,maxUInt32=2**31;function encodeLink(r,e){let t=e.length;if(typeof r.Tsize=="number"){if(r.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(r.Tsize))throw new Error("Tsize too large for encoding");t=encodeVarint(e,t,r.Tsize)-1,e[t]=24}if(typeof r.Name=="string"){const s=textEncoder$3.encode(r.Name);t-=s.length,e.set(s,t),t=encodeVarint(e,t,s.length)-1,e[t]=18}return r.Hash&&(t-=r.Hash.length,e.set(r.Hash,t),t=encodeVarint(e,t,r.Hash.length)-1,e[t]=10),e.length-t}function encodeNode(r){const e=sizeNode(r),t=new Uint8Array(e);let s=e;if(r.Data&&(s-=r.Data.length,t.set(r.Data,s),s=encodeVarint(t,s,r.Data.length)-1,t[s]=10),r.Links)for(let n=r.Links.length-1;n>=0;n--){const i=encodeLink(r.Links[n],t.subarray(0,s));s-=i,s=encodeVarint(t,s,i)-1,t[s]=18}return t}function sizeLink(r){let e=0;if(r.Hash){const t=r.Hash.length;e+=1+t+sov(t)}if(typeof r.Name=="string"){const t=textEncoder$3.encode(r.Name).length;e+=1+t+sov(t)}return typeof r.Tsize=="number"&&(e+=1+sov(r.Tsize)),e}function sizeNode(r){let e=0;if(r.Data){const t=r.Data.length;e+=1+t+sov(t)}if(r.Links)for(const t of r.Links){const s=sizeLink(t);e+=1+s+sov(s)}return e}function encodeVarint(r,e,t){e-=sov(t);const s=e;for(;t>=maxUInt32;)r[e++]=t&127|128,t/=128;for(;t>=128;)r[e++]=t&127|128,t>>>=7;return r[e]=t,s}function sov(r){return r%2===0&&r++,Math.floor((len64(r)+6)/7)}function len64(r){let e=0;return r>=maxInt32&&(r=Math.floor(r/maxInt32),e=32),r>=65536&&(r>>>=16,e+=16),r>=256&&(r>>>=8,e+=8),e+len8tab[r]}const len8tab=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],pbNodeProperties=["Data","Links"],pbLinkProperties=["Hash","Name","Tsize"],textEncoder$2=new TextEncoder;function linkComparator(r,e){if(r===e)return 0;const t=r.Name?textEncoder$2.encode(r.Name):[],s=e.Name?textEncoder$2.encode(e.Name):[];let n=t.length,i=s.length;for(let o=0,a=Math.min(n,i);o<a;++o)if(t[o]!==s[o]){n=t[o],i=s[o];break}return n<i?-1:i<n?1:0}function hasOnlyProperties(r,e){return!Object.keys(r).some(t=>!e.includes(t))}function asLink(r){if(typeof r.asCID=="object"){const t=CID$4.asCID(r);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if(typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");const e={};if(r.Hash){let t=CID$4.asCID(r.Hash);try{t||(typeof r.Hash=="string"?t=CID$4.parse(r.Hash):r.Hash instanceof Uint8Array&&(t=CID$4.decode(r.Hash)))}catch(s){throw new TypeError(`Invalid DAG-PB form: ${s.message}`)}t&&(e.Hash=t)}if(!e.Hash)throw new TypeError("Invalid DAG-PB form");return typeof r.Name=="string"&&(e.Name=r.Name),typeof r.Tsize=="number"&&(e.Tsize=r.Tsize),e}function prepare(r){if((r instanceof Uint8Array||typeof r=="string")&&(r={Data:r}),typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");const e={};if(r.Data!==void 0)if(typeof r.Data=="string")e.Data=textEncoder$2.encode(r.Data);else if(r.Data instanceof Uint8Array)e.Data=r.Data;else throw new TypeError("Invalid DAG-PB form");if(r.Links!==void 0)if(Array.isArray(r.Links))e.Links=r.Links.map(asLink),e.Links.sort(linkComparator);else throw new TypeError("Invalid DAG-PB form");else e.Links=[];return e}function validate$2(r){if(!r||typeof r!="object"||Array.isArray(r)||r instanceof Uint8Array||r["/"]&&r["/"]===r.bytes)throw new TypeError("Invalid DAG-PB form");if(!hasOnlyProperties(r,pbNodeProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(r.Data!==void 0&&!(r.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(r.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let e=0;e<r.Links.length;e++){const t=r.Links[e];if(!t||typeof t!="object"||Array.isArray(t)||t instanceof Uint8Array||t["/"]&&t["/"]===t.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!hasOnlyProperties(t,pbLinkProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(t.Hash===void 0)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(t.Hash==null||!t.Hash["/"]||t.Hash["/"]!==t.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(t.Name!==void 0&&typeof t.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(t.Tsize!==void 0){if(typeof t.Tsize!="number"||t.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(t.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(e>0&&linkComparator(t,r.Links[e-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function createNode(r,e=[]){return prepare({Data:r,Links:e})}function createLink(r,e,t){return asLink({Hash:t,Name:r,Tsize:e})}function toByteView$2(r){return r instanceof ArrayBuffer?new Uint8Array(r,0,r.byteLength):r}const name$6="dag-pb",code$6=112;function encode$m(r){validate$2(r);const e={};return r.Links&&(e.Links=r.Links.map(t=>{const s={};return t.Hash&&(s.Hash=t.Hash.bytes),t.Name!==void 0&&(s.Name=t.Name),t.Tsize!==void 0&&(s.Tsize=t.Tsize),s})),r.Data&&(e.Data=r.Data),encodeNode(e)}function decode$v(r){const e=toByteView$2(r),t=decodeNode(e),s={};return t.Data&&(s.Data=t.Data),t.Links&&(s.Links=t.Links.map(n=>{const i={};try{i.Hash=CID$4.decode(n.Hash)}catch{}if(!i.Hash)throw new Error("Invalid Hash field found in link, expected CID");return n.Name!==void 0&&(i.Name=n.Name),n.Tsize!==void 0&&(i.Tsize=n.Tsize),i})),s}const dagPB=Object.freeze(Object.defineProperty({__proto__:null,code:code$6,createLink,createNode,decode:decode$v,encode:encode$m,name:name$6,prepare,validate:validate$2},Symbol.toStringTag,{value:"Module"})),typeofs=["string","number","bigint","symbol"],objectTypeNames=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function is(r){if(r===null)return"null";if(r===void 0)return"undefined";if(r===!0||r===!1)return"boolean";const e=typeof r;if(typeofs.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(r))return"Array";if(isBuffer$1(r))return"Buffer";const t=getObjectType(r);return t||"Object"}function isBuffer$1(r){return r&&r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer.call(null,r)}function getObjectType(r){const e=Object.prototype.toString.call(r).slice(8,-1);if(objectTypeNames.includes(e))return e}class Type{constructor(e,t,s){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=s}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}Type.uint=new Type(0,"uint",!0);Type.negint=new Type(1,"negint",!0);Type.bytes=new Type(2,"bytes",!0);Type.string=new Type(3,"string",!0);Type.array=new Type(4,"array",!1);Type.map=new Type(5,"map",!1);Type.tag=new Type(6,"tag",!1);Type.float=new Type(7,"float",!0);Type.false=new Type(7,"false",!0);Type.true=new Type(7,"true",!0);Type.null=new Type(7,"null",!0);Type.undefined=new Type(7,"undefined",!0);Type.break=new Type(7,"break",!0);class Token{constructor(e,t,s){this.type=e,this.value=t,this.encodedLength=s,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const useBuffer=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",textDecoder$1=new TextDecoder,textEncoder$1=new TextEncoder;function isBuffer(r){return useBuffer&&globalThis.Buffer.isBuffer(r)}function asU8A(r){return r instanceof Uint8Array?isBuffer(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r:Uint8Array.from(r)}const toString$6=useBuffer?(r,e,t)=>t-e>64?globalThis.Buffer.from(r.subarray(e,t)).toString("utf8"):utf8Slice(r,e,t):(r,e,t)=>t-e>64?textDecoder$1.decode(r.subarray(e,t)):utf8Slice(r,e,t),fromString$6=useBuffer?r=>r.length>64?globalThis.Buffer.from(r):utf8ToBytes(r):r=>r.length>64?textEncoder$1.encode(r):utf8ToBytes(r),fromArray=r=>Uint8Array.from(r),slice=useBuffer?(r,e,t)=>isBuffer(r)?new Uint8Array(r.subarray(e,t)):r.slice(e,t):(r,e,t)=>r.slice(e,t),concat$2=useBuffer?(r,e)=>(r=r.map(t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t)),asU8A(globalThis.Buffer.concat(r,e))):(r,e)=>{const t=new Uint8Array(e);let s=0;for(let n of r)s+n.length>t.length&&(n=n.subarray(0,t.length-s)),t.set(n,s),s+=n.length;return t},alloc=useBuffer?r=>globalThis.Buffer.allocUnsafe(r):r=>new Uint8Array(r);function compare(r,e){if(isBuffer(r)&&isBuffer(e))return r.compare(e);for(let t=0;t<r.length;t++)if(r[t]!==e[t])return r[t]<e[t]?-1:1;return 0}function utf8ToBytes(r){const e=[];let t=0;for(let s=0;s<r.length;s++){let n=r.charCodeAt(s);n<128?e[t++]=n:n<2048?(e[t++]=n>>6|192,e[t++]=n&63|128):(n&64512)===55296&&s+1<r.length&&(r.charCodeAt(s+1)&64512)===56320?(n=65536+((n&1023)<<10)+(r.charCodeAt(++s)&1023),e[t++]=n>>18|240,e[t++]=n>>12&63|128,e[t++]=n>>6&63|128,e[t++]=n&63|128):(e[t++]=n>>12|224,e[t++]=n>>6&63|128,e[t++]=n&63|128)}return e}function utf8Slice(r,e,t){const s=[];for(;e<t;){const n=r[e];let i=null,o=n>239?4:n>223?3:n>191?2:1;if(e+o<=t){let a,l,p,g;switch(o){case 1:n<128&&(i=n);break;case 2:a=r[e+1],(a&192)===128&&(g=(n&31)<<6|a&63,g>127&&(i=g));break;case 3:a=r[e+1],l=r[e+2],(a&192)===128&&(l&192)===128&&(g=(n&15)<<12|(a&63)<<6|l&63,g>2047&&(g<55296||g>57343)&&(i=g));break;case 4:a=r[e+1],l=r[e+2],p=r[e+3],(a&192)===128&&(l&192)===128&&(p&192)===128&&(g=(n&15)<<18|(a&63)<<12|(l&63)<<6|p&63,g>65535&&g<1114112&&(i=g))}}i===null?(i=65533,o=1):i>65535&&(i-=65536,s.push(i>>>10&1023|55296),i=56320|i&1023),s.push(i),e+=o}return decodeCodePointsArray(s)}const MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(r){const e=r.length;if(e<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,r);let t="",s=0;for(;s<e;)t+=String.fromCharCode.apply(String,r.slice(s,s+=MAX_ARGUMENTS_LENGTH));return t}const defaultChunkSize=256;class Bl{constructor(e=defaultChunkSize){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const n=t.length-(this.maxCursor-this.cursor)-1;t.set(e,n)}else{if(t){const n=t.length-(this.maxCursor-this.cursor)-1;n<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,n),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=alloc(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(this.chunks.length===1){const s=this.chunks[0];e&&this.cursor>s.length/2?(t=this.cursor===s.length?s:s.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=slice(s,0,this.cursor)}else t=concat$2(this.chunks,this.cursor);return e&&this.reset(),t}}const decodeErrPrefix="CBOR decode error:",encodeErrPrefix="CBOR encode error:";function assertEnoughData(r,e,t){if(r.length-e<t)throw new Error(`${decodeErrPrefix} not enough data for type`)}const uintBoundaries=[24,256,65536,4294967296,BigInt("18446744073709551616")];function readUint8(r,e,t){assertEnoughData(r,e,1);const s=r[e];if(t.strict===!0&&s<uintBoundaries[0])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return s}function readUint16(r,e,t){assertEnoughData(r,e,2);const s=r[e]<<8|r[e+1];if(t.strict===!0&&s<uintBoundaries[1])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return s}function readUint32(r,e,t){assertEnoughData(r,e,4);const s=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3];if(t.strict===!0&&s<uintBoundaries[2])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return s}function readUint64(r,e,t){assertEnoughData(r,e,8);const s=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3],n=r[e+4]*16777216+(r[e+5]<<16)+(r[e+6]<<8)+r[e+7],i=(BigInt(s)<<BigInt(32))+BigInt(n);if(t.strict===!0&&i<uintBoundaries[3])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(t.allowBigInt===!0)return i;throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`)}function decodeUint8(r,e,t,s){return new Token(Type.uint,readUint8(r,e+1,s),2)}function decodeUint16(r,e,t,s){return new Token(Type.uint,readUint16(r,e+1,s),3)}function decodeUint32(r,e,t,s){return new Token(Type.uint,readUint32(r,e+1,s),5)}function decodeUint64(r,e,t,s){return new Token(Type.uint,readUint64(r,e+1,s),9)}function encodeUint(r,e){return encodeUintValue(r,0,e.value)}function encodeUintValue(r,e,t){if(t<uintBoundaries[0]){const s=Number(t);r.push([e|s])}else if(t<uintBoundaries[1]){const s=Number(t);r.push([e|24,s])}else if(t<uintBoundaries[2]){const s=Number(t);r.push([e|25,s>>>8,s&255])}else if(t<uintBoundaries[3]){const s=Number(t);r.push([e|26,s>>>24&255,s>>>16&255,s>>>8&255,s&255])}else{const s=BigInt(t);if(s<uintBoundaries[4]){const n=[e|27,0,0,0,0,0,0,0];let i=Number(s&BigInt(4294967295)),o=Number(s>>BigInt(32)&BigInt(4294967295));n[8]=i&255,i=i>>8,n[7]=i&255,i=i>>8,n[6]=i&255,i=i>>8,n[5]=i&255,n[4]=o&255,o=o>>8,n[3]=o&255,o=o>>8,n[2]=o&255,o=o>>8,n[1]=o&255,r.push(n)}else throw new Error(`${decodeErrPrefix} encountered BigInt larger than allowable range`)}}encodeUint.encodedSize=function(e){return encodeUintValue.encodedSize(e.value)};encodeUintValue.encodedSize=function(e){return e<uintBoundaries[0]?1:e<uintBoundaries[1]?2:e<uintBoundaries[2]?3:e<uintBoundaries[3]?5:9};encodeUint.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};function decodeNegint8(r,e,t,s){return new Token(Type.negint,-1-readUint8(r,e+1,s),2)}function decodeNegint16(r,e,t,s){return new Token(Type.negint,-1-readUint16(r,e+1,s),3)}function decodeNegint32(r,e,t,s){return new Token(Type.negint,-1-readUint32(r,e+1,s),5)}const neg1b=BigInt(-1),pos1b=BigInt(1);function decodeNegint64(r,e,t,s){const n=readUint64(r,e+1,s);if(typeof n!="bigint"){const i=-1-n;if(i>=Number.MIN_SAFE_INTEGER)return new Token(Type.negint,i,9)}if(s.allowBigInt!==!0)throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`);return new Token(Type.negint,neg1b-BigInt(n),9)}function encodeNegint(r,e){const t=e.value,s=typeof t=="bigint"?t*neg1b-pos1b:t*-1-1;encodeUintValue(r,e.type.majorEncoded,s)}encodeNegint.encodedSize=function(e){const t=e.value,s=typeof t=="bigint"?t*neg1b-pos1b:t*-1-1;return s<uintBoundaries[0]?1:s<uintBoundaries[1]?2:s<uintBoundaries[2]?3:s<uintBoundaries[3]?5:9};encodeNegint.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0};function toToken$3(r,e,t,s){assertEnoughData(r,e,t+s);const n=slice(r,e+t,e+t+s);return new Token(Type.bytes,n,t+s)}function decodeBytesCompact(r,e,t,s){return toToken$3(r,e,1,t)}function decodeBytes8(r,e,t,s){return toToken$3(r,e,2,readUint8(r,e+1,s))}function decodeBytes16(r,e,t,s){return toToken$3(r,e,3,readUint16(r,e+1,s))}function decodeBytes32(r,e,t,s){return toToken$3(r,e,5,readUint32(r,e+1,s))}function decodeBytes64(r,e,t,s){const n=readUint64(r,e+1,s);if(typeof n=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer bytes lengths not supported`);return toToken$3(r,e,9,n)}function tokenBytes(r){return r.encodedBytes===void 0&&(r.encodedBytes=r.type===Type.string?fromString$6(r.value):r.value),r.encodedBytes}function encodeBytes(r,e){const t=tokenBytes(e);encodeUintValue(r,e.type.majorEncoded,t.length),r.push(t)}encodeBytes.encodedSize=function(e){const t=tokenBytes(e);return encodeUintValue.encodedSize(t.length)+t.length};encodeBytes.compareTokens=function(e,t){return compareBytes(tokenBytes(e),tokenBytes(t))};function compareBytes(r,e){return r.length<e.length?-1:r.length>e.length?1:compare(r,e)}function toToken$2(r,e,t,s,n){const i=t+s;assertEnoughData(r,e,i);const o=new Token(Type.string,toString$6(r,e+t,e+i),i);return n.retainStringBytes===!0&&(o.byteValue=slice(r,e+t,e+i)),o}function decodeStringCompact(r,e,t,s){return toToken$2(r,e,1,t,s)}function decodeString8(r,e,t,s){return toToken$2(r,e,2,readUint8(r,e+1,s),s)}function decodeString16(r,e,t,s){return toToken$2(r,e,3,readUint16(r,e+1,s),s)}function decodeString32(r,e,t,s){return toToken$2(r,e,5,readUint32(r,e+1,s),s)}function decodeString64(r,e,t,s){const n=readUint64(r,e+1,s);if(typeof n=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer string lengths not supported`);return toToken$2(r,e,9,n,s)}const encodeString=encodeBytes;function toToken$1(r,e,t,s){return new Token(Type.array,s,t)}function decodeArrayCompact(r,e,t,s){return toToken$1(r,e,1,t)}function decodeArray8(r,e,t,s){return toToken$1(r,e,2,readUint8(r,e+1,s))}function decodeArray16(r,e,t,s){return toToken$1(r,e,3,readUint16(r,e+1,s))}function decodeArray32(r,e,t,s){return toToken$1(r,e,5,readUint32(r,e+1,s))}function decodeArray64(r,e,t,s){const n=readUint64(r,e+1,s);if(typeof n=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer array lengths not supported`);return toToken$1(r,e,9,n)}function decodeArrayIndefinite(r,e,t,s){if(s.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken$1(r,e,1,1/0)}function encodeArray(r,e){encodeUintValue(r,Type.array.majorEncoded,e.value)}encodeArray.compareTokens=encodeUint.compareTokens;encodeArray.encodedSize=function(e){return encodeUintValue.encodedSize(e.value)};function toToken(r,e,t,s){return new Token(Type.map,s,t)}function decodeMapCompact(r,e,t,s){return toToken(r,e,1,t)}function decodeMap8(r,e,t,s){return toToken(r,e,2,readUint8(r,e+1,s))}function decodeMap16(r,e,t,s){return toToken(r,e,3,readUint16(r,e+1,s))}function decodeMap32(r,e,t,s){return toToken(r,e,5,readUint32(r,e+1,s))}function decodeMap64(r,e,t,s){const n=readUint64(r,e+1,s);if(typeof n=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer map lengths not supported`);return toToken(r,e,9,n)}function decodeMapIndefinite(r,e,t,s){if(s.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken(r,e,1,1/0)}function encodeMap(r,e){encodeUintValue(r,Type.map.majorEncoded,e.value)}encodeMap.compareTokens=encodeUint.compareTokens;encodeMap.encodedSize=function(e){return encodeUintValue.encodedSize(e.value)};function decodeTagCompact(r,e,t,s){return new Token(Type.tag,t,1)}function decodeTag8(r,e,t,s){return new Token(Type.tag,readUint8(r,e+1,s),2)}function decodeTag16(r,e,t,s){return new Token(Type.tag,readUint16(r,e+1,s),3)}function decodeTag32(r,e,t,s){return new Token(Type.tag,readUint32(r,e+1,s),5)}function decodeTag64(r,e,t,s){return new Token(Type.tag,readUint64(r,e+1,s),9)}function encodeTag(r,e){encodeUintValue(r,Type.tag.majorEncoded,e.value)}encodeTag.compareTokens=encodeUint.compareTokens;encodeTag.encodedSize=function(e){return encodeUintValue.encodedSize(e.value)};const MINOR_FALSE=20,MINOR_TRUE=21,MINOR_NULL=22,MINOR_UNDEFINED=23;function decodeUndefined(r,e,t,s){if(s.allowUndefined===!1)throw new Error(`${decodeErrPrefix} undefined values are not supported`);return s.coerceUndefinedToNull===!0?new Token(Type.null,null,1):new Token(Type.undefined,void 0,1)}function decodeBreak(r,e,t,s){if(s.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return new Token(Type.break,void 0,1)}function createToken(r,e,t){if(t){if(t.allowNaN===!1&&Number.isNaN(r))throw new Error(`${decodeErrPrefix} NaN values are not supported`);if(t.allowInfinity===!1&&(r===1/0||r===-1/0))throw new Error(`${decodeErrPrefix} Infinity values are not supported`)}return new Token(Type.float,r,e)}function decodeFloat16(r,e,t,s){return createToken(readFloat16(r,e+1),3,s)}function decodeFloat32(r,e,t,s){return createToken(readFloat32(r,e+1),5,s)}function decodeFloat64(r,e,t,s){return createToken(readFloat64(r,e+1),9,s)}function encodeFloat(r,e,t){const s=e.value;if(s===!1)r.push([Type.float.majorEncoded|MINOR_FALSE]);else if(s===!0)r.push([Type.float.majorEncoded|MINOR_TRUE]);else if(s===null)r.push([Type.float.majorEncoded|MINOR_NULL]);else if(s===void 0)r.push([Type.float.majorEncoded|MINOR_UNDEFINED]);else{let n,i=!1;(!t||t.float64!==!0)&&(encodeFloat16(s),n=readFloat16(ui8a,1),s===n||Number.isNaN(s)?(ui8a[0]=249,r.push(ui8a.slice(0,3)),i=!0):(encodeFloat32(s),n=readFloat32(ui8a,1),s===n&&(ui8a[0]=250,r.push(ui8a.slice(0,5)),i=!0))),i||(encodeFloat64(s),n=readFloat64(ui8a,1),ui8a[0]=251,r.push(ui8a.slice(0,9)))}}encodeFloat.encodedSize=function(e,t){const s=e.value;if(s===!1||s===!0||s===null||s===void 0)return 1;if(!t||t.float64!==!0){encodeFloat16(s);let n=readFloat16(ui8a,1);if(s===n||Number.isNaN(s))return 3;if(encodeFloat32(s),n=readFloat32(ui8a,1),s===n)return 5}return 9};const buffer$1=new ArrayBuffer(9),dataView=new DataView(buffer$1,1),ui8a=new Uint8Array(buffer$1,0);function encodeFloat16(r){if(r===1/0)dataView.setUint16(0,31744,!1);else if(r===-1/0)dataView.setUint16(0,64512,!1);else if(Number.isNaN(r))dataView.setUint16(0,32256,!1);else{dataView.setFloat32(0,r);const e=dataView.getUint32(0),t=(e&2139095040)>>23,s=e&8388607;if(t===255)dataView.setUint16(0,31744,!1);else if(t===0)dataView.setUint16(0,(r&2147483648)>>16|s>>13,!1);else{const n=t-127;n<-24?dataView.setUint16(0,0):n<-14?dataView.setUint16(0,(e&2147483648)>>16|1<<24+n,!1):dataView.setUint16(0,(e&2147483648)>>16|n+15<<10|s>>13,!1)}}}function readFloat16(r,e){if(r.length-e<2)throw new Error(`${decodeErrPrefix} not enough data for float16`);const t=(r[e]<<8)+r[e+1];if(t===31744)return 1/0;if(t===64512)return-1/0;if(t===32256)return NaN;const s=t>>10&31,n=t&1023;let i;return s===0?i=n*2**-24:s!==31?i=(n+1024)*2**(s-25):i=n===0?1/0:NaN,t&32768?-i:i}function encodeFloat32(r){dataView.setFloat32(0,r,!1)}function readFloat32(r,e){if(r.length-e<4)throw new Error(`${decodeErrPrefix} not enough data for float32`);const t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,4).getFloat32(0,!1)}function encodeFloat64(r){dataView.setFloat64(0,r,!1)}function readFloat64(r,e){if(r.length-e<8)throw new Error(`${decodeErrPrefix} not enough data for float64`);const t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,8).getFloat64(0,!1)}encodeFloat.compareTokens=encodeUint.compareTokens;function invalidMinor(r,e,t){throw new Error(`${decodeErrPrefix} encountered invalid minor (${t}) for major ${r[e]>>>5}`)}function errorer(r){return()=>{throw new Error(`${decodeErrPrefix} ${r}`)}}const jump=[];for(let r=0;r<=23;r++)jump[r]=invalidMinor;jump[24]=decodeUint8;jump[25]=decodeUint16;jump[26]=decodeUint32;jump[27]=decodeUint64;jump[28]=invalidMinor;jump[29]=invalidMinor;jump[30]=invalidMinor;jump[31]=invalidMinor;for(let r=32;r<=55;r++)jump[r]=invalidMinor;jump[56]=decodeNegint8;jump[57]=decodeNegint16;jump[58]=decodeNegint32;jump[59]=decodeNegint64;jump[60]=invalidMinor;jump[61]=invalidMinor;jump[62]=invalidMinor;jump[63]=invalidMinor;for(let r=64;r<=87;r++)jump[r]=decodeBytesCompact;jump[88]=decodeBytes8;jump[89]=decodeBytes16;jump[90]=decodeBytes32;jump[91]=decodeBytes64;jump[92]=invalidMinor;jump[93]=invalidMinor;jump[94]=invalidMinor;jump[95]=errorer("indefinite length bytes/strings are not supported");for(let r=96;r<=119;r++)jump[r]=decodeStringCompact;jump[120]=decodeString8;jump[121]=decodeString16;jump[122]=decodeString32;jump[123]=decodeString64;jump[124]=invalidMinor;jump[125]=invalidMinor;jump[126]=invalidMinor;jump[127]=errorer("indefinite length bytes/strings are not supported");for(let r=128;r<=151;r++)jump[r]=decodeArrayCompact;jump[152]=decodeArray8;jump[153]=decodeArray16;jump[154]=decodeArray32;jump[155]=decodeArray64;jump[156]=invalidMinor;jump[157]=invalidMinor;jump[158]=invalidMinor;jump[159]=decodeArrayIndefinite;for(let r=160;r<=183;r++)jump[r]=decodeMapCompact;jump[184]=decodeMap8;jump[185]=decodeMap16;jump[186]=decodeMap32;jump[187]=decodeMap64;jump[188]=invalidMinor;jump[189]=invalidMinor;jump[190]=invalidMinor;jump[191]=decodeMapIndefinite;for(let r=192;r<=215;r++)jump[r]=decodeTagCompact;jump[216]=decodeTag8;jump[217]=decodeTag16;jump[218]=decodeTag32;jump[219]=decodeTag64;jump[220]=invalidMinor;jump[221]=invalidMinor;jump[222]=invalidMinor;jump[223]=invalidMinor;for(let r=224;r<=243;r++)jump[r]=errorer("simple values are not supported");jump[244]=invalidMinor;jump[245]=invalidMinor;jump[246]=invalidMinor;jump[247]=decodeUndefined;jump[248]=errorer("simple values are not supported");jump[249]=decodeFloat16;jump[250]=decodeFloat32;jump[251]=decodeFloat64;jump[252]=invalidMinor;jump[253]=invalidMinor;jump[254]=invalidMinor;jump[255]=decodeBreak;const quick=[];for(let r=0;r<24;r++)quick[r]=new Token(Type.uint,r,1);for(let r=-1;r>=-24;r--)quick[31-r]=new Token(Type.negint,r,1);quick[64]=new Token(Type.bytes,new Uint8Array(0),1);quick[96]=new Token(Type.string,"",1);quick[128]=new Token(Type.array,0,1);quick[160]=new Token(Type.map,0,1);quick[244]=new Token(Type.false,!1,1);quick[245]=new Token(Type.true,!0,1);quick[246]=new Token(Type.null,null,1);function quickEncodeToken(r){switch(r.type){case Type.false:return fromArray([244]);case Type.true:return fromArray([245]);case Type.null:return fromArray([246]);case Type.bytes:return r.value.length?void 0:fromArray([64]);case Type.string:return r.value===""?fromArray([96]):void 0;case Type.array:return r.value===0?fromArray([128]):void 0;case Type.map:return r.value===0?fromArray([160]):void 0;case Type.uint:return r.value<24?fromArray([Number(r.value)]):void 0;case Type.negint:if(r.value>=-24)return fromArray([31-Number(r.value)])}}const defaultEncodeOptions$1={float64:!1,mapSorter:mapSorter$1,quickEncodeToken};function makeCborEncoders(){const r=[];return r[Type.uint.major]=encodeUint,r[Type.negint.major]=encodeNegint,r[Type.bytes.major]=encodeBytes,r[Type.string.major]=encodeString,r[Type.array.major]=encodeArray,r[Type.map.major]=encodeMap,r[Type.tag.major]=encodeTag,r[Type.float.major]=encodeFloat,r}const cborEncoders=makeCborEncoders(),buf=new Bl;class Ref{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do if(t.obj===e)return!0;while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${encodeErrPrefix} object contains circular references`);return new Ref(t,e)}}const simpleTokens={null:new Token(Type.null,null),undefined:new Token(Type.undefined,void 0),true:new Token(Type.true,!0),false:new Token(Type.false,!1),emptyArray:new Token(Type.array,0),emptyMap:new Token(Type.map,0)},typeEncoders={number(r,e,t,s){return!Number.isInteger(r)||!Number.isSafeInteger(r)?new Token(Type.float,r):r>=0?new Token(Type.uint,r):new Token(Type.negint,r)},bigint(r,e,t,s){return r>=BigInt(0)?new Token(Type.uint,r):new Token(Type.negint,r)},Uint8Array(r,e,t,s){return new Token(Type.bytes,r)},string(r,e,t,s){return new Token(Type.string,r)},boolean(r,e,t,s){return r?simpleTokens.true:simpleTokens.false},null(r,e,t,s){return simpleTokens.null},undefined(r,e,t,s){return simpleTokens.undefined},ArrayBuffer(r,e,t,s){return new Token(Type.bytes,new Uint8Array(r))},DataView(r,e,t,s){return new Token(Type.bytes,new Uint8Array(r.buffer,r.byteOffset,r.byteLength))},Array(r,e,t,s){if(!r.length)return t.addBreakTokens===!0?[simpleTokens.emptyArray,new Token(Type.break)]:simpleTokens.emptyArray;s=Ref.createCheck(s,r);const n=[];let i=0;for(const o of r)n[i++]=objectToTokens(o,t,s);return t.addBreakTokens?[new Token(Type.array,r.length),n,new Token(Type.break)]:[new Token(Type.array,r.length),n]},Object(r,e,t,s){const n=e!=="Object",i=n?r.keys():Object.keys(r),o=n?r.size:i.length;if(!o)return t.addBreakTokens===!0?[simpleTokens.emptyMap,new Token(Type.break)]:simpleTokens.emptyMap;s=Ref.createCheck(s,r);const a=[];let l=0;for(const p of i)a[l++]=[objectToTokens(p,t,s),objectToTokens(n?r.get(p):r[p],t,s)];return sortMapEntries(a,t),t.addBreakTokens?[new Token(Type.map,o),a,new Token(Type.break)]:[new Token(Type.map,o),a]}};typeEncoders.Map=typeEncoders.Object;typeEncoders.Buffer=typeEncoders.Uint8Array;for(const r of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))typeEncoders[`${r}Array`]=typeEncoders.DataView;function objectToTokens(r,e={},t){const s=is(r),n=e&&e.typeEncoders&&e.typeEncoders[s]||typeEncoders[s];if(typeof n=="function"){const o=n(r,s,e,t);if(o!=null)return o}const i=typeEncoders[s];if(!i)throw new Error(`${encodeErrPrefix} unsupported type: ${s}`);return i(r,s,e,t)}function sortMapEntries(r,e){e.mapSorter&&r.sort(e.mapSorter)}function mapSorter$1(r,e){const t=Array.isArray(r[0])?r[0][0]:r[0],s=Array.isArray(e[0])?e[0][0]:e[0];if(t.type!==s.type)return t.type.compare(s.type);const n=t.type.major,i=cborEncoders[n].compareTokens(t,s);return i===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),i}function tokensToEncoded(r,e,t,s){if(Array.isArray(e))for(const n of e)tokensToEncoded(r,n,t,s);else t[e.type.major](r,e,s)}function encodeCustom(r,e,t){const s=objectToTokens(r,t);if(!Array.isArray(s)&&t.quickEncodeToken){const n=t.quickEncodeToken(s);if(n)return n;const i=e[s.type.major];if(i.encodedSize){const o=i.encodedSize(s,t),a=new Bl(o);if(i(a,s,t),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${s} was wrong`);return asU8A(a.chunks[0])}}return buf.reset(),tokensToEncoded(buf,s,e,t),buf.toBytes(!0)}function encode$l(r,e){return e=Object.assign({},defaultEncodeOptions$1,e),encodeCustom(r,cborEncoders,e)}const defaultDecodeOptions={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Tokeniser{constructor(e,t={}){this._pos=0,this.data=e,this.options=t}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const e=this.data[this._pos];let t=quick[e];if(t===void 0){const s=jump[e];if(!s)throw new Error(`${decodeErrPrefix} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);const n=e&31;t=s(this.data,this._pos,n,this.options)}return this._pos+=t.encodedLength,t}}const DONE=Symbol.for("DONE"),BREAK=Symbol.for("BREAK");function tokenToArray(r,e,t){const s=[];for(let n=0;n<r.value;n++){const i=tokensToObject(e,t);if(i===BREAK){if(r.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed array`)}if(i===DONE)throw new Error(`${decodeErrPrefix} found array but not enough entries (got ${n}, expected ${r.value})`);s[n]=i}return s}function tokenToMap(r,e,t){const s=t.useMaps===!0,n=s?void 0:{},i=s?new Map:void 0;for(let o=0;o<r.value;o++){const a=tokensToObject(e,t);if(a===BREAK){if(r.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed map`)}if(a===DONE)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${o} [no key], expected ${r.value})`);if(s!==!0&&typeof a!="string")throw new Error(`${decodeErrPrefix} non-string keys not supported (got ${typeof a})`);if(t.rejectDuplicateMapKeys===!0&&(s&&i.has(a)||!s&&a in n))throw new Error(`${decodeErrPrefix} found repeat map key "${a}"`);const l=tokensToObject(e,t);if(l===DONE)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${o} [no value], expected ${r.value})`);s?i.set(a,l):n[a]=l}return s?i:n}function tokensToObject(r,e){if(r.done())return DONE;const t=r.next();if(t.type===Type.break)return BREAK;if(t.type.terminal)return t.value;if(t.type===Type.array)return tokenToArray(t,r,e);if(t.type===Type.map)return tokenToMap(t,r,e);if(t.type===Type.tag){if(e.tags&&typeof e.tags[t.value]=="function"){const s=tokensToObject(r,e);return e.tags[t.value](s)}throw new Error(`${decodeErrPrefix} tag not supported (${t.value})`)}throw new Error("unsupported")}function decodeFirst(r,e){if(!(r instanceof Uint8Array))throw new Error(`${decodeErrPrefix} data to decode must be a Uint8Array`);e=Object.assign({},defaultDecodeOptions,e);const t=e.tokenizer||new Tokeniser(r,e),s=tokensToObject(t,e);if(s===DONE)throw new Error(`${decodeErrPrefix} did not find any content to decode`);if(s===BREAK)throw new Error(`${decodeErrPrefix} got unexpected break`);return[s,r.subarray(t.pos())]}function decode$u(r,e){const[t,s]=decodeFirst(r,e);if(s.length>0)throw new Error(`${decodeErrPrefix} too many terminals, data makes no sense`);return t}function equals$9(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}function coerce$4(r){if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}function base$4(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var n=0;n<r.length;n++){var i=r.charAt(n),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=n}var a=r.length,l=r.charAt(0),p=Math.log(a)/Math.log(256),g=Math.log(256)/Math.log(a);function x(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var j=0,C=0,S=0,R=f.length;S!==R&&f[S]===0;)S++,j++;for(var I=(R-S)*g+1>>>0,A=new Uint8Array(I);S!==R;){for(var $=f[S],N=0,k=I-1;($!==0||N<C)&&k!==-1;k--,N++)$+=256*A[k]>>>0,A[k]=$%a>>>0,$=$/a>>>0;if($!==0)throw new Error("Non-zero carry");C=N,S++}for(var P=I-C;P!==I&&A[P]===0;)P++;for(var D=l.repeat(j);P<I;++P)D+=r.charAt(A[P]);return D}function b(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var j=0;if(f[j]!==" "){for(var C=0,S=0;f[j]===l;)C++,j++;for(var R=(f.length-j)*p+1>>>0,I=new Uint8Array(R);f[j];){var A=t[f.charCodeAt(j)];if(A===255)return;for(var $=0,N=R-1;(A!==0||$<S)&&N!==-1;N--,$++)A+=a*I[N]>>>0,I[N]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");S=$,j++}if(f[j]!==" "){for(var k=R-S;k!==R&&I[k]===0;)k++;for(var P=new Uint8Array(C+(R-k)),D=C;k!==R;)P[D++]=I[k++];return P}}}function E(f){var j=b(f);if(j)return j;throw new Error(`Non-${e} character`)}return{encode:x,decodeUnsafe:b,decode:E}}var src$5=base$4,_brrp__multiformats_scope_baseX$4=src$5;let Encoder$4=class{constructor(e,t,s){O(this,"name");O(this,"prefix");O(this,"baseEncode");this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Decoder$4=class{constructor(e,t,s){O(this,"name");O(this,"prefix");O(this,"baseDecode");O(this,"prefixCodePoint");this.name=e,this.prefix=t;const n=t.codePointAt(0);if(n===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n,this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return or$4(this,e)}},ComposedDecoder$4=class{constructor(e){O(this,"decoders");this.decoders=e}or(e){return or$4(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s!=null)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function or$4(r,e){return new ComposedDecoder$4({...r.decoders??{[r.prefix]:r},...e.decoders??{[e.prefix]:e}})}let Codec$4=class{constructor(e,t,s,n){O(this,"name");O(this,"prefix");O(this,"baseEncode");O(this,"baseDecode");O(this,"encoder");O(this,"decoder");this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=n,this.encoder=new Encoder$4(e,t,s),this.decoder=new Decoder$4(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function from$5({name:r,prefix:e,encode:t,decode:s}){return new Codec$4(r,e,t,s)}function baseX$4({name:r,prefix:e,alphabet:t}){const{encode:s,decode:n}=_brrp__multiformats_scope_baseX$4(t,r);return from$5({prefix:e,name:r,encode:s,decode:i=>coerce$4(n(i))})}function decode$t(r,e,t,s){let n=r.length;for(;r[n-1]==="=";)--n;const i=new Uint8Array(n*t/8|0);let o=0,a=0,l=0;for(let p=0;p<n;++p){const g=e[r[p]];if(g===void 0)throw new SyntaxError(`Non-${s} character`);a=a<<t|g,o+=t,o>=8&&(o-=8,i[l++]=255&a>>o)}if(o>=t||(255&a<<8-o)!==0)throw new SyntaxError("Unexpected end of data");return i}function encode$k(r,e,t){const s=e[e.length-1]==="=",n=(1<<t)-1;let i="",o=0,a=0;for(let l=0;l<r.length;++l)for(a=a<<8|r[l],o+=8;o>t;)o-=t,i+=e[n&a>>o];if(o!==0&&(i+=e[n&a<<t-o]),s)for(;(i.length*t&7)!==0;)i+="=";return i}function createAlphabetIdx$2(r){const e={};for(let t=0;t<r.length;++t)e[r[t]]=t;return e}function rfc4648$4({name:r,prefix:e,bitsPerChar:t,alphabet:s}){const n=createAlphabetIdx$2(s);return from$5({prefix:e,name:r,encode(i){return encode$k(i,s,t)},decode(i){return decode$t(i,n,t,r)}})}const base32$7=rfc4648$4({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});rfc4648$4({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});rfc4648$4({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});rfc4648$4({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});rfc4648$4({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});rfc4648$4({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});rfc4648$4({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});rfc4648$4({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});rfc4648$4({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});const base36$7=baseX$4({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"});baseX$4({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});const base58btc$4=baseX$4({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});baseX$4({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var encode_1$4=encode$j,MSB$4=128,MSBALL$3=-128,INT$3=Math.pow(2,31);function encode$j(r,e,t){e=e||[],t=t||0;for(var s=t;r>=INT$3;)e[t++]=r&255|MSB$4,r/=128;for(;r&MSBALL$3;)e[t++]=r&255|MSB$4,r>>>=7;return e[t]=r|0,encode$j.bytes=t-s+1,e}var decode$s=read$3,MSB$1$4=128,REST$1$3=127;function read$3(r,s){var t=0,s=s||0,n=0,i=s,o,a=r.length;do{if(i>=a)throw read$3.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=n<28?(o&REST$1$3)<<n:(o&REST$1$3)*Math.pow(2,n),n+=7}while(o>=MSB$1$4);return read$3.bytes=i-s,t}var N1$4=Math.pow(2,7),N2$4=Math.pow(2,14),N3$4=Math.pow(2,21),N4$4=Math.pow(2,28),N5$4=Math.pow(2,35),N6$4=Math.pow(2,42),N7$4=Math.pow(2,49),N8$3=Math.pow(2,56),N9$3=Math.pow(2,63),length$4=function(r){return r<N1$4?1:r<N2$4?2:r<N3$4?3:r<N4$4?4:r<N5$4?5:r<N6$4?6:r<N7$4?7:r<N8$3?8:r<N9$3?9:10},varint$5={encode:encode_1$4,decode:decode$s,encodingLength:length$4},_brrp_varint$3=varint$5;function decode$r(r,e=0){return[_brrp_varint$3.decode(r,e),_brrp_varint$3.decode.bytes]}function encodeTo$3(r,e,t=0){return _brrp_varint$3.encode(r,e,t),e}function encodingLength$4(r){return _brrp_varint$3.encodingLength(r)}function create$4(r,e){const t=e.byteLength,s=encodingLength$4(r),n=s+encodingLength$4(t),i=new Uint8Array(n+t);return encodeTo$3(r,i,0),encodeTo$3(t,i,s),i.set(e,n),new Digest$3(r,t,e,i)}function decode$q(r){const e=coerce$4(r),[t,s]=decode$r(e),[n,i]=decode$r(e.subarray(s)),o=e.subarray(s+i);if(o.byteLength!==n)throw new Error("Incorrect length");return new Digest$3(t,n,o,e)}function equals$8(r,e){if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&equals$9(r.bytes,t.bytes)}}let Digest$3=class{constructor(e,t,s,n){O(this,"code");O(this,"size");O(this,"digest");O(this,"bytes");this.code=e,this.size=t,this.digest=s,this.bytes=n}};function format$4(r,e){const{bytes:t,version:s}=r;switch(s){case 0:return toStringV0$3(t,baseCache$3(r),e??base58btc$4.encoder);default:return toStringV1$3(t,baseCache$3(r),e??base32$7.encoder)}}const cache$3=new WeakMap;function baseCache$3(r){const e=cache$3.get(r);if(e==null){const t=new Map;return cache$3.set(r,t),t}return e}var Be;let CID$3=class ue{constructor(e,t,s,n){O(this,"code");O(this,"version");O(this,"multihash");O(this,"bytes");O(this,"/");O(this,Be,"CID");this.code=t,this.version=e,this.multihash=s,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE$3)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE$3)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return ue.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,s=create$4(e,t);return ue.createV1(this.code,s)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return ue.equals(this,e)}static equals(e,t){const s=t;return s!=null&&e.code===s.code&&e.version===s.version&&equals$8(e.multihash,s.multihash)}toString(e){return format$4(this,e)}toJSON(){return{"/":format$4(this)}}link(){return this}[(Be=Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"))](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;const t=e;if(t instanceof ue)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){const{version:s,code:n,multihash:i,bytes:o}=t;return new ue(s,n,i,o??encodeCID$4(s,n,i.bytes))}else if(t[cidSymbol$3]===!0){const{version:s,multihash:n,code:i}=t,o=decode$q(n);return ue.create(s,i,o)}else return null}static create(e,t,s){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(s.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(t!==DAG_PB_CODE$3)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$3}) block encoding`);return new ue(e,t,s,s.bytes)}case 1:{const n=encodeCID$4(e,t,s.bytes);return new ue(e,t,s,n)}default:throw new Error("Invalid version")}}static createV0(e){return ue.create(0,DAG_PB_CODE$3,e)}static createV1(e,t){return ue.create(1,e,t)}static decode(e){const[t,s]=ue.decodeFirst(e);if(s.length!==0)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=ue.inspectBytes(e),s=t.size-t.multihashSize,n=coerce$4(e.subarray(s,s+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),o=new Digest$3(t.multihashCode,t.digestSize,i,n);return[t.version===0?ue.createV0(o):ue.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const s=()=>{const[x,b]=decode$r(e.subarray(t));return t+=b,x};let n=s(),i=DAG_PB_CODE$3;if(n===18?(n=0,t=0):i=s(),n!==0&&n!==1)throw new RangeError(`Invalid CID version ${n}`);const o=t,a=s(),l=s(),p=t+l,g=p-o;return{version:n,codec:i,multihashCode:a,digestSize:l,multihashSize:g,size:p}}static parse(e,t){const[s,n]=parseCIDtoBytes$3(e,t),i=ue.decode(n);if(i.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return baseCache$3(i).set(s,e),i}};function parseCIDtoBytes$3(r,e){switch(r[0]){case"Q":{const t=e??base58btc$4;return[base58btc$4.prefix,t.decode(`${base58btc$4.prefix}${r}`)]}case base58btc$4.prefix:{const t=e??base58btc$4;return[base58btc$4.prefix,t.decode(r)]}case base32$7.prefix:{const t=e??base32$7;return[base32$7.prefix,t.decode(r)]}case base36$7.prefix:{const t=e??base36$7;return[base36$7.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}}function toStringV0$3(r,e,t){const{prefix:s}=t;if(s!==base58btc$4.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const n=e.get(s);if(n==null){const i=t.encode(r).slice(1);return e.set(s,i),i}else return n}function toStringV1$3(r,e,t){const{prefix:s}=t,n=e.get(s);if(n==null){const i=t.encode(r);return e.set(s,i),i}else return n}const DAG_PB_CODE$3=112,SHA_256_CODE$3=18;function encodeCID$4(r,e,t){const s=encodingLength$4(r),n=s+encodingLength$4(e),i=new Uint8Array(n+t.byteLength);return encodeTo$3(r,i,0),encodeTo$3(e,i,s),i.set(t,n),i}const cidSymbol$3=Symbol.for("@ipld/js-cid/CID"),CID_CBOR_TAG=42;function toByteView$1(r){return r instanceof ArrayBuffer?new Uint8Array(r,0,r.byteLength):r}function cidEncoder$1(r){if(r.asCID!==r&&r["/"]!==r.bytes)return null;const e=CID$3.asCID(r);if(!e)return null;const t=new Uint8Array(e.bytes.byteLength+1);return t.set(e.bytes,1),[new Token(Type.tag,CID_CBOR_TAG),new Token(Type.bytes,t)]}function undefinedEncoder$1(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder$1(r){if(Number.isNaN(r))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(r===1/0||r===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const _encodeOptions={float64:!0,typeEncoders:{Object:cidEncoder$1,undefined:undefinedEncoder$1,number:numberEncoder$1}},encodeOptions$1={..._encodeOptions,typeEncoders:{..._encodeOptions.typeEncoders}};function cidDecoder(r){if(r[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return CID$3.decode(r.subarray(1))}const _decodeOptions={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};_decodeOptions.tags[CID_CBOR_TAG]=cidDecoder;const decodeOptions$1={..._decodeOptions,tags:_decodeOptions.tags.slice()},name$5="dag-cbor",code$5=113,encode$i=r=>encode$l(r,_encodeOptions),decode$p=r=>decode$u(toByteView$1(r),_decodeOptions),dagCBOR=Object.freeze(Object.defineProperty({__proto__:null,code:code$5,decode:decode$p,decodeOptions:decodeOptions$1,encode:encode$i,encodeOptions:encodeOptions$1,name:name$5,toByteView:toByteView$1},Symbol.toStringTag,{value:"Module"}));class JSONEncoder extends Array{constructor(){super(),this.inRecursive=[]}prefix(e){const t=this.inRecursive[this.inRecursive.length-1];t&&(t.type===Type.array&&(t.elements++,t.elements!==1&&e.push([44])),t.type===Type.map&&(t.elements++,t.elements!==1&&(t.elements%2===1?e.push([44]):e.push([58]))))}[Type.uint.major](e,t){this.prefix(e);const s=String(t.value),n=[];for(let i=0;i<s.length;i++)n[i]=s.charCodeAt(i);e.push(n)}[Type.negint.major](e,t){this[Type.uint.major](e,t)}[Type.bytes.major](e,t){throw new Error(`${encodeErrPrefix} unsupported type: Uint8Array`)}[Type.string.major](e,t){this.prefix(e);const s=fromString$6(JSON.stringify(t.value));e.push(s.length>32?asU8A(s):s)}[Type.array.major](e,t){this.prefix(e),this.inRecursive.push({type:Type.array,elements:0}),e.push([91])}[Type.map.major](e,t){this.prefix(e),this.inRecursive.push({type:Type.map,elements:0}),e.push([123])}[Type.tag.major](e,t){}[Type.float.major](e,t){if(t.type.name==="break"){const o=this.inRecursive.pop();if(o){if(o.type===Type.array)e.push([93]);else if(o.type===Type.map)e.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(t.value===void 0)throw new Error(`${encodeErrPrefix} unsupported type: undefined`);if(this.prefix(e),t.type.name==="true"){e.push([116,114,117,101]);return}else if(t.type.name==="false"){e.push([102,97,108,115,101]);return}else if(t.type.name==="null"){e.push([110,117,108,108]);return}const s=String(t.value),n=[];let i=!1;for(let o=0;o<s.length;o++)n[o]=s.charCodeAt(o),!i&&(n[o]===46||n[o]===101||n[o]===69)&&(i=!0);i||(n.push(46),n.push(48)),e.push(n)}}function mapSorter(r,e){if(Array.isArray(r[0])||Array.isArray(e[0]))throw new Error(`${encodeErrPrefix} complex map keys are not supported`);const t=r[0],s=e[0];if(t.type!==Type.string||s.type!==Type.string)throw new Error(`${encodeErrPrefix} non-string map keys are not supported`);if(t<s)return-1;if(t>s)return 1;throw new Error(`${encodeErrPrefix} unexpected duplicate map keys, this is not supported`)}const defaultEncodeOptions={addBreakTokens:!0,mapSorter};function encode$h(r,e){return e=Object.assign({},defaultEncodeOptions,e),encodeCustom(r,new JSONEncoder,e)}class Tokenizer{constructor(e,t={}){this._pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}pos(){return this._pos}done(){return this._pos>=this.data.length}ch(){return this.data[this._pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;e===32||e===9||e===13||e===10;)e=this.data[++this._pos]}expect(e){if(this.data.length-this._pos<e.length)throw new Error(`${decodeErrPrefix} unexpected end of input at position ${this._pos}`);for(let t=0;t<e.length;t++)if(this.data[this._pos++]!==e[t])throw new Error(`${decodeErrPrefix} unexpected token at position ${this._pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){const e=this._pos;let t=!1,s=!1;const n=a=>{for(;!this.done();){const l=this.ch();if(a.includes(l))this._pos++;else break}};if(this.ch()===45&&(t=!0,this._pos++),this.ch()===48)if(this._pos++,this.ch()===46)this._pos++,s=!0;else return new Token(Type.uint,0,this._pos-e);if(n([48,49,50,51,52,53,54,55,56,57]),t&&this._pos===e+1)throw new Error(`${decodeErrPrefix} unexpected token at position ${this._pos}`);if(!this.done()&&this.ch()===46){if(s)throw new Error(`${decodeErrPrefix} unexpected token at position ${this._pos}`);s=!0,this._pos++,n([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(s=!0,this._pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this._pos++,n([48,49,50,51,52,53,54,55,56,57]));const i=String.fromCharCode.apply(null,this.data.subarray(e,this._pos)),o=parseFloat(i);return s?new Token(Type.float,o,this._pos-e):this.options.allowBigInt!==!0||Number.isSafeInteger(o)?new Token(o>=0?Type.uint:Type.negint,o,this._pos-e):new Token(o>=0?Type.uint:Type.negint,BigInt(i),this._pos-e)}parseString(){if(this.ch()!==34)throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}; this shouldn't happen`);this._pos++;for(let i=this._pos,o=0;i<this.data.length&&o<65536;i++,o++){const a=this.data[i];if(a===92||a<32||a>=128)break;if(a===34){const l=String.fromCharCode.apply(null,this.data.subarray(this._pos,i));return this._pos=i+1,new Token(Type.string,l,o)}}const e=this._pos,t=[],s=()=>{if(this._pos+4>=this.data.length)throw new Error(`${decodeErrPrefix} unexpected end of unicode escape sequence at position ${this._pos}`);let i=0;for(let o=0;o<4;o++){let a=this.ch();if(a>=48&&a<=57)a-=48;else if(a>=97&&a<=102)a=a-97+10;else if(a>=65&&a<=70)a=a-65+10;else throw new Error(`${decodeErrPrefix} unexpected unicode escape character at position ${this._pos}`);i=i*16+a,this._pos++}return i},n=()=>{const i=this.ch();let o=null,a=i>239?4:i>223?3:i>191?2:1;if(this._pos+a>this.data.length)throw new Error(`${decodeErrPrefix} unexpected unicode sequence at position ${this._pos}`);let l,p,g,x;switch(a){case 1:i<128&&(o=i);break;case 2:l=this.data[this._pos+1],(l&192)===128&&(x=(i&31)<<6|l&63,x>127&&(o=x));break;case 3:l=this.data[this._pos+1],p=this.data[this._pos+2],(l&192)===128&&(p&192)===128&&(x=(i&15)<<12|(l&63)<<6|p&63,x>2047&&(x<55296||x>57343)&&(o=x));break;case 4:l=this.data[this._pos+1],p=this.data[this._pos+2],g=this.data[this._pos+3],(l&192)===128&&(p&192)===128&&(g&192)===128&&(x=(i&15)<<18|(l&63)<<12|(p&63)<<6|g&63,x>65535&&x<1114112&&(o=x))}o===null?(o=65533,a=1):o>65535&&(o-=65536,t.push(o>>>10&1023|55296),o=56320|o&1023),t.push(o),this._pos+=a};for(;!this.done();){const i=this.ch();let o;switch(i){case 92:if(this._pos++,this.done())throw new Error(`${decodeErrPrefix} unexpected string termination at position ${this._pos}`);switch(o=this.ch(),this._pos++,o){case 34:case 39:case 92:case 47:t.push(o);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(s());break;default:throw new Error(`${decodeErrPrefix} unexpected string escape character at position ${this._pos}`)}break;case 34:return this._pos++,new Token(Type.string,decodeCodePointsArray(t),this._pos-e);default:if(i<32)throw new Error(`${decodeErrPrefix} invalid control character at position ${this._pos}`);i<128?(t.push(i),this._pos++):n()}}throw new Error(`${decodeErrPrefix} unexpected end of string at position ${this._pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this._pos++,new Token(Type.map,1/0,1);case 91:return this.modeStack.push("array-start"),this._pos++,new Token(Type.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new Token(Type.null,null,4);case 102:return this.expect([102,97,108,115,101]),new Token(Type.false,!1,5);case 116:return this.expect([116,114,117,101]),new Token(Type.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);if(this.ch()!==44)throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);if(this.ch()!==44)throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this._pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);const e=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${decodeErrPrefix} unexpected parse state at position ${this._pos}; this shouldn't happen`)}}}function decode$o(r,e){return e=Object.assign({tokenizer:new Tokenizer(r,e)},e),decode$u(r,e)}function equals$7(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}function coerce$3(r){if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}function base$3(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var n=0;n<r.length;n++){var i=r.charAt(n),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=n}var a=r.length,l=r.charAt(0),p=Math.log(a)/Math.log(256),g=Math.log(256)/Math.log(a);function x(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var j=0,C=0,S=0,R=f.length;S!==R&&f[S]===0;)S++,j++;for(var I=(R-S)*g+1>>>0,A=new Uint8Array(I);S!==R;){for(var $=f[S],N=0,k=I-1;($!==0||N<C)&&k!==-1;k--,N++)$+=256*A[k]>>>0,A[k]=$%a>>>0,$=$/a>>>0;if($!==0)throw new Error("Non-zero carry");C=N,S++}for(var P=I-C;P!==I&&A[P]===0;)P++;for(var D=l.repeat(j);P<I;++P)D+=r.charAt(A[P]);return D}function b(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var j=0;if(f[j]!==" "){for(var C=0,S=0;f[j]===l;)C++,j++;for(var R=(f.length-j)*p+1>>>0,I=new Uint8Array(R);f[j];){var A=t[f.charCodeAt(j)];if(A===255)return;for(var $=0,N=R-1;(A!==0||$<S)&&N!==-1;N--,$++)A+=a*I[N]>>>0,I[N]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");S=$,j++}if(f[j]!==" "){for(var k=R-S;k!==R&&I[k]===0;)k++;for(var P=new Uint8Array(C+(R-k)),D=C;k!==R;)P[D++]=I[k++];return P}}}function E(f){var j=b(f);if(j)return j;throw new Error(`Non-${e} character`)}return{encode:x,decodeUnsafe:b,decode:E}}var src$4=base$3,_brrp__multiformats_scope_baseX$3=src$4;let Encoder$3=class{constructor(e,t,s){O(this,"name");O(this,"prefix");O(this,"baseEncode");this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Decoder$3=class{constructor(e,t,s){O(this,"name");O(this,"prefix");O(this,"baseDecode");O(this,"prefixCodePoint");this.name=e,this.prefix=t;const n=t.codePointAt(0);if(n===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n,this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return or$3(this,e)}},ComposedDecoder$3=class{constructor(e){O(this,"decoders");this.decoders=e}or(e){return or$3(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s!=null)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function or$3(r,e){return new ComposedDecoder$3({...r.decoders??{[r.prefix]:r},...e.decoders??{[e.prefix]:e}})}let Codec$3=class{constructor(e,t,s,n){O(this,"name");O(this,"prefix");O(this,"baseEncode");O(this,"baseDecode");O(this,"encoder");O(this,"decoder");this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=n,this.encoder=new Encoder$3(e,t,s),this.decoder=new Decoder$3(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function from$4({name:r,prefix:e,encode:t,decode:s}){return new Codec$3(r,e,t,s)}function baseX$3({name:r,prefix:e,alphabet:t}){const{encode:s,decode:n}=_brrp__multiformats_scope_baseX$3(t,r);return from$4({prefix:e,name:r,encode:s,decode:i=>coerce$3(n(i))})}function decode$n(r,e,t,s){let n=r.length;for(;r[n-1]==="=";)--n;const i=new Uint8Array(n*t/8|0);let o=0,a=0,l=0;for(let p=0;p<n;++p){const g=e[r[p]];if(g===void 0)throw new SyntaxError(`Non-${s} character`);a=a<<t|g,o+=t,o>=8&&(o-=8,i[l++]=255&a>>o)}if(o>=t||(255&a<<8-o)!==0)throw new SyntaxError("Unexpected end of data");return i}function encode$g(r,e,t){const s=e[e.length-1]==="=",n=(1<<t)-1;let i="",o=0,a=0;for(let l=0;l<r.length;++l)for(a=a<<8|r[l],o+=8;o>t;)o-=t,i+=e[n&a>>o];if(o!==0&&(i+=e[n&a<<t-o]),s)for(;(i.length*t&7)!==0;)i+="=";return i}function createAlphabetIdx$1(r){const e={};for(let t=0;t<r.length;++t)e[r[t]]=t;return e}function rfc4648$3({name:r,prefix:e,bitsPerChar:t,alphabet:s}){const n=createAlphabetIdx$1(s);return from$4({prefix:e,name:r,encode(i){return encode$g(i,s,t)},decode(i){return decode$n(i,n,t,r)}})}const base32$6=rfc4648$3({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});rfc4648$3({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});rfc4648$3({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});rfc4648$3({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});rfc4648$3({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});rfc4648$3({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});rfc4648$3({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});rfc4648$3({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});rfc4648$3({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});const base36$6=baseX$3({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"});baseX$3({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});const base58btc$3=baseX$3({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});baseX$3({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var encode_1$3=encode$f,MSB$3=128,MSBALL$2=-128,INT$2=Math.pow(2,31);function encode$f(r,e,t){e=e||[],t=t||0;for(var s=t;r>=INT$2;)e[t++]=r&255|MSB$3,r/=128;for(;r&MSBALL$2;)e[t++]=r&255|MSB$3,r>>>=7;return e[t]=r|0,encode$f.bytes=t-s+1,e}var decode$m=read$2,MSB$1$3=128,REST$1$2=127;function read$2(r,s){var t=0,s=s||0,n=0,i=s,o,a=r.length;do{if(i>=a)throw read$2.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=n<28?(o&REST$1$2)<<n:(o&REST$1$2)*Math.pow(2,n),n+=7}while(o>=MSB$1$3);return read$2.bytes=i-s,t}var N1$3=Math.pow(2,7),N2$3=Math.pow(2,14),N3$3=Math.pow(2,21),N4$3=Math.pow(2,28),N5$3=Math.pow(2,35),N6$3=Math.pow(2,42),N7$3=Math.pow(2,49),N8$2=Math.pow(2,56),N9$2=Math.pow(2,63),length$3=function(r){return r<N1$3?1:r<N2$3?2:r<N3$3?3:r<N4$3?4:r<N5$3?5:r<N6$3?6:r<N7$3?7:r<N8$2?8:r<N9$2?9:10},varint$4={encode:encode_1$3,decode:decode$m,encodingLength:length$3},_brrp_varint$2=varint$4;function decode$l(r,e=0){return[_brrp_varint$2.decode(r,e),_brrp_varint$2.decode.bytes]}function encodeTo$2(r,e,t=0){return _brrp_varint$2.encode(r,e,t),e}function encodingLength$3(r){return _brrp_varint$2.encodingLength(r)}function create$3(r,e){const t=e.byteLength,s=encodingLength$3(r),n=s+encodingLength$3(t),i=new Uint8Array(n+t);return encodeTo$2(r,i,0),encodeTo$2(t,i,s),i.set(e,n),new Digest$2(r,t,e,i)}function decode$k(r){const e=coerce$3(r),[t,s]=decode$l(e),[n,i]=decode$l(e.subarray(s)),o=e.subarray(s+i);if(o.byteLength!==n)throw new Error("Incorrect length");return new Digest$2(t,n,o,e)}function equals$6(r,e){if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&equals$7(r.bytes,t.bytes)}}let Digest$2=class{constructor(e,t,s,n){O(this,"code");O(this,"size");O(this,"digest");O(this,"bytes");this.code=e,this.size=t,this.digest=s,this.bytes=n}};function format$3(r,e){const{bytes:t,version:s}=r;switch(s){case 0:return toStringV0$2(t,baseCache$2(r),e??base58btc$3.encoder);default:return toStringV1$2(t,baseCache$2(r),e??base32$6.encoder)}}const cache$2=new WeakMap;function baseCache$2(r){const e=cache$2.get(r);if(e==null){const t=new Map;return cache$2.set(r,t),t}return e}var Me;let CID$2=class he{constructor(e,t,s,n){O(this,"code");O(this,"version");O(this,"multihash");O(this,"bytes");O(this,"/");O(this,Me,"CID");this.code=t,this.version=e,this.multihash=s,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE$2)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE$2)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return he.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,s=create$3(e,t);return he.createV1(this.code,s)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return he.equals(this,e)}static equals(e,t){const s=t;return s!=null&&e.code===s.code&&e.version===s.version&&equals$6(e.multihash,s.multihash)}toString(e){return format$3(this,e)}toJSON(){return{"/":format$3(this)}}link(){return this}[(Me=Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"))](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;const t=e;if(t instanceof he)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){const{version:s,code:n,multihash:i,bytes:o}=t;return new he(s,n,i,o??encodeCID$3(s,n,i.bytes))}else if(t[cidSymbol$2]===!0){const{version:s,multihash:n,code:i}=t,o=decode$k(n);return he.create(s,i,o)}else return null}static create(e,t,s){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(s.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(t!==DAG_PB_CODE$2)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$2}) block encoding`);return new he(e,t,s,s.bytes)}case 1:{const n=encodeCID$3(e,t,s.bytes);return new he(e,t,s,n)}default:throw new Error("Invalid version")}}static createV0(e){return he.create(0,DAG_PB_CODE$2,e)}static createV1(e,t){return he.create(1,e,t)}static decode(e){const[t,s]=he.decodeFirst(e);if(s.length!==0)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=he.inspectBytes(e),s=t.size-t.multihashSize,n=coerce$3(e.subarray(s,s+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),o=new Digest$2(t.multihashCode,t.digestSize,i,n);return[t.version===0?he.createV0(o):he.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const s=()=>{const[x,b]=decode$l(e.subarray(t));return t+=b,x};let n=s(),i=DAG_PB_CODE$2;if(n===18?(n=0,t=0):i=s(),n!==0&&n!==1)throw new RangeError(`Invalid CID version ${n}`);const o=t,a=s(),l=s(),p=t+l,g=p-o;return{version:n,codec:i,multihashCode:a,digestSize:l,multihashSize:g,size:p}}static parse(e,t){const[s,n]=parseCIDtoBytes$2(e,t),i=he.decode(n);if(i.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return baseCache$2(i).set(s,e),i}};function parseCIDtoBytes$2(r,e){switch(r[0]){case"Q":{const t=e??base58btc$3;return[base58btc$3.prefix,t.decode(`${base58btc$3.prefix}${r}`)]}case base58btc$3.prefix:{const t=e??base58btc$3;return[base58btc$3.prefix,t.decode(r)]}case base32$6.prefix:{const t=e??base32$6;return[base32$6.prefix,t.decode(r)]}case base36$6.prefix:{const t=e??base36$6;return[base36$6.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}}function toStringV0$2(r,e,t){const{prefix:s}=t;if(s!==base58btc$3.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const n=e.get(s);if(n==null){const i=t.encode(r).slice(1);return e.set(s,i),i}else return n}function toStringV1$2(r,e,t){const{prefix:s}=t,n=e.get(s);if(n==null){const i=t.encode(r);return e.set(s,i),i}else return n}const DAG_PB_CODE$2=112,SHA_256_CODE$2=18;function encodeCID$3(r,e,t){const s=encodingLength$3(r),n=s+encodingLength$3(e),i=new Uint8Array(n+t.byteLength);return encodeTo$2(r,i,0),encodeTo$2(e,i,s),i.set(t,n),i}const cidSymbol$2=Symbol.for("@ipld/js-cid/CID"),base64$7=rfc4648$3({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});rfc4648$3({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});rfc4648$3({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});rfc4648$3({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function toByteView(r){return r instanceof ArrayBuffer?new Uint8Array(r,0,r.byteLength):r}function cidEncoder(r){if(r.asCID!==r&&r["/"]!==r.bytes)return null;const e=CID$2.asCID(r);if(!e)return null;const t=e.toString();return[new Token(Type.map,1/0,1),new Token(Type.string,"/",1),new Token(Type.string,t,t.length),new Token(Type.break,void 0,1)]}function bytesEncoder(r){const e=base64$7.encode(r).slice(1);return[new Token(Type.map,1/0,1),new Token(Type.string,"/",1),new Token(Type.map,1/0,1),new Token(Type.string,"bytes",5),new Token(Type.string,e,e.length),new Token(Type.break,void 0,1),new Token(Type.break,void 0,1)]}function taBytesEncoder(r){return bytesEncoder(new Uint8Array(r.buffer,r.byteOffset,r.byteLength))}function abBytesEncoder(r){return bytesEncoder(new Uint8Array(r))}function undefinedEncoder(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder(r){if(Number.isNaN(r))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(r===1/0||r===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const encodeOptions={typeEncoders:{Object:cidEncoder,Buffer:bytesEncoder,Uint8Array:bytesEncoder,Int8Array:taBytesEncoder,Uint16Array:taBytesEncoder,Int16Array:taBytesEncoder,Uint32Array:taBytesEncoder,Int32Array:taBytesEncoder,Float32Array:taBytesEncoder,Float64Array:taBytesEncoder,Uint8ClampedArray:taBytesEncoder,BigInt64Array:taBytesEncoder,BigUint64Array:taBytesEncoder,DataView:taBytesEncoder,ArrayBuffer:abBytesEncoder,undefined:undefinedEncoder,number:numberEncoder}};class DagJsonTokenizer extends Tokenizer{constructor(e,t){super(e,t),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const e=this._next();if(e.type===Type.map){const t=this._next();if(t.type===Type.string&&t.value==="/"){const s=this._next();if(s.type===Type.string){if(this._next().type!==Type.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(s),new Token(Type.tag,42,0)}if(s.type===Type.map){const n=this._next();if(n.type===Type.string&&n.value==="bytes"){const i=this._next();if(i.type===Type.string){for(let a=0;a<2;a++)if(this._next().type!==Type.break)throw new Error("Invalid encoded Bytes form");const o=base64$7.decode(`m${i.value}`);return new Token(Type.bytes,o,i.value.length)}this.tokenBuffer.push(i)}this.tokenBuffer.push(n)}this.tokenBuffer.push(s)}this.tokenBuffer.push(t)}return e}}const decodeOptions={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};decodeOptions.tags[42]=CID$2.parse;const name$4="dag-json",code$4=297,encode$e=r=>encode$h(r,encodeOptions),decode$j=r=>{const e=toByteView(r),t=Object.assign(decodeOptions,{tokenizer:new DagJsonTokenizer(e,decodeOptions)});return decode$o(e,t)},format$2=r=>utf8Decoder.decode(encode$e(r)),utf8Decoder=new TextDecoder,parse$1=r=>decode$j(utf8Encoder.encode(r)),utf8Encoder=new TextEncoder,dagJSON=Object.freeze(Object.defineProperty({__proto__:null,code:code$4,decode:decode$j,encode:encode$e,format:format$2,name:name$4,parse:parse$1,stringify:format$2},Symbol.toStringTag,{value:"Module"}));function base$2(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var n=0;n<r.length;n++){var i=r.charAt(n),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=n}var a=r.length,l=r.charAt(0),p=Math.log(a)/Math.log(256),g=Math.log(256)/Math.log(a);function x(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var j=0,C=0,S=0,R=f.length;S!==R&&f[S]===0;)S++,j++;for(var I=(R-S)*g+1>>>0,A=new Uint8Array(I);S!==R;){for(var $=f[S],N=0,k=I-1;($!==0||N<C)&&k!==-1;k--,N++)$+=256*A[k]>>>0,A[k]=$%a>>>0,$=$/a>>>0;if($!==0)throw new Error("Non-zero carry");C=N,S++}for(var P=I-C;P!==I&&A[P]===0;)P++;for(var D=l.repeat(j);P<I;++P)D+=r.charAt(A[P]);return D}function b(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var j=0;if(f[j]!==" "){for(var C=0,S=0;f[j]===l;)C++,j++;for(var R=(f.length-j)*p+1>>>0,I=new Uint8Array(R);f[j];){var A=t[f.charCodeAt(j)];if(A===255)return;for(var $=0,N=R-1;(A!==0||$<S)&&N!==-1;N--,$++)A+=a*I[N]>>>0,I[N]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");S=$,j++}if(f[j]!==" "){for(var k=R-S;k!==R&&I[k]===0;)k++;for(var P=new Uint8Array(C+(R-k)),D=C;k!==R;)P[D++]=I[k++];return P}}}function E(f){var j=b(f);if(j)return j;throw new Error(`Non-${e} character`)}return{encode:x,decodeUnsafe:b,decode:E}}var src$3=base$2,_brrp__multiformats_scope_baseX$2=src$3;const equals$5=(r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0},coerce$2=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},fromString$5=r=>new TextEncoder().encode(r),toString$5=r=>new TextDecoder().decode(r);let Encoder$2=class{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Decoder$2=class{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return or$2(this,e)}},ComposedDecoder$2=class{constructor(e){this.decoders=e}or(e){return or$2(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const or$2=(r,e)=>new ComposedDecoder$2({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});let Codec$2=class{constructor(e,t,s,n){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=n,this.encoder=new Encoder$2(e,t,s),this.decoder=new Decoder$2(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const from$3=({name:r,prefix:e,encode:t,decode:s})=>new Codec$2(r,e,t,s),baseX$2=({prefix:r,name:e,alphabet:t})=>{const{encode:s,decode:n}=_brrp__multiformats_scope_baseX$2(t,e);return from$3({prefix:r,name:e,encode:s,decode:i=>coerce$2(n(i))})},decode$i=(r,e,t,s)=>{const n={};for(let g=0;g<e.length;++g)n[e[g]]=g;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,l=0,p=0;for(let g=0;g<i;++g){const x=n[r[g]];if(x===void 0)throw new SyntaxError(`Non-${s} character`);l=l<<t|x,a+=t,a>=8&&(a-=8,o[p++]=255&l>>a)}if(a>=t||255&l<<8-a)throw new SyntaxError("Unexpected end of data");return o},encode$d=(r,e,t)=>{const s=e[e.length-1]==="=",n=(1<<t)-1;let i="",o=0,a=0;for(let l=0;l<r.length;++l)for(a=a<<8|r[l],o+=8;o>t;)o-=t,i+=e[n&a>>o];if(o&&(i+=e[n&a<<t-o]),s)for(;i.length*t&7;)i+="=";return i},rfc4648$2=({name:r,prefix:e,bitsPerChar:t,alphabet:s})=>from$3({prefix:e,name:r,encode(n){return encode$d(n,s,t)},decode(n){return decode$i(n,s,t,r)}}),base64$5=rfc4648$2({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad$2=rfc4648$2({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url$2=rfc4648$2({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad$2=rfc4648$2({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$6=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$5,base64pad:base64pad$2,base64url:base64url$2,base64urlpad:base64urlpad$2},Symbol.toStringTag,{value:"Module"}));function toBase64url(r){return base64url$2.encode(r).slice(1)}function fromBase64url(r){return base64url$2.decode(`u${r}`)}var encode_1$2=encode$c,MSB$2=128,MSBALL$1=-128,INT$1=Math.pow(2,31);function encode$c(r,e,t){e=e||[],t=t||0;for(var s=t;r>=INT$1;)e[t++]=r&255|MSB$2,r/=128;for(;r&MSBALL$1;)e[t++]=r&255|MSB$2,r>>>=7;return e[t]=r|0,encode$c.bytes=t-s+1,e}var decode$h=read$1,MSB$1$2=128,REST$1$1=127;function read$1(r,s){var t=0,s=s||0,n=0,i=s,o,a=r.length;do{if(i>=a)throw read$1.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=n<28?(o&REST$1$1)<<n:(o&REST$1$1)*Math.pow(2,n),n+=7}while(o>=MSB$1$2);return read$1.bytes=i-s,t}var N1$2=Math.pow(2,7),N2$2=Math.pow(2,14),N3$2=Math.pow(2,21),N4$2=Math.pow(2,28),N5$2=Math.pow(2,35),N6$2=Math.pow(2,42),N7$2=Math.pow(2,49),N8$1=Math.pow(2,56),N9$1=Math.pow(2,63),length$2=function(r){return r<N1$2?1:r<N2$2?2:r<N3$2?3:r<N4$2?4:r<N5$2?5:r<N6$2?6:r<N7$2?7:r<N8$1?8:r<N9$1?9:10},varint$3={encode:encode_1$2,decode:decode$h,encodingLength:length$2},_brrp_varint$1=varint$3;const decode$g=(r,e=0)=>[_brrp_varint$1.decode(r,e),_brrp_varint$1.decode.bytes],encodeTo$1=(r,e,t=0)=>(_brrp_varint$1.encode(r,e,t),e),encodingLength$2=r=>_brrp_varint$1.encodingLength(r),create$2=(r,e)=>{const t=e.byteLength,s=encodingLength$2(r),n=s+encodingLength$2(t),i=new Uint8Array(n+t);return encodeTo$1(r,i,0),encodeTo$1(t,i,s),i.set(e,n),new Digest$1(r,t,e,i)},decode$f=r=>{const e=coerce$2(r),[t,s]=decode$g(e),[n,i]=decode$g(e.subarray(s)),o=e.subarray(s+i);if(o.byteLength!==n)throw new Error("Incorrect length");return new Digest$1(t,n,o,e)},equals$4=(r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&equals$5(r.bytes,t.bytes)}};let Digest$1=class{constructor(e,t,s,n){this.code=e,this.size=t,this.digest=s,this.bytes=n}};const base58btc$2=baseX$2({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr$2=baseX$2({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58$2=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc$2,base58flickr:base58flickr$2},Symbol.toStringTag,{value:"Module"})),base32$4=rfc4648$2({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper$2=rfc4648$2({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad$2=rfc4648$2({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper$2=rfc4648$2({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex$2=rfc4648$2({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper$2=rfc4648$2({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad$2=rfc4648$2({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper$2=rfc4648$2({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z$2=rfc4648$2({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$5=Object.freeze(Object.defineProperty({__proto__:null,base32:base32$4,base32hex:base32hex$2,base32hexpad:base32hexpad$2,base32hexpadupper:base32hexpadupper$2,base32hexupper:base32hexupper$2,base32pad:base32pad$2,base32padupper:base32padupper$2,base32upper:base32upper$2,base32z:base32z$2},Symbol.toStringTag,{value:"Module"})),format$1=(r,e)=>{const{bytes:t,version:s}=r;switch(s){case 0:return toStringV0$1(t,baseCache$1(r),e||base58btc$2.encoder);default:return toStringV1$1(t,baseCache$1(r),e||base32$4.encoder)}},cache$1=new WeakMap,baseCache$1=r=>{const e=cache$1.get(r);if(e==null){const t=new Map;return cache$1.set(r,t),t}return e};let CID$1=class pe{constructor(e,t,s,n){this.code=t,this.version=e,this.multihash=s,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE$1)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE$1)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return pe.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,s=create$2(e,t);return pe.createV1(this.code,s)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return pe.equals(this,e)}static equals(e,t){const s=t;return s&&e.code===s.code&&e.version===s.version&&equals$4(e.multihash,s.multihash)}toString(e){return format$1(this,e)}toJSON(){return{"/":format$1(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;const t=e;if(t instanceof pe)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){const{version:s,code:n,multihash:i,bytes:o}=t;return new pe(s,n,i,o||encodeCID$2(s,n,i.bytes))}else if(t[cidSymbol$1]===!0){const{version:s,multihash:n,code:i}=t,o=decode$f(n);return pe.create(s,i,o)}else return null}static create(e,t,s){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(s.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(t!==DAG_PB_CODE$1)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$1}) block encoding`);return new pe(e,t,s,s.bytes)}case 1:{const n=encodeCID$2(e,t,s.bytes);return new pe(e,t,s,n)}default:throw new Error("Invalid version")}}static createV0(e){return pe.create(0,DAG_PB_CODE$1,e)}static createV1(e,t){return pe.create(1,e,t)}static decode(e){const[t,s]=pe.decodeFirst(e);if(s.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=pe.inspectBytes(e),s=t.size-t.multihashSize,n=coerce$2(e.subarray(s,s+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),o=new Digest$1(t.multihashCode,t.digestSize,i,n);return[t.version===0?pe.createV0(o):pe.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const s=()=>{const[x,b]=decode$g(e.subarray(t));return t+=b,x};let n=s(),i=DAG_PB_CODE$1;if(n===18?(n=0,t=0):i=s(),n!==0&&n!==1)throw new RangeError(`Invalid CID version ${n}`);const o=t,a=s(),l=s(),p=t+l,g=p-o;return{version:n,codec:i,multihashCode:a,digestSize:l,multihashSize:g,size:p}}static parse(e,t){const[s,n]=parseCIDtoBytes$1(e,t),i=pe.decode(n);if(i.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return baseCache$1(i).set(s,e),i}};const parseCIDtoBytes$1=(r,e)=>{switch(r[0]){case"Q":{const t=e||base58btc$2;return[base58btc$2.prefix,t.decode(`${base58btc$2.prefix}${r}`)]}case base58btc$2.prefix:{const t=e||base58btc$2;return[base58btc$2.prefix,t.decode(r)]}case base32$4.prefix:{const t=e||base32$4;return[base32$4.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}},toStringV0$1=(r,e,t)=>{const{prefix:s}=t;if(s!==base58btc$2.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const n=e.get(s);if(n==null){const i=t.encode(r).slice(1);return e.set(s,i),i}else return n},toStringV1$1=(r,e,t)=>{const{prefix:s}=t,n=e.get(s);if(n==null){const i=t.encode(r);return e.set(s,i),i}else return n},DAG_PB_CODE$1=112,SHA_256_CODE$1=18,encodeCID$2=(r,e,t)=>{const s=encodingLength$2(r),n=s+encodingLength$2(e),i=new Uint8Array(n+t.byteLength);return encodeTo$1(r,i,0),encodeTo$1(e,i,s),i.set(t,n),i},cidSymbol$1=Symbol.for("@ipld/js-cid/CID");function fromSplit$1(r){const[e,t,s]=r;return{payload:t,signatures:[{protected:e,signature:s}],link:CID$1.decode(fromBase64url(t))}}function encodeSignature(r){const e={signature:fromBase64url(r.signature)};return r.header&&(e.header=r.header),r.protected&&(e.protected=fromBase64url(r.protected)),e}function encode$b(r){const e=fromBase64url(r.payload);try{CID$1.decode(e)}catch{throw new Error("Not a valid DagJWS")}return{payload:e,signatures:r.signatures.map(encodeSignature)}}function decodeSignature(r){const e={signature:toBase64url(r.signature)};return r.header&&(e.header=r.header),r.protected&&(e.protected=toBase64url(r.protected)),e}function decode$e(r){const e={payload:toBase64url(r.payload),signatures:r.signatures.map(decodeSignature)};return e.link=CID$1.decode(new Uint8Array(r.payload)),e}function fromSplit(r){const[e,t,s,n,i]=r,o={ciphertext:n,iv:s,protected:e,tag:i};return t&&(o.recipients=[{encrypted_key:t}]),o}function encodeRecipient(r){const e={};return r.encrypted_key&&(e.encrypted_key=fromBase64url(r.encrypted_key)),r.header&&(e.header=r.header),e}function encode$a(r){const e={ciphertext:fromBase64url(r.ciphertext),protected:fromBase64url(r.protected),iv:fromBase64url(r.iv),tag:fromBase64url(r.tag)};return r.aad&&(e.aad=fromBase64url(r.aad)),r.recipients&&(e.recipients=r.recipients.map(encodeRecipient)),r.unprotected&&(e.unprotected=r.unprotected),e}function decodeRecipient(r){const e={};return r.encrypted_key&&(e.encrypted_key=toBase64url(r.encrypted_key)),r.header&&(e.header=r.header),e}function decode$d(r){const e={ciphertext:toBase64url(r.ciphertext),protected:toBase64url(r.protected),iv:toBase64url(r.iv),tag:toBase64url(r.tag)};return r.aad&&(e.aad=toBase64url(r.aad)),r.recipients&&(e.recipients=r.recipients.map(decodeRecipient)),r.unprotected&&(e.unprotected=r.unprotected),e}const name$3="dag-jose",code$3=133;function isDagJWS(r){return"payload"in r&&typeof r.payload=="string"&&"signatures"in r&&Array.isArray(r.signatures)}function isEncodedJWS(r){return"payload"in r&&r.payload instanceof Uint8Array&&"signatures"in r&&Array.isArray(r.signatures)}function isEncodedJWE(r){return"ciphertext"in r&&r.ciphertext instanceof Uint8Array&&"iv"in r&&r.iv instanceof Uint8Array&&"protected"in r&&r.protected instanceof Uint8Array&&"tag"in r&&r.tag instanceof Uint8Array}function isDagJWE(r){return"ciphertext"in r&&typeof r.ciphertext=="string"&&"iv"in r&&typeof r.iv=="string"&&"protected"in r&&typeof r.protected=="string"&&"tag"in r&&typeof r.tag=="string"}function toGeneral(r){if(typeof r=="string"){const e=r.split(".");if(e.length===3)return fromSplit$1(e);if(e.length===5)return fromSplit(e);throw new Error("Not a valid JOSE string")}if(isDagJWS(r)||isDagJWE(r))return r;throw new Error("Not a valid unencoded JOSE object")}function encode$9(r){typeof r=="string"&&(r=toGeneral(r));let e;if(isDagJWS(r))e=encode$b(r);else if(isDagJWE(r))e=encode$a(r);else throw new Error("Not a valid JOSE object");return new Uint8Array(encode$i(e))}function decode$c(r){let e;try{e=decode$p(r)}catch{throw new Error("Not a valid DAG-JOSE object")}if(isEncodedJWS(e))return decode$e(e);if(isEncodedJWE(e))return decode$d(e);throw new Error("Not a valid DAG-JOSE object")}const dagJOSE=Object.freeze(Object.defineProperty({__proto__:null,code:code$3,decode:decode$c,encode:encode$9,name:name$3,toGeneral},Symbol.toStringTag,{value:"Module"})),code$2=0,name$2="identity",encode$8=coerce$2,digest=r=>create$2(code$2,encode$8(r)),identity$3={code:code$2,name:name$2,encode:encode$8,digest},identity$4=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$3},Symbol.toStringTag,{value:"Module"})),identity$2=from$3({prefix:"\0",name:"identity",encode:r=>toString$5(r),decode:r=>fromString$5(r)}),identityBase$2=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$2},Symbol.toStringTag,{value:"Module"})),base2$4=rfc4648$2({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$5=Object.freeze(Object.defineProperty({__proto__:null,base2:base2$4},Symbol.toStringTag,{value:"Module"})),base8$4=rfc4648$2({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$5=Object.freeze(Object.defineProperty({__proto__:null,base8:base8$4},Symbol.toStringTag,{value:"Module"})),base10$4=baseX$2({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$5=Object.freeze(Object.defineProperty({__proto__:null,base10:base10$4},Symbol.toStringTag,{value:"Module"})),base16$4=rfc4648$2({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper$2=rfc4648$2({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$5=Object.freeze(Object.defineProperty({__proto__:null,base16:base16$4,base16upper:base16upper$2},Symbol.toStringTag,{value:"Module"})),base36$4=baseX$2({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper$2=baseX$2({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$5=Object.freeze(Object.defineProperty({__proto__:null,base36:base36$4,base36upper:base36upper$2},Symbol.toStringTag,{value:"Module"})),alphabet$2=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),alphabetBytesToChars$2=alphabet$2.reduce((r,e,t)=>(r[t]=e,r),[]),alphabetCharsToBytes$2=alphabet$2.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function encode$7(r){return r.reduce((e,t)=>(e+=alphabetBytesToChars$2[t],e),"")}function decode$b(r){const e=[];for(const t of r){const s=alphabetCharsToBytes$2[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const base256emoji$4=from$3({prefix:"🚀",name:"base256emoji",encode:encode$7,decode:decode$b}),base256emoji$5=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:base256emoji$4},Symbol.toStringTag,{value:"Module"})),from$2=({name:r,code:e,encode:t})=>new Hasher(r,e,t);class Hasher{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?create$2(this.code,t):t.then(s=>create$2(this.code,s))}else throw Error("Unknown type, must be binary type")}}const sha=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),sha256=from$2({name:"sha2-256",code:18,encode:sha("SHA-256")}),sha512=from$2({name:"sha2-512",code:19,encode:sha("SHA-512")}),sha2=Object.freeze(Object.defineProperty({__proto__:null,sha256,sha512},Symbol.toStringTag,{value:"Module"})),name$1="raw",code$1=85,encode$6=r=>coerce$2(r),decode$a=r=>coerce$2(r),raw=Object.freeze(Object.defineProperty({__proto__:null,code:code$1,decode:decode$a,encode:encode$6,name:name$1},Symbol.toStringTag,{value:"Module"})),textEncoder=new TextEncoder,textDecoder=new TextDecoder,name="json",code=512,encode$5=r=>textEncoder.encode(JSON.stringify(r)),decode$9=r=>JSON.parse(textDecoder.decode(r)),json=Object.freeze(Object.defineProperty({__proto__:null,code,decode:decode$9,encode:encode$5,name},Symbol.toStringTag,{value:"Module"})),bases$2={...identityBase$2,...base2$5,...base8$5,...base10$5,...base16$5,...base32$5,...base36$5,...base58$2,...base64$6,...base256emoji$5},hashes={...sha2,...identity$4},codecs$1={raw,json};class Parser{constructor(){O(this,"index",0);O(this,"input","")}new(e){return this.index=0,this.input=e,this}readAtomically(e){const t=this.index,s=e();return s===void 0&&(this.index=t),s}parseWith(e){const t=e();if(this.index===this.input.length)return t}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically(()=>{const t=this.readChar();if(t===e)return t})}readSeparator(e,t,s){return this.readAtomically(()=>{if(!(t>0&&this.readGivenChar(e)===void 0))return s()})}readNumber(e,t,s,n){return this.readAtomically(()=>{let i=0,o=0;const a=this.peekChar();if(a===void 0)return;const l=a==="0",p=2**(8*n)-1;for(;;){const g=this.readAtomically(()=>{const x=this.readChar();if(x===void 0)return;const b=Number.parseInt(x,e);if(!Number.isNaN(b))return b});if(g===void 0)break;if(i*=e,i+=g,i>p||(o+=1,t!==void 0&&o>t))return}if(o!==0)return!s&&l&&o>1?void 0:i})}readIPv4Addr(){return this.readAtomically(()=>{const e=new Uint8Array(4);for(let t=0;t<e.length;t++){const s=this.readSeparator(".",t,()=>this.readNumber(10,3,!1,1));if(s===void 0)return;e[t]=s}return e})}readIPv6Addr(){const e=t=>{for(let s=0;s<t.length/2;s++){const n=s*2;if(s<t.length-3){const o=this.readSeparator(":",s,()=>this.readIPv4Addr());if(o!==void 0)return t[n]=o[0],t[n+1]=o[1],t[n+2]=o[2],t[n+3]=o[3],[n+4,!0]}const i=this.readSeparator(":",s,()=>this.readNumber(16,4,!0,2));if(i===void 0)return[n,!1];t[n]=i>>8,t[n+1]=i&255}return[t.length,!1]};return this.readAtomically(()=>{const t=new Uint8Array(16),[s,n]=e(t);if(s===16)return t;if(n||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;const i=new Uint8Array(14),o=16-(s+2),[a]=e(i.subarray(0,o));return t.set(i.subarray(0,a),16-a),t})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}}const MAX_IPV6_LENGTH=45,MAX_IPV4_LENGTH=15,parser=new Parser;function parseIPv4(r){if(!(r.length>MAX_IPV4_LENGTH))return parser.new(r).parseWith(()=>parser.readIPv4Addr())}function parseIPv6(r){if(r.includes("%")&&(r=r.split("%")[0]),!(r.length>MAX_IPV6_LENGTH))return parser.new(r).parseWith(()=>parser.readIPv6Addr())}function parseIP(r,e=!1){if(r.includes("%")&&(r=r.split("%")[0]),r.length>MAX_IPV6_LENGTH)return;const t=parser.new(r).parseWith(()=>parser.readIPAddr());if(t)return e&&t.length===4?Uint8Array.from([0,0,0,0,0,0,0,0,0,0,255,255,t[0],t[1],t[2],t[3]]):t}function isIPv4(r){return!!parseIPv4(r)}function isIPv6(r){return!!parseIPv6(r)}function isIP(r){return!!parseIP(r)}function base$1(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var n=0;n<r.length;n++){var i=r.charAt(n),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=n}var a=r.length,l=r.charAt(0),p=Math.log(a)/Math.log(256),g=Math.log(256)/Math.log(a);function x(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var j=0,C=0,S=0,R=f.length;S!==R&&f[S]===0;)S++,j++;for(var I=(R-S)*g+1>>>0,A=new Uint8Array(I);S!==R;){for(var $=f[S],N=0,k=I-1;($!==0||N<C)&&k!==-1;k--,N++)$+=256*A[k]>>>0,A[k]=$%a>>>0,$=$/a>>>0;if($!==0)throw new Error("Non-zero carry");C=N,S++}for(var P=I-C;P!==I&&A[P]===0;)P++;for(var D=l.repeat(j);P<I;++P)D+=r.charAt(A[P]);return D}function b(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var j=0;if(f[j]!==" "){for(var C=0,S=0;f[j]===l;)C++,j++;for(var R=(f.length-j)*p+1>>>0,I=new Uint8Array(R);f[j];){var A=t[f.charCodeAt(j)];if(A===255)return;for(var $=0,N=R-1;(A!==0||$<S)&&N!==-1;N--,$++)A+=a*I[N]>>>0,I[N]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");S=$,j++}if(f[j]!==" "){for(var k=R-S;k!==R&&I[k]===0;)k++;for(var P=new Uint8Array(C+(R-k)),D=C;k!==R;)P[D++]=I[k++];return P}}}function E(f){var j=b(f);if(j)return j;throw new Error(`Non-${e} character`)}return{encode:x,decodeUnsafe:b,decode:E}}var src$2=base$1,_brrp__multiformats_scope_baseX$1=src$2;const coerce$1=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},fromString$4=r=>new TextEncoder().encode(r),toString$4=r=>new TextDecoder().decode(r);let Encoder$1=class{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Decoder$1=class{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return or$1(this,e)}},ComposedDecoder$1=class{constructor(e){this.decoders=e}or(e){return or$1(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const or$1=(r,e)=>new ComposedDecoder$1({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});let Codec$1=class{constructor(e,t,s,n){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=n,this.encoder=new Encoder$1(e,t,s),this.decoder=new Decoder$1(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const from$1=({name:r,prefix:e,encode:t,decode:s})=>new Codec$1(r,e,t,s),baseX$1=({prefix:r,name:e,alphabet:t})=>{const{encode:s,decode:n}=_brrp__multiformats_scope_baseX$1(t,e);return from$1({prefix:r,name:e,encode:s,decode:i=>coerce$1(n(i))})},decode$8=(r,e,t,s)=>{const n={};for(let g=0;g<e.length;++g)n[e[g]]=g;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,l=0,p=0;for(let g=0;g<i;++g){const x=n[r[g]];if(x===void 0)throw new SyntaxError(`Non-${s} character`);l=l<<t|x,a+=t,a>=8&&(a-=8,o[p++]=255&l>>a)}if(a>=t||255&l<<8-a)throw new SyntaxError("Unexpected end of data");return o},encode$4=(r,e,t)=>{const s=e[e.length-1]==="=",n=(1<<t)-1;let i="",o=0,a=0;for(let l=0;l<r.length;++l)for(a=a<<8|r[l],o+=8;o>t;)o-=t,i+=e[n&a>>o];if(o&&(i+=e[n&a<<t-o]),s)for(;i.length*t&7;)i+="=";return i},rfc4648$1=({name:r,prefix:e,bitsPerChar:t,alphabet:s})=>from$1({prefix:e,name:r,encode(n){return encode$4(n,s,t)},decode(n){return decode$8(n,s,t,r)}}),base10$2=baseX$1({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$3=Object.freeze(Object.defineProperty({__proto__:null,base10:base10$2},Symbol.toStringTag,{value:"Module"})),base16$2=rfc4648$1({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper$1=rfc4648$1({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$3=Object.freeze(Object.defineProperty({__proto__:null,base16:base16$2,base16upper:base16upper$1},Symbol.toStringTag,{value:"Module"})),base2$2=rfc4648$1({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$3=Object.freeze(Object.defineProperty({__proto__:null,base2:base2$2},Symbol.toStringTag,{value:"Module"})),alphabet$1=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),alphabetBytesToChars$1=alphabet$1.reduce((r,e,t)=>(r[t]=e,r),[]),alphabetCharsToBytes$1=alphabet$1.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function encode$3(r){return r.reduce((e,t)=>(e+=alphabetBytesToChars$1[t],e),"")}function decode$7(r){const e=[];for(const t of r){const s=alphabetCharsToBytes$1[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const base256emoji$2=from$1({prefix:"🚀",name:"base256emoji",encode:encode$3,decode:decode$7}),base256emoji$3=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:base256emoji$2},Symbol.toStringTag,{value:"Module"})),base32$2=rfc4648$1({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper$1=rfc4648$1({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad$1=rfc4648$1({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper$1=rfc4648$1({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex$1=rfc4648$1({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper$1=rfc4648$1({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad$1=rfc4648$1({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper$1=rfc4648$1({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z$1=rfc4648$1({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$3=Object.freeze(Object.defineProperty({__proto__:null,base32:base32$2,base32hex:base32hex$1,base32hexpad:base32hexpad$1,base32hexpadupper:base32hexpadupper$1,base32hexupper:base32hexupper$1,base32pad:base32pad$1,base32padupper:base32padupper$1,base32upper:base32upper$1,base32z:base32z$1},Symbol.toStringTag,{value:"Module"})),base36$2=baseX$1({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper$1=baseX$1({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$3=Object.freeze(Object.defineProperty({__proto__:null,base36:base36$2,base36upper:base36upper$1},Symbol.toStringTag,{value:"Module"})),base58btc$1=baseX$1({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr$1=baseX$1({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58$1=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc$1,base58flickr:base58flickr$1},Symbol.toStringTag,{value:"Module"})),base64$3=rfc4648$1({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad$1=rfc4648$1({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url$1=rfc4648$1({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad$1=rfc4648$1({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$4=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$3,base64pad:base64pad$1,base64url:base64url$1,base64urlpad:base64urlpad$1},Symbol.toStringTag,{value:"Module"})),base8$2=rfc4648$1({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$3=Object.freeze(Object.defineProperty({__proto__:null,base8:base8$2},Symbol.toStringTag,{value:"Module"})),identity$1=from$1({prefix:"\0",name:"identity",encode:r=>toString$4(r),decode:r=>fromString$4(r)}),identityBase$1=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$1},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const bases$1={...identityBase$1,...base2$3,...base8$3,...base10$3,...base16$3,...base32$3,...base36$3,...base58$1,...base64$4,...base256emoji$3};function asUint8Array$1(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function allocUnsafe$1(r=0){var e;return((e=globalThis.Buffer)==null?void 0:e.allocUnsafe)!=null?asUint8Array$1(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function createCodec$1(r,e,t,s){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:s}}}const string$1=createCodec$1("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),ascii$1=createCodec$1("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=allocUnsafe$1(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),BASES$1={utf8:string$1,"utf-8":string$1,hex:bases$1.base16,latin1:ascii$1,ascii:ascii$1,binary:ascii$1,...bases$1};function toString$3(r,e="utf8"){const t=BASES$1[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}const isV4=isIPv4,isV6=isIPv6,toBytes$1=function(r){let e=0;if(r=r.toString().trim(),isV4(r)){const t=new Uint8Array(e+4);return r.split(/\./g).forEach(s=>{t[e++]=parseInt(s,10)&255}),t}if(isV6(r)){const t=r.split(":",8);let s;for(s=0;s<t.length;s++){const i=isV4(t[s]);let o;i&&(o=toBytes$1(t[s]),t[s]=toString$3(o.slice(0,2),"base16")),o!=null&&++s<8&&t.splice(s,0,toString$3(o.slice(2,4),"base16"))}if(t[0]==="")for(;t.length<8;)t.unshift("0");else if(t[t.length-1]==="")for(;t.length<8;)t.push("0");else if(t.length<8){for(s=0;s<t.length&&t[s]!=="";s++);const i=[s,1];for(s=9-t.length;s>0;s--)i.push("0");t.splice.apply(t,i)}const n=new Uint8Array(e+16);for(s=0;s<t.length;s++){const i=parseInt(t[s],16);n[e++]=i>>8&255,n[e++]=i&255}return n}throw new Error("invalid ip address")},toString$2=function(r,e=0,t){e=~~e,t=t??r.length-e;const s=new DataView(r.buffer);if(t===4){const n=[];for(let i=0;i<t;i++)n.push(r[e+i]);return n.join(".")}if(t===16){const n=[];for(let i=0;i<t;i+=2)n.push(s.getUint16(e+i).toString(16));return n.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},V$1=-1,names={},codes={},table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,V$1,"ip6zone"],[43,8,"ipcidr"],[53,V$1,"dns",!0],[54,V$1,"dns4",!0],[55,V$1,"dns6",!0],[56,V$1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[281,0,"webrtc-w3c"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,V$1,"unix",!1,!0],[421,V$1,"ipfs"],[421,V$1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,V$1,"garlic64"],[448,0,"tls"],[449,V$1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,V$1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,V$1,"memory"]];table.forEach(r=>{const e=createProtocol(...r);codes[e.code]=e,names[e.name]=e});function createProtocol(r,e,t,s,n){return{code:r,size:e,name:t,resolvable:!!s,path:!!n}}function getProtocol(r){if(typeof r=="number"){if(codes[r]!=null)return codes[r];throw new Error(`no protocol with code: ${r}`)}else if(typeof r=="string"){if(names[r]!=null)return names[r];throw new Error(`no protocol with name: ${r}`)}throw new Error(`invalid protocol id type: ${typeof r}`)}var encode_1$1,hasRequiredEncode;function requireEncode(){if(hasRequiredEncode)return encode_1$1;hasRequiredEncode=1,encode_1$1=s;var r=128,e=-128,t=Math.pow(2,31);function s(n,i,o){if(Number.MAX_SAFE_INTEGER&&n>Number.MAX_SAFE_INTEGER)throw s.bytes=0,new RangeError("Could not encode varint");i=i||[],o=o||0;for(var a=o;n>=t;)i[o++]=n&255|r,n/=128;for(;n&e;)i[o++]=n&255|r,n>>>=7;return i[o]=n|0,s.bytes=o-a+1,i}return encode_1$1}var decode$6,hasRequiredDecode;function requireDecode(){if(hasRequiredDecode)return decode$6;hasRequiredDecode=1,decode$6=t;var r=128,e=127;function t(s,o){var i=0,o=o||0,a=0,l=o,p,g=s.length;do{if(l>=g||a>49)throw t.bytes=0,new RangeError("Could not decode varint");p=s[l++],i+=a<28?(p&e)<<a:(p&e)*Math.pow(2,a),a+=7}while(p>=r);return t.bytes=l-o,i}return decode$6}var length$1,hasRequiredLength;function requireLength(){if(hasRequiredLength)return length$1;hasRequiredLength=1;var r=Math.pow(2,7),e=Math.pow(2,14),t=Math.pow(2,21),s=Math.pow(2,28),n=Math.pow(2,35),i=Math.pow(2,42),o=Math.pow(2,49),a=Math.pow(2,56),l=Math.pow(2,63);return length$1=function(p){return p<r?1:p<e?2:p<t?3:p<s?4:p<n?5:p<i?6:p<o?7:p<a?8:p<l?9:10},length$1}var varint$2,hasRequiredVarint;function requireVarint(){return hasRequiredVarint||(hasRequiredVarint=1,varint$2={encode:requireEncode(),decode:requireDecode(),encodingLength:requireLength()}),varint$2}var varintExports=requireVarint();const varint$1=getDefaultExportFromCjs(varintExports);function fromString$3(r,e="utf8"){const t=BASES$1[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?asUint8Array$1(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}function concat$1(r,e){e==null&&(e=r.reduce((n,i)=>n+i.length,0));const t=allocUnsafe$1(e);let s=0;for(const n of r)t.set(n,s),s+=n.length;return asUint8Array$1(t)}function convertToString(r,e){switch(getProtocol(r).code){case 4:case 41:return bytes2ip(e);case 42:return bytes2str(e);case 6:case 273:case 33:case 132:return bytes2port$1(e).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return bytes2str(e);case 421:return bytes2mh(e);case 444:return bytes2onion$1(e);case 445:return bytes2onion$1(e);case 466:return bytes2mb$1(e);default:return toString$3(e,"base16")}}function convertToBytes(r,e){switch(getProtocol(r).code){case 4:return ip2bytes(e);case 41:return ip2bytes(e);case 42:return str2bytes(e);case 6:case 273:case 33:case 132:return port2bytes$1(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return str2bytes(e);case 421:return mh2bytes(e);case 444:return onion2bytes$1(e);case 445:return onion32bytes$1(e);case 466:return mb2bytes$1(e);default:return fromString$3(e,"base16")}}const decoders$1=Object.values(bases$2).map(r=>r.decoder),anybaseDecoder$1=function(){let r=decoders$1[0].or(decoders$1[1]);return decoders$1.slice(2).forEach(e=>r=r.or(e)),r}();function ip2bytes(r){if(!isIP(r))throw new Error("invalid ip address");return toBytes$1(r)}function bytes2ip(r){const e=toString$2(r,0,r.length);if(e==null)throw new Error("ipBuff is required");if(!isIP(e))throw new Error("invalid ip address");return e}function port2bytes$1(r){const e=new ArrayBuffer(2);return new DataView(e).setUint16(0,r),new Uint8Array(e)}function bytes2port$1(r){return new DataView(r.buffer).getUint16(r.byteOffset)}function str2bytes(r){const e=fromString$3(r),t=Uint8Array.from(varint$1.encode(e.length));return concat$1([t,e],t.length+e.length)}function bytes2str(r){const e=varint$1.decode(r);if(r=r.slice(varint$1.decode.bytes),r.length!==e)throw new Error("inconsistent lengths");return toString$3(r)}function mh2bytes(r){let e;r[0]==="Q"||r[0]==="1"?e=decode$f(base58btc$2.decode(`z${r}`)).bytes:e=CID$1.parse(r).multihash.bytes;const t=Uint8Array.from(varint$1.encode(e.length));return concat$1([t,e],t.length+e.length)}function mb2bytes$1(r){const e=anybaseDecoder$1.decode(r),t=Uint8Array.from(varint$1.encode(e.length));return concat$1([t,e],t.length+e.length)}function bytes2mb$1(r){const e=varint$1.decode(r),t=r.slice(varint$1.decode.bytes);if(t.length!==e)throw new Error("inconsistent lengths");return"u"+toString$3(t,"base64url")}function bytes2mh(r){const e=varint$1.decode(r),t=r.slice(varint$1.decode.bytes);if(t.length!==e)throw new Error("inconsistent lengths");return toString$3(t,"base58btc")}function onion2bytes$1(r){const e=r.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);const t=base32$4.decode("b"+e[0]),s=parseInt(e[1],10);if(s<1||s>65536)throw new Error("Port number is not in range(1, 65536)");const n=port2bytes$1(s);return concat$1([t,n],t.length+n.length)}function onion32bytes$1(r){const e=r.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);const t=base32$4.decode(`b${e[0]}`),s=parseInt(e[1],10);if(s<1||s>65536)throw new Error("Port number is not in range(1, 65536)");const n=port2bytes$1(s);return concat$1([t,n],t.length+n.length)}function bytes2onion$1(r){const e=r.slice(0,r.length-2),t=r.slice(r.length-2),s=toString$3(e,"base32"),n=bytes2port$1(t);return`${s}:${n}`}function stringToStringTuples(r){const e=[],t=r.split("/").slice(1);if(t.length===1&&t[0]==="")return[];for(let s=0;s<t.length;s++){const n=t[s],i=getProtocol(n);if(i.size===0){e.push([n]);continue}if(s++,s>=t.length)throw ParseError("invalid address: "+r);if(i.path===!0){e.push([n,cleanPath(t.slice(s).join("/"))]);break}e.push([n,t[s]])}return e}function stringTuplesToString(r){const e=[];return r.map(t=>{const s=protoFromTuple(t);return e.push(s.name),t.length>1&&t[1]!=null&&e.push(t[1]),null}),cleanPath(e.join("/"))}function stringTuplesToTuples(r){return r.map(e=>{Array.isArray(e)||(e=[e]);const t=protoFromTuple(e);return e.length>1?[t.code,convertToBytes(t.code,e[1])]:[t.code]})}function tuplesToStringTuples(r){return r.map(e=>{const t=protoFromTuple(e);return e[1]!=null?[t.code,convertToString(t.code,e[1])]:[t.code]})}function tuplesToBytes(r){return fromBytes(concat$1(r.map(e=>{const t=protoFromTuple(e);let s=Uint8Array.from(varint$1.encode(t.code));return e.length>1&&e[1]!=null&&(s=concat$1([s,e[1]])),s})))}function sizeForAddr$1(r,e){return r.size>0?r.size/8:r.size===0?0:varint$1.decode(e)+(varint$1.decode.bytes??0)}function bytesToTuples(r){const e=[];let t=0;for(;t<r.length;){const s=varint$1.decode(r,t),n=varint$1.decode.bytes??0,i=getProtocol(s),o=sizeForAddr$1(i,r.slice(t+n));if(o===0){e.push([s]),t+=n;continue}const a=r.slice(t+n,t+n+o);if(t+=o+n,t>r.length)throw ParseError("Invalid address Uint8Array: "+toString$3(r,"base16"));e.push([s,a])}return e}function bytesToString$1(r){const e=bytesToTuples(r),t=tuplesToStringTuples(e);return stringTuplesToString(t)}function stringToBytes$1(r){r=cleanPath(r);const e=stringToStringTuples(r),t=stringTuplesToTuples(e);return tuplesToBytes(t)}function fromString$2(r){return stringToBytes$1(r)}function fromBytes(r){const e=validateBytes(r);if(e!=null)throw e;return Uint8Array.from(r)}function validateBytes(r){try{bytesToTuples(r)}catch(e){return e}}function cleanPath(r){return"/"+r.trim().split("/").filter(e=>e).join("/")}function ParseError(r){return new Error("Error parsing address: "+r)}function protoFromTuple(r){return getProtocol(r[0])}var errCode$1,hasRequiredErrCode;function requireErrCode(){if(hasRequiredErrCode)return errCode$1;hasRequiredErrCode=1;function r(t,s){for(const n in s)Object.defineProperty(t,n,{value:s[n],enumerable:!0,configurable:!0});return t}function e(t,s,n){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");n||(n={}),typeof s=="object"&&(n=s,s=""),s&&(n.code=s);try{return r(t,n)}catch{n.message=t.message,n.stack=t.stack;const o=function(){};return o.prototype=Object.create(Object.getPrototypeOf(t)),r(new o,n)}}return errCode$1=e,errCode$1}var errCodeExports=requireErrCode();const errCode=getDefaultExportFromCjs(errCodeExports);function equals$3(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}var __classPrivateFieldGet=function(r,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(r):s?s.value:e.get(r)},__classPrivateFieldSet=function(r,e,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(r,t):n?n.value=t:e.set(r,t),t},_DefaultMultiaddr_string,_DefaultMultiaddr_tuples,_DefaultMultiaddr_stringTuples,_a;const inspect$2=Symbol.for("nodejs.util.inspect.custom"),DNS_CODES$1=[getProtocol("dns").code,getProtocol("dns4").code,getProtocol("dns6").code,getProtocol("dnsaddr").code],resolvers$1=new Map,symbol$2=Symbol.for("@multiformats/js-multiaddr/multiaddr");function isMultiaddr$1(r){return!!(r!=null&&r[symbol$2])}class DefaultMultiaddr{constructor(e){if(_DefaultMultiaddr_string.set(this,void 0),_DefaultMultiaddr_tuples.set(this,void 0),_DefaultMultiaddr_stringTuples.set(this,void 0),this[_a]=!0,e==null&&(e=""),e instanceof Uint8Array)this.bytes=fromBytes(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=fromString$2(e)}else if(isMultiaddr$1(e))this.bytes=fromBytes(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return __classPrivateFieldGet(this,_DefaultMultiaddr_string,"f")==null&&__classPrivateFieldSet(this,_DefaultMultiaddr_string,bytesToString$1(this.bytes),"f"),__classPrivateFieldGet(this,_DefaultMultiaddr_string,"f")}toJSON(){return this.toString()}toOptions(){let e,t,s,n,i="";const o=getProtocol("tcp"),a=getProtocol("udp"),l=getProtocol("ip4"),p=getProtocol("ip6"),g=getProtocol("dns6"),x=getProtocol("ip6zone");for(const[E,f]of this.stringTuples())E===x.code&&(i=`%${f??""}`),DNS_CODES$1.includes(E)&&(t=o.name,n=443,s=`${f??""}${i}`,e=E===g.code?6:4),(E===o.code||E===a.code)&&(t=getProtocol(E).name,n=parseInt(f??"")),(E===l.code||E===p.code)&&(t=getProtocol(E).name,s=`${f??""}${i}`,e=E===p.code?6:4);if(e==null||t==null||s==null||n==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:s,transport:t,port:n}}protos(){return this.protoCodes().map(e=>Object.assign({},getProtocol(e)))}protoCodes(){const e=[],t=this.bytes;let s=0;for(;s<t.length;){const n=varint$1.decode(t,s),i=varint$1.decode.bytes??0,o=getProtocol(n),a=sizeForAddr$1(o,t.slice(s+i));s+=a+i,e.push(n)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return __classPrivateFieldGet(this,_DefaultMultiaddr_tuples,"f")==null&&__classPrivateFieldSet(this,_DefaultMultiaddr_tuples,bytesToTuples(this.bytes),"f"),__classPrivateFieldGet(this,_DefaultMultiaddr_tuples,"f")}stringTuples(){return __classPrivateFieldGet(this,_DefaultMultiaddr_stringTuples,"f")==null&&__classPrivateFieldSet(this,_DefaultMultiaddr_stringTuples,tuplesToStringTuples(this.tuples()),"f"),__classPrivateFieldGet(this,_DefaultMultiaddr_stringTuples,"f")}encapsulate(e){return e=new DefaultMultiaddr(e),new DefaultMultiaddr(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),s=this.toString(),n=s.lastIndexOf(t);if(n<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new DefaultMultiaddr(s.slice(0,n))}decapsulateCode(e){const t=this.tuples();for(let s=t.length-1;s>=0;s--)if(t[s][0]===e)return new DefaultMultiaddr(tuplesToBytes(t.slice(0,s)));return this}getPeerId(){try{const t=this.stringTuples().filter(s=>s[0]===names.ipfs.code).pop();if((t==null?void 0:t[1])!=null){const s=t[1];return s[0]==="Q"||s[0]==="1"?toString$3(base58btc$2.decode(`z${s}`),"base58btc"):toString$3(CID$1.parse(s).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let e=null;try{e=this.stringTuples().filter(t=>getProtocol(t[0]).path===!0)[0][1],e==null&&(e=null)}catch{e=null}return e}equals(e){return equals$3(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find(i=>i.resolvable);if(t==null)return[this];const s=resolvers$1.get(t.name);if(s==null)throw errCode(new Error(`no available resolver for ${t.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await s(this,e)).map(i=>new DefaultMultiaddr(i))}nodeAddress(){const e=this.toOptions();if(e.transport!=="tcp"&&e.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(e??this).protos();return!(t.length!==2||t[0].code!==4&&t[0].code!==41||t[1].code!==6&&t[1].code!==273)}[(_DefaultMultiaddr_string=new WeakMap,_DefaultMultiaddr_tuples=new WeakMap,_DefaultMultiaddr_stringTuples=new WeakMap,_a=symbol$2,inspect$2)](){return`Multiaddr(${bytesToString$1(this.bytes)})`}}function multiaddr$1(r){return new DefaultMultiaddr(r)}var isElectron_1,hasRequiredIsElectron;function requireIsElectron(){if(hasRequiredIsElectron)return isElectron_1;hasRequiredIsElectron=1;function r(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}return isElectron_1=r,isElectron_1}var env,hasRequiredEnv;function requireEnv(){if(hasRequiredEnv)return env;hasRequiredEnv=1;var r={};const e=requireIsElectron(),t=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,s=e(),n=t&&!s,i=s&&!t,o=s&&t,a=typeof commonjsRequire=="function"&&typeof process<"u"&&typeof process.release<"u"&&process.release.name==="node"&&!s,l=typeof importScripts=="function"&&typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,p=typeof process<"u"&&typeof r<"u"&&!1,g=typeof navigator<"u"&&navigator.product==="ReactNative";return env={isTest:p,isElectron:s,isElectronMain:i,isElectronRenderer:o,isNode:a,isBrowser:n,isWebWorker:l,isEnvWithDom:t,isReactNative:g},env}var envExports=requireEnv();const unit=Object.create(null),m=6e4,h=m*60,d=h*24,y=d*365.25;unit.year=unit.yr=unit.y=y;unit.month=unit.mo=unit.mth=y/12;unit.week=unit.wk=unit.w=d*7;unit.day=unit.d=d;unit.hour=unit.hr=unit.h=h;unit.minute=unit.min=unit.m=m;unit.second=unit.sec=unit.s=1e3;unit.millisecond=unit.millisec=unit.ms=1;unit.microsecond=unit.microsec=unit.us=unit.µs=.001;unit.nanosecond=unit.nanosec=unit.ns=1e-6;unit.group=",";unit.decimal=".";unit.placeholder=" _";const durationRE=/((?:\d{1,16}(?:\.\d{1,16})?|\.\d{1,16})(?:[eE][-+]?\d{1,4})?)\s?([\p{L}]{0,14})/gu;parse.unit=unit;function parse(r="",e="ms"){let t=null,s;return String(r).replace(new RegExp(`(\\d)[${parse.unit.placeholder}${parse.unit.group}](\\d)`,"g"),"$1$2").replace(parse.unit.decimal,".").replace(durationRE,(n,i,o)=>{if(o)o=o.toLowerCase();else if(s){for(const a in parse.unit)if(parse.unit[a]<s){o=a;break}}else o=e;s=o=parse.unit[o]||parse.unit[o.replace(/s$/,"")],o&&(t=(t||0)+i*o)}),t&&t/(parse.unit[e]||1)*(r[0]==="-"?-1:1)}var browser$1={exports:{}},ms,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms;hasRequiredMs=1;var r=1e3,e=r*60,t=e*60,s=t*24,n=s*7,i=s*365.25;ms=function(g,x){x=x||{};var b=typeof g;if(b==="string"&&g.length>0)return o(g);if(b==="number"&&isFinite(g))return x.long?l(g):a(g);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(g))};function o(g){if(g=String(g),!(g.length>100)){var x=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(g);if(x){var b=parseFloat(x[1]),E=(x[2]||"ms").toLowerCase();switch(E){case"years":case"year":case"yrs":case"yr":case"y":return b*i;case"weeks":case"week":case"w":return b*n;case"days":case"day":case"d":return b*s;case"hours":case"hour":case"hrs":case"hr":case"h":return b*t;case"minutes":case"minute":case"mins":case"min":case"m":return b*e;case"seconds":case"second":case"secs":case"sec":case"s":return b*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return b;default:return}}}}function a(g){var x=Math.abs(g);return x>=s?Math.round(g/s)+"d":x>=t?Math.round(g/t)+"h":x>=e?Math.round(g/e)+"m":x>=r?Math.round(g/r)+"s":g+"ms"}function l(g){var x=Math.abs(g);return x>=s?p(g,x,s,"day"):x>=t?p(g,x,t,"hour"):x>=e?p(g,x,e,"minute"):x>=r?p(g,x,r,"second"):g+" ms"}function p(g,x,b,E){var f=x>=b*1.5;return Math.round(g/b)+" "+E+(f?"s":"")}return ms}var common,hasRequiredCommon;function requireCommon(){if(hasRequiredCommon)return common;hasRequiredCommon=1;function r(e){s.debug=s,s.default=s,s.coerce=p,s.disable=a,s.enable=i,s.enabled=l,s.humanize=requireMs(),s.destroy=g,Object.keys(e).forEach(x=>{s[x]=e[x]}),s.names=[],s.skips=[],s.formatters={};function t(x){let b=0;for(let E=0;E<x.length;E++)b=(b<<5)-b+x.charCodeAt(E),b|=0;return s.colors[Math.abs(b)%s.colors.length]}s.selectColor=t;function s(x){let b,E=null,f,j;function C(...S){if(!C.enabled)return;const R=C,I=Number(new Date),A=I-(b||I);R.diff=A,R.prev=b,R.curr=I,b=I,S[0]=s.coerce(S[0]),typeof S[0]!="string"&&S.unshift("%O");let $=0;S[0]=S[0].replace(/%([a-zA-Z%])/g,(k,P)=>{if(k==="%%")return"%";$++;const D=s.formatters[P];if(typeof D=="function"){const M=S[$];k=D.call(R,M),S.splice($,1),$--}return k}),s.formatArgs.call(R,S),(R.log||s.log).apply(R,S)}return C.namespace=x,C.useColors=s.useColors(),C.color=s.selectColor(x),C.extend=n,C.destroy=s.destroy,Object.defineProperty(C,"enabled",{enumerable:!0,configurable:!1,get:()=>E!==null?E:(f!==s.namespaces&&(f=s.namespaces,j=s.enabled(x)),j),set:S=>{E=S}}),typeof s.init=="function"&&s.init(C),C}function n(x,b){const E=s(this.namespace+(typeof b>"u"?":":b)+x);return E.log=this.log,E}function i(x){s.save(x),s.namespaces=x,s.names=[],s.skips=[];const b=(typeof x=="string"?x:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const E of b)E[0]==="-"?s.skips.push(E.slice(1)):s.names.push(E)}function o(x,b){let E=0,f=0,j=-1,C=0;for(;E<x.length;)if(f<b.length&&(b[f]===x[E]||b[f]==="*"))b[f]==="*"?(j=f,C=E,f++):(E++,f++);else if(j!==-1)f=j+1,C++,E=C;else return!1;for(;f<b.length&&b[f]==="*";)f++;return f===b.length}function a(){const x=[...s.names,...s.skips.map(b=>"-"+b)].join(",");return s.enable(""),x}function l(x){for(const b of s.skips)if(o(x,b))return!1;for(const b of s.names)if(o(x,b))return!0;return!1}function p(x){return x instanceof Error?x.stack||x.message:x}function g(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return s.enable(s.load()),s}return common=r,common}var hasRequiredBrowser$1;function requireBrowser$1(){return hasRequiredBrowser$1||(hasRequiredBrowser$1=1,function(r,e){var t={};e.formatArgs=n,e.save=i,e.load=o,e.useColors=s,e.storage=a(),e.destroy=(()=>{let p=!1;return()=>{p||(p=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function s(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let p;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(p=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(p[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(p){if(p[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+p[0]+(this.useColors?"%c ":" ")+"+"+r.exports.humanize(this.diff),!this.useColors)return;const g="color: "+this.color;p.splice(1,0,g,"color: inherit");let x=0,b=0;p[0].replace(/%[a-zA-Z%]/g,E=>{E!=="%%"&&(x++,E==="%c"&&(b=x))}),p.splice(b,0,g)}e.log=console.debug||console.log||(()=>{});function i(p){try{p?e.storage.setItem("debug",p):e.storage.removeItem("debug")}catch{}}function o(){let p;try{p=e.storage.getItem("debug")||e.storage.getItem("DEBUG")}catch{}return!p&&typeof process<"u"&&"env"in process&&(p=t.DEBUG),p}function a(){try{return localStorage}catch{}}r.exports=requireCommon()(e);const{formatters:l}=r.exports;l.j=function(p){try{return JSON.stringify(p)}catch(g){return"[UnexpectedJSONParseError]: "+g.message}}}(browser$1,browser$1.exports)),browser$1.exports}var browserExports=requireBrowser$1();const debug=getDefaultExportFromCjs(browserExports);debug.formatters.b=r=>r==null?"undefined":base58btc$2.baseEncode(r);debug.formatters.t=r=>r==null?"undefined":base32$4.baseEncode(r);debug.formatters.m=r=>r==null?"undefined":base64$5.baseEncode(r);debug.formatters.p=r=>r==null?"undefined":r.toString();debug.formatters.c=r=>r==null?"undefined":r.toString();debug.formatters.k=r=>r==null?"undefined":r.toString();debug.formatters.a=r=>r==null?"undefined":r.toString();function createDisabledLogger(r){const e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=r,e.destroy=()=>!0,e.extend=()=>e,e}function logger$1(r){let e=createDisabledLogger(`${r}:trace`);return debug.enabled(`${r}:trace`)&&debug.names.map(t=>t.toString()).find(t=>t.includes(":trace"))!=null&&(e=debug(`${r}:trace`)),Object.assign(debug(r),{error:debug(`${r}:error`),trace:e})}var error={},hasRequiredError;function requireError(){if(hasRequiredError)return error;hasRequiredError=1;class r extends Error{constructor(n="Request timed out"){super(n),this.name="TimeoutError"}}error.TimeoutError=r;class e extends Error{constructor(n="The operation was aborted."){super(n),this.name="AbortError"}}error.AbortError=e;class t extends Error{constructor(n){super(n.statusText),this.name="HTTPError",this.response=n}}return error.HTTPError=t,error}var src$1={exports:{}},browser={exports:{}},hasRequiredBrowser;function requireBrowser(){return hasRequiredBrowser||(hasRequiredBrowser=1,function(r,e){var t=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof commonjsGlobal<"u")return commonjsGlobal;throw new Error("unable to locate global object")},s=t();r.exports=e=s.fetch,s.fetch&&(e.default=s.fetch.bind(s)),e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response}(browser,browser.exports)),browser.exports}var hasRequiredSrc;function requireSrc(){return hasRequiredSrc||(hasRequiredSrc=1,globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?src$1.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:src$1.exports={default:requireBrowser().default,Headers:requireBrowser().Headers,Request:requireBrowser().Request,Response:requireBrowser().Response}),src$1.exports}var fetch_browser$1,hasRequiredFetch_browser$1;function requireFetch_browser$1(){return hasRequiredFetch_browser$1||(hasRequiredFetch_browser$1=1,fetch_browser$1=requireSrc()),fetch_browser$1}var fetch_browser,hasRequiredFetch_browser;function requireFetch_browser(){if(hasRequiredFetch_browser)return fetch_browser;hasRequiredFetch_browser=1;const{TimeoutError:r,AbortError:e}=requireError(),{Response:t,Request:s,Headers:n,default:i}=requireFetch_browser$1(),o=(x,b={})=>{const E=new XMLHttpRequest;E.open(b.method||"GET",x.toString(),!0);const{timeout:f,headers:j}=b;if(f&&f>0&&f<1/0&&(E.timeout=f),b.overrideMimeType!=null&&E.overrideMimeType(b.overrideMimeType),j)for(const[C,S]of new n(j))E.setRequestHeader(C,S);return b.signal&&(b.signal.onabort=()=>E.abort()),b.onUploadProgress&&(E.upload.onprogress=b.onUploadProgress),E.responseType="arraybuffer",new Promise((C,S)=>{const R=I=>{switch(I.type){case"error":{C(t.error());break}case"load":{C(new g(E.responseURL,E.response,{status:E.status,statusText:E.statusText,headers:p(E.getAllResponseHeaders())}));break}case"timeout":{S(new r);break}case"abort":{S(new e);break}}};E.onerror=R,E.onload=R,E.ontimeout=R,E.onabort=R,E.send(b.body)})},a=i,l=(x,b={})=>b.onUploadProgress!=null?o(x,b):a(x,b),p=x=>{const b=new n;for(const E of x.trim().split(/[\r\n]+/)){const f=E.indexOf(": ");f>0&&b.set(E.slice(0,f),E.slice(f+1))}return b};class g extends t{constructor(b,E,f){super(E,f),Object.defineProperty(this,"url",{value:b})}}return fetch_browser={fetch:l,Request:s,Headers:n},fetch_browser}var isPlainObj,hasRequiredIsPlainObj;function requireIsPlainObj(){return hasRequiredIsPlainObj||(hasRequiredIsPlainObj=1,isPlainObj=r=>{if(Object.prototype.toString.call(r)!=="[object Object]")return!1;const e=Object.getPrototypeOf(r);return e===null||e===Object.prototype}),isPlainObj}var mergeOptions$1,hasRequiredMergeOptions;function requireMergeOptions(){if(hasRequiredMergeOptions)return mergeOptions$1;hasRequiredMergeOptions=1;const r=requireIsPlainObj(),{hasOwnProperty:e}=Object.prototype,{propertyIsEnumerable:t}=Object,s=(E,f,j)=>Object.defineProperty(E,f,{value:j,writable:!0,enumerable:!0,configurable:!0}),n=mergeOptions$1,i={concatArrays:!1,ignoreUndefined:!1},o=E=>{const f=[];for(const j in E)e.call(E,j)&&f.push(j);if(Object.getOwnPropertySymbols){const j=Object.getOwnPropertySymbols(E);for(const C of j)t.call(E,C)&&f.push(C)}return f};function a(E){return Array.isArray(E)?l(E):r(E)?p(E):E}function l(E){const f=E.slice(0,0);return o(E).forEach(j=>{s(f,j,a(E[j]))}),f}function p(E){const f=Object.getPrototypeOf(E)===null?Object.create(null):{};return o(E).forEach(j=>{s(f,j,a(E[j]))}),f}const g=(E,f,j,C)=>(j.forEach(S=>{typeof f[S]>"u"&&C.ignoreUndefined||(S in E&&E[S]!==Object.getPrototypeOf(E)?s(E,S,b(E[S],f[S],C)):s(E,S,a(f[S])))}),E),x=(E,f,j)=>{let C=E.slice(0,0),S=0;return[E,f].forEach(R=>{const I=[];for(let A=0;A<R.length;A++)e.call(R,A)&&(I.push(String(A)),R===E?s(C,S++,R[A]):s(C,S++,a(R[A])));C=g(C,R,o(R).filter(A=>!I.includes(A)),j)}),C};function b(E,f,j){return j.concatArrays&&Array.isArray(E)&&Array.isArray(f)?x(E,f,j):!r(f)||!r(E)?a(f):g(E,f,o(f),j)}return mergeOptions$1=function(...E){const f=b(a(i),this!==n&&this||{},i);let j={_:{}};for(const C of E)if(C!==void 0){if(!r(C))throw new TypeError("`"+C+"` is not an Option Object");j=b(j,{_:C},f)}return j._},mergeOptions$1}var urlBrowser,hasRequiredUrlBrowser;function requireUrlBrowser(){if(hasRequiredUrlBrowser)return urlBrowser;hasRequiredUrlBrowser=1;const r=typeof navigator<"u"&&navigator.product==="ReactNative";function e(){return r?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}const t=self.URL,s=e();class n{constructor(a="",l=s){this.super=new t(a,l),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(a){this.super.hash=a}set host(a){this.super.host=a}set hostname(a){this.super.hostname=a}set href(a){this.super.href=a}set password(a){this.super.password=a}set pathname(a){this.super.pathname=a}set port(a){this.super.port=a}set protocol(a){this.super.protocol=a}set search(a){this.super.search=a}set username(a){this.super.username=a}static createObjectURL(a){return t.createObjectURL(a)}static revokeObjectURL(a){t.revokeObjectURL(a)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}}function i(o){if(typeof o=="string")return new t(o).toString();if(!(o instanceof t)){const a=o.username&&o.password?`${o.username}:${o.password}@`:"",l=o.auth?o.auth+"@":"",p=o.port?":"+o.port:"",g=o.protocol?o.protocol+"//":"",x=o.host||"",b=o.hostname||"",E=o.search||(o.query?"?"+o.query:""),f=o.hash||"",j=o.pathname||"",C=o.path||j+E;return`${g}${a||l}${x||b+p}${C}${f}`}}return urlBrowser={URLWithLegacySupport:n,URLSearchParams:self.URLSearchParams,defaultBase:s,format:i},urlBrowser}var relative,hasRequiredRelative;function requireRelative(){if(hasRequiredRelative)return relative;hasRequiredRelative=1;const{URLWithLegacySupport:r,format:e}=requireUrlBrowser();return relative=(t,s={},n={},i)=>{let o=s.protocol?s.protocol.replace(":",""):"http";o=(n[o]||i||o)+":";let a;try{a=new r(t)}catch{a={}}const l=Object.assign({},s,{protocol:o||a.protocol,host:s.host||a.host});return new r(t,e(l)).toString()},relative}var isoUrl,hasRequiredIsoUrl;function requireIsoUrl(){if(hasRequiredIsoUrl)return isoUrl;hasRequiredIsoUrl=1;const{URLWithLegacySupport:r,format:e,URLSearchParams:t,defaultBase:s}=requireUrlBrowser(),n=requireRelative();return isoUrl={URL:r,URLSearchParams:t,format:e,relative:n,defaultBase:s},isoUrl}var anySignal={exports:{}},hasRequiredAnySignal;function requireAnySignal(){if(hasRequiredAnySignal)return anySignal.exports;hasRequiredAnySignal=1;function r(e){const t=new globalThis.AbortController;function s(){t.abort();for(const n of e)!n||!n.removeEventListener||n.removeEventListener("abort",s)}for(const n of e)if(!(!n||!n.addEventListener)){if(n.aborted){s();break}n.addEventListener("abort",s)}return t.signal}return anySignal.exports=r,anySignal.exports.anySignal=r,anySignal.exports}var browserReadablestreamToIt,hasRequiredBrowserReadablestreamToIt;function requireBrowserReadablestreamToIt(){if(hasRequiredBrowserReadablestreamToIt)return browserReadablestreamToIt;hasRequiredBrowserReadablestreamToIt=1;async function*r(e,t={}){const s=e.getReader();try{for(;;){const n=await s.read();if(n.done)return;yield n.value}}finally{t.preventCancel!==!0&&s.cancel(),s.releaseLock()}}return browserReadablestreamToIt=r,browserReadablestreamToIt}var itAll,hasRequiredItAll;function requireItAll(){return hasRequiredItAll||(hasRequiredItAll=1,itAll=async e=>{const t=[];for await(const s of e)t.push(s);return t}),itAll}var http,hasRequiredHttp;function requireHttp(){if(hasRequiredHttp)return http;hasRequiredHttp=1;const{fetch:r,Request:e,Headers:t}=requireFetch_browser(),{TimeoutError:s,HTTPError:n}=requireError(),i=requireMergeOptions().bind({ignoreUndefined:!0}),{URL:o,URLSearchParams:a}=requireIsoUrl(),l=requireAnySignal(),p=requireBrowserReadablestreamToIt(),{isBrowser:g,isWebWorker:x}=requireEnv(),b=requireItAll(),E=($,N,k)=>{if(N===void 0)return $;const P=Date.now(),D=()=>Date.now()-P>=N;return new Promise((M,L)=>{const q=setTimeout(()=>{D()&&(L(new s),k.abort())},N),K=H=>B=>{if(clearTimeout(q),D()){L(new s);return}H(B)};$.then(K(M),K(L))})},f={throwHttpErrors:!0,credentials:"same-origin"};class j{constructor(N={}){this.opts=i(f,N)}async fetch(N,k={}){const P=i(this.opts,k),D=new t(P.headers);if(typeof N!="string"&&!(N instanceof o||N instanceof e))throw new TypeError("`resource` must be a string, URL, or Request");const M=new o(N.toString(),P.base),{searchParams:L,transformSearchParams:q,json:K}=P;L&&(typeof q=="function"?M.search=q(new a(P.searchParams)):M.search=new a(P.searchParams)),K&&(P.body=JSON.stringify(P.json),D.set("content-type","application/json"));const H=new AbortController,ee=l([H.signal,P.signal]);globalThis.ReadableStream!=null&&P.body instanceof globalThis.ReadableStream&&(g||x)&&(P.body=new Blob(await b(p(P.body))));const B=await E(r(M.toString(),{...P,signal:ee,timeout:void 0,headers:D,duplex:"half"}),P.timeout,H);if(!B.ok&&P.throwHttpErrors)throw P.handleError&&await P.handleError(B),new n(B);return B.iterator=async function*(){yield*S(B.body)},B.ndjson=async function*(){for await(const G of C(B.iterator()))k.transform?yield k.transform(G):yield G},B}post(N,k={}){return this.fetch(N,{...k,method:"POST"})}get(N,k={}){return this.fetch(N,{...k,method:"GET"})}put(N,k={}){return this.fetch(N,{...k,method:"PUT"})}delete(N,k={}){return this.fetch(N,{...k,method:"DELETE"})}options(N,k={}){return this.fetch(N,{...k,method:"OPTIONS"})}}const C=async function*($){const N=new TextDecoder;let k="";for await(const P of $){k+=N.decode(P,{stream:!0});const D=k.split(/\r?\n/);for(let M=0;M<D.length-1;M++){const L=D[M].trim();L.length>0&&(yield JSON.parse(L))}k=D[D.length-1]}k+=N.decode(),k=k.trim(),k.length!==0&&(yield JSON.parse(k))},S=$=>{if(R($))return $;if(A($)){const N=$[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:N.next.bind(N),return(k){return $.destroy(),typeof N.return=="function"?N.return():Promise.resolve({done:!0,value:k})}}}}}if(I($)){const N=$.getReader();return async function*(){try{for(;;){const{done:k,value:P}=await N.read();if(k)return;P&&(yield P)}}finally{N.releaseLock()}}()}throw new TypeError("Body can't be converted to AsyncIterable")},R=$=>typeof $=="object"&&$!==null&&typeof $[Symbol.asyncIterator]=="function",I=$=>$&&typeof $.getReader=="function",A=$=>Object.prototype.hasOwnProperty.call($,"readable")&&Object.prototype.hasOwnProperty.call($,"writable");return j.HTTPError=n,j.TimeoutError=s,j.streamToAsyncIterator=S,j.post=($,N)=>new j(N).post($,N),j.get=($,N)=>new j(N).get($,N),j.put=($,N)=>new j(N).put($,N),j.delete=($,N)=>new j(N).delete($,N),j.options=($,N)=>new j(N).options($,N),http=j,http}var httpExports=requireHttp();const HTTP=getDefaultExportFromCjs(httpExports);var mergeOptionsExports=requireMergeOptions();const mergeOptions=getDefaultExportFromCjs(mergeOptionsExports);function equals$2(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}function coerce(r){if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}function fromString$1(r){return new TextEncoder().encode(r)}function toString$1(r){return new TextDecoder().decode(r)}function base(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var n=0;n<r.length;n++){var i=r.charAt(n),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=n}var a=r.length,l=r.charAt(0),p=Math.log(a)/Math.log(256),g=Math.log(256)/Math.log(a);function x(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var j=0,C=0,S=0,R=f.length;S!==R&&f[S]===0;)S++,j++;for(var I=(R-S)*g+1>>>0,A=new Uint8Array(I);S!==R;){for(var $=f[S],N=0,k=I-1;($!==0||N<C)&&k!==-1;k--,N++)$+=256*A[k]>>>0,A[k]=$%a>>>0,$=$/a>>>0;if($!==0)throw new Error("Non-zero carry");C=N,S++}for(var P=I-C;P!==I&&A[P]===0;)P++;for(var D=l.repeat(j);P<I;++P)D+=r.charAt(A[P]);return D}function b(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var j=0;if(f[j]!==" "){for(var C=0,S=0;f[j]===l;)C++,j++;for(var R=(f.length-j)*p+1>>>0,I=new Uint8Array(R);f[j];){var A=t[f.charCodeAt(j)];if(A===255)return;for(var $=0,N=R-1;(A!==0||$<S)&&N!==-1;N--,$++)A+=a*I[N]>>>0,I[N]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");S=$,j++}if(f[j]!==" "){for(var k=R-S;k!==R&&I[k]===0;)k++;for(var P=new Uint8Array(C+(R-k)),D=C;k!==R;)P[D++]=I[k++];return P}}}function E(f){var j=b(f);if(j)return j;throw new Error(`Non-${e} character`)}return{encode:x,decodeUnsafe:b,decode:E}}var src=base,_brrp__multiformats_scope_baseX=src;class Encoder{constructor(e,t,s){O(this,"name");O(this,"prefix");O(this,"baseEncode");this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Decoder{constructor(e,t,s){O(this,"name");O(this,"prefix");O(this,"baseDecode");O(this,"prefixCodePoint");this.name=e,this.prefix=t;const n=t.codePointAt(0);if(n===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n,this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return or(this,e)}}class ComposedDecoder{constructor(e){O(this,"decoders");this.decoders=e}or(e){return or(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s!=null)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function or(r,e){return new ComposedDecoder({...r.decoders??{[r.prefix]:r},...e.decoders??{[e.prefix]:e}})}class Codec{constructor(e,t,s,n){O(this,"name");O(this,"prefix");O(this,"baseEncode");O(this,"baseDecode");O(this,"encoder");O(this,"decoder");this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=n,this.encoder=new Encoder(e,t,s),this.decoder=new Decoder(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function from({name:r,prefix:e,encode:t,decode:s}){return new Codec(r,e,t,s)}function baseX({name:r,prefix:e,alphabet:t}){const{encode:s,decode:n}=_brrp__multiformats_scope_baseX(t,r);return from({prefix:e,name:r,encode:s,decode:i=>coerce(n(i))})}function decode$5(r,e,t,s){let n=r.length;for(;r[n-1]==="=";)--n;const i=new Uint8Array(n*t/8|0);let o=0,a=0,l=0;for(let p=0;p<n;++p){const g=e[r[p]];if(g===void 0)throw new SyntaxError(`Non-${s} character`);a=a<<t|g,o+=t,o>=8&&(o-=8,i[l++]=255&a>>o)}if(o>=t||(255&a<<8-o)!==0)throw new SyntaxError("Unexpected end of data");return i}function encode$2(r,e,t){const s=e[e.length-1]==="=",n=(1<<t)-1;let i="",o=0,a=0;for(let l=0;l<r.length;++l)for(a=a<<8|r[l],o+=8;o>t;)o-=t,i+=e[n&a>>o];if(o!==0&&(i+=e[n&a<<t-o]),s)for(;(i.length*t&7)!==0;)i+="=";return i}function createAlphabetIdx(r){const e={};for(let t=0;t<r.length;++t)e[r[t]]=t;return e}function rfc4648({name:r,prefix:e,bitsPerChar:t,alphabet:s}){const n=createAlphabetIdx(s);return from({prefix:e,name:r,encode(i){return encode$2(i,s,t)},decode(i){return decode$5(i,n,t,r)}})}const base10=baseX({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$1=Object.freeze(Object.defineProperty({__proto__:null,base10},Symbol.toStringTag,{value:"Module"})),base16=rfc4648({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper=rfc4648({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$1=Object.freeze(Object.defineProperty({__proto__:null,base16,base16upper},Symbol.toStringTag,{value:"Module"})),base2=rfc4648({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$1=Object.freeze(Object.defineProperty({__proto__:null,base2},Symbol.toStringTag,{value:"Module"})),alphabet=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),alphabetBytesToChars=alphabet.reduce((r,e,t)=>(r[t]=e,r),[]),alphabetCharsToBytes=alphabet.reduce((r,e,t)=>{const s=e.codePointAt(0);if(s==null)throw new Error(`Invalid character: ${e}`);return r[s]=t,r},[]);function encode$1(r){return r.reduce((e,t)=>(e+=alphabetBytesToChars[t],e),"")}function decode$4(r){const e=[];for(const t of r){const s=t.codePointAt(0);if(s==null)throw new Error(`Invalid character: ${t}`);const n=alphabetCharsToBytes[s];if(n==null)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const base256emoji=from({prefix:"🚀",name:"base256emoji",encode:encode$1,decode:decode$4}),base256emoji$1=Object.freeze(Object.defineProperty({__proto__:null,base256emoji},Symbol.toStringTag,{value:"Module"})),base32=rfc4648({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper=rfc4648({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad=rfc4648({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper=rfc4648({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex=rfc4648({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper=rfc4648({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad=rfc4648({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper=rfc4648({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z=rfc4648({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$1=Object.freeze(Object.defineProperty({__proto__:null,base32,base32hex,base32hexpad,base32hexpadupper,base32hexupper,base32pad,base32padupper,base32upper,base32z},Symbol.toStringTag,{value:"Module"})),base36=baseX({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper=baseX({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$1=Object.freeze(Object.defineProperty({__proto__:null,base36,base36upper},Symbol.toStringTag,{value:"Module"})),base58btc=baseX({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr=baseX({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58=Object.freeze(Object.defineProperty({__proto__:null,base58btc,base58flickr},Symbol.toStringTag,{value:"Module"})),base64$1=rfc4648({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad=rfc4648({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url=rfc4648({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad=rfc4648({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$2=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$1,base64pad,base64url,base64urlpad},Symbol.toStringTag,{value:"Module"})),base8=rfc4648({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$1=Object.freeze(Object.defineProperty({__proto__:null,base8},Symbol.toStringTag,{value:"Module"})),identity=from({prefix:"\0",name:"identity",encode:r=>toString$1(r),decode:r=>fromString$1(r)}),identityBase=Object.freeze(Object.defineProperty({__proto__:null,identity},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;var encode_1=encode,MSB$1=128,MSBALL=-128,INT=Math.pow(2,31);function encode(r,e,t){e=e||[],t=t||0;for(var s=t;r>=INT;)e[t++]=r&255|MSB$1,r/=128;for(;r&MSBALL;)e[t++]=r&255|MSB$1,r>>>=7;return e[t]=r|0,encode.bytes=t-s+1,e}var decode$3=read,MSB$1$1=128,REST$1=127;function read(r,s){var t=0,s=s||0,n=0,i=s,o,a=r.length;do{if(i>=a)throw read.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=n<28?(o&REST$1)<<n:(o&REST$1)*Math.pow(2,n),n+=7}while(o>=MSB$1$1);return read.bytes=i-s,t}var N1$1=Math.pow(2,7),N2$1=Math.pow(2,14),N3$1=Math.pow(2,21),N4$1=Math.pow(2,28),N5$1=Math.pow(2,35),N6$1=Math.pow(2,42),N7$1=Math.pow(2,49),N8=Math.pow(2,56),N9=Math.pow(2,63),length=function(r){return r<N1$1?1:r<N2$1?2:r<N3$1?3:r<N4$1?4:r<N5$1?5:r<N6$1?6:r<N7$1?7:r<N8?8:r<N9?9:10},varint={encode:encode_1,decode:decode$3,encodingLength:length},_brrp_varint=varint;function decode$2(r,e=0){return[_brrp_varint.decode(r,e),_brrp_varint.decode.bytes]}function encodeTo(r,e,t=0){return _brrp_varint.encode(r,e,t),e}function encodingLength$1(r){return _brrp_varint.encodingLength(r)}function create$1(r,e){const t=e.byteLength,s=encodingLength$1(r),n=s+encodingLength$1(t),i=new Uint8Array(n+t);return encodeTo(r,i,0),encodeTo(t,i,s),i.set(e,n),new Digest(r,t,e,i)}function decode$1(r){const e=coerce(r),[t,s]=decode$2(e),[n,i]=decode$2(e.subarray(s)),o=e.subarray(s+i);if(o.byteLength!==n)throw new Error("Incorrect length");return new Digest(t,n,o,e)}function equals$1(r,e){if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&equals$2(r.bytes,t.bytes)}}class Digest{constructor(e,t,s,n){O(this,"code");O(this,"size");O(this,"digest");O(this,"bytes");this.code=e,this.size=t,this.digest=s,this.bytes=n}}function format(r,e){const{bytes:t,version:s}=r;switch(s){case 0:return toStringV0(t,baseCache(r),e??base58btc.encoder);default:return toStringV1(t,baseCache(r),e??base32.encoder)}}const cache=new WeakMap;function baseCache(r){const e=cache.get(r);if(e==null){const t=new Map;return cache.set(r,t),t}return e}var ze;class CID{constructor(e,t,s,n){O(this,"code");O(this,"version");O(this,"multihash");O(this,"bytes");O(this,"/");O(this,ze,"CID");this.code=t,this.version=e,this.multihash=s,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return CID.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,s=create$1(e,t);return CID.createV1(this.code,s)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return CID.equals(this,e)}static equals(e,t){const s=t;return s!=null&&e.code===s.code&&e.version===s.version&&equals$1(e.multihash,s.multihash)}toString(e){return format(this,e)}toJSON(){return{"/":format(this)}}link(){return this}[(ze=Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"))](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;const t=e;if(t instanceof CID)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){const{version:s,code:n,multihash:i,bytes:o}=t;return new CID(s,n,i,o??encodeCID$1(s,n,i.bytes))}else if(t[cidSymbol]===!0){const{version:s,multihash:n,code:i}=t,o=decode$1(n);return CID.create(s,i,o)}else return null}static create(e,t,s){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(s.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(t!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new CID(e,t,s,s.bytes)}case 1:{const n=encodeCID$1(e,t,s.bytes);return new CID(e,t,s,n)}default:throw new Error("Invalid version")}}static createV0(e){return CID.create(0,DAG_PB_CODE,e)}static createV1(e,t){return CID.create(1,e,t)}static decode(e){const[t,s]=CID.decodeFirst(e);if(s.length!==0)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=CID.inspectBytes(e),s=t.size-t.multihashSize,n=coerce(e.subarray(s,s+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),o=new Digest(t.multihashCode,t.digestSize,i,n);return[t.version===0?CID.createV0(o):CID.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const s=()=>{const[x,b]=decode$2(e.subarray(t));return t+=b,x};let n=s(),i=DAG_PB_CODE;if(n===18?(n=0,t=0):i=s(),n!==0&&n!==1)throw new RangeError(`Invalid CID version ${n}`);const o=t,a=s(),l=s(),p=t+l,g=p-o;return{version:n,codec:i,multihashCode:a,digestSize:l,multihashSize:g,size:p}}static parse(e,t){const[s,n]=parseCIDtoBytes(e,t),i=CID.decode(n);if(i.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return baseCache(i).set(s,e),i}}function parseCIDtoBytes(r,e){switch(r[0]){case"Q":{const t=e??base58btc;return[base58btc.prefix,t.decode(`${base58btc.prefix}${r}`)]}case base58btc.prefix:{const t=e??base58btc;return[base58btc.prefix,t.decode(r)]}case base32.prefix:{const t=e??base32;return[base32.prefix,t.decode(r)]}case base36.prefix:{const t=e??base36;return[base36.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}}function toStringV0(r,e,t){const{prefix:s}=t;if(s!==base58btc.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const n=e.get(s);if(n==null){const i=t.encode(r).slice(1);return e.set(s,i),i}else return n}function toStringV1(r,e,t){const{prefix:s}=t,n=e.get(s);if(n==null){const i=t.encode(r);return e.set(s,i),i}else return n}const DAG_PB_CODE=112,SHA_256_CODE=18;function encodeCID$1(r,e,t){const s=encodingLength$1(r),n=s+encodingLength$1(e),i=new Uint8Array(n+t.byteLength);return encodeTo(r,i,0),encodeTo(e,i,s),i.set(t,n),i}const cidSymbol=Symbol.for("@ipld/js-cid/CID"),bases={...identityBase,...base2$1,...base8$1,...base10$1,...base16$1,...base32$1,...base36$1,...base58,...base64$2,...base256emoji$1};function allocUnsafe(r=0){return new Uint8Array(r)}function createCodec(r,e,t,s){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:s}}}const string=createCodec("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),ascii=createCodec("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=allocUnsafe(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),BASES={utf8:string,"utf-8":string,hex:bases.base16,latin1:ascii,ascii,binary:ascii,...bases};function toString(r,e="utf8"){const t=BASES[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return t.encoder.encode(r).substring(1)}class InvalidMultiaddrError extends Error{constructor(){super(...arguments);O(this,"name","InvalidMultiaddrError")}}O(InvalidMultiaddrError,"name","InvalidMultiaddrError");class ValidationError extends Error{constructor(){super(...arguments);O(this,"name","ValidationError")}}O(ValidationError,"name","ValidationError");class InvalidParametersError extends Error{constructor(){super(...arguments);O(this,"name","InvalidParametersError")}}O(InvalidParametersError,"name","InvalidParametersError");class UnknownProtocolError extends Error{constructor(){super(...arguments);O(this,"name","UnknownProtocolError")}}O(UnknownProtocolError,"name","UnknownProtocolError");function equals(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}function fromString(r,e="utf8"){const t=BASES[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return t.decoder.decode(`${t.prefix}${r}`)}const N1=Math.pow(2,7),N2=Math.pow(2,14),N3=Math.pow(2,21),N4=Math.pow(2,28),N5=Math.pow(2,35),N6=Math.pow(2,42),N7=Math.pow(2,49),MSB=128,REST=127;function encodingLength(r){if(r<N1)return 1;if(r<N2)return 2;if(r<N3)return 3;if(r<N4)return 4;if(r<N5)return 5;if(r<N6)return 6;if(r<N7)return 7;if(Number.MAX_SAFE_INTEGER!=null&&r>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function encodeUint8Array(r,e,t=0){switch(encodingLength(r)){case 8:e[t++]=r&255|MSB,r/=128;case 7:e[t++]=r&255|MSB,r/=128;case 6:e[t++]=r&255|MSB,r/=128;case 5:e[t++]=r&255|MSB,r/=128;case 4:e[t++]=r&255|MSB,r>>>=7;case 3:e[t++]=r&255|MSB,r>>>=7;case 2:e[t++]=r&255|MSB,r>>>=7;case 1:{e[t++]=r&255,r>>>=7;break}default:throw new Error("unreachable")}return e}function decodeUint8Array(r,e){let t=r[e],s=0;if(s+=t&REST,t<MSB||(t=r[e+1],s+=(t&REST)<<7,t<MSB)||(t=r[e+2],s+=(t&REST)<<14,t<MSB)||(t=r[e+3],s+=(t&REST)<<21,t<MSB)||(t=r[e+4],s+=(t&REST)*N4,t<MSB)||(t=r[e+5],s+=(t&REST)*N5,t<MSB)||(t=r[e+6],s+=(t&REST)*N6,t<MSB)||(t=r[e+7],s+=(t&REST)*N7,t<MSB))return s;throw new RangeError("Could not decode varint")}function decodeUint8ArrayList(r,e){let t=r.get(e),s=0;if(s+=t&REST,t<MSB||(t=r.get(e+1),s+=(t&REST)<<7,t<MSB)||(t=r.get(e+2),s+=(t&REST)<<14,t<MSB)||(t=r.get(e+3),s+=(t&REST)<<21,t<MSB)||(t=r.get(e+4),s+=(t&REST)*N4,t<MSB)||(t=r.get(e+5),s+=(t&REST)*N5,t<MSB)||(t=r.get(e+6),s+=(t&REST)*N6,t<MSB)||(t=r.get(e+7),s+=(t&REST)*N7,t<MSB))return s;throw new RangeError("Could not decode varint")}function decode(r,e=0){return r instanceof Uint8Array?decodeUint8Array(r,e):decodeUint8ArrayList(r,e)}function asUint8Array(r){return r}function concat(r,e){e==null&&(e=r.reduce((n,i)=>n+i.length,0));const t=allocUnsafe(e);let s=0;for(const n of r)t.set(n,s),s+=n.length;return t}const CODE_IP4=4,CODE_TCP=6,CODE_UDP=273,CODE_DCCP=33,CODE_IP6=41,CODE_IP6ZONE=42,CODE_IPCIDR=43,CODE_DNS=53,CODE_DNS4=54,CODE_DNS6=55,CODE_DNSADDR=56,CODE_SCTP=132,CODE_UDT=301,CODE_UTP=302,CODE_UNIX=400,CODE_P2P=421,CODE_ONION=444,CODE_ONION3=445,CODE_GARLIC64=446,CODE_GARLIC32=447,CODE_TLS=448,CODE_SNI=449,CODE_NOISE=454,CODE_QUIC=460,CODE_QUIC_V1=461,CODE_WEBTRANSPORT=465,CODE_CERTHASH=466,CODE_HTTP=480,CODE_HTTP_PATH=481,CODE_HTTPS=443,CODE_WS=477,CODE_WSS=478,CODE_P2P_WEBSOCKET_STAR=479,CODE_P2P_STARDUST=277,CODE_P2P_WEBRTC_STAR=275,CODE_P2P_WEBRTC_DIRECT=276,CODE_WEBRTC_DIRECT=280,CODE_WEBRTC=281,CODE_P2P_CIRCUIT=290,CODE_MEMORY=777;function bytesToString(r){return e=>toString(e,r)}function stringToBytes(r){return e=>fromString(e,r)}function bytes2port(r){return new DataView(r.buffer).getUint16(r.byteOffset).toString()}function port2bytes(r){const e=new ArrayBuffer(2);return new DataView(e).setUint16(0,typeof r=="string"?parseInt(r):r),new Uint8Array(e)}function onion2bytes(r){const e=r.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);const t=fromString(e[0],"base32"),s=parseInt(e[1],10);if(s<1||s>65536)throw new Error("Port number is not in range(1, 65536)");const n=port2bytes(s);return concat([t,n],t.length+n.length)}function onion32bytes(r){const e=r.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);const t=base32.decode(`b${e[0]}`),s=parseInt(e[1],10);if(s<1||s>65536)throw new Error("Port number is not in range(1, 65536)");const n=port2bytes(s);return concat([t,n],t.length+n.length)}function bytes2onion(r){const e=r.subarray(0,r.length-2),t=r.subarray(r.length-2),s=toString(e,"base32"),n=bytes2port(t);return`${s}:${n}`}const ip4ToBytes=function(r){r=r.toString().trim();const e=new Uint8Array(4);return r.split(/\./g).forEach((t,s)=>{const n=parseInt(t,10);if(isNaN(n)||n<0||n>255)throw new InvalidMultiaddrError("Invalid byte value in IP address");e[s]=n}),e},ip6ToBytes=function(r){let e=0;r=r.toString().trim();const t=r.split(":",8);let s;for(s=0;s<t.length;s++){const i=isIPv4(t[s]);let o;i&&(o=ip4ToBytes(t[s]),t[s]=toString(o.subarray(0,2),"base16")),o!=null&&++s<8&&t.splice(s,0,toString(o.subarray(2,4),"base16"))}if(t[0]==="")for(;t.length<8;)t.unshift("0");else if(t[t.length-1]==="")for(;t.length<8;)t.push("0");else if(t.length<8){for(s=0;s<t.length&&t[s]!=="";s++);const i=[s,1];for(s=9-t.length;s>0;s--)i.push("0");t.splice.apply(t,i)}const n=new Uint8Array(e+16);for(s=0;s<t.length;s++){t[s]===""&&(t[s]="0");const i=parseInt(t[s],16);if(isNaN(i)||i<0||i>65535)throw new InvalidMultiaddrError("Invalid byte value in IP address");n[e++]=i>>8&255,n[e++]=i&255}return n},ip4ToString=function(r){if(r.byteLength!==4)throw new InvalidMultiaddrError("IPv4 address was incorrect length");const e=[];for(let t=0;t<r.byteLength;t++)e.push(r[t]);return e.join(".")},ip6ToString=function(r){if(r.byteLength!==16)throw new InvalidMultiaddrError("IPv6 address was incorrect length");const e=[];for(let s=0;s<r.byteLength;s+=2){const n=r[s],i=r[s+1],o=`${n.toString(16).padStart(2,"0")}${i.toString(16).padStart(2,"0")}`;e.push(o)}const t=e.join(":");try{const s=new URL(`http://[${t}]`);return s.hostname.substring(1,s.hostname.length-1)}catch{throw new InvalidMultiaddrError(`Invalid IPv6 address "${t}"`)}};function ip6StringToValue(r){try{const e=new URL(`http://[${r}]`);return e.hostname.substring(1,e.hostname.length-1)}catch{throw new InvalidMultiaddrError(`Invalid IPv6 address "${r}"`)}}const decoders=Object.values(bases).map(r=>r.decoder),anybaseDecoder=function(){let r=decoders[0].or(decoders[1]);return decoders.slice(2).forEach(e=>r=r.or(e)),r}();function mb2bytes(r){return anybaseDecoder.decode(r)}function bytes2mb(r){return e=>r.encoder.encode(e)}function integer(r){if(parseInt(r).toString()!==r)throw new ValidationError("Value must be an integer")}function positive(r){if(r<0)throw new ValidationError("Value must be a positive integer, or zero")}function maxValue(r){return e=>{if(e>r)throw new ValidationError(`Value must be smaller than or equal to ${r}`)}}function validate$1(...r){return e=>{for(const t of r)t(e)}}const validatePort=validate$1(integer,positive,maxValue(65535)),V=-1;class Registry{constructor(){O(this,"protocolsByCode",new Map);O(this,"protocolsByName",new Map)}getProtocol(e){let t;if(typeof e=="string"?t=this.protocolsByName.get(e):t=this.protocolsByCode.get(e),t==null)throw new UnknownProtocolError(`Protocol ${e} was unknown`);return t}addProtocol(e){var t;this.protocolsByCode.set(e.code,e),this.protocolsByName.set(e.name,e),(t=e.aliases)==null||t.forEach(s=>{this.protocolsByName.set(s,e)})}removeProtocol(e){var s;const t=this.protocolsByCode.get(e);t!=null&&(this.protocolsByCode.delete(t.code),this.protocolsByName.delete(t.name),(s=t.aliases)==null||s.forEach(n=>{this.protocolsByName.delete(n)}))}}const registry=new Registry,codecs=[{code:CODE_IP4,name:"ip4",size:32,valueToBytes:ip4ToBytes,bytesToValue:ip4ToString,validate:r=>{if(!isIPv4(r))throw new ValidationError(`Invalid IPv4 address "${r}"`)}},{code:CODE_TCP,name:"tcp",size:16,valueToBytes:port2bytes,bytesToValue:bytes2port,validate:validatePort},{code:CODE_UDP,name:"udp",size:16,valueToBytes:port2bytes,bytesToValue:bytes2port,validate:validatePort},{code:CODE_DCCP,name:"dccp",size:16,valueToBytes:port2bytes,bytesToValue:bytes2port,validate:validatePort},{code:CODE_IP6,name:"ip6",size:128,valueToBytes:ip6ToBytes,bytesToValue:ip6ToString,stringToValue:ip6StringToValue,validate:r=>{if(!isIPv6(r))throw new ValidationError(`Invalid IPv6 address "${r}"`)}},{code:CODE_IP6ZONE,name:"ip6zone",size:V},{code:CODE_IPCIDR,name:"ipcidr",size:8,bytesToValue:bytesToString("base10"),valueToBytes:stringToBytes("base10")},{code:CODE_DNS,name:"dns",size:V,resolvable:!0},{code:CODE_DNS4,name:"dns4",size:V,resolvable:!0},{code:CODE_DNS6,name:"dns6",size:V,resolvable:!0},{code:CODE_DNSADDR,name:"dnsaddr",size:V,resolvable:!0},{code:CODE_SCTP,name:"sctp",size:16,valueToBytes:port2bytes,bytesToValue:bytes2port,validate:validatePort},{code:CODE_UDT,name:"udt"},{code:CODE_UTP,name:"utp"},{code:CODE_UNIX,name:"unix",size:V,path:!0,stringToValue:r=>decodeURIComponent(r),valueToString:r=>encodeURIComponent(r)},{code:CODE_P2P,name:"p2p",aliases:["ipfs"],size:V,bytesToValue:bytesToString("base58btc"),valueToBytes:r=>r.startsWith("Q")||r.startsWith("1")?stringToBytes("base58btc")(r):CID.parse(r).multihash.bytes},{code:CODE_ONION,name:"onion",size:96,bytesToValue:bytes2onion,valueToBytes:onion2bytes},{code:CODE_ONION3,name:"onion3",size:296,bytesToValue:bytes2onion,valueToBytes:onion32bytes},{code:CODE_GARLIC64,name:"garlic64",size:V},{code:CODE_GARLIC32,name:"garlic32",size:V},{code:CODE_TLS,name:"tls"},{code:CODE_SNI,name:"sni",size:V},{code:CODE_NOISE,name:"noise"},{code:CODE_QUIC,name:"quic"},{code:CODE_QUIC_V1,name:"quic-v1"},{code:CODE_WEBTRANSPORT,name:"webtransport"},{code:CODE_CERTHASH,name:"certhash",size:V,bytesToValue:bytes2mb(base64url),valueToBytes:mb2bytes},{code:CODE_HTTP,name:"http"},{code:CODE_HTTP_PATH,name:"http-path",size:V,stringToValue:r=>`/${decodeURIComponent(r)}`,valueToString:r=>encodeURIComponent(r.substring(1))},{code:CODE_HTTPS,name:"https"},{code:CODE_WS,name:"ws"},{code:CODE_WSS,name:"wss"},{code:CODE_P2P_WEBSOCKET_STAR,name:"p2p-websocket-star"},{code:CODE_P2P_STARDUST,name:"p2p-stardust"},{code:CODE_P2P_WEBRTC_STAR,name:"p2p-webrtc-star"},{code:CODE_P2P_WEBRTC_DIRECT,name:"p2p-webrtc-direct"},{code:CODE_WEBRTC_DIRECT,name:"webrtc-direct"},{code:CODE_WEBRTC,name:"webrtc"},{code:CODE_P2P_CIRCUIT,name:"p2p-circuit"},{code:CODE_MEMORY,name:"memory",size:V}];codecs.forEach(r=>{registry.addProtocol(r)});function bytesToComponents(r){var s;const e=[];let t=0;for(;t<r.length;){const n=decode(r,t),i=registry.getProtocol(n),o=encodingLength(n),a=sizeForAddr(i,r,t+o);let l=0;a>0&&i.size===V&&(l=encodingLength(a));const p=o+l+a,g={code:n,name:i.name,bytes:r.subarray(t,t+p)};if(a>0){const x=t+o+l,b=r.subarray(x,x+a);g.value=((s=i.bytesToValue)==null?void 0:s.call(i,b))??toString(b)}e.push(g),t+=p}return e}function componentsToBytes(r){var s;let e=0;const t=[];for(const n of r){if(n.bytes==null){const i=registry.getProtocol(n.code),o=encodingLength(n.code);let a,l=0,p=0;n.value!=null&&(a=((s=i.valueToBytes)==null?void 0:s.call(i,n.value))??fromString(n.value),l=a.byteLength,i.size===V&&(p=encodingLength(l)));const g=new Uint8Array(o+p+l);let x=0;encodeUint8Array(n.code,g,x),x+=o,a!=null&&(i.size===V&&(encodeUint8Array(l,g,x),x+=p),g.set(a,x)),n.bytes=g}t.push(n.bytes),e+=n.bytes.byteLength}return concat(t,e)}function stringToComponents(r){var i;if(r.charAt(0)!=="/")throw new InvalidMultiaddrError('String multiaddr must start with "/"');const e=[];let t="protocol",s="",n="";for(let o=1;o<r.length;o++){const a=r.charAt(o);a!=="/"&&(t==="protocol"?n+=r.charAt(o):s+=r.charAt(o));const l=o===r.length-1;if(a==="/"||l){const p=registry.getProtocol(n);if(t==="protocol"){if(p.size==null||p.size===0){e.push({code:p.code,name:p.name}),s="",n="",t="protocol";continue}else if(l)throw new InvalidMultiaddrError(`Component ${n} was missing value`);t="value"}else if(t==="value"){const g={code:p.code,name:p.name};if(p.size!=null&&p.size!==0){if(s==="")throw new InvalidMultiaddrError(`Component ${n} was missing value`);g.value=((i=p.stringToValue)==null?void 0:i.call(p,s))??s}e.push(g),s="",n="",t="protocol"}}}if(n!==""&&s!=="")throw new InvalidMultiaddrError("Incomplete multiaddr");return e}function componentsToString(r){return`/${r.flatMap(e=>{var s;if(e.value==null)return e.name;const t=registry.getProtocol(e.code);if(t==null)throw new InvalidMultiaddrError(`Unknown protocol code ${e.code}`);return[e.name,((s=t.valueToString)==null?void 0:s.call(t,e.value))??e.value]}).join("/")}`}function sizeForAddr(r,e,t){return r.size==null||r.size===0?0:r.size>0?r.size/8:decode(e,t)}const inspect$1=Symbol.for("nodejs.util.inspect.custom"),symbol$1=Symbol.for("@multiformats/multiaddr"),DNS_CODES=[CODE_DNS,CODE_DNS4,CODE_DNS6,CODE_DNSADDR];class NoAvailableResolverError extends Error{constructor(e="No available resolver"){super(e),this.name="NoAvailableResolverError"}}function toComponents(r){if(r==null&&(r="/"),isMultiaddr(r))return r.getComponents();if(r instanceof Uint8Array)return bytesToComponents(r);if(typeof r=="string")return r=r.replace(/\/(\/)+/,"/").replace(/(\/)+$/,""),r===""&&(r="/"),stringToComponents(r);if(Array.isArray(r))return r;throw new InvalidMultiaddrError("Must be a string, Uint8Array, Component[], or another Multiaddr")}var qe,ie,ve,Ce;const Re=class Re{constructor(e="/",t={}){O(this,qe,!0);Ae(this,ie);Ae(this,ve);Ae(this,Ce);De(this,ie,toComponents(e)),t.validate!==!1&&validate(this)}get bytes(){return se(this,Ce)==null&&De(this,Ce,componentsToBytes(se(this,ie))),se(this,Ce)}toString(){return se(this,ve)==null&&De(this,ve,componentsToString(se(this,ie))),se(this,ve)}toJSON(){return this.toString()}toOptions(){let e,t,s,n,i="";for(const{code:a,name:l,value:p}of se(this,ie))a===CODE_IP6ZONE&&(i=`%${p??""}`),DNS_CODES.includes(a)&&(t="tcp",n=443,s=`${p??""}${i}`,e=a===CODE_DNS6?6:4),(a===CODE_TCP||a===CODE_UDP)&&(t=l==="tcp"?"tcp":"udp",n=parseInt(p??"")),(a===CODE_IP4||a===CODE_IP6)&&(t="tcp",s=`${p??""}${i}`,e=a===CODE_IP6?6:4);if(e==null||t==null||s==null||n==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:s,transport:t,port:n}}getComponents(){return[...se(this,ie)]}protos(){return se(this,ie).map(({code:e,value:t})=>{const s=registry.getProtocol(e);return{code:e,size:s.size??0,name:s.name,resolvable:!!s.resolvable,path:!!s.path}})}protoCodes(){return se(this,ie).map(({code:e})=>e)}protoNames(){return se(this,ie).map(({name:e})=>e)}tuples(){return se(this,ie).map(({code:e,value:t})=>{var i;if(t==null)return[e];const s=registry.getProtocol(e),n=[e];return t!=null&&n.push(((i=s.valueToBytes)==null?void 0:i.call(s,t))??fromString(t)),n})}stringTuples(){return se(this,ie).map(({code:e,value:t})=>t==null?[e]:[e,t])}encapsulate(e){const t=new Re(e);return new Re([...se(this,ie),...t.getComponents()],{validate:!1})}decapsulate(e){const t=e.toString(),s=this.toString(),n=s.lastIndexOf(t);if(n<0)throw new InvalidParametersError(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new Re(s.slice(0,n),{validate:!1})}decapsulateCode(e){let t;for(let s=se(this,ie).length-1;s>-1;s--)if(se(this,ie)[s].code===e){t=s;break}return new Re(se(this,ie).slice(0,t),{validate:!1})}getPeerId(){try{let e=[];se(this,ie).forEach(({code:s,value:n})=>{s===CODE_P2P&&e.push([s,n]),s===CODE_P2P_CIRCUIT&&(e=[])});const t=e.pop();if((t==null?void 0:t[1])!=null){const s=t[1];return s[0]==="Q"||s[0]==="1"?toString(base58btc.decode(`z${s}`),"base58btc"):toString(CID.parse(s).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){for(const e of se(this,ie))if(registry.getProtocol(e.code).path)return e.value??null;return null}equals(e){return equals(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find(i=>i.resolvable);if(t==null)return[this];const s=resolvers.get(t.name);if(s==null)throw new NoAvailableResolverError(`no available resolver for ${t.name}`);return(await s(this,e)).map(i=>multiaddr(i))}nodeAddress(){const e=this.toOptions();if(e.transport!=="tcp"&&e.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(){return!(se(this,ie).length!==2||se(this,ie)[0].code!==CODE_IP4&&se(this,ie)[0].code!==CODE_IP6||se(this,ie)[1].code!==CODE_TCP&&se(this,ie)[1].code!==CODE_UDP)}[(qe=symbol$1,inspect$1)](){return`Multiaddr(${this.toString()})`}};ie=new WeakMap,ve=new WeakMap,Ce=new WeakMap;let Multiaddr=Re;function validate(r){r.getComponents().forEach(e=>{var s;const t=registry.getProtocol(e.code);e.value!=null&&((s=t.validate)==null||s.call(t,e.value))})}const resolvers=new Map;function isMultiaddr(r){return!!(r!=null&&r[symbol$1])}function multiaddr(r){return new Multiaddr(r)}function protocols(r){const e=registry.getProtocol(r);return{code:e.code,size:e.size??0,name:e.name,resolvable:!!e.resolvable,path:!!e.path}}function extractSNI(r){let e;try{e=protocols("sni").code}catch{return null}for(const[t,s]of r)if(t===e&&s!==void 0)return s;return null}function hasTLS(r){return r.some(([e,t])=>e===protocols("tls").code)}function interpretNext(r,e,t){const s=interpreters[protocols(r).name];if(s===void 0)throw new Error(`Can't interpret protocol ${protocols(r).name}`);const n=s(e,t);return r===protocols("ip6").code?`[${n}]`:n}const interpreters={ip4:(r,e)=>r,ip6:(r,e)=>e.length===0?r:`[${r}]`,tcp:(r,e)=>{const t=e.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`tcp://${interpretNext(t[0],t[1]??"",e)}:${r}`},udp:(r,e)=>{const t=e.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`udp://${interpretNext(t[0],t[1]??"",e)}:${r}`},dnsaddr:(r,e)=>r,dns4:(r,e)=>r,dns6:(r,e)=>r,dns:(r,e)=>r,ipfs:(r,e)=>{const t=e.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`${interpretNext(t[0],t[1]??"",e)}/ipfs/${r}`},p2p:(r,e)=>{const t=e.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`${interpretNext(t[0],t[1]??"",e)}/p2p/${r}`},http:(r,e)=>{const t=hasTLS(e),s=extractSNI(e);if(t&&s!==null)return`https://${s}`;const n=t?"https://":"http://",i=e.pop();if(i===void 0)throw new Error("Unexpected end of multiaddr");let o=interpretNext(i[0],i[1]??"",e);return o=o.replace("tcp://",""),`${n}${o}`},tls:(r,e)=>{const t=e.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return interpretNext(t[0],t[1]??"",e)},sni:(r,e)=>{const t=e.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return interpretNext(t[0],t[1]??"",e)},https:(r,e)=>{const t=e.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");let s=interpretNext(t[0],t[1]??"",e);return s=s.replace("tcp://",""),`https://${s}`},ws:(r,e)=>{const t=hasTLS(e),s=extractSNI(e);if(t&&s!==null)return`wss://${s}`;const n=t?"wss://":"ws://",i=e.pop();if(i===void 0)throw new Error("Unexpected end of multiaddr");let o=interpretNext(i[0],i[1]??"",e);return o=o.replace("tcp://",""),`${n}${o}`},wss:(r,e)=>{const t=e.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");let s=interpretNext(t[0],t[1]??"",e);return s=s.replace("tcp://",""),`wss://${s}`},"p2p-websocket-star":(r,e)=>{const t=e.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`${interpretNext(t[0],t[1]??"",e)}/p2p-websocket-star`},"p2p-webrtc-star":(r,e)=>{const t=e.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`${interpretNext(t[0],t[1]??"",e)}/p2p-webrtc-star`},"p2p-webrtc-direct":(r,e)=>{const t=e.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`${interpretNext(t[0],t[1]??"",e)}/p2p-webrtc-direct`}};function multiaddrToUri(r,e){const s=multiaddr(r).stringTuples(),n=s.pop();if(n===void 0)throw new Error("Unexpected end of multiaddr");const i=protocols(n[0]),o=interpreters[i.name];if(o==null)throw new Error(`No interpreter found for ${i.name}`);let a=o(n[1]??"",s);return n[0]===protocols("tcp").code&&(a=a.replace("tcp://","http://"),(n[1]==="443"||n[1]==="80")&&(n[1]==="443"&&(a=a.replace("http://","https://")),a=a.substring(0,a.lastIndexOf(":")))),a}function toUrlString(r){try{r=multiaddrToUri(multiaddr$1(r))}catch{}return r=r.toString(),r}const getAgent=()=>{},log$2=logger$1("ipfs-http-client:lib:error-handler"),merge=mergeOptions.bind({ignoreUndefined:!0}),DEFAULT_PROTOCOL=envExports.isBrowser||envExports.isWebWorker?location.protocol:"http",DEFAULT_HOST=envExports.isBrowser||envExports.isWebWorker?location.hostname:"localhost",DEFAULT_PORT=envExports.isBrowser||envExports.isWebWorker?location.port:"5001",normalizeOptions=(r={})=>{let e,t={},s;if(typeof r=="string"||isMultiaddr$1(r))e=new URL(toUrlString(r));else if(r instanceof URL)e=r;else if(typeof r.url=="string"||isMultiaddr$1(r.url))e=new URL(toUrlString(r.url)),t=r;else if(r.url instanceof URL)e=r.url,t=r;else{t=r||{};const n=(t.protocol||DEFAULT_PROTOCOL).replace(":",""),i=(t.host||DEFAULT_HOST).split(":")[0],o=t.port||DEFAULT_PORT;e=new URL(`${n}://${i}:${o}`)}if(t.apiPath?e.pathname=t.apiPath:(e.pathname==="/"||e.pathname===void 0)&&(e.pathname="api/v0"),envExports.isNode){const n=getAgent();s=t.agent||new n({keepAlive:!0,maxSockets:6})}return{...t,host:e.host,protocol:e.protocol.replace(":",""),port:Number(e.port),apiPath:e.pathname,url:e,agent:s}},errorHandler=async r=>{let e;try{if((r.headers.get("Content-Type")||"").startsWith("application/json")){const s=await r.json();log$2(s),e=s.Message||s.message}else e=await r.text()}catch(s){log$2("Failed to parse error response",s),e=s.message}let t=new HTTP.HTTPError(r);throw e&&(e.includes("deadline has elapsed")&&(t=new HTTP.TimeoutError),e&&e.includes("context deadline exceeded")&&(t=new HTTP.TimeoutError)),e&&e.includes("request timed out")&&(t=new HTTP.TimeoutError),e&&(t.message=e),t},KEBAB_REGEX=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,kebabCase=r=>r.replace(KEBAB_REGEX,function(e){return"-"+e.toLowerCase()}),parseTimeout=r=>typeof r=="string"?parse(r):r;class Client extends HTTP{constructor(e={}){const t=normalizeOptions(e);super({timeout:parseTimeout(t.timeout||0)||void 0,headers:t.headers,base:`${t.url}`,handleError:errorHandler,transformSearchParams:n=>{const i=new URLSearchParams;for(const[o,a]of n)a!=="undefined"&&a!=="null"&&o!=="signal"&&i.append(kebabCase(o),a),o==="timeout"&&!isNaN(a)&&i.append(kebabCase(o),a);return i},agent:t.agent}),delete this.get,delete this.put,delete this.delete,delete this.options;const s=this.fetch;this.fetch=(n,i={})=>(typeof n=="string"&&!n.startsWith("/")&&(n=`${t.url}/${n}`),s.call(this,n,merge(i,{method:"POST"})))}}HTTP.HTTPError;const configure=r=>e=>r(new Client(e),e);function modeToString$1(r){if(r!=null)return typeof r=="string"?r:r.toString(8).padStart(4,"0")}function parseMtime$1(r){if(r==null)return;let e;if(r.secs!=null&&(e={secs:r.secs,nsecs:r.nsecs}),r.Seconds!=null&&(e={secs:r.Seconds,nsecs:r.FractionalNanoseconds}),Array.isArray(r)&&(e={secs:r[0],nsecs:r[1]}),r instanceof Date){const t=r.getTime(),s=Math.floor(t/1e3);e={secs:s,nsecs:(t-s*1e3)*1e3}}if(Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw errCode(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}function toUrlSearchParams({arg:r,searchParams:e,hashAlg:t,mtime:s,mode:n,...i}={}){e&&(i={...i,...e}),t&&(i.hash=t),s!=null&&(s=parseMtime$1(s),i.mtime=s.secs,i.mtimeNsecs=s.nsecs),n!=null&&(i.mode=modeToString$1(n)),i.timeout&&!isNaN(i.timeout)&&(i.timeout=`${i.timeout}ms`),r==null?r=[]:Array.isArray(r)||(r=[r]);const o=new URLSearchParams(i);return r.forEach(a=>o.append("arg",a)),o}const createWantlist=configure(r=>{async function e(t={}){return((await(await r.post("bitswap/wantlist",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers})).json()).Keys||[]).map(n=>CID$1.parse(n["/"]))}return e}),createWantlistForPeer=configure(r=>{async function e(t,s={}){return((await(await r.post("bitswap/wantlist",{signal:s.signal,searchParams:toUrlSearchParams({...s,peer:t.toString()}),headers:s.headers})).json()).Keys||[]).map(i=>CID$1.parse(i["/"]))}return e}),symbol=Symbol.for("@libp2p/peer-id"),inspect=Symbol.for("nodejs.util.inspect.custom"),baseDecoder=Object.values(bases$2).map(r=>r.decoder).reduce((r,e)=>r.or(e),bases$2.identity.decoder),LIBP2P_KEY_CODE=114,MARSHALLED_ED225519_PUBLIC_KEY_LENGTH=36,MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH=37;var He;class PeerIdImpl{constructor(e){O(this,"type");O(this,"multihash");O(this,"privateKey");O(this,"publicKey");O(this,"string");O(this,He,!0);this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}toString(){return this.string==null&&(this.string=base58btc$2.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return CID$1.createV1(LIBP2P_KEY_CODE,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return equals$3(this.multihash.bytes,e);if(typeof e=="string")return peerIdFromString(e).equals(this);if(((t=e==null?void 0:e.multihash)==null?void 0:t.bytes)!=null)return equals$3(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[(He=symbol,inspect)](){return`PeerId(${this.toString()})`}}class RSAPeerIdImpl extends PeerIdImpl{constructor(t){super({...t,type:"RSA"});O(this,"type","RSA");O(this,"publicKey");this.publicKey=t.publicKey}}class Ed25519PeerIdImpl extends PeerIdImpl{constructor(t){super({...t,type:"Ed25519"});O(this,"type","Ed25519");O(this,"publicKey");this.publicKey=t.multihash.digest}}class Secp256k1PeerIdImpl extends PeerIdImpl{constructor(t){super({...t,type:"secp256k1"});O(this,"type","secp256k1");O(this,"publicKey");this.publicKey=t.multihash.digest}}function peerIdFromString(r,e){if(r.charAt(0)==="1"||r.charAt(0)==="Q"){const t=decode$f(base58btc$2.decode(`z${r}`));return r.startsWith("12D")?new Ed25519PeerIdImpl({multihash:t}):r.startsWith("16U")?new Secp256k1PeerIdImpl({multihash:t}):new RSAPeerIdImpl({multihash:t})}return peerIdFromBytes(baseDecoder.decode(r))}function peerIdFromBytes(r){try{const e=decode$f(r);if(e.code===identity$3.code){if(e.digest.length===MARSHALLED_ED225519_PUBLIC_KEY_LENGTH)return new Ed25519PeerIdImpl({multihash:e});if(e.digest.length===MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH)return new Secp256k1PeerIdImpl({multihash:e})}if(e.code===sha256.code)return new RSAPeerIdImpl({multihash:e})}catch{return peerIdFromCID(CID$1.decode(r))}throw new Error("Supplied PeerID CID is invalid")}function peerIdFromCID(r){if(r==null||r.multihash==null||r.version==null||r.version===1&&r.code!==LIBP2P_KEY_CODE)throw new Error("Supplied PeerID CID is invalid");const e=r.multihash;if(e.code===sha256.code)return new RSAPeerIdImpl({multihash:r.multihash});if(e.code===identity$3.code){if(e.digest.length===MARSHALLED_ED225519_PUBLIC_KEY_LENGTH)return new Ed25519PeerIdImpl({multihash:r.multihash});if(e.digest.length===MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH)return new Secp256k1PeerIdImpl({multihash:r.multihash})}throw new Error("Supplied PeerID CID is invalid")}const createStat$4=configure(r=>{async function e(t={}){const s=await r.post("bitswap/stat",{searchParams:toUrlSearchParams(t),signal:t.signal,headers:t.headers});return toCoreInterface$4(await s.json())}return e});function toCoreInterface$4(r){return{provideBufLen:r.ProvideBufLen,wantlist:(r.Wantlist||[]).map(e=>CID$1.parse(e["/"])),peers:(r.Peers||[]).map(e=>peerIdFromString(e)),blocksReceived:BigInt(r.BlocksReceived),dataReceived:BigInt(r.DataReceived),blocksSent:BigInt(r.BlocksSent),dataSent:BigInt(r.DataSent),dupBlksReceived:BigInt(r.DupBlksReceived),dupDataReceived:BigInt(r.DupDataReceived)}}const createUnwant=configure(r=>{async function e(t,s={}){return(await r.post("bitswap/unwant",{signal:s.signal,searchParams:toUrlSearchParams({arg:t.toString(),...s}),headers:s.headers})).json()}return e});function createBitswap(r){return{wantlist:createWantlist(r),wantlistForPeer:createWantlistForPeer(r),unwant:createUnwant(r),stat:createStat$4(r)}}const createGet$5=configure(r=>{async function e(t,s={}){const n=await r.post("block/get",{signal:s.signal,searchParams:toUrlSearchParams({arg:t.toString(),...s}),headers:s.headers});return new Uint8Array(await n.arrayBuffer())}return e});function peekableIterator(r){const[e,t]=r[Symbol.asyncIterator]!=null?[r[Symbol.asyncIterator](),Symbol.asyncIterator]:[r[Symbol.iterator](),Symbol.iterator],s=[];return{peek:()=>e.next(),push:n=>{s.push(n)},next:()=>s.length>0?{done:!1,value:s.shift()}:e.next(),[t](){return this}}}async function*browserReadableStreamToIt(r,e={}){const t=r.getReader();try{for(;;){const s=await t.read();if(s.done)return;yield s.value}}finally{e.preventCancel!==!0&&await t.cancel(),t.releaseLock()}}async function all(r){const e=[];for await(const t of r)e.push(t);return e}function isBytes(r){return ArrayBuffer.isView(r)||r instanceof ArrayBuffer}function isBlob(r){return r.constructor&&(r.constructor.name==="Blob"||r.constructor.name==="File")&&typeof r.stream=="function"}function isFileObject(r){return typeof r=="object"&&(r.path||r.content)}const isReadableStream=r=>r&&typeof r.getReader=="function";async function normaliseContent$1(r){if(isBytes(r))return new Blob([r]);if(typeof r=="string"||r instanceof String)return new Blob([r.toString()]);if(isBlob(r))return r;if(isReadableStream(r)&&(r=browserReadableStreamToIt(r)),Symbol.iterator in r||Symbol.asyncIterator in r){const e=peekableIterator(r),{value:t,done:s}=await e.peek();if(s)return itToBlob(e);if(e.push(t),Number.isInteger(t))return new Blob([Uint8Array.from(await all(e))]);if(isBytes(t)||typeof t=="string"||t instanceof String)return itToBlob(e)}throw errCode(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT")}async function itToBlob(r){const e=[];for await(const t of r)e.push(t);return new Blob(e)}async function*map(r,e){for await(const t of r)yield e(t)}var indexMinimal={},minimal$1={},aspromise,hasRequiredAspromise;function requireAspromise(){if(hasRequiredAspromise)return aspromise;hasRequiredAspromise=1,aspromise=r;function r(e,t){for(var s=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)s[n++]=arguments[i++];return new Promise(function(l,p){s[n]=function(x){if(o)if(o=!1,x)p(x);else{for(var b=new Array(arguments.length-1),E=0;E<b.length;)b[E++]=arguments[E];l.apply(null,b)}};try{e.apply(t||null,s)}catch(g){o&&(o=!1,p(g))}})}return aspromise}var base64={},hasRequiredBase64;function requireBase64(){return hasRequiredBase64||(hasRequiredBase64=1,function(r){var e=r;e.length=function(a){var l=a.length;if(!l)return 0;for(var p=0;--l%4>1&&a.charAt(l)==="=";)++p;return Math.ceil(a.length*3)/4-p};for(var t=new Array(64),s=new Array(123),n=0;n<64;)s[t[n]=n<26?n+65:n<52?n+71:n<62?n-4:n-59|43]=n++;e.encode=function(a,l,p){for(var g=null,x=[],b=0,E=0,f;l<p;){var j=a[l++];switch(E){case 0:x[b++]=t[j>>2],f=(j&3)<<4,E=1;break;case 1:x[b++]=t[f|j>>4],f=(j&15)<<2,E=2;break;case 2:x[b++]=t[f|j>>6],x[b++]=t[j&63],E=0;break}b>8191&&((g||(g=[])).push(String.fromCharCode.apply(String,x)),b=0)}return E&&(x[b++]=t[f],x[b++]=61,E===1&&(x[b++]=61)),g?(b&&g.push(String.fromCharCode.apply(String,x.slice(0,b))),g.join("")):String.fromCharCode.apply(String,x.slice(0,b))};var i="invalid encoding";e.decode=function(a,l,p){for(var g=p,x=0,b,E=0;E<a.length;){var f=a.charCodeAt(E++);if(f===61&&x>1)break;if((f=s[f])===void 0)throw Error(i);switch(x){case 0:b=f,x=1;break;case 1:l[p++]=b<<2|(f&48)>>4,b=f,x=2;break;case 2:l[p++]=(b&15)<<4|(f&60)>>2,b=f,x=3;break;case 3:l[p++]=(b&3)<<6|f,x=0;break}}if(x===1)throw Error(i);return p-g},e.test=function(a){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(a)}}(base64)),base64}var eventemitter,hasRequiredEventemitter;function requireEventemitter(){if(hasRequiredEventemitter)return eventemitter;hasRequiredEventemitter=1,eventemitter=r;function r(){this._listeners={}}return r.prototype.on=function(t,s,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:s,ctx:n||this}),this},r.prototype.off=function(t,s){if(t===void 0)this._listeners={};else if(s===void 0)this._listeners[t]=[];else for(var n=this._listeners[t],i=0;i<n.length;)n[i].fn===s?n.splice(i,1):++i;return this},r.prototype.emit=function(t){var s=this._listeners[t];if(s){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<s.length;)s[i].fn.apply(s[i++].ctx,n)}return this},eventemitter}var float,hasRequiredFloat;function requireFloat(){if(hasRequiredFloat)return float;hasRequiredFloat=1,float=r(r);function r(i){return typeof Float32Array<"u"?function(){var o=new Float32Array([-0]),a=new Uint8Array(o.buffer),l=a[3]===128;function p(E,f,j){o[0]=E,f[j]=a[0],f[j+1]=a[1],f[j+2]=a[2],f[j+3]=a[3]}function g(E,f,j){o[0]=E,f[j]=a[3],f[j+1]=a[2],f[j+2]=a[1],f[j+3]=a[0]}i.writeFloatLE=l?p:g,i.writeFloatBE=l?g:p;function x(E,f){return a[0]=E[f],a[1]=E[f+1],a[2]=E[f+2],a[3]=E[f+3],o[0]}function b(E,f){return a[3]=E[f],a[2]=E[f+1],a[1]=E[f+2],a[0]=E[f+3],o[0]}i.readFloatLE=l?x:b,i.readFloatBE=l?b:x}():function(){function o(l,p,g,x){var b=p<0?1:0;if(b&&(p=-p),p===0)l(1/p>0?0:2147483648,g,x);else if(isNaN(p))l(2143289344,g,x);else if(p>34028234663852886e22)l((b<<31|2139095040)>>>0,g,x);else if(p<11754943508222875e-54)l((b<<31|Math.round(p/1401298464324817e-60))>>>0,g,x);else{var E=Math.floor(Math.log(p)/Math.LN2),f=Math.round(p*Math.pow(2,-E)*8388608)&8388607;l((b<<31|E+127<<23|f)>>>0,g,x)}}i.writeFloatLE=o.bind(null,e),i.writeFloatBE=o.bind(null,t);function a(l,p,g){var x=l(p,g),b=(x>>31)*2+1,E=x>>>23&255,f=x&8388607;return E===255?f?NaN:b*(1/0):E===0?b*1401298464324817e-60*f:b*Math.pow(2,E-150)*(f+8388608)}i.readFloatLE=a.bind(null,s),i.readFloatBE=a.bind(null,n)}(),typeof Float64Array<"u"?function(){var o=new Float64Array([-0]),a=new Uint8Array(o.buffer),l=a[7]===128;function p(E,f,j){o[0]=E,f[j]=a[0],f[j+1]=a[1],f[j+2]=a[2],f[j+3]=a[3],f[j+4]=a[4],f[j+5]=a[5],f[j+6]=a[6],f[j+7]=a[7]}function g(E,f,j){o[0]=E,f[j]=a[7],f[j+1]=a[6],f[j+2]=a[5],f[j+3]=a[4],f[j+4]=a[3],f[j+5]=a[2],f[j+6]=a[1],f[j+7]=a[0]}i.writeDoubleLE=l?p:g,i.writeDoubleBE=l?g:p;function x(E,f){return a[0]=E[f],a[1]=E[f+1],a[2]=E[f+2],a[3]=E[f+3],a[4]=E[f+4],a[5]=E[f+5],a[6]=E[f+6],a[7]=E[f+7],o[0]}function b(E,f){return a[7]=E[f],a[6]=E[f+1],a[5]=E[f+2],a[4]=E[f+3],a[3]=E[f+4],a[2]=E[f+5],a[1]=E[f+6],a[0]=E[f+7],o[0]}i.readDoubleLE=l?x:b,i.readDoubleBE=l?b:x}():function(){function o(l,p,g,x,b,E){var f=x<0?1:0;if(f&&(x=-x),x===0)l(0,b,E+p),l(1/x>0?0:2147483648,b,E+g);else if(isNaN(x))l(0,b,E+p),l(2146959360,b,E+g);else if(x>17976931348623157e292)l(0,b,E+p),l((f<<31|2146435072)>>>0,b,E+g);else{var j;if(x<22250738585072014e-324)j=x/5e-324,l(j>>>0,b,E+p),l((f<<31|j/4294967296)>>>0,b,E+g);else{var C=Math.floor(Math.log(x)/Math.LN2);C===1024&&(C=1023),j=x*Math.pow(2,-C),l(j*4503599627370496>>>0,b,E+p),l((f<<31|C+1023<<20|j*1048576&1048575)>>>0,b,E+g)}}}i.writeDoubleLE=o.bind(null,e,0,4),i.writeDoubleBE=o.bind(null,t,4,0);function a(l,p,g,x,b){var E=l(x,b+p),f=l(x,b+g),j=(f>>31)*2+1,C=f>>>20&2047,S=4294967296*(f&1048575)+E;return C===2047?S?NaN:j*(1/0):C===0?j*5e-324*S:j*Math.pow(2,C-1075)*(S+4503599627370496)}i.readDoubleLE=a.bind(null,s,0,4),i.readDoubleBE=a.bind(null,n,4,0)}(),i}function e(i,o,a){o[a]=i&255,o[a+1]=i>>>8&255,o[a+2]=i>>>16&255,o[a+3]=i>>>24}function t(i,o,a){o[a]=i>>>24,o[a+1]=i>>>16&255,o[a+2]=i>>>8&255,o[a+3]=i&255}function s(i,o){return(i[o]|i[o+1]<<8|i[o+2]<<16|i[o+3]<<24)>>>0}function n(i,o){return(i[o]<<24|i[o+1]<<16|i[o+2]<<8|i[o+3])>>>0}return float}var inquire_1,hasRequiredInquire;function requireInquire(){if(hasRequiredInquire)return inquire_1;hasRequiredInquire=1,inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}return inquire_1}var utf8={},hasRequiredUtf8;function requireUtf8(){return hasRequiredUtf8||(hasRequiredUtf8=1,function(r){var e=r;e.length=function(s){for(var n=0,i=0,o=0;o<s.length;++o)i=s.charCodeAt(o),i<128?n+=1:i<2048?n+=2:(i&64512)===55296&&(s.charCodeAt(o+1)&64512)===56320?(++o,n+=4):n+=3;return n},e.read=function(s,n,i){var o=i-n;if(o<1)return"";for(var a=null,l=[],p=0,g;n<i;)g=s[n++],g<128?l[p++]=g:g>191&&g<224?l[p++]=(g&31)<<6|s[n++]&63:g>239&&g<365?(g=((g&7)<<18|(s[n++]&63)<<12|(s[n++]&63)<<6|s[n++]&63)-65536,l[p++]=55296+(g>>10),l[p++]=56320+(g&1023)):l[p++]=(g&15)<<12|(s[n++]&63)<<6|s[n++]&63,p>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,l)),p=0);return a?(p&&a.push(String.fromCharCode.apply(String,l.slice(0,p))),a.join("")):String.fromCharCode.apply(String,l.slice(0,p))},e.write=function(s,n,i){for(var o=i,a,l,p=0;p<s.length;++p)a=s.charCodeAt(p),a<128?n[i++]=a:a<2048?(n[i++]=a>>6|192,n[i++]=a&63|128):(a&64512)===55296&&((l=s.charCodeAt(p+1))&64512)===56320?(a=65536+((a&1023)<<10)+(l&1023),++p,n[i++]=a>>18|240,n[i++]=a>>12&63|128,n[i++]=a>>6&63|128,n[i++]=a&63|128):(n[i++]=a>>12|224,n[i++]=a>>6&63|128,n[i++]=a&63|128);return i-o}}(utf8)),utf8}var pool_1,hasRequiredPool;function requirePool(){if(hasRequiredPool)return pool_1;hasRequiredPool=1,pool_1=r;function r(e,t,s){var n=s||8192,i=n>>>1,o=null,a=n;return function(p){if(p<1||p>i)return e(p);a+p>n&&(o=e(n),a=0);var g=t.call(o,a,a+=p);return a&7&&(a=(a|7)+1),g}}return pool_1}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=e;var r=requireMinimal$1();function e(i,o){this.lo=i>>>0,this.hi=o>>>0}var t=e.zero=new e(0,0);t.toNumber=function(){return 0},t.zzEncode=t.zzDecode=function(){return this},t.length=function(){return 1};var s=e.zeroHash="\0\0\0\0\0\0\0\0";e.fromNumber=function(o){if(o===0)return t;var a=o<0;a&&(o=-o);var l=o>>>0,p=(o-l)/4294967296>>>0;return a&&(p=~p>>>0,l=~l>>>0,++l>4294967295&&(l=0,++p>4294967295&&(p=0))),new e(l,p)},e.from=function(o){if(typeof o=="number")return e.fromNumber(o);if(r.isString(o))if(r.Long)o=r.Long.fromString(o);else return e.fromNumber(parseInt(o,10));return o.low||o.high?new e(o.low>>>0,o.high>>>0):t},e.prototype.toNumber=function(o){if(!o&&this.hi>>>31){var a=~this.lo+1>>>0,l=~this.hi>>>0;return a||(l=l+1>>>0),-(a+l*4294967296)}return this.lo+this.hi*4294967296},e.prototype.toLong=function(o){return r.Long?new r.Long(this.lo|0,this.hi|0,!!o):{low:this.lo|0,high:this.hi|0,unsigned:!!o}};var n=String.prototype.charCodeAt;return e.fromHash=function(o){return o===s?t:new e((n.call(o,0)|n.call(o,1)<<8|n.call(o,2)<<16|n.call(o,3)<<24)>>>0,(n.call(o,4)|n.call(o,5)<<8|n.call(o,6)<<16|n.call(o,7)<<24)>>>0)},e.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},e.prototype.zzEncode=function(){var o=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^o)>>>0,this.lo=(this.lo<<1^o)>>>0,this},e.prototype.zzDecode=function(){var o=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^o)>>>0,this.hi=(this.hi>>>1^o)>>>0,this},e.prototype.length=function(){var o=this.lo,a=(this.lo>>>28|this.hi<<4)>>>0,l=this.hi>>>24;return l===0?a===0?o<16384?o<128?1:2:o<2097152?3:4:a<16384?a<128?5:6:a<2097152?7:8:l<128?9:10},longbits}var hasRequiredMinimal$1;function requireMinimal$1(){return hasRequiredMinimal$1||(hasRequiredMinimal$1=1,function(r){var e=r;e.asPromise=requireAspromise(),e.base64=requireBase64(),e.EventEmitter=requireEventemitter(),e.float=requireFloat(),e.inquire=requireInquire(),e.utf8=requireUtf8(),e.pool=requirePool(),e.LongBits=requireLongbits(),e.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),e.global=e.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||minimal$1,e.emptyArray=Object.freeze?Object.freeze([]):[],e.emptyObject=Object.freeze?Object.freeze({}):{},e.isInteger=Number.isInteger||function(i){return typeof i=="number"&&isFinite(i)&&Math.floor(i)===i},e.isString=function(i){return typeof i=="string"||i instanceof String},e.isObject=function(i){return i&&typeof i=="object"},e.isset=e.isSet=function(i,o){var a=i[o];return a!=null&&i.hasOwnProperty(o)?typeof a!="object"||(Array.isArray(a)?a.length:Object.keys(a).length)>0:!1},e.Buffer=function(){try{var n=e.inquire("buffer").Buffer;return n.prototype.utf8Write?n:null}catch{return null}}(),e._Buffer_from=null,e._Buffer_allocUnsafe=null,e.newBuffer=function(i){return typeof i=="number"?e.Buffer?e._Buffer_allocUnsafe(i):new e.Array(i):e.Buffer?e._Buffer_from(i):typeof Uint8Array>"u"?i:new Uint8Array(i)},e.Array=typeof Uint8Array<"u"?Uint8Array:Array,e.Long=e.global.dcodeIO&&e.global.dcodeIO.Long||e.global.Long||e.inquire("long"),e.key2Re=/^true|false|0|1$/,e.key32Re=/^-?(?:0|[1-9][0-9]*)$/,e.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,e.longToHash=function(i){return i?e.LongBits.from(i).toHash():e.LongBits.zeroHash},e.longFromHash=function(i,o){var a=e.LongBits.fromHash(i);return e.Long?e.Long.fromBits(a.lo,a.hi,o):a.toNumber(!!o)};function t(n,i,o){for(var a=Object.keys(i),l=0;l<a.length;++l)(n[a[l]]===void 0||!o)&&(n[a[l]]=i[a[l]]);return n}e.merge=t,e.lcFirst=function(i){return i.charAt(0).toLowerCase()+i.substring(1)};function s(n){function i(o,a){if(!(this instanceof i))return new i(o,a);Object.defineProperty(this,"message",{get:function(){return o}}),Error.captureStackTrace?Error.captureStackTrace(this,i):Object.defineProperty(this,"stack",{value:new Error().stack||""}),a&&t(this,a)}return i.prototype=Object.create(Error.prototype,{constructor:{value:i,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return n},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),i}e.newError=s,e.ProtocolError=s("ProtocolError"),e.oneOfGetter=function(i){for(var o={},a=0;a<i.length;++a)o[i[a]]=1;return function(){for(var l=Object.keys(this),p=l.length-1;p>-1;--p)if(o[l[p]]===1&&this[l[p]]!==void 0&&this[l[p]]!==null)return l[p]}},e.oneOfSetter=function(i){return function(o){for(var a=0;a<i.length;++a)i[a]!==o&&delete this[i[a]]}},e.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},e._configure=function(){var n=e.Buffer;if(!n){e._Buffer_from=e._Buffer_allocUnsafe=null;return}e._Buffer_from=n.from!==Uint8Array.from&&n.from||function(o,a){return new n(o,a)},e._Buffer_allocUnsafe=n.allocUnsafe||function(o){return new n(o)}}}(minimal$1)),minimal$1}var writer,hasRequiredWriter;function requireWriter(){if(hasRequiredWriter)return writer;hasRequiredWriter=1,writer=l;var r=requireMinimal$1(),e,t=r.LongBits,s=r.base64,n=r.utf8;function i(C,S,R){this.fn=C,this.len=S,this.next=void 0,this.val=R}function o(){}function a(C){this.head=C.head,this.tail=C.tail,this.len=C.len,this.next=C.states}function l(){this.len=0,this.head=new i(o,0,0),this.tail=this.head,this.states=null}var p=function(){return r.Buffer?function(){return(l.create=function(){return new e})()}:function(){return new l}};l.create=p(),l.alloc=function(S){return new r.Array(S)},r.Array!==Array&&(l.alloc=r.pool(l.alloc,r.Array.prototype.subarray)),l.prototype._push=function(S,R,I){return this.tail=this.tail.next=new i(S,R,I),this.len+=R,this};function g(C,S,R){S[R]=C&255}function x(C,S,R){for(;C>127;)S[R++]=C&127|128,C>>>=7;S[R]=C}function b(C,S){this.len=C,this.next=void 0,this.val=S}b.prototype=Object.create(i.prototype),b.prototype.fn=x,l.prototype.uint32=function(S){return this.len+=(this.tail=this.tail.next=new b((S=S>>>0)<128?1:S<16384?2:S<2097152?3:S<268435456?4:5,S)).len,this},l.prototype.int32=function(S){return S<0?this._push(E,10,t.fromNumber(S)):this.uint32(S)},l.prototype.sint32=function(S){return this.uint32((S<<1^S>>31)>>>0)};function E(C,S,R){for(;C.hi;)S[R++]=C.lo&127|128,C.lo=(C.lo>>>7|C.hi<<25)>>>0,C.hi>>>=7;for(;C.lo>127;)S[R++]=C.lo&127|128,C.lo=C.lo>>>7;S[R++]=C.lo}l.prototype.uint64=function(S){var R=t.from(S);return this._push(E,R.length(),R)},l.prototype.int64=l.prototype.uint64,l.prototype.sint64=function(S){var R=t.from(S).zzEncode();return this._push(E,R.length(),R)},l.prototype.bool=function(S){return this._push(g,1,S?1:0)};function f(C,S,R){S[R]=C&255,S[R+1]=C>>>8&255,S[R+2]=C>>>16&255,S[R+3]=C>>>24}l.prototype.fixed32=function(S){return this._push(f,4,S>>>0)},l.prototype.sfixed32=l.prototype.fixed32,l.prototype.fixed64=function(S){var R=t.from(S);return this._push(f,4,R.lo)._push(f,4,R.hi)},l.prototype.sfixed64=l.prototype.fixed64,l.prototype.float=function(S){return this._push(r.float.writeFloatLE,4,S)},l.prototype.double=function(S){return this._push(r.float.writeDoubleLE,8,S)};var j=r.Array.prototype.set?function(S,R,I){R.set(S,I)}:function(S,R,I){for(var A=0;A<S.length;++A)R[I+A]=S[A]};return l.prototype.bytes=function(S){var R=S.length>>>0;if(!R)return this._push(g,1,0);if(r.isString(S)){var I=l.alloc(R=s.length(S));s.decode(S,I,0),S=I}return this.uint32(R)._push(j,R,S)},l.prototype.string=function(S){var R=n.length(S);return R?this.uint32(R)._push(n.write,R,S):this._push(g,1,0)},l.prototype.fork=function(){return this.states=new a(this),this.head=this.tail=new i(o,0,0),this.len=0,this},l.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new i(o,0,0),this.len=0),this},l.prototype.ldelim=function(){var S=this.head,R=this.tail,I=this.len;return this.reset().uint32(I),I&&(this.tail.next=S.next,this.tail=R,this.len+=I),this},l.prototype.finish=function(){for(var S=this.head.next,R=this.constructor.alloc(this.len),I=0;S;)S.fn(S.val,R,I),I+=S.len,S=S.next;return R},l._configure=function(C){e=C,l.create=p(),e._configure()},writer}var writer_buffer,hasRequiredWriter_buffer;function requireWriter_buffer(){if(hasRequiredWriter_buffer)return writer_buffer;hasRequiredWriter_buffer=1,writer_buffer=t;var r=requireWriter();(t.prototype=Object.create(r.prototype)).constructor=t;var e=requireMinimal$1();function t(){r.call(this)}t._configure=function(){t.alloc=e._Buffer_allocUnsafe,t.writeBytesBuffer=e.Buffer&&e.Buffer.prototype instanceof Uint8Array&&e.Buffer.prototype.set.name==="set"?function(i,o,a){o.set(i,a)}:function(i,o,a){if(i.copy)i.copy(o,a,0,i.length);else for(var l=0;l<i.length;)o[a++]=i[l++]}},t.prototype.bytes=function(i){e.isString(i)&&(i=e._Buffer_from(i,"base64"));var o=i.length>>>0;return this.uint32(o),o&&this._push(t.writeBytesBuffer,o,i),this};function s(n,i,o){n.length<40?e.utf8.write(n,i,o):i.utf8Write?i.utf8Write(n,o):i.write(n,o)}return t.prototype.string=function(i){var o=e.Buffer.byteLength(i);return this.uint32(o),o&&this._push(s,o,i),this},t._configure(),writer_buffer}var reader,hasRequiredReader;function requireReader(){if(hasRequiredReader)return reader;hasRequiredReader=1,reader=i;var r=requireMinimal$1(),e,t=r.LongBits,s=r.utf8;function n(x,b){return RangeError("index out of range: "+x.pos+" + "+(b||1)+" > "+x.len)}function i(x){this.buf=x,this.pos=0,this.len=x.length}var o=typeof Uint8Array<"u"?function(b){if(b instanceof Uint8Array||Array.isArray(b))return new i(b);throw Error("illegal buffer")}:function(b){if(Array.isArray(b))return new i(b);throw Error("illegal buffer")},a=function(){return r.Buffer?function(E){return(i.create=function(j){return r.Buffer.isBuffer(j)?new e(j):o(j)})(E)}:o};i.create=a(),i.prototype._slice=r.Array.prototype.subarray||r.Array.prototype.slice,i.prototype.uint32=function(){var b=4294967295;return function(){if(b=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(b=(b|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(b=(b|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(b=(b|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(b=(b|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return b;if((this.pos+=5)>this.len)throw this.pos=this.len,n(this,10);return b}}(),i.prototype.int32=function(){return this.uint32()|0},i.prototype.sint32=function(){var b=this.uint32();return b>>>1^-(b&1)|0};function l(){var x=new t(0,0),b=0;if(this.len-this.pos>4){for(;b<4;++b)if(x.lo=(x.lo|(this.buf[this.pos]&127)<<b*7)>>>0,this.buf[this.pos++]<128)return x;if(x.lo=(x.lo|(this.buf[this.pos]&127)<<28)>>>0,x.hi=(x.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return x;b=0}else{for(;b<3;++b){if(this.pos>=this.len)throw n(this);if(x.lo=(x.lo|(this.buf[this.pos]&127)<<b*7)>>>0,this.buf[this.pos++]<128)return x}return x.lo=(x.lo|(this.buf[this.pos++]&127)<<b*7)>>>0,x}if(this.len-this.pos>4){for(;b<5;++b)if(x.hi=(x.hi|(this.buf[this.pos]&127)<<b*7+3)>>>0,this.buf[this.pos++]<128)return x}else for(;b<5;++b){if(this.pos>=this.len)throw n(this);if(x.hi=(x.hi|(this.buf[this.pos]&127)<<b*7+3)>>>0,this.buf[this.pos++]<128)return x}throw Error("invalid varint encoding")}i.prototype.bool=function(){return this.uint32()!==0};function p(x,b){return(x[b-4]|x[b-3]<<8|x[b-2]<<16|x[b-1]<<24)>>>0}i.prototype.fixed32=function(){if(this.pos+4>this.len)throw n(this,4);return p(this.buf,this.pos+=4)},i.prototype.sfixed32=function(){if(this.pos+4>this.len)throw n(this,4);return p(this.buf,this.pos+=4)|0};function g(){if(this.pos+8>this.len)throw n(this,8);return new t(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}return i.prototype.float=function(){if(this.pos+4>this.len)throw n(this,4);var b=r.float.readFloatLE(this.buf,this.pos);return this.pos+=4,b},i.prototype.double=function(){if(this.pos+8>this.len)throw n(this,4);var b=r.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,b},i.prototype.bytes=function(){var b=this.uint32(),E=this.pos,f=this.pos+b;if(f>this.len)throw n(this,b);if(this.pos+=b,Array.isArray(this.buf))return this.buf.slice(E,f);if(E===f){var j=r.Buffer;return j?j.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,E,f)},i.prototype.string=function(){var b=this.bytes();return s.read(b,0,b.length)},i.prototype.skip=function(b){if(typeof b=="number"){if(this.pos+b>this.len)throw n(this,b);this.pos+=b}else do if(this.pos>=this.len)throw n(this);while(this.buf[this.pos++]&128);return this},i.prototype.skipType=function(x){switch(x){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(x=this.uint32()&7)!==4;)this.skipType(x);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+x+" at offset "+this.pos)}return this},i._configure=function(x){e=x,i.create=a(),e._configure();var b=r.Long?"toLong":"toNumber";r.merge(i.prototype,{int64:function(){return l.call(this)[b](!1)},uint64:function(){return l.call(this)[b](!0)},sint64:function(){return l.call(this).zzDecode()[b](!1)},fixed64:function(){return g.call(this)[b](!0)},sfixed64:function(){return g.call(this)[b](!1)}})},reader}var reader_buffer,hasRequiredReader_buffer;function requireReader_buffer(){if(hasRequiredReader_buffer)return reader_buffer;hasRequiredReader_buffer=1,reader_buffer=t;var r=requireReader();(t.prototype=Object.create(r.prototype)).constructor=t;var e=requireMinimal$1();function t(s){r.call(this,s)}return t._configure=function(){e.Buffer&&(t.prototype._slice=e.Buffer.prototype.slice)},t.prototype.string=function(){var n=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+n,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+n,this.len))},t._configure(),reader_buffer}var rpc={},service,hasRequiredService;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=e;var r=requireMinimal$1();(e.prototype=Object.create(r.EventEmitter.prototype)).constructor=e;function e(t,s,n){if(typeof t!="function")throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=!!s,this.responseDelimited=!!n}return e.prototype.rpcCall=function t(s,n,i,o,a){if(!o)throw TypeError("request must be specified");var l=this;if(!a)return r.asPromise(t,l,s,n,i,o);if(!l.rpcImpl){setTimeout(function(){a(Error("already ended"))},0);return}try{return l.rpcImpl(s,n[l.requestDelimited?"encodeDelimited":"encode"](o).finish(),function(g,x){if(g)return l.emit("error",g,s),a(g);if(x===null){l.end(!0);return}if(!(x instanceof i))try{x=i[l.responseDelimited?"decodeDelimited":"decode"](x)}catch(b){return l.emit("error",b,s),a(b)}return l.emit("data",x,s),a(null,x)})}catch(p){l.emit("error",p,s),setTimeout(function(){a(p)},0);return}},e.prototype.end=function(s){return this.rpcImpl&&(s||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},service}var hasRequiredRpc;function requireRpc(){return hasRequiredRpc||(hasRequiredRpc=1,function(r){var e=r;e.Service=requireService()}(rpc)),rpc}var roots,hasRequiredRoots;function requireRoots(){return hasRequiredRoots||(hasRequiredRoots=1,roots={}),roots}var hasRequiredIndexMinimal;function requireIndexMinimal(){return hasRequiredIndexMinimal||(hasRequiredIndexMinimal=1,function(r){var e=r;e.build="minimal",e.Writer=requireWriter(),e.BufferWriter=requireWriter_buffer(),e.Reader=requireReader(),e.BufferReader=requireReader_buffer(),e.util=requireMinimal$1(),e.rpc=requireRpc(),e.roots=requireRoots(),e.configure=t;function t(){e.util._configure(),e.Writer._configure(e.BufferWriter),e.Reader._configure(e.BufferReader)}t()}(indexMinimal)),indexMinimal}var minimal,hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,minimal=requireIndexMinimal()),minimal}var minimalExports=requireMinimal();const $protobuf=getDefaultExportFromCjs(minimalExports),$Reader=$protobuf.Reader,$Writer=$protobuf.Writer,$util=$protobuf.util,$root=$protobuf.roots["ipfs-unixfs"]||($protobuf.roots["ipfs-unixfs"]={});$root.Data=(()=>{function r(e){if(this.blocksizes=[],e)for(var t=Object.keys(e),s=0;s<t.length;++s)e[t[s]]!=null&&(this[t[s]]=e[t[s]])}return r.prototype.Type=0,r.prototype.Data=$util.newBuffer([]),r.prototype.filesize=$util.Long?$util.Long.fromBits(0,0,!0):0,r.prototype.blocksizes=$util.emptyArray,r.prototype.hashType=$util.Long?$util.Long.fromBits(0,0,!0):0,r.prototype.fanout=$util.Long?$util.Long.fromBits(0,0,!0):0,r.prototype.mode=0,r.prototype.mtime=null,r.encode=function(t,s){if(s||(s=$Writer.create()),s.uint32(8).int32(t.Type),t.Data!=null&&Object.hasOwnProperty.call(t,"Data")&&s.uint32(18).bytes(t.Data),t.filesize!=null&&Object.hasOwnProperty.call(t,"filesize")&&s.uint32(24).uint64(t.filesize),t.blocksizes!=null&&t.blocksizes.length)for(var n=0;n<t.blocksizes.length;++n)s.uint32(32).uint64(t.blocksizes[n]);return t.hashType!=null&&Object.hasOwnProperty.call(t,"hashType")&&s.uint32(40).uint64(t.hashType),t.fanout!=null&&Object.hasOwnProperty.call(t,"fanout")&&s.uint32(48).uint64(t.fanout),t.mode!=null&&Object.hasOwnProperty.call(t,"mode")&&s.uint32(56).uint32(t.mode),t.mtime!=null&&Object.hasOwnProperty.call(t,"mtime")&&$root.UnixTime.encode(t.mtime,s.uint32(66).fork()).ldelim(),s},r.decode=function(t,s){t instanceof $Reader||(t=$Reader.create(t));for(var n=s===void 0?t.len:t.pos+s,i=new $root.Data;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:i.Type=t.int32();break;case 2:i.Data=t.bytes();break;case 3:i.filesize=t.uint64();break;case 4:if(i.blocksizes&&i.blocksizes.length||(i.blocksizes=[]),(o&7)===2)for(var a=t.uint32()+t.pos;t.pos<a;)i.blocksizes.push(t.uint64());else i.blocksizes.push(t.uint64());break;case 5:i.hashType=t.uint64();break;case 6:i.fanout=t.uint64();break;case 7:i.mode=t.uint32();break;case 8:i.mtime=$root.UnixTime.decode(t,t.uint32());break;default:t.skipType(o&7);break}}if(!i.hasOwnProperty("Type"))throw $util.ProtocolError("missing required 'Type'",{instance:i});return i},r.fromObject=function(t){if(t instanceof $root.Data)return t;var s=new $root.Data;switch(t.Type){case"Raw":case 0:s.Type=0;break;case"Directory":case 1:s.Type=1;break;case"File":case 2:s.Type=2;break;case"Metadata":case 3:s.Type=3;break;case"Symlink":case 4:s.Type=4;break;case"HAMTShard":case 5:s.Type=5;break}if(t.Data!=null&&(typeof t.Data=="string"?$util.base64.decode(t.Data,s.Data=$util.newBuffer($util.base64.length(t.Data)),0):t.Data.length&&(s.Data=t.Data)),t.filesize!=null&&($util.Long?(s.filesize=$util.Long.fromValue(t.filesize)).unsigned=!0:typeof t.filesize=="string"?s.filesize=parseInt(t.filesize,10):typeof t.filesize=="number"?s.filesize=t.filesize:typeof t.filesize=="object"&&(s.filesize=new $util.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0))),t.blocksizes){if(!Array.isArray(t.blocksizes))throw TypeError(".Data.blocksizes: array expected");s.blocksizes=[];for(var n=0;n<t.blocksizes.length;++n)$util.Long?(s.blocksizes[n]=$util.Long.fromValue(t.blocksizes[n])).unsigned=!0:typeof t.blocksizes[n]=="string"?s.blocksizes[n]=parseInt(t.blocksizes[n],10):typeof t.blocksizes[n]=="number"?s.blocksizes[n]=t.blocksizes[n]:typeof t.blocksizes[n]=="object"&&(s.blocksizes[n]=new $util.LongBits(t.blocksizes[n].low>>>0,t.blocksizes[n].high>>>0).toNumber(!0))}if(t.hashType!=null&&($util.Long?(s.hashType=$util.Long.fromValue(t.hashType)).unsigned=!0:typeof t.hashType=="string"?s.hashType=parseInt(t.hashType,10):typeof t.hashType=="number"?s.hashType=t.hashType:typeof t.hashType=="object"&&(s.hashType=new $util.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0))),t.fanout!=null&&($util.Long?(s.fanout=$util.Long.fromValue(t.fanout)).unsigned=!0:typeof t.fanout=="string"?s.fanout=parseInt(t.fanout,10):typeof t.fanout=="number"?s.fanout=t.fanout:typeof t.fanout=="object"&&(s.fanout=new $util.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0))),t.mode!=null&&(s.mode=t.mode>>>0),t.mtime!=null){if(typeof t.mtime!="object")throw TypeError(".Data.mtime: object expected");s.mtime=$root.UnixTime.fromObject(t.mtime)}return s},r.toObject=function(t,s){s||(s={});var n={};if((s.arrays||s.defaults)&&(n.blocksizes=[]),s.defaults){if(n.Type=s.enums===String?"Raw":0,s.bytes===String?n.Data="":(n.Data=[],s.bytes!==Array&&(n.Data=$util.newBuffer(n.Data))),$util.Long){var i=new $util.Long(0,0,!0);n.filesize=s.longs===String?i.toString():s.longs===Number?i.toNumber():i}else n.filesize=s.longs===String?"0":0;if($util.Long){var i=new $util.Long(0,0,!0);n.hashType=s.longs===String?i.toString():s.longs===Number?i.toNumber():i}else n.hashType=s.longs===String?"0":0;if($util.Long){var i=new $util.Long(0,0,!0);n.fanout=s.longs===String?i.toString():s.longs===Number?i.toNumber():i}else n.fanout=s.longs===String?"0":0;n.mode=0,n.mtime=null}if(t.Type!=null&&t.hasOwnProperty("Type")&&(n.Type=s.enums===String?$root.Data.DataType[t.Type]:t.Type),t.Data!=null&&t.hasOwnProperty("Data")&&(n.Data=s.bytes===String?$util.base64.encode(t.Data,0,t.Data.length):s.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),t.filesize!=null&&t.hasOwnProperty("filesize")&&(typeof t.filesize=="number"?n.filesize=s.longs===String?String(t.filesize):t.filesize:n.filesize=s.longs===String?$util.Long.prototype.toString.call(t.filesize):s.longs===Number?new $util.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0):t.filesize),t.blocksizes&&t.blocksizes.length){n.blocksizes=[];for(var o=0;o<t.blocksizes.length;++o)typeof t.blocksizes[o]=="number"?n.blocksizes[o]=s.longs===String?String(t.blocksizes[o]):t.blocksizes[o]:n.blocksizes[o]=s.longs===String?$util.Long.prototype.toString.call(t.blocksizes[o]):s.longs===Number?new $util.LongBits(t.blocksizes[o].low>>>0,t.blocksizes[o].high>>>0).toNumber(!0):t.blocksizes[o]}return t.hashType!=null&&t.hasOwnProperty("hashType")&&(typeof t.hashType=="number"?n.hashType=s.longs===String?String(t.hashType):t.hashType:n.hashType=s.longs===String?$util.Long.prototype.toString.call(t.hashType):s.longs===Number?new $util.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0):t.hashType),t.fanout!=null&&t.hasOwnProperty("fanout")&&(typeof t.fanout=="number"?n.fanout=s.longs===String?String(t.fanout):t.fanout:n.fanout=s.longs===String?$util.Long.prototype.toString.call(t.fanout):s.longs===Number?new $util.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0):t.fanout),t.mode!=null&&t.hasOwnProperty("mode")&&(n.mode=t.mode),t.mtime!=null&&t.hasOwnProperty("mtime")&&(n.mtime=$root.UnixTime.toObject(t.mtime,s)),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},r.DataType=function(){const e={},t=Object.create(e);return t[e[0]="Raw"]=0,t[e[1]="Directory"]=1,t[e[2]="File"]=2,t[e[3]="Metadata"]=3,t[e[4]="Symlink"]=4,t[e[5]="HAMTShard"]=5,t}(),r})();$root.UnixTime=(()=>{function r(e){if(e)for(var t=Object.keys(e),s=0;s<t.length;++s)e[t[s]]!=null&&(this[t[s]]=e[t[s]])}return r.prototype.Seconds=$util.Long?$util.Long.fromBits(0,0,!1):0,r.prototype.FractionalNanoseconds=0,r.encode=function(t,s){return s||(s=$Writer.create()),s.uint32(8).int64(t.Seconds),t.FractionalNanoseconds!=null&&Object.hasOwnProperty.call(t,"FractionalNanoseconds")&&s.uint32(21).fixed32(t.FractionalNanoseconds),s},r.decode=function(t,s){t instanceof $Reader||(t=$Reader.create(t));for(var n=s===void 0?t.len:t.pos+s,i=new $root.UnixTime;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:i.Seconds=t.int64();break;case 2:i.FractionalNanoseconds=t.fixed32();break;default:t.skipType(o&7);break}}if(!i.hasOwnProperty("Seconds"))throw $util.ProtocolError("missing required 'Seconds'",{instance:i});return i},r.fromObject=function(t){if(t instanceof $root.UnixTime)return t;var s=new $root.UnixTime;return t.Seconds!=null&&($util.Long?(s.Seconds=$util.Long.fromValue(t.Seconds)).unsigned=!1:typeof t.Seconds=="string"?s.Seconds=parseInt(t.Seconds,10):typeof t.Seconds=="number"?s.Seconds=t.Seconds:typeof t.Seconds=="object"&&(s.Seconds=new $util.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber())),t.FractionalNanoseconds!=null&&(s.FractionalNanoseconds=t.FractionalNanoseconds>>>0),s},r.toObject=function(t,s){s||(s={});var n={};if(s.defaults){if($util.Long){var i=new $util.Long(0,0,!1);n.Seconds=s.longs===String?i.toString():s.longs===Number?i.toNumber():i}else n.Seconds=s.longs===String?"0":0;n.FractionalNanoseconds=0}return t.Seconds!=null&&t.hasOwnProperty("Seconds")&&(typeof t.Seconds=="number"?n.Seconds=s.longs===String?String(t.Seconds):t.Seconds:n.Seconds=s.longs===String?$util.Long.prototype.toString.call(t.Seconds):s.longs===Number?new $util.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber():t.Seconds),t.FractionalNanoseconds!=null&&t.hasOwnProperty("FractionalNanoseconds")&&(n.FractionalNanoseconds=t.FractionalNanoseconds),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},r})();$root.Metadata=(()=>{function r(e){if(e)for(var t=Object.keys(e),s=0;s<t.length;++s)e[t[s]]!=null&&(this[t[s]]=e[t[s]])}return r.prototype.MimeType="",r.encode=function(t,s){return s||(s=$Writer.create()),t.MimeType!=null&&Object.hasOwnProperty.call(t,"MimeType")&&s.uint32(10).string(t.MimeType),s},r.decode=function(t,s){t instanceof $Reader||(t=$Reader.create(t));for(var n=s===void 0?t.len:t.pos+s,i=new $root.Metadata;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:i.MimeType=t.string();break;default:t.skipType(o&7);break}}return i},r.fromObject=function(t){if(t instanceof $root.Metadata)return t;var s=new $root.Metadata;return t.MimeType!=null&&(s.MimeType=String(t.MimeType)),s},r.toObject=function(t,s){s||(s={});var n={};return s.defaults&&(n.MimeType=""),t.MimeType!=null&&t.hasOwnProperty("MimeType")&&(n.MimeType=t.MimeType),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},r})();function parseMode(r){if(r!=null)return typeof r=="number"?r&4095:(r=r.toString(),r.substring(0,1)==="0"?parseInt(r,8)&4095:parseInt(r,10)&4095)}function parseMtime(r){if(r==null)return;let e;if(r.secs!=null&&(e={secs:r.secs,nsecs:r.nsecs}),r.Seconds!=null&&(e={secs:r.Seconds,nsecs:r.FractionalNanoseconds}),Array.isArray(r)&&(e={secs:r[0],nsecs:r[1]}),r instanceof Date){const t=r.getTime(),s=Math.floor(t/1e3);e={secs:s,nsecs:(t-s*1e3)*1e3}}if(Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw errCode(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}async function*normaliseCandidateMultiple(r,e){if(typeof r=="string"||r instanceof String||isBytes(r)||isBlob(r)||r._readableState)throw errCode(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(isReadableStream(r)&&(r=browserReadableStreamToIt(r)),Symbol.iterator in r||Symbol.asyncIterator in r){const t=peekableIterator(r),{value:s,done:n}=await t.peek();if(n){yield*[];return}if(t.push(s),Number.isInteger(s))throw errCode(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(s._readableState){yield*map(t,i=>toFileObject$1({content:i},e));return}if(isBytes(s)){yield toFileObject$1({content:t},e);return}if(isFileObject(s)||s[Symbol.iterator]||s[Symbol.asyncIterator]||isReadableStream(s)||isBlob(s)){yield*map(t,i=>toFileObject$1(i,e));return}}throw isFileObject(r)?errCode(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT"):errCode(new Error("Unexpected input: "+typeof r),"ERR_UNEXPECTED_INPUT")}async function toFileObject$1(r,e){const{path:t,mode:s,mtime:n,content:i}=r,o={path:t||"",mode:parseMode(s),mtime:parseMtime(n)};return i?o.content=await e(i):t||(o.content=await e(r)),o}function normaliseInput$2(r){return normaliseCandidateMultiple(r,normaliseContent$1)}function modeToString(r){if(r!=null)return typeof r=="string"?r:r.toString(8).padStart(4,"0")}async function multipartRequest(r,e,t={}){const s=[],n=new FormData;let i=0,o=0;for await(const{content:a,path:l,mode:p,mtime:g}of normaliseInput$2(r)){let x="";const b=a?"file":"dir";i>0&&(x=`-${i}`);let E=b+x;const f=[];if(p!=null&&f.push(`mode=${modeToString(p)}`),g!=null){const{secs:j,nsecs:C}=g;f.push(`mtime=${j}`),C!=null&&f.push(`mtime-nsecs=${C}`)}if(f.length&&(E=`${E}?${f.join("&")}`),a){n.set(E,a,l!=null?encodeURIComponent(l):void 0);const j=o+a.size;s.push({name:l,start:o,end:j}),o=j}else if(l!=null)n.set(E,new File([""],encodeURIComponent(l),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");i++}return{total:o,parts:s,headers:t,body:n}}var anySignalExports=requireAnySignal();function filter(r){return r.filter(Boolean)}function abortSignal(...r){return anySignalExports.anySignal(filter(r))}const createPut$3=configure(r=>{async function e(t,s={}){const n=new AbortController,i=abortSignal(n.signal,s.signal);let o;try{o=await(await r.post("block/put",{signal:i,searchParams:toUrlSearchParams(s),...await multipartRequest([t],n,s.headers)})).json()}catch(a){if(s.format==="dag-pb")return e(t,{...s,format:"protobuf"});if(s.format==="dag-cbor")return e(t,{...s,format:"cbor"});throw a}return CID$1.parse(o.Key)}return e}),createRm$6=configure(r=>{async function*e(t,s={}){Array.isArray(t)||(t=[t]);const n=await r.post("block/rm",{signal:s.signal,searchParams:toUrlSearchParams({arg:t.map(i=>i.toString()),"stream-channels":!0,...s}),headers:s.headers});for await(const i of n.ndjson())yield toCoreInterface$3(i)}return e});function toCoreInterface$3(r){const e={cid:CID$1.parse(r.Hash)};return r.Error&&(e.error=new Error(r.Error)),e}const createStat$3=configure(r=>{async function e(t,s={}){const i=await(await r.post("block/stat",{signal:s.signal,searchParams:toUrlSearchParams({arg:t.toString(),...s}),headers:s.headers})).json();return{cid:CID$1.parse(i.Key),size:i.Size}}return e});function createBlock(r){return{get:createGet$5(r),put:createPut$3(r),rm:createRm$6(r),stat:createStat$3(r)}}const createAdd$4=configure(r=>{async function e(t,s={}){const n=await r.post("bootstrap/add",{signal:s.signal,searchParams:toUrlSearchParams({arg:t,...s}),headers:s.headers}),{Peers:i}=await n.json();return{Peers:i.map(o=>multiaddr$1(o))}}return e}),createClear=configure(r=>{async function e(t={}){const s=await r.post("bootstrap/rm",{signal:t.signal,searchParams:toUrlSearchParams({...t,all:!0}),headers:t.headers}),{Peers:n}=await s.json();return{Peers:n.map(i=>multiaddr$1(i))}}return e}),createList$2=configure(r=>{async function e(t={}){const s=await r.post("bootstrap/list",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers}),{Peers:n}=await s.json();return{Peers:n.map(i=>multiaddr$1(i))}}return e}),createReset=configure(r=>{async function e(t={}){const s=await r.post("bootstrap/add",{signal:t.signal,searchParams:toUrlSearchParams({...t,default:!0}),headers:t.headers}),{Peers:n}=await s.json();return{Peers:n.map(i=>multiaddr$1(i))}}return e}),createRm$5=configure(r=>{async function e(t,s={}){const n=await r.post("bootstrap/rm",{signal:s.signal,searchParams:toUrlSearchParams({arg:t,...s}),headers:s.headers}),{Peers:i}=await n.json();return{Peers:i.map(o=>multiaddr$1(o))}}return e});function createBootstrap(r){return{add:createAdd$4(r),clear:createClear(r),list:createList$2(r),reset:createReset(r),rm:createRm$5(r)}}const createApply=configure(r=>{async function e(t,s={}){const i=await(await r.post("config/profile/apply",{signal:s.signal,searchParams:toUrlSearchParams({arg:t,...s}),headers:s.headers})).json();return{original:i.OldCfg,updated:i.NewCfg}}return e});function objectToCamel(r){if(r==null)return r;const e=/^[A-Z]+$/,t={};return Object.keys(r).reduce((s,n)=>(e.test(n)?s[n.toLowerCase()]=r[n]:e.test(n[0])?s[n[0].toLowerCase()+n.slice(1)]=r[n]:s[n]=r[n],s),t)}const createList$1=configure(r=>{async function e(t={}){return(await(await r.post("config/profile/list",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers})).json()).map(i=>objectToCamel(i))}return e});function createProfiles(r){return{apply:createApply(r),list:createList$1(r)}}const createGet$4=configure(r=>async(t,s={})=>{if(!t)throw new Error("key argument is required");return(await(await r.post("config",{signal:s.signal,searchParams:toUrlSearchParams({arg:t,...s}),headers:s.headers})).json()).Value}),createGetAll=configure(r=>async(t={})=>await(await r.post("config/show",{signal:t.signal,searchParams:toUrlSearchParams({...t}),headers:t.headers})).json()),createReplace=configure(r=>async(t,s={})=>{const n=new AbortController,i=abortSignal(n.signal,s.signal);await(await r.post("config/replace",{signal:i,searchParams:toUrlSearchParams(s),...await multipartRequest([fromString$3(JSON.stringify(t))],n,s.headers)})).text()}),createSet=configure(r=>async(t,s,n={})=>{if(typeof t!="string")throw new Error("Invalid key type");const i={...n,...encodeParam(t,s)};await(await r.post("config",{signal:n.signal,searchParams:toUrlSearchParams(i),headers:n.headers})).text()}),encodeParam=(r,e)=>{switch(typeof e){case"boolean":return{arg:[r,e.toString()],bool:!0};case"string":return{arg:[r,e]};default:return{arg:[r,JSON.stringify(e)],json:!0}}};function createConfig(r){return{getAll:createGetAll(r),get:createGet$4(r),set:createSet(r),replace:createReplace(r),profiles:createProfiles(r)}}const createExport$1=configure(r=>{async function*e(t,s={}){yield*(await r.post("dag/export",{signal:s.signal,searchParams:toUrlSearchParams({arg:t.toString()}),headers:s.headers})).iterator()}return e});async function*resolve(r,e,t,s,n){const i=async p=>{const g=await t.getCodec(p.code),x=await s(p,n);return g.decode(x)},o=e.split("/").filter(Boolean);let a=await i(r),l=r;for(;o.length;){const p=o.shift();if(!p)throw errCode(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(a,p))a=a[p],yield{value:a,remainderPath:o.join("/")};else throw errCode(new Error(`no link named "${p}" under ${l}`),"ERR_NO_LINK");const g=CID$1.asCID(a);g&&(l=g,a=await i(a))}yield{value:a,remainderPath:""}}async function first(r){for await(const e of r)return e}async function last(r){let e;for await(const t of r)e=t;return e}const createGet$3=(r,e)=>configure((s,n)=>{const i=createGet$5(n);return async(a,l={})=>{if(l.path){const E=l.localResolve?await first(resolve(a,l.path,r,i,l)):await last(resolve(a,l.path,r,i,l));if(!E)throw errCode(new Error("Not found"),"ERR_NOT_FOUND");return E}const p=await r.getCodec(a.code),g=await i(a,l);return{value:p.decode(g),remainderPath:""}}})(e),createImport$1=configure(r=>{async function*e(t,s={}){const n=new AbortController,i=abortSignal(n.signal,s.signal),{headers:o,body:a}=await multipartRequest(t,n,s.headers),l=await r.post("dag/import",{signal:i,headers:o,body:a,searchParams:toUrlSearchParams({"pin-roots":s.pinRoots})});for await(const{Root:p}of l.ndjson())if(p!==void 0){const{Cid:{"/":g},PinErrorMsg:x}=p;yield{root:{cid:CID$1.parse(g),pinErrorMsg:x}}}}return e}),createPut$2=(r,e)=>configure(s=>async(i,o={})=>{const a={storeCodec:"dag-cbor",hashAlg:"sha2-256",...o};let l;if(a.inputCodec){if(!(i instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");l=i}else l=(await r.getCodec(a.storeCodec)).encode(i),a.inputCodec=a.storeCodec;const p=new AbortController,g=abortSignal(p.signal,a.signal),b=await(await s.post("dag/put",{timeout:a.timeout,signal:g,searchParams:toUrlSearchParams(a),...await multipartRequest([l],p,a.headers)})).json();return CID$1.parse(b.Cid["/"])})(e),createResolve$2=configure(r=>async(t,s={})=>{const i=await(await r.post("dag/resolve",{signal:s.signal,searchParams:toUrlSearchParams({arg:`${t}${s.path?`/${s.path}`.replace(/\/[/]+/g,"/"):""}`,...s}),headers:s.headers})).json();return{cid:CID$1.parse(i.Cid["/"]),remainderPath:i.RemPath}});function createDag(r,e){return{export:createExport$1(e),get:createGet$3(r,e),import:createImport$1(e),put:createPut$2(r,e),resolve:createResolve$2(e)}}const SendingQuery=0,PeerResponse=1,FinalPeer=2,QueryError=3,Provider=4,Value=5,AddingPeer=6,DialingPeer=7,mapEvent=r=>{if(r.Type===SendingQuery)return{name:"SENDING_QUERY",type:r.Type};if(r.Type===PeerResponse)return{from:peerIdFromString(r.ID),name:"PEER_RESPONSE",type:r.Type,messageType:0,messageName:"PUT_VALUE",closer:(r.Responses||[]).map(({ID:e,Addrs:t})=>({id:peerIdFromString(e),multiaddrs:t.map(s=>multiaddr$1(s)),protocols:[]})),providers:(r.Responses||[]).map(({ID:e,Addrs:t})=>({id:peerIdFromString(e),multiaddrs:t.map(s=>multiaddr$1(s)),protocols:[]}))};if(r.Type===FinalPeer){let e={id:r.ID??peerIdFromString(r.ID),multiaddrs:[],protocols:[]};return r.Responses&&r.Responses.length&&(e={id:peerIdFromString(r.Responses[0].ID),multiaddrs:r.Responses[0].Addrs.map(t=>multiaddr$1(t)),protocols:[]}),{name:"FINAL_PEER",type:r.Type,peer:e}}if(r.Type===QueryError)return{name:"QUERY_ERROR",type:r.Type,error:new Error(r.Extra)};if(r.Type===Provider)return{name:"PROVIDER",type:r.Type,providers:r.Responses.map(({ID:e,Addrs:t})=>({id:peerIdFromString(e),multiaddrs:t.map(s=>multiaddr$1(s)),protocols:[]}))};if(r.Type===Value)return{name:"VALUE",type:r.Type,value:fromString$3(r.Extra,"base64pad")};if(r.Type===AddingPeer){const e=r.Responses.map(({ID:t})=>peerIdFromString(t));if(!e.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:r.Type,peer:e[0]}}if(r.Type===DialingPeer)return{name:"DIALING_PEER",type:r.Type,peer:peerIdFromString(r.ID)};throw new Error("Unknown DHT event type")},createFindPeer=configure(r=>{async function*e(t,s={}){const n=await r.post("dht/findpeer",{signal:s.signal,searchParams:toUrlSearchParams({arg:t,...s}),headers:s.headers});for await(const i of n.ndjson())yield mapEvent(i)}return e}),createFindProvs=configure(r=>{async function*e(t,s={}){const n=await r.post("dht/findprovs",{signal:s.signal,searchParams:toUrlSearchParams({arg:t.toString(),...s}),headers:s.headers});for await(const i of n.ndjson())yield mapEvent(i)}return e}),createGet$2=configure(r=>{async function*e(t,s={}){const n=await r.post("dht/get",{signal:s.signal,searchParams:toUrlSearchParams({arg:t instanceof Uint8Array?toString$3(t):t.toString(),...s}),headers:s.headers});for await(const i of n.ndjson())yield mapEvent(i)}return e}),createProvide=configure(r=>{async function*e(t,s={recursive:!1}){const n=Array.isArray(t)?t:[t],i=await r.post("dht/provide",{signal:s.signal,searchParams:toUrlSearchParams({arg:n.map(o=>o.toString()),...s}),headers:s.headers});for await(const o of i.ndjson())yield mapEvent(o)}return e}),createPut$1=configure(r=>{async function*e(t,s,n={}){const i=new AbortController,o=abortSignal(i.signal,n.signal),a=await r.post("dht/put",{signal:o,searchParams:toUrlSearchParams({arg:t instanceof Uint8Array?toString$3(t):t.toString(),...n}),...await multipartRequest([s],i,n.headers)});for await(const l of a.ndjson())yield mapEvent(l)}return e}),createQuery=configure(r=>{async function*e(t,s={}){const n=await r.post("dht/query",{signal:s.signal,searchParams:toUrlSearchParams({arg:t.toString(),...s}),headers:s.headers});for await(const i of n.ndjson())yield mapEvent(i)}return e});function createDht(r){return{findPeer:createFindPeer(r),findProvs:createFindProvs(r),get:createGet$2(r),provide:createProvide(r),put:createPut$1(r),query:createQuery(r)}}const createCmds=configure(r=>{async function e(t={}){return(await r.post("diag/cmds",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers})).json()}return e}),createNet=configure(r=>{async function e(t={}){return(await r.post("diag/net",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers})).json()}return e}),createSys=configure(r=>{async function e(t={}){return(await r.post("diag/sys",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers})).json()}return e});function createDiag(r){return{cmds:createCmds(r),net:createNet(r),sys:createSys(r)}}const createChmod=configure(r=>{async function e(t,s,n={}){await(await r.post("files/chmod",{signal:n.signal,searchParams:toUrlSearchParams({arg:t,mode:s,...n}),headers:n.headers})).text()}return e}),createCp=configure(r=>{async function e(t,s,n={}){const i=Array.isArray(t)?t:[t];await(await r.post("files/cp",{signal:n.signal,searchParams:toUrlSearchParams({arg:i.concat(s).map(a=>CID$1.asCID(a)?`/ipfs/${a}`:a),...n}),headers:n.headers})).text()}return e}),createFlush=configure(r=>{async function e(t,s={}){if(!t||typeof t!="string")throw new Error("ipfs.files.flush requires a path");const i=await(await r.post("files/flush",{signal:s.signal,searchParams:toUrlSearchParams({arg:t,...s}),headers:s.headers})).json();return CID$1.parse(i.Cid)}return e});function objectToCamelWithMetadata(r){const e=objectToCamel(r);return Object.prototype.hasOwnProperty.call(e,"mode")&&(e.mode=parseInt(e.mode,8)),Object.prototype.hasOwnProperty.call(e,"mtime")&&(e.mtime={secs:e.mtime,nsecs:e.mtimeNsecs||0},delete e.mtimeNsecs),e}const createLs$6=configure(r=>{async function*e(t,s={}){if(!t)throw new Error("ipfs.files.ls requires a path");const n=await r.post("files/ls",{signal:s.signal,searchParams:toUrlSearchParams({arg:CID$1.asCID(t)?`/ipfs/${t}`:t,long:!0,...s,stream:!0}),headers:s.headers});for await(const i of n.ndjson())if("Entries"in i)for(const o of i.Entries||[])yield toCoreInterface$2(objectToCamelWithMetadata(o));else yield toCoreInterface$2(objectToCamelWithMetadata(i))}return e});function toCoreInterface$2(r){return r.hash&&(r.cid=CID$1.parse(r.hash)),delete r.hash,r.type=r.type===1?"directory":"file",r}const createMkdir=configure(r=>{async function e(t,s={}){await(await r.post("files/mkdir",{signal:s.signal,searchParams:toUrlSearchParams({arg:t,...s}),headers:s.headers})).text()}return e}),createMv=configure(r=>{async function e(t,s,n={}){Array.isArray(t)||(t=[t]),await(await r.post("files/mv",{signal:n.signal,searchParams:toUrlSearchParams({arg:t.concat(s),...n}),headers:n.headers})).text()}return e});var source,hasRequiredSource;function requireSource(){return hasRequiredSource||(hasRequiredSource=1,source=r=>{if(r[Symbol.asyncIterator])return r;if(r.getReader)return async function*(){const e=r.getReader();try{for(;;){const{done:t,value:s}=await e.read();if(t)return;yield s}}finally{e.releaseLock()}}();throw new Error("unknown stream")}),source}var sourceExports=requireSource();const toIterable=getDefaultExportFromCjs(sourceExports),createRead=configure(r=>{async function*e(t,s={}){const n=await r.post("files/read",{signal:s.signal,searchParams:toUrlSearchParams({arg:t,count:s.length,...s}),headers:s.headers});yield*toIterable(n.body)}return e}),createRm$4=configure(r=>{async function e(t,s={}){const n=await r.post("files/rm",{signal:s.signal,searchParams:toUrlSearchParams({arg:t,...s}),headers:s.headers}),i=await n.text();if(i!==""){const o=new HTTP.HTTPError(n);throw o.message=i,o}}return e}),createStat$2=configure(r=>{async function e(t,s={}){const i=await(await r.post("files/stat",{signal:s.signal,searchParams:toUrlSearchParams({arg:t,...s}),headers:s.headers})).json();return i.WithLocality=i.WithLocality||!1,toCoreInterface$1(objectToCamelWithMetadata(i))}return e});function toCoreInterface$1(r){return r.cid=CID$1.parse(r.hash),delete r.hash,r}const createTouch=configure(r=>{async function e(t,s={}){await(await r.post("files/touch",{signal:s.signal,searchParams:toUrlSearchParams({arg:t,...s}),headers:s.headers})).text()}return e}),createWrite=configure(r=>{async function e(t,s,n={}){const i=new AbortController,o=abortSignal(i.signal,n.signal);await(await r.post("files/write",{signal:o,searchParams:toUrlSearchParams({arg:t,streamChannels:!0,count:n.length,...n}),...await multipartRequest([{content:s,path:"arg",mode:modeToString$1(n.mode),mtime:parseMtime$1(n.mtime)}],i,n.headers)})).text()}return e});function createFiles(r){return{chmod:createChmod(r),cp:createCp(r),flush:createFlush(r),ls:createLs$6(r),mkdir:createMkdir(r),mv:createMv(r),read:createRead(r),rm:createRm$4(r),stat:createStat$2(r),touch:createTouch(r),write:createWrite(r)}}const createExport=configure(r=>async(t,s,n={})=>{throw errCode(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),createGen=configure(r=>{async function e(t,s){const n=s??{type:"Ed25519"},o=await(await r.post("key/gen",{signal:n.signal,searchParams:toUrlSearchParams({arg:t,...n}),headers:n.headers})).json();return objectToCamel(o)}return e}),createImport=configure(r=>{async function e(t,s,n,i={}){const a=await(await r.post("key/import",{signal:i.signal,searchParams:toUrlSearchParams({arg:t,pem:s,password:n,...i}),headers:i.headers})).json();return objectToCamel(a)}return e}),createInfo=configure(r=>async(t,s={})=>{throw errCode(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),createList=configure(r=>{async function e(t={}){return((await(await r.post("key/list",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers})).json()).Keys||[]).map(i=>objectToCamel(i))}return e}),createRename=configure(r=>{async function e(t,s,n={}){const i=await r.post("key/rename",{signal:n.signal,searchParams:toUrlSearchParams({arg:[t,s],...n}),headers:n.headers});return objectToCamel(await i.json())}return e}),createRm$3=configure(r=>{async function e(t,s={}){const i=await(await r.post("key/rm",{signal:s.signal,searchParams:toUrlSearchParams({arg:t,...s}),headers:s.headers})).json();return objectToCamel(i.Keys[0])}return e});function createKey(r){return{export:createExport(r),gen:createGen(r),import:createImport(r),info:createInfo(r),list:createList(r),rename:createRename(r),rm:createRm$3(r)}}const createLevel=configure(r=>{async function e(t,s,n={}){const i=await r.post("log/level",{signal:n.signal,searchParams:toUrlSearchParams({arg:[t,s],...n}),headers:n.headers});return objectToCamel(await i.json())}return e}),createLs$5=configure(r=>{async function e(t={}){return(await(await r.post("log/ls",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers})).json()).Strings}return e}),createTail=configure(r=>{async function*e(t={}){yield*(await r.post("log/tail",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers})).ndjson()}return e});function createLog(r){return{level:createLevel(r),ls:createLs$5(r),tail:createTail(r)}}const createPublish$1=configure(r=>{async function e(t,s={}){const n=await r.post("name/publish",{signal:s.signal,searchParams:toUrlSearchParams({arg:`${t}`,...s}),headers:s.headers});return objectToCamel(await n.json())}return e}),createResolve$1=configure(r=>{async function*e(t,s={}){const n=await r.post("name/resolve",{signal:s.signal,searchParams:toUrlSearchParams({arg:t,stream:!0,...s}),headers:s.headers});for await(const i of n.ndjson())yield i.Path}return e}),createCancel=configure(r=>{async function e(t,s={}){const n=await r.post("name/pubsub/cancel",{signal:s.signal,searchParams:toUrlSearchParams({arg:t,...s}),headers:s.headers});return objectToCamel(await n.json())}return e}),createState=configure(r=>{async function e(t={}){const s=await r.post("name/pubsub/state",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers});return objectToCamel(await s.json())}return e}),createSubs=configure(r=>{async function e(t={}){return(await(await r.post("name/pubsub/subs",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers})).json()).Strings||[]}return e});function createPubsub$1(r){return{cancel:createCancel(r),state:createState(r),subs:createSubs(r)}}function createName(r){return{publish:createPublish$1(r),resolve:createResolve$1(r),pubsub:createPubsub$1(r)}}const createData=configure(r=>{async function e(t,s={}){const i=await(await r.post("object/data",{signal:s.signal,searchParams:toUrlSearchParams({arg:`${t instanceof Uint8Array?CID$1.decode(t):t}`,...s}),headers:s.headers})).arrayBuffer();return new Uint8Array(i,0,i.byteLength)}return e}),createGet$1=configure(r=>{async function e(t,s={}){const i=await(await r.post("object/get",{signal:s.signal,searchParams:toUrlSearchParams({arg:`${t instanceof Uint8Array?CID$1.decode(t):t}`,dataEncoding:"base64",...s}),headers:s.headers})).json();return{Data:fromString$3(i.Data,"base64pad"),Links:(i.Links||[]).map(o=>({Name:o.Name,Hash:CID$1.parse(o.Hash),Tsize:o.Size}))}}return e}),createLinks=configure(r=>{async function e(t,s={}){return((await(await r.post("object/links",{signal:s.signal,searchParams:toUrlSearchParams({arg:`${t instanceof Uint8Array?CID$1.decode(t):t}`,...s}),headers:s.headers})).json()).Links||[]).map(o=>({Name:o.Name,Tsize:o.Size,Hash:CID$1.parse(o.Hash)}))}return e}),createNew=configure(r=>{async function e(t={}){const s=await r.post("object/new",{signal:t.signal,searchParams:toUrlSearchParams({arg:t.template,...t}),headers:t.headers}),{Hash:n}=await s.json();return CID$1.parse(n)}return e}),createPut=(r,e)=>configure(s=>{const n=createPut$2(r,e);async function i(o,a={}){return n(o,{...a,storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})}return i})(e),createStat$1=configure(r=>{async function e(t,s={}){const i=await(await r.post("object/stat",{signal:s.signal,searchParams:toUrlSearchParams({arg:`${t}`,...s}),headers:s.headers})).json();return{...i,Hash:CID$1.parse(i.Hash)}}return e}),createAddLink=configure(r=>{async function e(t,s,n={}){const i=await r.post("object/patch/add-link",{signal:n.signal,searchParams:toUrlSearchParams({arg:[`${t}`,s.Name||s.name||"",(s.Hash||s.cid||"").toString()||null],...n}),headers:n.headers}),{Hash:o}=await i.json();return CID$1.parse(o)}return e}),createAppendData=configure(r=>{async function e(t,s,n={}){const i=new AbortController,o=abortSignal(i.signal,n.signal),a=await r.post("object/patch/append-data",{signal:o,searchParams:toUrlSearchParams({arg:`${t}`,...n}),...await multipartRequest([s],i,n.headers)}),{Hash:l}=await a.json();return CID$1.parse(l)}return e}),createRmLink=configure(r=>{async function e(t,s,n={}){const i=await r.post("object/patch/rm-link",{signal:n.signal,searchParams:toUrlSearchParams({arg:[`${t}`,s.Name||s.name||null],...n}),headers:n.headers}),{Hash:o}=await i.json();return CID$1.parse(o)}return e}),createSetData=configure(r=>{async function e(t,s,n={}){const i=new AbortController,o=abortSignal(i.signal,n.signal),a=await r.post("object/patch/set-data",{signal:o,searchParams:toUrlSearchParams({arg:[`${t}`],...n}),...await multipartRequest([s],i,n.headers)}),{Hash:l}=await a.json();return CID$1.parse(l)}return e});function createPatch(r){return{addLink:createAddLink(r),appendData:createAppendData(r),rmLink:createRmLink(r),setData:createSetData(r)}}function createObject(r,e){return{data:createData(e),get:createGet$1(e),links:createLinks(e),new:createNew(e),put:createPut(r,e),stat:createStat$1(e),patch:createPatch(e)}}function isIterable(r){return Symbol.iterator in r}function isAsyncIterable(r){return Symbol.asyncIterator in r}function isCID(r){return CID$1.asCID(r)!=null}async function*normaliseInput$1(r){if(r==null)throw errCode(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT");const e=CID$1.asCID(r);if(e){yield toPin$1({cid:e});return}if(r instanceof String||typeof r=="string"){yield toPin$1({path:r});return}if(r.cid!=null||r.path!=null)return yield toPin$1(r);if(isIterable(r)){const t=r[Symbol.iterator](),s=t.next();if(s.done)return t;if(isCID(s.value)){yield toPin$1({cid:s.value});for(const n of t)yield toPin$1({cid:n});return}if(s.value instanceof String||typeof s.value=="string"){yield toPin$1({path:s.value});for(const n of t)yield toPin$1({path:n});return}if(s.value.cid!=null||s.value.path!=null){yield toPin$1(s.value);for(const n of t)yield toPin$1(n);return}throw errCode(new Error("Unexpected input: "+typeof r),"ERR_UNEXPECTED_INPUT")}if(isAsyncIterable(r)){const t=r[Symbol.asyncIterator](),s=await t.next();if(s.done)return t;if(isCID(s.value)){yield toPin$1({cid:s.value});for await(const n of t)yield toPin$1({cid:n});return}if(s.value instanceof String||typeof s.value=="string"){yield toPin$1({path:s.value});for await(const n of t)yield toPin$1({path:n});return}if(s.value.cid!=null||s.value.path!=null){yield toPin$1(s.value);for await(const n of t)yield toPin$1(n);return}throw errCode(new Error("Unexpected input: "+typeof r),"ERR_UNEXPECTED_INPUT")}throw errCode(new Error("Unexpected input: "+typeof r),"ERR_UNEXPECTED_INPUT")}function toPin$1(r){const e=r.cid||`${r.path}`;if(!e)throw errCode(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");const t={path:e,recursive:r.recursive!==!1};return r.metadata!=null&&(t.metadata=r.metadata),t}const createAddAll$1=configure(r=>{async function*e(t,s={}){for await(const{path:n,recursive:i,metadata:o}of normaliseInput$1(t)){const a=await r.post("pin/add",{signal:s.signal,searchParams:toUrlSearchParams({...s,arg:n,recursive:i,metadata:o?JSON.stringify(o):void 0,stream:!0}),headers:s.headers});for await(const l of a.ndjson()){if(l.Pins){for(const p of l.Pins)yield CID$1.parse(p);continue}yield CID$1.parse(l)}}}return e});function createAdd$3(r){const e=createAddAll$1(r);return configure(()=>{async function t(s,n={}){return last(e([{path:s,...n}],n))}return t})(r)}function toPin(r,e,t){const s={type:r,cid:CID$1.parse(e)};return t&&(s.metadata=t),s}const createLs$4=configure(r=>{async function*e(t={}){let s=[];t.paths&&(s=Array.isArray(t.paths)?t.paths:[t.paths]);const n=await r.post("pin/ls",{signal:t.signal,searchParams:toUrlSearchParams({...t,arg:s.map(i=>`${i}`),stream:!0}),headers:t.headers});for await(const i of n.ndjson()){if(i.Keys){for(const o of Object.keys(i.Keys))yield toPin(i.Keys[o].Type,o,i.Keys[o].Metadata);return}yield toPin(i.Type,i.Cid,i.Metadata)}}return e}),createRmAll$1=configure(r=>{async function*e(t,s={}){for await(const{path:n,recursive:i}of normaliseInput$1(t)){const o=new URLSearchParams(s.searchParams);o.append("arg",`${n}`),i!=null&&o.set("recursive",String(i));const a=await r.post("pin/rm",{signal:s.signal,headers:s.headers,searchParams:toUrlSearchParams({...s,arg:`${n}`,recursive:i})});for await(const l of a.ndjson()){if(l.Pins){yield*l.Pins.map(p=>CID$1.parse(p));continue}yield CID$1.parse(l)}}}return e}),createRm$2=r=>{const e=createRmAll$1(r);return configure(()=>{async function t(s,n={}){return last(e([{path:s,...n}],n))}return t})(r)},decodePin=({Name:r,Status:e,Cid:t})=>({cid:CID$1.parse(t),name:r,status:e}),encodeService=r=>{if(typeof r=="string"&&r!=="")return r;throw new TypeError("service name must be passed")},encodeCID=r=>{if(CID$1.asCID(r))return r.toString();throw new TypeError(`CID instance expected instead of ${typeof r}`)},encodeQuery=({service:r,cid:e,name:t,status:s,all:n})=>{const i=toUrlSearchParams({service:encodeService(r),name:t,force:n?!0:void 0});if(e)for(const o of e)i.append("cid",encodeCID(o));if(s)for(const o of s)i.append("status",o);return i},encodeAddParams=({cid:r,service:e,background:t,name:s,origins:n})=>{const i=toUrlSearchParams({arg:encodeCID(r),service:encodeService(e),name:s,background:t?!0:void 0});if(n)for(const o of n)i.append("origin",o.toString());return i};function createAdd$2(r){async function e(t,{timeout:s,signal:n,headers:i,...o}){const a=await r.post("pin/remote/add",{timeout:s,signal:n,headers:i,searchParams:encodeAddParams({cid:t,...o})});return decodePin(await a.json())}return e}function createLs$3(r){async function*e({timeout:t,signal:s,headers:n,...i}){const o=await r.post("pin/remote/ls",{timeout:t,signal:s,headers:n,searchParams:encodeQuery(i)});for await(const a of o.ndjson())yield decodePin(a)}return e}function createRm$1(r){async function e({timeout:t,signal:s,headers:n,...i}){await r.post("pin/remote/rm",{timeout:t,signal:s,headers:n,searchParams:encodeQuery({...i,all:!1})})}return e}function createRmAll(r){async function e({timeout:t,signal:s,headers:n,...i}){await r.post("pin/remote/rm",{timeout:t,signal:s,headers:n,searchParams:encodeQuery({...i,all:!0})})}return e}function encodeEndpoint(r){const e=String(r);if(e==="undefined")throw Error("endpoint is required");return e[e.length-1]==="/"?e.slice(0,-1):e}function decodeRemoteService(r){return{service:r.Service,endpoint:new URL(r.ApiEndpoint),...r.Stat&&{stat:decodeStat(r.Stat)}}}function decodeStat(r){switch(r.Status){case"valid":{const{Pinning:e,Pinned:t,Queued:s,Failed:n}=r.PinCount;return{status:"valid",pinCount:{queued:s,pinning:e,pinned:t,failed:n}}}case"invalid":return{status:"invalid"};default:return{status:r.Status}}}function createAdd$1(r){async function e(t,s){const{endpoint:n,key:i,headers:o,timeout:a,signal:l}=s;await r.post("pin/remote/service/add",{timeout:a,signal:l,searchParams:toUrlSearchParams({arg:[t,encodeEndpoint(n),i]}),headers:o})}return e}function createLs$2(r){async function e(t={}){const{stat:s,headers:n,timeout:i,signal:o}=t,a=await r.post("pin/remote/service/ls",{timeout:i,signal:o,headers:n,searchParams:s===!0?toUrlSearchParams({stat:s}):void 0}),{RemoteServices:l}=await a.json();return l.map(decodeRemoteService)}return e}function createRm(r){async function e(t,s={}){await r.post("pin/remote/service/rm",{signal:s.signal,headers:s.headers,searchParams:toUrlSearchParams({arg:t})})}return e}function createService(r){const e=new Client(r);return{add:createAdd$1(e),ls:createLs$2(e),rm:createRm(e)}}function createRemote(r){const e=new Client(r);return{add:createAdd$2(e),ls:createLs$3(e),rm:createRm$1(e),rmAll:createRmAll(e),service:createService(r)}}function createPin(r){return{addAll:createAddAll$1(r),add:createAdd$3(r),ls:createLs$4(r),rmAll:createRmAll$1(r),rm:createRm$2(r),remote:createRemote(r)}}const rpcArrayToTextArray=r=>Array.isArray(r)?r.map(rpcToText):r,rpcToText=r=>toString$3(rpcToBytes(r)),rpcToBytes=r=>base64url$2.decode(r),rpcToBigInt=r=>BigInt(`0x${toString$3(base64url$2.decode(r),"base16")}`),textToUrlSafeRpc=r=>base64url$2.encode(fromString$3(r)),createLs$1=configure(r=>{async function e(t={}){const{Strings:s}=await(await r.post("pubsub/ls",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers})).json();return rpcArrayToTextArray(s)||[]}return e}),createPeers$1=configure(r=>{async function e(t,s={}){const n=await r.post("pubsub/peers",{signal:s.signal,searchParams:toUrlSearchParams({arg:textToUrlSafeRpc(t),...s}),headers:s.headers}),{Strings:i}=await n.json();return i||[]}return e}),createPublish=configure(r=>{async function e(t,s,n={}){const i=toUrlSearchParams({arg:textToUrlSafeRpc(t),...n}),o=new AbortController,a=abortSignal(o.signal,n.signal);await(await r.post("pubsub/pub",{signal:a,searchParams:i,...await multipartRequest([s],o,n.headers)})).text()}return e}),log$1=logger$1("ipfs-http-client:pubsub:subscribe"),createSubscribe=(r,e)=>configure(t=>{async function s(n,i,o={}){o.signal=e.subscribe(n,i,o.signal);let a,l;const p=new Promise((x,b)=>{a=x,l=b}),g=setTimeout(()=>a(),1e3);return t.post("pubsub/sub",{signal:o.signal,searchParams:toUrlSearchParams({arg:textToUrlSafeRpc(n),...o}),headers:o.headers}).catch(x=>{e.unsubscribe(n,i),l(x)}).then(x=>{clearTimeout(g),x&&(readMessages(x,{onMessage:b=>{if(i){if(typeof i=="function"){i(b);return}typeof i.handleEvent=="function"&&i.handleEvent(b)}},onEnd:()=>e.unsubscribe(n,i),onError:o.onError}),a())}),p}return s})(r);async function readMessages(r,{onMessage:e,onEnd:t,onError:s}){s=s||log$1;try{for await(const n of r.ndjson())try{if(!n.from)continue;n.from!=null&&n.seqno!=null?e({type:"signed",from:peerIdFromString(n.from),data:rpcToBytes(n.data),sequenceNumber:rpcToBigInt(n.seqno),topic:rpcToText(n.topicIDs[0]),key:rpcToBytes(n.key??"u"),signature:rpcToBytes(n.signature??"u")}):e({type:"unsigned",data:rpcToBytes(n.data),topic:rpcToText(n.topicIDs[0])})}catch(i){i.message=`Failed to parse pubsub message: ${i.message}`,s(i,!1,n)}}catch(n){isAbortError(n)||s(n,!0)}finally{t()}}const isAbortError=r=>{switch(r.type){case"aborted":return!0;case"abort":return!0;default:return r.name==="AbortError"}},createUnsubscribe=(r,e)=>{async function t(s,n){e.unsubscribe(s,n)}return t};class SubscriptionTracker{constructor(){this._subs=new Map}subscribe(e,t,s){const n=this._subs.get(e)||[];if(n.find(o=>o.handler===t))throw new Error(`Already subscribed to ${e} with this handler`);const i=new AbortController;return this._subs.set(e,[{handler:t,controller:i}].concat(n)),s&&s.addEventListener("abort",()=>this.unsubscribe(e,t)),i.signal}unsubscribe(e,t){const s=this._subs.get(e)||[];let n;t?(this._subs.set(e,s.filter(i=>i.handler!==t)),n=s.filter(i=>i.handler===t)):(this._subs.set(e,[]),n=s),(this._subs.get(e)||[]).length||this._subs.delete(e),n.forEach(i=>i.controller.abort())}}function createPubsub(r){const e=new SubscriptionTracker;return{ls:createLs$1(r),peers:createPeers$1(r),publish:createPublish(r),subscribe:createSubscribe(r,e),unsubscribe:createUnsubscribe(r,e)}}const createLocal=configure(r=>{async function*e(t={}){yield*(await r.post("refs/local",{signal:t.signal,transform:objectToCamel,searchParams:toUrlSearchParams(t),headers:t.headers})).ndjson()}return e}),createRefs=configure((r,e)=>Object.assign(async function*(s,n={}){const i=Array.isArray(s)?s:[s];yield*(await r.post("refs",{signal:n.signal,searchParams:toUrlSearchParams({arg:i.map(a=>`${a instanceof Uint8Array?CID$1.decode(a):a}`),...n}),headers:n.headers,transform:objectToCamel})).ndjson()},{local:createLocal(e)})),createGc=configure(r=>{async function*e(t={}){yield*(await r.post("repo/gc",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers,transform:n=>({err:n.Error?new Error(n.Error):null,cid:(n.Key||{})["/"]?CID$1.parse(n.Key["/"]):null})})).ndjson()}return e}),createStat=configure(r=>{async function e(t={}){const n=await(await r.post("repo/stat",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers})).json();return{numObjects:BigInt(n.NumObjects),repoSize:BigInt(n.RepoSize),repoPath:n.RepoPath,version:n.Version,storageMax:BigInt(n.StorageMax)}}return e}),createVersion$1=configure(r=>{async function e(t={}){return(await(await r.post("repo/version",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers})).json()).Version}return e});function createRepo(r){return{gc:createGc(r),stat:createStat(r),version:createVersion$1(r)}}const createBw=configure(r=>{async function*e(t={}){yield*(await r.post("stats/bw",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers,transform:n=>({totalIn:BigInt(n.TotalIn),totalOut:BigInt(n.TotalOut),rateIn:parseFloat(n.RateIn),rateOut:parseFloat(n.RateOut)})})).ndjson()}return e});function createStats(r){return{bitswap:createStat$4(r),repo:createStat(r),bw:createBw(r)}}const createAddrs=configure(r=>{async function e(t={}){const s=await r.post("swarm/addrs",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers}),{Addrs:n}=await s.json();return Object.keys(n).map(i=>({id:peerIdFromString(i),addrs:(n[i]||[]).map(o=>multiaddr$1(o))}))}return e}),createConnect=configure(r=>{async function e(t,s={}){const n=await r.post("swarm/connect",{signal:s.signal,searchParams:toUrlSearchParams({arg:t,...s}),headers:s.headers}),{Strings:i}=await n.json();return i||[]}return e}),createDisconnect=configure(r=>{async function e(t,s={}){const n=await r.post("swarm/disconnect",{signal:s.signal,searchParams:toUrlSearchParams({arg:t,...s}),headers:s.headers}),{Strings:i}=await n.json();return i||[]}return e}),createLocalAddrs=configure(r=>{async function e(t={}){const s=await r.post("swarm/addrs/local",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers}),{Strings:n}=await s.json();return(n||[]).map(i=>multiaddr$1(i))}return e}),createPeers=configure(r=>{async function e(t={}){const s=await r.post("swarm/peers",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers}),{Peers:n}=await s.json();return(n||[]).map(i=>({addr:multiaddr$1(i.Addr),peer:peerIdFromString(i.Peer),muxer:i.Muxer,latency:i.Latency,streams:i.Streams,direction:i.Direction==null?void 0:i.Direction===0?"inbound":"outbound"}))}return e});function createSwarm(r){return{addrs:createAddrs(r),connect:createConnect(r),disconnect:createDisconnect(r),localAddrs:createLocalAddrs(r),peers:createPeers(r)}}const createAddAll=configure(r=>{async function*e(t,s={}){const n=new AbortController,i=abortSignal(n.signal,s.signal),{headers:o,body:a,total:l,parts:p}=await multipartRequest(t,n,s.headers),[g,x]=typeof s.progress=="function"?createProgressHandler(l,p,s.progress):[void 0,void 0],b=await r.post("add",{searchParams:toUrlSearchParams({"stream-channels":!0,...s,progress:!!g}),onUploadProgress:x,signal:i,headers:o,body:a});for await(let E of b.ndjson())E=objectToCamel(E),E.hash!==void 0?yield toCoreInterface(E):g&&g(E.bytes||0,E.name)}return e}),createProgressHandler=(r,e,t)=>e?[void 0,createOnUploadProgress(r,e,t)]:[t,void 0],createOnUploadProgress=(r,e,t)=>{let s=0;const n=e.length;return({loaded:i,total:o})=>{const a=Math.floor(i/o*r);for(;s<n;){const{start:l,end:p,name:g}=e[s];if(a<p){t(a-l,g);break}else t(p-l,g),s+=1}}};function toCoreInterface({name:r,hash:e,size:t,mode:s,mtime:n,mtimeNsecs:i}){const o={path:r,cid:CID$1.parse(e),size:parseInt(t)};return s!=null&&(o.mode=parseInt(s,8)),n!=null&&(o.mtime={secs:n,nsecs:i||0}),o}function blobToIt(r){return typeof r.stream=="function"?browserReadableStreamToIt(r.stream()):browserReadableStreamToIt(new Response(r).body)}async function*toAsyncIterable(r){yield r}async function normaliseContent(r){if(isBytes(r))return toAsyncIterable(toBytes(r));if(typeof r=="string"||r instanceof String)return toAsyncIterable(toBytes(r.toString()));if(isBlob(r))return blobToIt(r);if(isReadableStream(r)&&(r=browserReadableStreamToIt(r)),Symbol.iterator in r||Symbol.asyncIterator in r){const e=peekableIterator(r),{value:t,done:s}=await e.peek();if(s)return toAsyncIterable(new Uint8Array(0));if(e.push(t),Number.isInteger(t))return toAsyncIterable(Uint8Array.from(await all(e)));if(isBytes(t)||typeof t=="string"||t instanceof String)return map(e,toBytes)}throw errCode(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT")}function toBytes(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r instanceof ArrayBuffer?new Uint8Array(r):Array.isArray(r)?Uint8Array.from(r):fromString$3(r.toString())}async function*normaliseCandidateSingle(r,e){if(r==null)throw errCode(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT");if(typeof r=="string"||r instanceof String){yield toFileObject(r.toString(),e);return}if(isBytes(r)||isBlob(r)){yield toFileObject(r,e);return}if(isReadableStream(r)&&(r=browserReadableStreamToIt(r)),Symbol.iterator in r||Symbol.asyncIterator in r){const t=peekableIterator(r),{value:s,done:n}=await t.peek();if(n){yield{content:[]};return}if(t.push(s),Number.isInteger(s)||isBytes(s)||typeof s=="string"||s instanceof String){yield toFileObject(t,e);return}throw errCode(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(isFileObject(r)){yield toFileObject(r,e);return}throw errCode(new Error('Unexpected input: cannot convert "'+typeof r+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT")}async function toFileObject(r,e){const{path:t,mode:s,mtime:n,content:i}=r,o={path:t||"",mode:parseMode(s),mtime:parseMtime(n)};return i?o.content=await e(i):t||(o.content=await e(r)),o}function normaliseInput(r){return normaliseCandidateSingle(r,normaliseContent)}function createAdd(r){const e=createAddAll(r);return configure(()=>{async function t(s,n={}){return await last(e(normaliseInput(s),n))}return t})(r)}const createCat=configure(r=>{async function*e(t,s={}){yield*(await r.post("cat",{signal:s.signal,searchParams:toUrlSearchParams({arg:t.toString(),...s}),headers:s.headers})).iterator()}return e}),createCommands=configure(r=>async(t={})=>(await r.post("commands",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers})).json()),createDns=configure(r=>async(t,s={})=>(await(await r.post("dns",{signal:s.signal,searchParams:toUrlSearchParams({arg:t,...s}),headers:s.headers})).json()).Path),createGetEndpointConfig=configure(r=>()=>{const e=new URL(r.opts.base||"");return{host:e.hostname,port:e.port,protocol:e.protocol,pathname:e.pathname,"api-path":e.pathname}}),createGet=configure(r=>{async function*e(t,s={}){const n={arg:`${t instanceof Uint8Array?CID$1.decode(t):t}`,...s};n.compressionLevel&&(n["compression-level"]=n.compressionLevel,delete n.compressionLevel),yield*(await r.post("get",{signal:s.signal,searchParams:toUrlSearchParams(n),headers:s.headers})).iterator()}return e}),createId=configure(r=>{async function e(t={}){const n=await(await r.post("id",{signal:t.signal,searchParams:toUrlSearchParams({arg:t.peerId?t.peerId.toString():void 0,...t}),headers:t.headers})).json(),i={...objectToCamel(n)};return i.id=peerIdFromString(i.id),i.addresses&&(i.addresses=i.addresses.map(o=>multiaddr$1(o))),i}return e}),createIsOnline=r=>{const e=createId(r);async function t(s={}){const n=await e(s);return!!(n&&n.addresses&&n.addresses.length)}return t},createLs=configure((r,e)=>{async function*t(s,n={}){const i=`${s instanceof Uint8Array?CID$1.decode(s):s}`;async function o(l){let p=l.Hash;if(p.includes("/")){const x=p.startsWith("/ipfs/")?p:`/ipfs/${p}`;p=(await createStat$2(e)(x)).cid}else p=CID$1.parse(p);const g={name:l.Name,path:i+(l.Name?`/${l.Name}`:""),size:l.Size,cid:p,type:typeOf(l)};return l.Mode&&(g.mode=parseInt(l.Mode,8)),l.Mtime!==void 0&&l.Mtime!==null&&(g.mtime={secs:l.Mtime},l.MtimeNsecs!==void 0&&l.MtimeNsecs!==null&&(g.mtime.nsecs=l.MtimeNsecs)),g}const a=await r.post("ls",{signal:n.signal,searchParams:toUrlSearchParams({arg:i,...n}),headers:n.headers});for await(let l of a.ndjson()){if(l=l.Objects,!l)throw new Error("expected .Objects in results");if(l=l[0],!l)throw new Error("expected one array in results.Objects");const p=l.Links;if(!Array.isArray(p))throw new Error("expected one array in results.Objects[0].Links");if(!p.length){yield o(l);return}yield*p.map(o)}}return t});function typeOf(r){switch(r.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}const createMount=configure(r=>{async function e(t={}){const s=await r.post("dns",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers});return objectToCamel(await s.json())}return e}),createPing=configure(r=>{async function*e(t,s={}){yield*(await r.post("ping",{signal:s.signal,searchParams:toUrlSearchParams({arg:`${t}`,...s}),headers:s.headers,transform:objectToCamel})).ndjson()}return e}),createResolve=configure(r=>{async function e(t,s={}){const n=await r.post("resolve",{signal:s.signal,searchParams:toUrlSearchParams({arg:t,...s}),headers:s.headers}),{Path:i}=await n.json();return i}return e}),createStart=configure(r=>async(t={})=>{throw errCode(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),createStop=configure(r=>{async function e(t={}){await(await r.post("shutdown",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers})).text()}return e}),createVersion=configure(r=>{async function e(t={}){const s=await r.post("version",{signal:t.signal,searchParams:toUrlSearchParams(t),headers:t.headers});return{...objectToCamel(await s.json()),"ipfs-http-client":"1.0.0"}}return e});var urlSource_1,hasRequiredUrlSource;function requireUrlSource(){if(hasRequiredUrlSource)return urlSource_1;hasRequiredUrlSource=1;const r=requireHttp(),e=(s,n)=>({path:decodeURIComponent(new URL(s).pathname.split("/").pop()||""),content:t(s,n)});async function*t(s,n){yield*(await new r().get(s,n)).iterator()}return urlSource_1=e,urlSource_1}requireUrlSource();function create(r={}){const e={name:identity$3.name,code:identity$3.code,encode:p=>p,decode:p=>p},t=Object.values(bases$2);(r.ipld&&r.ipld.bases?r.ipld.bases:[]).forEach(p=>t.push(p));const s=new Multibases({bases:t,loadBase:r.ipld&&r.ipld.loadBase}),n=Object.values(codecs$1);[dagPB,dagCBOR,dagJSON,dagJOSE,e].concat(r.ipld&&r.ipld.codecs||[]).forEach(p=>n.push(p));const i=new Multicodecs({codecs:n,loadCodec:r.ipld&&r.ipld.loadCodec}),o=Object.values(hashes);(r.ipld&&r.ipld.hashers?r.ipld.hashers:[]).forEach(p=>o.push(p));const a=new Multihashes({hashers:o,loadHasher:r.ipld&&r.ipld.loadHasher});return{add:createAdd(r),addAll:createAddAll(r),bitswap:createBitswap(r),block:createBlock(r),bootstrap:createBootstrap(r),cat:createCat(r),commands:createCommands(r),config:createConfig(r),dag:createDag(i,r),dht:createDht(r),diag:createDiag(r),dns:createDns(r),files:createFiles(r),get:createGet(r),getEndpointConfig:createGetEndpointConfig(r),id:createId(r),isOnline:createIsOnline(r),key:createKey(r),log:createLog(r),ls:createLs(r),mount:createMount(r),name:createName(r),object:createObject(i,r),pin:createPin(r),ping:createPing(r),pubsub:createPubsub(r),refs:createRefs(r),repo:createRepo(r),resolve:createResolve(r),start:createStart(r),stats:createStats(r),stop:createStop(r),swarm:createSwarm(r),version:createVersion(r),bases:s,codecs:i,hashers:a}}var buffer={},base64Js={},hasRequiredBase64Js;function requireBase64Js(){if(hasRequiredBase64Js)return base64Js;hasRequiredBase64Js=1,base64Js.byteLength=a,base64Js.toByteArray=p,base64Js.fromByteArray=b;for(var r=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=0,i=s.length;n<i;++n)r[n]=s[n],e[s.charCodeAt(n)]=n;e[45]=62,e[95]=63;function o(E){var f=E.length;if(f%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var j=E.indexOf("=");j===-1&&(j=f);var C=j===f?0:4-j%4;return[j,C]}function a(E){var f=o(E),j=f[0],C=f[1];return(j+C)*3/4-C}function l(E,f,j){return(f+j)*3/4-j}function p(E){var f,j=o(E),C=j[0],S=j[1],R=new t(l(E,C,S)),I=0,A=S>0?C-4:C,$;for($=0;$<A;$+=4)f=e[E.charCodeAt($)]<<18|e[E.charCodeAt($+1)]<<12|e[E.charCodeAt($+2)]<<6|e[E.charCodeAt($+3)],R[I++]=f>>16&255,R[I++]=f>>8&255,R[I++]=f&255;return S===2&&(f=e[E.charCodeAt($)]<<2|e[E.charCodeAt($+1)]>>4,R[I++]=f&255),S===1&&(f=e[E.charCodeAt($)]<<10|e[E.charCodeAt($+1)]<<4|e[E.charCodeAt($+2)]>>2,R[I++]=f>>8&255,R[I++]=f&255),R}function g(E){return r[E>>18&63]+r[E>>12&63]+r[E>>6&63]+r[E&63]}function x(E,f,j){for(var C,S=[],R=f;R<j;R+=3)C=(E[R]<<16&16711680)+(E[R+1]<<8&65280)+(E[R+2]&255),S.push(g(C));return S.join("")}function b(E){for(var f,j=E.length,C=j%3,S=[],R=16383,I=0,A=j-C;I<A;I+=R)S.push(x(E,I,I+R>A?A:I+R));return C===1?(f=E[j-1],S.push(r[f>>2]+r[f<<4&63]+"==")):C===2&&(f=(E[j-2]<<8)+E[j-1],S.push(r[f>>10]+r[f>>4&63]+r[f<<2&63]+"=")),S.join("")}return base64Js}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var hasRequiredIeee754;function requireIeee754(){return hasRequiredIeee754||(hasRequiredIeee754=1,ieee754.read=function(r,e,t,s,n){var i,o,a=n*8-s-1,l=(1<<a)-1,p=l>>1,g=-7,x=t?n-1:0,b=t?-1:1,E=r[e+x];for(x+=b,i=E&(1<<-g)-1,E>>=-g,g+=a;g>0;i=i*256+r[e+x],x+=b,g-=8);for(o=i&(1<<-g)-1,i>>=-g,g+=s;g>0;o=o*256+r[e+x],x+=b,g-=8);if(i===0)i=1-p;else{if(i===l)return o?NaN:(E?-1:1)*(1/0);o=o+Math.pow(2,s),i=i-p}return(E?-1:1)*o*Math.pow(2,i-s)},ieee754.write=function(r,e,t,s,n,i){var o,a,l,p=i*8-n-1,g=(1<<p)-1,x=g>>1,b=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=s?0:i-1,f=s?1:-1,j=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=g):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+x>=1?e+=b/l:e+=b*Math.pow(2,1-x),e*l>=2&&(o++,l/=2),o+x>=g?(a=0,o=g):o+x>=1?(a=(e*l-1)*Math.pow(2,n),o=o+x):(a=e*Math.pow(2,x-1)*Math.pow(2,n),o=0));n>=8;r[t+E]=a&255,E+=f,a/=256,n-=8);for(o=o<<n|a,p+=n;p>0;r[t+E]=o&255,E+=f,o/=256,p-=8);r[t+E-f]|=j*128}),ieee754}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var hasRequiredBuffer;function requireBuffer(){return hasRequiredBuffer||(hasRequiredBuffer=1,function(r){const e=requireBase64Js(),t=requireIeee754(),s=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=a,r.SlowBuffer=R,r.INSPECT_MAX_BYTES=50;const n=2147483647;r.kMaxLength=n,a.TYPED_ARRAY_SUPPORT=i(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{const w=new Uint8Array(1),c={foo:function(){return 42}};return Object.setPrototypeOf(c,Uint8Array.prototype),Object.setPrototypeOf(w,c),w.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(w){if(w>n)throw new RangeError('The value "'+w+'" is invalid for option "size"');const c=new Uint8Array(w);return Object.setPrototypeOf(c,a.prototype),c}function a(w,c,u){if(typeof w=="number"){if(typeof c=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return x(w)}return l(w,c,u)}a.poolSize=8192;function l(w,c,u){if(typeof w=="string")return b(w,c);if(ArrayBuffer.isView(w))return f(w);if(w==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof w);if(ge(w,ArrayBuffer)||w&&ge(w.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ge(w,SharedArrayBuffer)||w&&ge(w.buffer,SharedArrayBuffer)))return j(w,c,u);if(typeof w=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const v=w.valueOf&&w.valueOf();if(v!=null&&v!==w)return a.from(v,c,u);const T=C(w);if(T)return T;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof w[Symbol.toPrimitive]=="function")return a.from(w[Symbol.toPrimitive]("string"),c,u);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof w)}a.from=function(w,c,u){return l(w,c,u)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function p(w){if(typeof w!="number")throw new TypeError('"size" argument must be of type number');if(w<0)throw new RangeError('The value "'+w+'" is invalid for option "size"')}function g(w,c,u){return p(w),w<=0?o(w):c!==void 0?typeof u=="string"?o(w).fill(c,u):o(w).fill(c):o(w)}a.alloc=function(w,c,u){return g(w,c,u)};function x(w){return p(w),o(w<0?0:S(w)|0)}a.allocUnsafe=function(w){return x(w)},a.allocUnsafeSlow=function(w){return x(w)};function b(w,c){if((typeof c!="string"||c==="")&&(c="utf8"),!a.isEncoding(c))throw new TypeError("Unknown encoding: "+c);const u=I(w,c)|0;let v=o(u);const T=v.write(w,c);return T!==u&&(v=v.slice(0,T)),v}function E(w){const c=w.length<0?0:S(w.length)|0,u=o(c);for(let v=0;v<c;v+=1)u[v]=w[v]&255;return u}function f(w){if(ge(w,Uint8Array)){const c=new Uint8Array(w);return j(c.buffer,c.byteOffset,c.byteLength)}return E(w)}function j(w,c,u){if(c<0||w.byteLength<c)throw new RangeError('"offset" is outside of buffer bounds');if(w.byteLength<c+(u||0))throw new RangeError('"length" is outside of buffer bounds');let v;return c===void 0&&u===void 0?v=new Uint8Array(w):u===void 0?v=new Uint8Array(w,c):v=new Uint8Array(w,c,u),Object.setPrototypeOf(v,a.prototype),v}function C(w){if(a.isBuffer(w)){const c=S(w.length)|0,u=o(c);return u.length===0||w.copy(u,0,0,c),u}if(w.length!==void 0)return typeof w.length!="number"||_e(w.length)?o(0):E(w);if(w.type==="Buffer"&&Array.isArray(w.data))return E(w.data)}function S(w){if(w>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return w|0}function R(w){return+w!=w&&(w=0),a.alloc(+w)}a.isBuffer=function(c){return c!=null&&c._isBuffer===!0&&c!==a.prototype},a.compare=function(c,u){if(ge(c,Uint8Array)&&(c=a.from(c,c.offset,c.byteLength)),ge(u,Uint8Array)&&(u=a.from(u,u.offset,u.byteLength)),!a.isBuffer(c)||!a.isBuffer(u))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(c===u)return 0;let v=c.length,T=u.length;for(let _=0,F=Math.min(v,T);_<F;++_)if(c[_]!==u[_]){v=c[_],T=u[_];break}return v<T?-1:T<v?1:0},a.isEncoding=function(c){switch(String(c).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(c,u){if(!Array.isArray(c))throw new TypeError('"list" argument must be an Array of Buffers');if(c.length===0)return a.alloc(0);let v;if(u===void 0)for(u=0,v=0;v<c.length;++v)u+=c[v].length;const T=a.allocUnsafe(u);let _=0;for(v=0;v<c.length;++v){let F=c[v];if(ge(F,Uint8Array))_+F.length>T.length?(a.isBuffer(F)||(F=a.from(F)),F.copy(T,_)):Uint8Array.prototype.set.call(T,F,_);else if(a.isBuffer(F))F.copy(T,_);else throw new TypeError('"list" argument must be an Array of Buffers');_+=F.length}return T};function I(w,c){if(a.isBuffer(w))return w.length;if(ArrayBuffer.isView(w)||ge(w,ArrayBuffer))return w.byteLength;if(typeof w!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof w);const u=w.length,v=arguments.length>2&&arguments[2]===!0;if(!v&&u===0)return 0;let T=!1;for(;;)switch(c){case"ascii":case"latin1":case"binary":return u;case"utf8":case"utf-8":return Oe(w).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u*2;case"hex":return u>>>1;case"base64":return ke(w).length;default:if(T)return v?-1:Oe(w).length;c=(""+c).toLowerCase(),T=!0}}a.byteLength=I;function A(w,c,u){let v=!1;if((c===void 0||c<0)&&(c=0),c>this.length||((u===void 0||u>this.length)&&(u=this.length),u<=0)||(u>>>=0,c>>>=0,u<=c))return"";for(w||(w="utf8");;)switch(w){case"hex":return z(this,c,u);case"utf8":case"utf-8":return H(this,c,u);case"ascii":return G(this,c,u);case"latin1":case"binary":return Q(this,c,u);case"base64":return K(this,c,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J(this,c,u);default:if(v)throw new TypeError("Unknown encoding: "+w);w=(w+"").toLowerCase(),v=!0}}a.prototype._isBuffer=!0;function $(w,c,u){const v=w[c];w[c]=w[u],w[u]=v}a.prototype.swap16=function(){const c=this.length;if(c%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let u=0;u<c;u+=2)$(this,u,u+1);return this},a.prototype.swap32=function(){const c=this.length;if(c%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let u=0;u<c;u+=4)$(this,u,u+3),$(this,u+1,u+2);return this},a.prototype.swap64=function(){const c=this.length;if(c%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let u=0;u<c;u+=8)$(this,u,u+7),$(this,u+1,u+6),$(this,u+2,u+5),$(this,u+3,u+4);return this},a.prototype.toString=function(){const c=this.length;return c===0?"":arguments.length===0?H(this,0,c):A.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(c){if(!a.isBuffer(c))throw new TypeError("Argument must be a Buffer");return this===c?!0:a.compare(this,c)===0},a.prototype.inspect=function(){let c="";const u=r.INSPECT_MAX_BYTES;return c=this.toString("hex",0,u).replace(/(.{2})/g,"$1 ").trim(),this.length>u&&(c+=" ... "),"<Buffer "+c+">"},s&&(a.prototype[s]=a.prototype.inspect),a.prototype.compare=function(c,u,v,T,_){if(ge(c,Uint8Array)&&(c=a.from(c,c.offset,c.byteLength)),!a.isBuffer(c))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof c);if(u===void 0&&(u=0),v===void 0&&(v=c?c.length:0),T===void 0&&(T=0),_===void 0&&(_=this.length),u<0||v>c.length||T<0||_>this.length)throw new RangeError("out of range index");if(T>=_&&u>=v)return 0;if(T>=_)return-1;if(u>=v)return 1;if(u>>>=0,v>>>=0,T>>>=0,_>>>=0,this===c)return 0;let F=_-T,Y=v-u;const oe=Math.min(F,Y),ne=this.slice(T,_),ae=c.slice(u,v);for(let re=0;re<oe;++re)if(ne[re]!==ae[re]){F=ne[re],Y=ae[re];break}return F<Y?-1:Y<F?1:0};function N(w,c,u,v,T){if(w.length===0)return-1;if(typeof u=="string"?(v=u,u=0):u>2147483647?u=2147483647:u<-2147483648&&(u=-2147483648),u=+u,_e(u)&&(u=T?0:w.length-1),u<0&&(u=w.length+u),u>=w.length){if(T)return-1;u=w.length-1}else if(u<0)if(T)u=0;else return-1;if(typeof c=="string"&&(c=a.from(c,v)),a.isBuffer(c))return c.length===0?-1:k(w,c,u,v,T);if(typeof c=="number")return c=c&255,typeof Uint8Array.prototype.indexOf=="function"?T?Uint8Array.prototype.indexOf.call(w,c,u):Uint8Array.prototype.lastIndexOf.call(w,c,u):k(w,[c],u,v,T);throw new TypeError("val must be string, number or Buffer")}function k(w,c,u,v,T){let _=1,F=w.length,Y=c.length;if(v!==void 0&&(v=String(v).toLowerCase(),v==="ucs2"||v==="ucs-2"||v==="utf16le"||v==="utf-16le")){if(w.length<2||c.length<2)return-1;_=2,F/=2,Y/=2,u/=2}function oe(ae,re){return _===1?ae[re]:ae.readUInt16BE(re*_)}let ne;if(T){let ae=-1;for(ne=u;ne<F;ne++)if(oe(w,ne)===oe(c,ae===-1?0:ne-ae)){if(ae===-1&&(ae=ne),ne-ae+1===Y)return ae*_}else ae!==-1&&(ne-=ne-ae),ae=-1}else for(u+Y>F&&(u=F-Y),ne=u;ne>=0;ne--){let ae=!0;for(let re=0;re<Y;re++)if(oe(w,ne+re)!==oe(c,re)){ae=!1;break}if(ae)return ne}return-1}a.prototype.includes=function(c,u,v){return this.indexOf(c,u,v)!==-1},a.prototype.indexOf=function(c,u,v){return N(this,c,u,v,!0)},a.prototype.lastIndexOf=function(c,u,v){return N(this,c,u,v,!1)};function P(w,c,u,v){u=Number(u)||0;const T=w.length-u;v?(v=Number(v),v>T&&(v=T)):v=T;const _=c.length;v>_/2&&(v=_/2);let F;for(F=0;F<v;++F){const Y=parseInt(c.substr(F*2,2),16);if(_e(Y))return F;w[u+F]=Y}return F}function D(w,c,u,v){return Ie(Oe(c,w.length-u),w,u,v)}function M(w,c,u,v){return Ie(Ge(c),w,u,v)}function L(w,c,u,v){return Ie(ke(c),w,u,v)}function q(w,c,u,v){return Ie(We(c,w.length-u),w,u,v)}a.prototype.write=function(c,u,v,T){if(u===void 0)T="utf8",v=this.length,u=0;else if(v===void 0&&typeof u=="string")T=u,v=this.length,u=0;else if(isFinite(u))u=u>>>0,isFinite(v)?(v=v>>>0,T===void 0&&(T="utf8")):(T=v,v=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const _=this.length-u;if((v===void 0||v>_)&&(v=_),c.length>0&&(v<0||u<0)||u>this.length)throw new RangeError("Attempt to write outside buffer bounds");T||(T="utf8");let F=!1;for(;;)switch(T){case"hex":return P(this,c,u,v);case"utf8":case"utf-8":return D(this,c,u,v);case"ascii":case"latin1":case"binary":return M(this,c,u,v);case"base64":return L(this,c,u,v);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,c,u,v);default:if(F)throw new TypeError("Unknown encoding: "+T);T=(""+T).toLowerCase(),F=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function K(w,c,u){return c===0&&u===w.length?e.fromByteArray(w):e.fromByteArray(w.slice(c,u))}function H(w,c,u){u=Math.min(w.length,u);const v=[];let T=c;for(;T<u;){const _=w[T];let F=null,Y=_>239?4:_>223?3:_>191?2:1;if(T+Y<=u){let oe,ne,ae,re;switch(Y){case 1:_<128&&(F=_);break;case 2:oe=w[T+1],(oe&192)===128&&(re=(_&31)<<6|oe&63,re>127&&(F=re));break;case 3:oe=w[T+1],ne=w[T+2],(oe&192)===128&&(ne&192)===128&&(re=(_&15)<<12|(oe&63)<<6|ne&63,re>2047&&(re<55296||re>57343)&&(F=re));break;case 4:oe=w[T+1],ne=w[T+2],ae=w[T+3],(oe&192)===128&&(ne&192)===128&&(ae&192)===128&&(re=(_&15)<<18|(oe&63)<<12|(ne&63)<<6|ae&63,re>65535&&re<1114112&&(F=re))}}F===null?(F=65533,Y=1):F>65535&&(F-=65536,v.push(F>>>10&1023|55296),F=56320|F&1023),v.push(F),T+=Y}return B(v)}const ee=4096;function B(w){const c=w.length;if(c<=ee)return String.fromCharCode.apply(String,w);let u="",v=0;for(;v<c;)u+=String.fromCharCode.apply(String,w.slice(v,v+=ee));return u}function G(w,c,u){let v="";u=Math.min(w.length,u);for(let T=c;T<u;++T)v+=String.fromCharCode(w[T]&127);return v}function Q(w,c,u){let v="";u=Math.min(w.length,u);for(let T=c;T<u;++T)v+=String.fromCharCode(w[T]);return v}function z(w,c,u){const v=w.length;(!c||c<0)&&(c=0),(!u||u<0||u>v)&&(u=v);let T="";for(let _=c;_<u;++_)T+=Je[w[_]];return T}function J(w,c,u){const v=w.slice(c,u);let T="";for(let _=0;_<v.length-1;_+=2)T+=String.fromCharCode(v[_]+v[_+1]*256);return T}a.prototype.slice=function(c,u){const v=this.length;c=~~c,u=u===void 0?v:~~u,c<0?(c+=v,c<0&&(c=0)):c>v&&(c=v),u<0?(u+=v,u<0&&(u=0)):u>v&&(u=v),u<c&&(u=c);const T=this.subarray(c,u);return Object.setPrototypeOf(T,a.prototype),T};function W(w,c,u){if(w%1!==0||w<0)throw new RangeError("offset is not uint");if(w+c>u)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(c,u,v){c=c>>>0,u=u>>>0,v||W(c,u,this.length);let T=this[c],_=1,F=0;for(;++F<u&&(_*=256);)T+=this[c+F]*_;return T},a.prototype.readUintBE=a.prototype.readUIntBE=function(c,u,v){c=c>>>0,u=u>>>0,v||W(c,u,this.length);let T=this[c+--u],_=1;for(;u>0&&(_*=256);)T+=this[c+--u]*_;return T},a.prototype.readUint8=a.prototype.readUInt8=function(c,u){return c=c>>>0,u||W(c,1,this.length),this[c]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(c,u){return c=c>>>0,u||W(c,2,this.length),this[c]|this[c+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(c,u){return c=c>>>0,u||W(c,2,this.length),this[c]<<8|this[c+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(c,u){return c=c>>>0,u||W(c,4,this.length),(this[c]|this[c+1]<<8|this[c+2]<<16)+this[c+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(c,u){return c=c>>>0,u||W(c,4,this.length),this[c]*16777216+(this[c+1]<<16|this[c+2]<<8|this[c+3])},a.prototype.readBigUInt64LE=be(function(c){c=c>>>0,fe(c,"offset");const u=this[c],v=this[c+7];(u===void 0||v===void 0)&&Ee(c,this.length-8);const T=u+this[++c]*2**8+this[++c]*2**16+this[++c]*2**24,_=this[++c]+this[++c]*2**8+this[++c]*2**16+v*2**24;return BigInt(T)+(BigInt(_)<<BigInt(32))}),a.prototype.readBigUInt64BE=be(function(c){c=c>>>0,fe(c,"offset");const u=this[c],v=this[c+7];(u===void 0||v===void 0)&&Ee(c,this.length-8);const T=u*2**24+this[++c]*2**16+this[++c]*2**8+this[++c],_=this[++c]*2**24+this[++c]*2**16+this[++c]*2**8+v;return(BigInt(T)<<BigInt(32))+BigInt(_)}),a.prototype.readIntLE=function(c,u,v){c=c>>>0,u=u>>>0,v||W(c,u,this.length);let T=this[c],_=1,F=0;for(;++F<u&&(_*=256);)T+=this[c+F]*_;return _*=128,T>=_&&(T-=Math.pow(2,8*u)),T},a.prototype.readIntBE=function(c,u,v){c=c>>>0,u=u>>>0,v||W(c,u,this.length);let T=u,_=1,F=this[c+--T];for(;T>0&&(_*=256);)F+=this[c+--T]*_;return _*=128,F>=_&&(F-=Math.pow(2,8*u)),F},a.prototype.readInt8=function(c,u){return c=c>>>0,u||W(c,1,this.length),this[c]&128?(255-this[c]+1)*-1:this[c]},a.prototype.readInt16LE=function(c,u){c=c>>>0,u||W(c,2,this.length);const v=this[c]|this[c+1]<<8;return v&32768?v|4294901760:v},a.prototype.readInt16BE=function(c,u){c=c>>>0,u||W(c,2,this.length);const v=this[c+1]|this[c]<<8;return v&32768?v|4294901760:v},a.prototype.readInt32LE=function(c,u){return c=c>>>0,u||W(c,4,this.length),this[c]|this[c+1]<<8|this[c+2]<<16|this[c+3]<<24},a.prototype.readInt32BE=function(c,u){return c=c>>>0,u||W(c,4,this.length),this[c]<<24|this[c+1]<<16|this[c+2]<<8|this[c+3]},a.prototype.readBigInt64LE=be(function(c){c=c>>>0,fe(c,"offset");const u=this[c],v=this[c+7];(u===void 0||v===void 0)&&Ee(c,this.length-8);const T=this[c+4]+this[c+5]*2**8+this[c+6]*2**16+(v<<24);return(BigInt(T)<<BigInt(32))+BigInt(u+this[++c]*2**8+this[++c]*2**16+this[++c]*2**24)}),a.prototype.readBigInt64BE=be(function(c){c=c>>>0,fe(c,"offset");const u=this[c],v=this[c+7];(u===void 0||v===void 0)&&Ee(c,this.length-8);const T=(u<<24)+this[++c]*2**16+this[++c]*2**8+this[++c];return(BigInt(T)<<BigInt(32))+BigInt(this[++c]*2**24+this[++c]*2**16+this[++c]*2**8+v)}),a.prototype.readFloatLE=function(c,u){return c=c>>>0,u||W(c,4,this.length),t.read(this,c,!0,23,4)},a.prototype.readFloatBE=function(c,u){return c=c>>>0,u||W(c,4,this.length),t.read(this,c,!1,23,4)},a.prototype.readDoubleLE=function(c,u){return c=c>>>0,u||W(c,8,this.length),t.read(this,c,!0,52,8)},a.prototype.readDoubleBE=function(c,u){return c=c>>>0,u||W(c,8,this.length),t.read(this,c,!1,52,8)};function te(w,c,u,v,T,_){if(!a.isBuffer(w))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>T||c<_)throw new RangeError('"value" argument is out of bounds');if(u+v>w.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(c,u,v,T){if(c=+c,u=u>>>0,v=v>>>0,!T){const Y=Math.pow(2,8*v)-1;te(this,c,u,v,Y,0)}let _=1,F=0;for(this[u]=c&255;++F<v&&(_*=256);)this[u+F]=c/_&255;return u+v},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(c,u,v,T){if(c=+c,u=u>>>0,v=v>>>0,!T){const Y=Math.pow(2,8*v)-1;te(this,c,u,v,Y,0)}let _=v-1,F=1;for(this[u+_]=c&255;--_>=0&&(F*=256);)this[u+_]=c/F&255;return u+v},a.prototype.writeUint8=a.prototype.writeUInt8=function(c,u,v){return c=+c,u=u>>>0,v||te(this,c,u,1,255,0),this[u]=c&255,u+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(c,u,v){return c=+c,u=u>>>0,v||te(this,c,u,2,65535,0),this[u]=c&255,this[u+1]=c>>>8,u+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(c,u,v){return c=+c,u=u>>>0,v||te(this,c,u,2,65535,0),this[u]=c>>>8,this[u+1]=c&255,u+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(c,u,v){return c=+c,u=u>>>0,v||te(this,c,u,4,4294967295,0),this[u+3]=c>>>24,this[u+2]=c>>>16,this[u+1]=c>>>8,this[u]=c&255,u+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(c,u,v){return c=+c,u=u>>>0,v||te(this,c,u,4,4294967295,0),this[u]=c>>>24,this[u+1]=c>>>16,this[u+2]=c>>>8,this[u+3]=c&255,u+4};function xe(w,c,u,v,T){le(c,v,T,w,u,7);let _=Number(c&BigInt(4294967295));w[u++]=_,_=_>>8,w[u++]=_,_=_>>8,w[u++]=_,_=_>>8,w[u++]=_;let F=Number(c>>BigInt(32)&BigInt(4294967295));return w[u++]=F,F=F>>8,w[u++]=F,F=F>>8,w[u++]=F,F=F>>8,w[u++]=F,u}function me(w,c,u,v,T){le(c,v,T,w,u,7);let _=Number(c&BigInt(4294967295));w[u+7]=_,_=_>>8,w[u+6]=_,_=_>>8,w[u+5]=_,_=_>>8,w[u+4]=_;let F=Number(c>>BigInt(32)&BigInt(4294967295));return w[u+3]=F,F=F>>8,w[u+2]=F,F=F>>8,w[u+1]=F,F=F>>8,w[u]=F,u+8}a.prototype.writeBigUInt64LE=be(function(c,u=0){return xe(this,c,u,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=be(function(c,u=0){return me(this,c,u,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(c,u,v,T){if(c=+c,u=u>>>0,!T){const oe=Math.pow(2,8*v-1);te(this,c,u,v,oe-1,-oe)}let _=0,F=1,Y=0;for(this[u]=c&255;++_<v&&(F*=256);)c<0&&Y===0&&this[u+_-1]!==0&&(Y=1),this[u+_]=(c/F>>0)-Y&255;return u+v},a.prototype.writeIntBE=function(c,u,v,T){if(c=+c,u=u>>>0,!T){const oe=Math.pow(2,8*v-1);te(this,c,u,v,oe-1,-oe)}let _=v-1,F=1,Y=0;for(this[u+_]=c&255;--_>=0&&(F*=256);)c<0&&Y===0&&this[u+_+1]!==0&&(Y=1),this[u+_]=(c/F>>0)-Y&255;return u+v},a.prototype.writeInt8=function(c,u,v){return c=+c,u=u>>>0,v||te(this,c,u,1,127,-128),c<0&&(c=255+c+1),this[u]=c&255,u+1},a.prototype.writeInt16LE=function(c,u,v){return c=+c,u=u>>>0,v||te(this,c,u,2,32767,-32768),this[u]=c&255,this[u+1]=c>>>8,u+2},a.prototype.writeInt16BE=function(c,u,v){return c=+c,u=u>>>0,v||te(this,c,u,2,32767,-32768),this[u]=c>>>8,this[u+1]=c&255,u+2},a.prototype.writeInt32LE=function(c,u,v){return c=+c,u=u>>>0,v||te(this,c,u,4,2147483647,-2147483648),this[u]=c&255,this[u+1]=c>>>8,this[u+2]=c>>>16,this[u+3]=c>>>24,u+4},a.prototype.writeInt32BE=function(c,u,v){return c=+c,u=u>>>0,v||te(this,c,u,4,2147483647,-2147483648),c<0&&(c=4294967295+c+1),this[u]=c>>>24,this[u+1]=c>>>16,this[u+2]=c>>>8,this[u+3]=c&255,u+4},a.prototype.writeBigInt64LE=be(function(c,u=0){return xe(this,c,u,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=be(function(c,u=0){return me(this,c,u,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ye(w,c,u,v,T,_){if(u+v>w.length)throw new RangeError("Index out of range");if(u<0)throw new RangeError("Index out of range")}function $e(w,c,u,v,T){return c=+c,u=u>>>0,T||ye(w,c,u,4),t.write(w,c,u,v,23,4),u+4}a.prototype.writeFloatLE=function(c,u,v){return $e(this,c,u,!0,v)},a.prototype.writeFloatBE=function(c,u,v){return $e(this,c,u,!1,v)};function Te(w,c,u,v,T){return c=+c,u=u>>>0,T||ye(w,c,u,8),t.write(w,c,u,v,52,8),u+8}a.prototype.writeDoubleLE=function(c,u,v){return Te(this,c,u,!0,v)},a.prototype.writeDoubleBE=function(c,u,v){return Te(this,c,u,!1,v)},a.prototype.copy=function(c,u,v,T){if(!a.isBuffer(c))throw new TypeError("argument should be a Buffer");if(v||(v=0),!T&&T!==0&&(T=this.length),u>=c.length&&(u=c.length),u||(u=0),T>0&&T<v&&(T=v),T===v||c.length===0||this.length===0)return 0;if(u<0)throw new RangeError("targetStart out of bounds");if(v<0||v>=this.length)throw new RangeError("Index out of range");if(T<0)throw new RangeError("sourceEnd out of bounds");T>this.length&&(T=this.length),c.length-u<T-v&&(T=c.length-u+v);const _=T-v;return this===c&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(u,v,T):Uint8Array.prototype.set.call(c,this.subarray(v,T),u),_},a.prototype.fill=function(c,u,v,T){if(typeof c=="string"){if(typeof u=="string"?(T=u,u=0,v=this.length):typeof v=="string"&&(T=v,v=this.length),T!==void 0&&typeof T!="string")throw new TypeError("encoding must be a string");if(typeof T=="string"&&!a.isEncoding(T))throw new TypeError("Unknown encoding: "+T);if(c.length===1){const F=c.charCodeAt(0);(T==="utf8"&&F<128||T==="latin1")&&(c=F)}}else typeof c=="number"?c=c&255:typeof c=="boolean"&&(c=Number(c));if(u<0||this.length<u||this.length<v)throw new RangeError("Out of range index");if(v<=u)return this;u=u>>>0,v=v===void 0?this.length:v>>>0,c||(c=0);let _;if(typeof c=="number")for(_=u;_<v;++_)this[_]=c;else{const F=a.isBuffer(c)?c:a.from(c,T),Y=F.length;if(Y===0)throw new TypeError('The value "'+c+'" is invalid for argument "value"');for(_=0;_<v-u;++_)this[_+u]=F[_%Y]}return this};const U={};function X(w,c,u){U[w]=class extends u{constructor(){super(),Object.defineProperty(this,"message",{value:c.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${w}]`,this.stack,delete this.name}get code(){return w}set code(T){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:T,writable:!0})}toString(){return`${this.name} [${w}]: ${this.message}`}}}X("ERR_BUFFER_OUT_OF_BOUNDS",function(w){return w?`${w} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),X("ERR_INVALID_ARG_TYPE",function(w,c){return`The "${w}" argument must be of type number. Received type ${typeof c}`},TypeError),X("ERR_OUT_OF_RANGE",function(w,c,u){let v=`The value of "${w}" is out of range.`,T=u;return Number.isInteger(u)&&Math.abs(u)>2**32?T=Z(String(u)):typeof u=="bigint"&&(T=String(u),(u>BigInt(2)**BigInt(32)||u<-(BigInt(2)**BigInt(32)))&&(T=Z(T)),T+="n"),v+=` It must be ${c}. Received ${T}`,v},RangeError);function Z(w){let c="",u=w.length;const v=w[0]==="-"?1:0;for(;u>=v+4;u-=3)c=`_${w.slice(u-3,u)}${c}`;return`${w.slice(0,u)}${c}`}function ce(w,c,u){fe(c,"offset"),(w[c]===void 0||w[c+u]===void 0)&&Ee(c,w.length-(u+1))}function le(w,c,u,v,T,_){if(w>u||w<c){const F=typeof c=="bigint"?"n":"";let Y;throw c===0||c===BigInt(0)?Y=`>= 0${F} and < 2${F} ** ${(_+1)*8}${F}`:Y=`>= -(2${F} ** ${(_+1)*8-1}${F}) and < 2 ** ${(_+1)*8-1}${F}`,new U.ERR_OUT_OF_RANGE("value",Y,w)}ce(v,T,_)}function fe(w,c){if(typeof w!="number")throw new U.ERR_INVALID_ARG_TYPE(c,"number",w)}function Ee(w,c,u){throw Math.floor(w)!==w?(fe(w,u),new U.ERR_OUT_OF_RANGE("offset","an integer",w)):c<0?new U.ERR_BUFFER_OUT_OF_BOUNDS:new U.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${c}`,w)}const Ne=/[^+/0-9A-Za-z-_]/g;function Ve(w){if(w=w.split("=")[0],w=w.trim().replace(Ne,""),w.length<2)return"";for(;w.length%4!==0;)w=w+"=";return w}function Oe(w,c){c=c||1/0;let u;const v=w.length;let T=null;const _=[];for(let F=0;F<v;++F){if(u=w.charCodeAt(F),u>55295&&u<57344){if(!T){if(u>56319){(c-=3)>-1&&_.push(239,191,189);continue}else if(F+1===v){(c-=3)>-1&&_.push(239,191,189);continue}T=u;continue}if(u<56320){(c-=3)>-1&&_.push(239,191,189),T=u;continue}u=(T-55296<<10|u-56320)+65536}else T&&(c-=3)>-1&&_.push(239,191,189);if(T=null,u<128){if((c-=1)<0)break;_.push(u)}else if(u<2048){if((c-=2)<0)break;_.push(u>>6|192,u&63|128)}else if(u<65536){if((c-=3)<0)break;_.push(u>>12|224,u>>6&63|128,u&63|128)}else if(u<1114112){if((c-=4)<0)break;_.push(u>>18|240,u>>12&63|128,u>>6&63|128,u&63|128)}else throw new Error("Invalid code point")}return _}function Ge(w){const c=[];for(let u=0;u<w.length;++u)c.push(w.charCodeAt(u)&255);return c}function We(w,c){let u,v,T;const _=[];for(let F=0;F<w.length&&!((c-=2)<0);++F)u=w.charCodeAt(F),v=u>>8,T=u%256,_.push(T),_.push(v);return _}function ke(w){return e.toByteArray(Ve(w))}function Ie(w,c,u,v){let T;for(T=0;T<v&&!(T+u>=c.length||T>=w.length);++T)c[T+u]=w[T];return T}function ge(w,c){return w instanceof c||w!=null&&w.constructor!=null&&w.constructor.name!=null&&w.constructor.name===c.name}function _e(w){return w!==w}const Je=function(){const w="0123456789abcdef",c=new Array(256);for(let u=0;u<16;++u){const v=u*16;for(let T=0;T<16;++T)c[v+T]=w[u]+w[T]}return c}();function be(w){return typeof BigInt>"u"?Ke:w}function Ke(){throw new Error("BigInt not supported")}}(buffer)),buffer}var bufferExports=requireBuffer(),define_process_env_default$1={VITE_INFURA_PROJECT_ID:'""',VITE_INFURA_API_SECRET:'""'};const getEnvVar=r=>typeof process<"u"&&define_process_env_default$1&&define_process_env_default$1[r]&&define_process_env_default$1[r]||"",INFURA_PROJECT_ID=getEnvVar("VITE_INFURA_PROJECT_ID"),INFURA_API_SECRET=getEnvVar("VITE_INFURA_API_SECRET"),initIPFSClient=()=>{try{return create({host:"ipfs.infura.io",port:5001,protocol:"https",headers:{authorization:"Basic "+bufferExports.Buffer.from(INFURA_PROJECT_ID+":"+INFURA_API_SECRET).toString("base64")}})}catch(r){throw console.error("Error initializing IPFS client:",r),new Error("Failed to connect to IPFS")}},uploadToIPFS=async(r,e)=>{try{return(await e.add(r)).cid.toString()}catch(t){throw console.error("Error uploading to IPFS:",t),new Error("Failed to upload content to IPFS")}},retrieveFromIPFS=async(r,e)=>{try{const t=e.cat(r),s=new TextDecoder;let n="";for await(const i of t)n+=s.decode(i);return n}catch(t){throw console.error("Error retrieving from IPFS:",t),new Error("Failed to retrieve content from IPFS")}},pinContent=async(r,e)=>{try{await e.pin.add(r),console.log(`Content with CID ${r} pinned successfully`)}catch(t){throw console.error("Error pinning content:",t),new Error("Failed to pin content to IPFS")}},defaultContext={ipfs:null,isConnected:!1,uploadContent:async()=>"",getContent:async()=>"",pinContent:async()=>{},ipfsError:null},IPFSContext=reactExports.createContext(defaultContext),IPFSProvider=({children:r})=>{const{isConnected:e}=useWeb3(),[t,s]=reactExports.useState(null),[n,i]=reactExports.useState(!1),[o,a]=reactExports.useState(null);reactExports.useEffect(()=>((async()=>{try{if(!e){a("Web3 wallet must be connected to use IPFS features");return}a(null);const E=initIPFSClient();s(E),i(!0)}catch(E){console.error("Failed to connect to IPFS:",E),a("Failed to connect to IPFS network"),i(!1)}})(),()=>{s(null),i(!1)}),[e]);const x={ipfs:t,isConnected:n,uploadContent:async b=>{if(!t)throw new Error("IPFS client not initialized");try{const E=(b instanceof ArrayBuffer,Buffer.from(b));return await uploadToIPFS(E,t)}catch(E){throw console.error("Error uploading to IPFS:",E),new Error("Failed to upload content to IPFS")}},getContent:async b=>{if(!t)throw new Error("IPFS client not initialized");try{return await retrieveFromIPFS(b,t)}catch(E){throw console.error("Error retrieving from IPFS:",E),new Error("Failed to retrieve content from IPFS")}},pinContent:async b=>{if(!t)throw new Error("IPFS client not initialized");try{await pinContent(b,t)}catch(E){throw console.error("Error pinning content:",E),new Error("Failed to pin content to IPFS")}},ipfsError:o};return jsxRuntimeExports.jsx(IPFSContext.Provider,{value:x,children:r})},initialState={items:[],sources:[],alerts:[],threats:[],statistics:{totalItems:0,byCategory:{OSINT:0,HUMINT:0,SIGINT:0,GEOINT:0,TECHINT:0,CYBINT:0,MILINT:0,MASINT:0},byClassification:{UNCLASSIFIED:0,CONFIDENTIAL:0,SECRET:0,TOP_SECRET:0},byPriority:{LOW:0,MEDIUM:0,HIGH:0,CRITICAL:0},processingRate:0,errorRate:0,averageProcessingTime:0,sourceHealthSummary:{operational:0,degraded:0,down:0,maintenance:0}},isProcessing:!1,lastUpdate:new Date,errors:[],filters:{categories:[],classifications:[],priorities:[],timeRange:"last-24h",sources:[],searchTerm:"",showAlertsOnly:!1}};function intelligenceReducer(r,e){switch(e.type){case"ADD_INTELLIGENCE":const t=e.payload,s=[t,...r.items];return{...r,items:s,statistics:updateStatistics(r.statistics,t,"add"),lastUpdate:new Date};case"ADD_INTELLIGENCE_BATCH":const n=e.payload,i=[...n,...r.items];let o=r.statistics;return n.forEach(p=>{o=updateStatistics(o,p,"add")}),{...r,items:i,statistics:o,lastUpdate:new Date};case"UPDATE_INTELLIGENCE":return{...r,items:r.items.map(p=>p.id===e.payload.id?{...p,...e.payload.updates}:p),lastUpdate:new Date};case"REMOVE_INTELLIGENCE":const a=r.items.find(p=>p.id===e.payload),l=r.items.filter(p=>p.id!==e.payload);return{...r,items:l,statistics:a?updateStatistics(r.statistics,a,"remove"):r.statistics,lastUpdate:new Date};case"ADD_SOURCE":return{...r,sources:[...r.sources,e.payload],lastUpdate:new Date};case"UPDATE_SOURCE":return{...r,sources:r.sources.map(p=>p.id===e.payload.id?{...p,...e.payload.updates}:p),lastUpdate:new Date};case"REMOVE_SOURCE":return{...r,sources:r.sources.filter(p=>p.id!==e.payload),lastUpdate:new Date};case"ADD_ALERT":return{...r,alerts:[e.payload,...r.alerts],lastUpdate:new Date};case"ACKNOWLEDGE_ALERT":return{...r,alerts:r.alerts.map(p=>p.id===e.payload.id?{...p,status:"acknowledged",acknowledgedBy:e.payload.userId,acknowledgedAt:new Date}:p),lastUpdate:new Date};case"DISMISS_ALERT":return{...r,alerts:r.alerts.map(p=>p.id===e.payload?{...p,status:"dismissed"}:p),lastUpdate:new Date};case"UPDATE_STATISTICS":return{...r,statistics:{...r.statistics,...e.payload}};case"SET_PROCESSING":return{...r,isProcessing:e.payload};case"ADD_ERROR":return{...r,errors:[e.payload,...r.errors.slice(0,9)]};case"CLEAR_ERRORS":return{...r,errors:[]};case"UPDATE_FILTERS":return{...r,filters:{...r.filters,...e.payload}};case"RESET_STATE":return initialState;default:return r}}function updateStatistics(r,e,t){const s=t==="add"?1:-1;return{...r,totalItems:r.totalItems+s,byCategory:{...r.byCategory,[e.category]:r.byCategory[e.category]+s},byClassification:{...r.byClassification,[e.classification.level]:r.byClassification[e.classification.level]+s},byPriority:{...r.byPriority,[e.priority]:r.byPriority[e.priority]+s}}}function generateAlert(r){return r.priority==="CRITICAL"||r.priority==="HIGH"?{id:`alert-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,intelligenceId:r.id,type:"CRITICAL_INTELLIGENCE",priority:r.priority,title:`${r.priority} Priority Intelligence Alert`,message:`New ${r.priority.toLowerCase()} priority intelligence: ${r.title}`,timestamp:new Date,status:"active",escalationLevel:r.priority==="CRITICAL"?2:1,metadata:{sourceId:r.sourceId,classification:r.classification.level,location:r.location}}:null}const IntelligenceContext=reactExports.createContext(void 0),IntelligenceProvider=({children:r})=>{const[e,t]=reactExports.useReducer(intelligenceReducer,initialState);reactExports.useEffect(()=>{(()=>{try{const o=localStorage.getItem("tactical-intel-sources");o&&JSON.parse(o).forEach(p=>{t({type:"ADD_SOURCE",payload:p})});const a=localStorage.getItem("tactical-intel-items");if(a){const p=JSON.parse(a).filter(g=>{const x=new Date(g.timestamp),b=new Date(Date.now()-24*60*60*1e3);return x>b});p.length>0&&t({type:"ADD_INTELLIGENCE_BATCH",payload:p})}}catch(o){console.error("Failed to load stored intelligence data:",o),t({type:"ADD_ERROR",payload:"Failed to load stored data"})}})()},[]),reactExports.useEffect(()=>{try{localStorage.setItem("tactical-intel-sources",JSON.stringify(e.sources))}catch(i){console.error("Failed to save sources to localStorage:",i)}},[e.sources]),reactExports.useEffect(()=>{try{const i=e.items.slice(0,100);localStorage.setItem("tactical-intel-items",JSON.stringify(i))}catch(i){console.error("Failed to save intelligence items to localStorage:",i)}},[e.items]);const s={addIntelligence:reactExports.useCallback(i=>{t({type:"ADD_INTELLIGENCE",payload:i});const o=generateAlert(i);o&&t({type:"ADD_ALERT",payload:o})},[]),addIntelligenceBatch:reactExports.useCallback(i=>{t({type:"ADD_INTELLIGENCE_BATCH",payload:i}),i.forEach(o=>{const a=generateAlert(o);a&&t({type:"ADD_ALERT",payload:a})})},[]),updateIntelligence:reactExports.useCallback((i,o)=>{t({type:"UPDATE_INTELLIGENCE",payload:{id:i,updates:o}})},[]),removeIntelligence:reactExports.useCallback(i=>{t({type:"REMOVE_INTELLIGENCE",payload:i})},[]),addSource:reactExports.useCallback(i=>{t({type:"ADD_SOURCE",payload:i})},[]),updateSource:reactExports.useCallback((i,o)=>{t({type:"UPDATE_SOURCE",payload:{id:i,updates:o}})},[]),removeSource:reactExports.useCallback(i=>{t({type:"REMOVE_SOURCE",payload:i})},[]),createAlert:reactExports.useCallback(i=>{const o=generateAlert(i);o&&t({type:"ADD_ALERT",payload:o})},[]),acknowledgeAlert:reactExports.useCallback((i,o)=>{t({type:"ACKNOWLEDGE_ALERT",payload:{id:i,userId:o}})},[]),dismissAlert:reactExports.useCallback(i=>{t({type:"DISMISS_ALERT",payload:i})},[]),updateFilters:reactExports.useCallback(i=>{t({type:"UPDATE_FILTERS",payload:i})},[]),clearErrors:reactExports.useCallback(()=>{t({type:"CLEAR_ERRORS"})},[]),resetState:reactExports.useCallback(()=>{t({type:"RESET_STATE"})},[])},n={state:e,actions:s};return jsxRuntimeExports.jsx(IntelligenceContext.Provider,{value:n,children:r})},useIntelligence=()=>{const r=reactExports.useContext(IntelligenceContext);if(r===void 0)throw new Error("useIntelligence must be used within an IntelligenceProvider");return r};class LocalStorageUtil{static getItem(e){try{const t=localStorage.getItem(e);if(!t)return null;const s=JSON.parse(t);return s.expiry&&new Date(s.expiry)<new Date?(localStorage.removeItem(e),null):s.value!==void 0?s.value:s}catch(t){return console.error(`Error getting item from localStorage: ${t}`),null}}static setItem(e,t,s){try{const n={value:t};if(s){const i=new Date;i.setMinutes(i.getMinutes()+s),n.expiry=i.toISOString()}localStorage.setItem(e,JSON.stringify(n))}catch(n){console.error(`Error setting item in localStorage: ${n}`)}}static removeItem(e){try{localStorage.removeItem(e)}catch(t){console.error(`Error removing item from localStorage: ${t}`)}}static clear(){try{localStorage.clear()}catch(e){console.error(`Error clearing localStorage: ${e}`)}}static getNamespacedKey(e,t){return`${e}:${t}`}}var define_process_env_default={},LogLevel=(r=>(r[r.DEBUG=0]="DEBUG",r[r.INFO=1]="INFO",r[r.WARN=2]="WARN",r[r.ERROR=3]="ERROR",r[r.CRITICAL=4]="CRITICAL",r))(LogLevel||{});const Pe=class Pe{constructor(){O(this,"logs",[]);O(this,"maxLogs",1e3);O(this,"logLevel",1);O(this,"enableConsoleOutput",typeof process<"u"&&!1);const e=typeof process<"u"&&define_process_env_default&&define_process_env_default.VITE_LOG_LEVEL||"INFO";this.logLevel=this.parseLogLevel(e)}static getInstance(){return this.instance||(this.instance=new Pe),this.instance}parseLogLevel(e){switch(e.toUpperCase()){case"DEBUG":return 0;case"INFO":return 1;case"WARN":return 2;case"ERROR":return 3;case"CRITICAL":return 4;default:return 1}}log(e,t,s,n,i){if(e<this.logLevel)return;const o={timestamp:new Date,level:e,category:t,message:s,data:n,stack:i==null?void 0:i.stack};if(this.logs.push(o),this.logs.length>this.maxLogs&&(this.logs=this.logs.slice(-this.maxLogs)),this.enableConsoleOutput){const a=LogLevel[e],p=`[${o.timestamp.toISOString()}] ${a} [${t}]`;switch(e){case 0:console.debug(p,s,n);break;case 1:console.info(p,s,n);break;case 2:console.warn(p,s,n);break;case 3:case 4:console.error(p,s,n,i);break}}}debug(e,t,s){this.log(0,e,t,s)}info(e,t,s){this.log(1,e,t,s)}warn(e,t,s){this.log(2,e,t,s)}error(e,t,s,n){this.log(3,e,t,s,n)}critical(e,t,s,n){this.log(4,e,t,s,n)}getLogs(e){return e===void 0?[...this.logs]:this.logs.filter(t=>t.level>=e)}clearLogs(){this.logs=[]}exportLogs(){return JSON.stringify(this.logs,null,2)}setLogLevel(e){this.logLevel=e}setConsoleOutput(e){this.enableConsoleOutput=e}};O(Pe,"instance");let LoggerService=Pe;const logger=LoggerService.getInstance(),log={debug:(r,e,t)=>logger.debug(r,e,t),info:(r,e,t)=>logger.info(r,e,t),warn:(r,e,t)=>logger.warn(r,e,t),error:(r,e,t,s)=>logger.error(r,e,t,s),critical:(r,e,t,s)=>logger.critical(r,e,t,s)};class SettingsIntegrationService{static loadSettings(){if(this.settings)return this.settings;try{const e=localStorage.getItem("dashboardSettings");if(e)return this.settings=JSON.parse(e),log.debug("SettingsIntegration","Loaded settings from localStorage"),this.settings}catch(e){log.error("SettingsIntegration","Failed to load settings",e)}return{}}static getCORSStrategy(e){var s,n,i;const t=this.loadSettings();return e&&((n=(s=t.cors)==null?void 0:s.protocolStrategies)!=null&&n[e])?t.cors.protocolStrategies[e]:((i=t.cors)==null?void 0:i.defaultStrategy)||CORSStrategy.RSS2JSON}static getProxyUrl(e,t){var i,o,a;const s=this.getCORSStrategy(t),n=this.loadSettings();switch(s){case CORSStrategy.RSS2JSON:return((a=(o=(i=n.cors)==null?void 0:i.services)==null?void 0:o.rss2json)==null?void 0:a.length)>0?`${n.cors.services.rss2json[0]}?rss_url=${encodeURIComponent(e)}`:e;case CORSStrategy.DIRECT:return e;case CORSStrategy.SERVICE_WORKER:return`${window.location.origin}/sw-proxy?url=${encodeURIComponent(e)}`;case CORSStrategy.JSONP:return e;case CORSStrategy.EXTENSION:return e;default:return e}}static getCORSProxyChain(){var s;const e=this.loadSettings(),t=[];if((s=e.cors)!=null&&s.fallbackChain&&e.cors.services){for(const n of e.cors.fallbackChain)switch(n){case CORSStrategy.RSS2JSON:e.cors.services.rss2json&&t.push(...e.cors.services.rss2json.map(i=>`${i}?rss_url=`));break;case CORSStrategy.DIRECT:t.push("");break;case CORSStrategy.SERVICE_WORKER:t.push(`${window.location.origin}/sw-proxy?url=`);break;case CORSStrategy.JSONP:break;case CORSStrategy.EXTENSION:break}e.cors.services.corsProxies&&t.push(...e.cors.services.corsProxies)}return t.length>0?t:[""]}static getThemeSettings(){return this.loadSettings().display||{theme:"alliance",density:"comfortable",fontSize:14}}static applyThemeSettings(){const{theme:e,density:t,fontSize:s}=this.getThemeSettings();document.documentElement.setAttribute("data-theme",e),document.documentElement.setAttribute("data-density",t),document.documentElement.style.setProperty("--base-font-size",`${s}px`),document.documentElement.setAttribute("data-compact",t==="compact"?"true":"false"),log.debug("SettingsIntegration",`Applied theme: ${e}, density: ${t}, fontSize: ${s}`)}static getVerificationSettings(){return this.loadSettings().verification||{minimumTrustRating:60,preferredMethods:["official","community","automated"],warningThreshold:40}}static getTrustStatus(e){const{minimumTrustRating:t,warningThreshold:s}=this.getVerificationSettings(),n=e>=t,i=e<t&&e>=s;let o="untrusted";return n?o="trusted":i&&(o="warning"),{trusted:n,warning:i,status:o}}static getProtocolPriority(){var t;return((t=this.loadSettings().protocols)==null?void 0:t.priority)||["RSS","JSON","API","IPFS","MASTODON","SSB"]}static orderByProtocolPriority(e){const t=this.getProtocolPriority();return[...e].sort((s,n)=>{const i=s.protocol||"",o=n.protocol||"",a=t.indexOf(i),l=t.indexOf(o);return a===-1&&l===-1?0:a===-1?1:l===-1?-1:a-l})}static getGeneralSettings(){const e=localStorage.getItem("generalSettings"),t={autoRefresh:!1,refreshInterval:300,preserveHistory:!0,notifications:!0,notificationSound:"ping",showNotificationCount:!0,cacheDuration:1800,storageLimit:50};if(e)try{const s=JSON.parse(e);return{...t,...s}}catch(s){return console.warn("Failed to parse general settings from localStorage:",s),t}return t}static detectProtocolFromUrl(e){const t=e.toLowerCase();if(t.includes(".rss")||t.includes("/rss")||t.includes("/feed")||t.includes("/atom"))return"RSS";if(t.includes(".json")||t.includes("/json"))return"JSON";if(t.includes("api."))return"API";if(t.startsWith("ipfs://")||t.includes("ipfs/"))return"IPFS";if(t.includes("@")&&(t.includes("mastodon")||t.includes("pleroma")))return"MASTODON"}static resetCache(){this.settings=null}static applyCorsSettings(){const e=this.loadSettings();e.cors&&log.debug("SettingsIntegration","Applied CORS settings",{defaultStrategy:e.cors.defaultStrategy,protocolStrategies:e.cors.protocolStrategies})}static applyProtocolSettings(){const e=this.loadSettings();e.protocols&&log.debug("SettingsIntegration","Applied protocol settings",{priority:e.protocols.priority,autoDetect:e.protocols.autoDetect})}static applyVerificationSettings(){const e=this.loadSettings();e.verification&&log.debug("SettingsIntegration","Applied verification settings",{minimumTrustRating:e.verification.minimumTrustRating,warningThreshold:e.verification.warningThreshold,preferredMethods:e.verification.preferredMethods})}static applyGeneralSettings(){const e=this.loadSettings();e.general&&log.debug("SettingsIntegration","Applied general settings",{refreshInterval:e.general.refreshInterval,cacheSettings:e.general.cacheSettings,notifications:e.general.notifications})}static saveSettings(e){try{const t=this.loadSettings();this.settings={...t,...e},localStorage.setItem("dashboardSettings",JSON.stringify(this.settings)),log.debug("SettingsIntegration","Saved settings to localStorage")}catch(t){log.error("SettingsIntegration","Failed to save settings",t)}}static resetToDefaults(){try{localStorage.removeItem("dashboardSettings"),this.settings=null,log.debug("SettingsIntegration","Reset settings to defaults")}catch(e){log.error("SettingsIntegration","Failed to reset settings",e)}}static validateSettings(e){return!(!e||typeof e!="object")}static validateAndSanitizeSettings(e){if(!this.validateSettings(e))return{};const t={...e};return delete t.__proto__,delete t.constructor,t}static applySettings(e){const t=this.validateAndSanitizeSettings(e);this.saveSettings(t),this.applyThemeSettings(),this.applyCorsSettings(),this.applyProtocolSettings(),this.applyVerificationSettings(),this.applyGeneralSettings()}static sanitizeInput(e){return typeof e!="string"?"":e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,"").replace(/javascript:/gi,"").replace(/on\w+\s*=/gi,"")}static async testCORSStrategy(e,t={}){const s=t.timeout||5e3;return new Promise(n=>{const i=setTimeout(()=>n(!1),s);setTimeout(()=>{clearTimeout(i),n(!0)},100)})}}O(SettingsIntegrationService,"settings",null);class RSS2JSONService{static async fetchFeed(e){console.log(`🔄 Fetching RSS via RSS2JSON: ${e}`);for(let t=0;t<this.APIS.length;t++)try{const s=this.buildApiUrl(this.APIS[t],e);console.log(`📡 Trying API ${t+1}: ${this.APIS[t]}`);const n=await fetch(s,{headers:{Accept:"application/json","User-Agent":"Mozilla/5.0 (compatible; RSS-Reader/1.0)"},signal:AbortSignal.timeout(15e3)});if(!n.ok){const a=await n.text();throw new Error(`HTTP ${n.status}: ${n.statusText}. Response: ${a.substring(0,100)}`)}const i=await n.json();if(!this.validateResponse(i,this.APIS[t]))throw new Error(`Invalid response format from ${this.APIS[t]}`);const o=this.convertToFeedFormat(i,e);if(o.length===0)throw new Error("No feed items found in response");return console.log(`✅ Successfully fetched ${o.length} items from ${this.APIS[t]}`),o}catch(s){if(console.warn(`❌ API ${t+1} failed:`,s),t===this.APIS.length-1)throw new Error(`All RSS2JSON APIs failed. Last error: ${s}`);await new Promise(n=>setTimeout(n,1e3))}throw new Error("Unexpected error in RSS2JSON service")}static validateResponse(e,t){return e?t.includes("rss2json.vercel.app")?Array.isArray(e.items)||Array.isArray(e):t.includes("rss2json.com")?e.status==="ok"&&Array.isArray(e.items):t.includes("feed2json.org")?Array.isArray(e.items)||Array.isArray(e):e.items&&Array.isArray(e.items):!1}static buildApiUrl(e,t){const s=encodeURIComponent(t);switch(e){case"https://rss2json.vercel.app/api":return`${e}?url=${s}`;case"https://api.rss2json.com/v1/api.json":return`${e}?rss_url=${s}`;case"https://feed2json.org/convert":return`${e}?url=${s}`;default:return`${e}?url=${s}`}}static convertToFeedFormat(e,t){try{const s=e.feed||e,n=e.items||e.entries||[];if(!Array.isArray(n))throw new Error("No items array found in response");return n.map((i,o)=>{let a=i.pubDate||i.published||i.date_published||new Date().toISOString();if(a&&!a.includes("T"))try{a=new Date(a).toISOString()}catch{a=new Date().toISOString()}return{id:`${t}-${o}`,name:s.title||"Unknown Feed",url:t,title:i.title||"No Title",link:i.link||i.url||t,pubDate:a,description:this.cleanHtml(i.description||i.summary||""),content:this.cleanHtml(i.content||i.description||i.summary||""),feedListId:"1",author:i.author||s.author||"Unknown Author",categories:Array.isArray(i.categories)?i.categories:[],media:this.extractMedia(i)}})}catch(s){throw console.error("Error converting RSS2JSON data:",s),new Error("Failed to convert RSS data to feed format")}}static extractMedia(e){const t=[];return e.enclosure&&e.enclosure.link&&t.push({url:e.enclosure.link,type:e.enclosure.type||"unknown"}),e.thumbnail&&t.push({url:e.thumbnail,type:"image"}),e.image&&t.push({url:e.image,type:"image"}),t}static cleanHtml(e){return e?e.replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').trim():""}}O(RSS2JSONService,"APIS",["https://rss2json.vercel.app/api","https://api.rss2json.com/v1/api.json","https://api.rss-to-json.com/v1/api.json","https://api.allorigins.win/get?url=","https://corsproxy.io/?","https://api.cors.sh/cors/?url="]);const convertFeedsToFeedItems=r=>r.map(e=>({id:e.id,title:e.title,link:e.link,pubDate:new Date(e.pubDate).toISOString(),description:e.description||"",content:e.content||"",feedListId:e.feedListId,author:e.author,categories:e.categories,media:e.media})),convertFeedItemsToFeeds=r=>r.map(e=>({id:e.id,name:e.title,url:e.link,title:e.title,link:e.link,pubDate:new Date(e.pubDate).toISOString(),description:e.description,content:e.content,feedListId:e.feedListId,author:e.author,categories:e.categories,media:e.media}));class FetchService{static async fetchFeed(e,t){log.debug("FetchService",`Starting to fetch feed from URL: ${e}`);const s=SettingsIntegrationService.getCORSStrategy(t);log.debug("FetchService",`Using CORS strategy: ${s} for ${t||"default"} protocol`);try{switch(s){case CORSStrategy.RSS2JSON:return await this.fetchWithRSS2JSON(e);case CORSStrategy.DIRECT:return await this.fetchDirect(e);case CORSStrategy.SERVICE_WORKER:return await this.fetchWithServiceWorker(e);case CORSStrategy.JSONP:return await this.fetchWithJSONP(e);case CORSStrategy.EXTENSION:return await this.fetchWithExtension(e);default:return await this.fetchWithProxyChain(e)}}catch(n){log.error("FetchService",`Failed to fetch ${e} with strategy ${s}`,n);try{return log.debug("FetchService","Attempting fallback chain"),await this.fetchWithProxyChain(e)}catch(i){throw log.error("FetchService","All fallback methods failed",i),i}}}static async fetchWithRSS2JSON(e){try{log.debug("FetchService",`Attempting RSS2JSON fetch for: ${e}`);const t=await RSS2JSONService.fetchFeed(e);if(t&&t.length>0)return log.debug("FetchService",`✅ Successfully fetched ${t.length} items using RSS2JSON`),{feeds:convertFeedsToFeedItems(t),fetchedAt:new Date().toISOString()};throw new Error("No feed items found in RSS2JSON response")}catch(t){throw log.error("FetchService","RSS2JSON fetch failed",t),t}}static async fetchDirect(e){try{log.debug("FetchService",`Attempting direct fetch: ${e}`);const t=await fetch(e,{method:"GET",headers:{Accept:"application/xml, text/xml, application/rss+xml, application/atom+xml, application/json, text/html, */*","User-Agent":"Mozilla/5.0 (compatible; RSS-Reader/1.0)"},signal:AbortSignal.timeout(1e4)});if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const s=t.headers.get("Content-Type")||"",n=await t.text();return await this.parseFeedResponse(n,s,e)}catch(t){throw log.error("FetchService","Direct fetch failed",t),t}}static async fetchWithServiceWorker(e){throw log.warn("FetchService","Service Worker fetch not fully implemented"),new Error("Service Worker CORS strategy not implemented")}static async fetchWithJSONP(e){throw log.warn("FetchService","JSONP fetch not fully implemented"),new Error("JSONP CORS strategy not implemented")}static async fetchWithExtension(e){return this.fetchDirect(e)}static async fetchWithProxyChain(e){const t=SettingsIntegrationService.getCORSProxyChain();log.debug("FetchService",`Attempting proxy chain with ${t.length} proxies`);for(let s=0;s<t.length;s++)try{const n=t[s];let i=e;n&&(i=`${n}${encodeURIComponent(e)}`),log.debug("FetchService",`Trying proxy ${s+1}: ${i}`);const o=await fetch(i,{method:"GET",headers:{Accept:"application/xml, text/xml, application/rss+xml, application/atom+xml, application/json, text/html, */*","User-Agent":"Mozilla/5.0 (compatible; RSS-Reader/1.0)"},signal:AbortSignal.timeout(8e3)});if(!o.ok){log.warn("FetchService",`Proxy ${s+1} returned ${o.status}: ${o.statusText}`);continue}const a=await o.text(),{content:l,contentType:p}=this.extractContentFromProxyResponse(a,i);return await this.parseFeedResponse(l,p,e)}catch(n){log.warn("FetchService",`Proxy ${s+1} failed:`,n);continue}throw new Error(`All proxies in the chain failed for URL: ${e}`)}static extractContentFromProxyResponse(e,t){if(t.includes("allorigins.win"))try{const s=JSON.parse(e);if(s.contents)return{content:s.contents,contentType:"application/xml"}}catch{log.warn("FetchService","Failed to parse allorigins response as JSON, treating as raw content")}if(t.includes("codetabs.com")&&e.includes("Moved Permanently"))throw new Error("Codetabs proxy returned redirect - feed likely not accessible");if(e.startsWith("data:application/")&&e.includes("base64,"))try{const s=e.split("base64,")[1],n=atob(s),i=e.split(";")[0].replace("data:","");return{content:n,contentType:i}}catch(s){log.warn("FetchService","Failed to decode base64 content:",s)}return{content:e,contentType:"application/xml"}}static async parseFeedResponse(e,t,s){throw new Error("Direct parsing not implemented, falling back to RSS2JSON")}static async testCORSStrategy(e,t){var i,o;log.debug("FetchService",`Testing ${t} strategy for ${e}`);const s=new AbortController,n=setTimeout(()=>s.abort(),1e4);try{let a=e;switch(t){case CORSStrategy.RSS2JSON:const g=((o=(i=SettingsIntegrationService.loadSettings().cors)==null?void 0:i.services)==null?void 0:o.rss2json)||[];if(g.length===0)throw new Error("No RSS2JSON services configured");a=`${g[0]}?rss_url=${encodeURIComponent(e)}`;break;case CORSStrategy.SERVICE_WORKER:a=`${window.location.origin}/sw-proxy?url=${encodeURIComponent(e)}`;break;case CORSStrategy.JSONP:throw new Error("JSONP testing not implemented in test utility");case CORSStrategy.DIRECT:break;case CORSStrategy.EXTENSION:break}const l=await fetch(a,{method:"GET",headers:{Accept:"application/xml, text/xml, application/rss+xml, application/atom+xml, application/json, text/html, */*","User-Agent":"Tactical Intel Dashboard Test Utility"},signal:s.signal});if(clearTimeout(n),!l.ok)throw new Error(`HTTP ${l.status}: ${l.statusText}`);const p=await l.text();if(!p||p.length===0)throw new Error("Empty response received");return{success:!0,data:{contentType:l.headers.get("Content-Type"),contentLength:p.length}}}catch(a){throw clearTimeout(n),log.error("FetchService",`Test failed for ${t}:`,a),a}}}const fetchFeed$1=async r=>{var e,t;log.debug("Component",`Starting to fetch feed from URL: ${r}`);try{const n=SettingsIntegrationService.getGeneralSettings().cacheDuration*1e3,i=LocalStorageUtil.getItem(`feed_${r}`);if(i){const l=JSON.parse(i),p=new Date(l.fetchedAt).getTime();if(new Date().getTime()-p<n)return log.debug("Component",`Using cached feed data for ${r}`),l}let o;((e=SettingsIntegrationService.loadSettings().protocols)==null?void 0:e.autoDetect)!==!1&&(o=SettingsIntegrationService.detectProtocolFromUrl(r),log.debug("Component",`Auto-detected protocol: ${o||"unknown"}`));let a=await FetchService.fetchFeed(r,o);if(!a&&((t=SettingsIntegrationService.loadSettings().protocols)==null?void 0:t.fallbackEnabled)!==!1){log.debug("Component",`Initial fetch failed, trying protocol fallbacks for ${r}`);const l=SettingsIntegrationService.getProtocolPriority();for(const p of l)if(p!==o&&(log.debug("Component",`Trying fallback protocol: ${p}`),a=await FetchService.fetchFeed(r,p),a)){log.debug("Component",`Fallback protocol ${p} succeeded`);break}}return a&&LocalStorageUtil.setItem(`feed_${r}`,JSON.stringify(a)),a}catch(s){log.error("Component",`Failed to fetch feed: ${s}`);try{const n=LocalStorageUtil.getItem(`feed_${r}`);if(n)return log.debug("Component",`Using expired cached feed data for ${r} due to fetch error`),JSON.parse(n)}catch(n){log.error("Component",`Failed to retrieve cached data: ${n}`)}throw s}};class FeedController{constructor(){O(this,"feedResultsCache",new Map);O(this,"cacheExpiryTime",1e3*60*5)}async fetchAndParseFeed(e){try{const t=this.getCachedFeedResults(e);if(t)return log.debug("Component",`Returning cached results for URL: ${e}`),t;log.debug("Component",`Fetching feed for URL: ${e}`);const s=await fetchFeed$1(e);if(s){const n=this.convertFeedResults(s);return this.cacheFeedResults(e,n),n}return null}catch(t){return console.error(`Failed to fetch and parse feed for URL: ${e}`,t),null}}convertFeedResults(e){return{feeds:e.feeds.map(s=>({id:s.id,title:s.title,link:s.link,pubDate:s.pubDate,description:s.description||"",content:s.content||"",feedListId:s.feedListId,author:s.author,categories:s.categories,media:s.media})),fetchedAt:new Date().toISOString()}}cacheFeedResults(e,t){this.feedResultsCache.set(e,t),log.debug("Component",`Feed fetched and cached for URL: ${e}`)}getFeedResults(e){try{const t=this.getCachedFeedResults(e);return t?(log.debug("Component",`Returning cached results for URL: ${e}`),t):(console.warn(`No cached results found for URL: ${e}`),null)}catch(t){return console.error(`Failed to get feed results for URL: ${e}`,t),null}}getCachedFeedResults(e){const t=this.feedResultsCache.get(e);if(t){if(new Date().getTime()-new Date(t.fetchedAt).getTime()<this.cacheExpiryTime)return t;log.debug("Component",`Cache expired for URL: ${e}`),this.feedResultsCache.delete(e)}return null}clearCache(){log.debug("Component","Clearing feed results cache"),this.feedResultsCache.clear()}removeCacheEntry(e){this.feedResultsCache.has(e)?(log.debug("Component",`Removing cache entry for URL: ${e}`),this.feedResultsCache.delete(e)):console.warn(`No cache entry found for URL: ${e}`)}getCacheStatus(){const e={};return this.feedResultsCache.forEach((t,s)=>{e[s]=t.fetchedAt}),e}}const FeedController$1=new FeedController,mainstreamUrls=["https://rss.nytimes.com/services/xml/rss/nyt/HomePage.xml","https://feeds.bbci.co.uk/news/rss.xml","https://www.npr.org/rss/rss.php?id=1001","https://www.reddit.com/r/news/.rss","https://www.aljazeera.com/xml/rss/all.xml","https://rss.cnn.com/rss/edition.rss","https://www.theguardian.com/world/rss","https://www.washingtonpost.com/rss/world","https://www.bloomberg.com/feed/podcast/etf-report.xml","https://www.ft.com/?format=rss"];mainstreamUrls.map((r,e)=>({id:`ms-${e+1}`,title:`Mainstream Source ${e+1}`,link:r,pubDate:`2023-01-${String(e+1).padStart(2,"0")}`,description:`Mainstream news source ${e+1}`,content:`Content from mainstream source ${e+1}`,feedListId:"1"}));const DefaultFeeds=DefaultFeeds$1,getTextContent$1=(r,e,t)=>{try{const s=r.getElementsByTagName(e)[0];return s?s.textContent||t:(["content:encoded","content","author","media:content","media:thumbnail","enclosure","dc:creator","managingEditor","webMaster","subtitle","summary","pubDate","description","published","updated"].includes(e)||console.warn(`Element with tag name '${e}' not found in element '${r.tagName}'. Returning default value.`),t)}catch(s){return console.error(`Error getting text content for tag name '${e}' in element '${r.tagName}':`,s),t}},getContentWithFallback=(r,e="")=>{var t;try{const s=["content:encoded","content","description","summary","subtitle"];for(const n of s){const i=r.getElementsByTagName(n)[0];if(i&&((t=i.textContent)!=null&&t.trim())){let o=i.textContent.trim();if(n==="description"&&o.length>100)return o;if(n!=="description"&&o.length>0)return o;n==="description"&&!e&&(e=o)}}return e}catch(s){return console.error(`Error getting content with fallback in element '${r.tagName}':`,s),e}},getAuthorWithFallback=(r,e="")=>{var t;try{const s=["dc:creator","author","managingEditor","webMaster","creator"];for(const n of s){const i=r.getElementsByTagName(n)[0];if(i&&((t=i.textContent)!=null&&t.trim()))return i.textContent.trim()}return e}catch(s){return console.error(`Error getting author with fallback in element '${r.tagName}':`,s),e}},getMediaWithFallback=r=>{try{const e=[],t=["media:content","enclosure","media:thumbnail","image"];for(const s of t){const n=r.getElementsByTagName(s);Array.from(n).forEach(i=>{var l;const o=i.getAttribute("url")||i.getAttribute("href")||((l=i.textContent)==null?void 0:l.trim()),a=i.getAttribute("type")||i.getAttribute("medium")||"unknown";o&&e.push({url:o,type:a})})}return e}catch(e){return console.error(`Error getting media with fallback in element '${r.tagName}':`,e),[]}},getAllTextContents$1=(r,e)=>{const t=r.getElementsByTagName(e),s=[];return Array.from(t).forEach(n=>{n.textContent&&s.push(n.textContent)}),s},parseFeedData$3=(r,e)=>{const t=[],s=r.getElementsByTagName("item");if(s.length>0&&Array.from(s).forEach((n,i)=>{try{const o={id:`${e}-${i}`,name:getTextContent$1(r.documentElement,"title","No title"),url:e,title:getTextContent$1(n,"title","No title"),link:getTextContent$1(n,"link",e),pubDate:getTextContent$1(n,"pubDate",new Date().toISOString()),description:getTextContent$1(n,"description",""),content:getContentWithFallback(n,getTextContent$1(n,"description","")),feedListId:"1",author:getAuthorWithFallback(n,""),categories:getAllTextContents$1(n,"category"),media:getMediaWithFallback(n)};t.push(o)}catch(o){console.warn(`Error parsing RSS item ${i} from ${e}:`,o)}}),t.length===0){const n=r.getElementsByTagName("entry");Array.from(n).forEach((i,o)=>{try{const a={id:`${e}-${o}`,name:getTextContent$1(r.documentElement,"title","No title"),url:e,title:getTextContent$1(i,"title","No title"),link:getAtomLink(i)||e,pubDate:getTextContent$1(i,"published",getTextContent$1(i,"updated",new Date().toISOString())),description:getTextContent$1(i,"summary",getTextContent$1(i,"content","")),content:getContentWithFallback(i,getTextContent$1(i,"summary","")),feedListId:"1",author:getAtomAuthor(i)||getAuthorWithFallback(i,""),categories:getAllTextContents$1(i,"category"),media:getMediaWithFallback(i)};t.push(a)}catch(a){console.warn(`Error parsing Atom entry ${o} from ${e}:`,a)}})}return t},getAtomLink=r=>{const e=r.getElementsByTagName("link");for(let t=0;t<e.length;t++){const s=e[t],n=s.getAttribute("href"),i=s.getAttribute("rel");if(n&&(!i||i==="alternate"))return n}return""},getAtomAuthor=r=>{const e=r.getElementsByTagName("author")[0];if(e){const t=getTextContent$1(e,"name",""),s=getTextContent$1(e,"email","");return t||s||""}return""},isValidXML=r=>{if(r.includes("<?xml")||r.includes("<rss")||r.includes("<feed")||r.includes("<channel"))return!0;try{return new DOMParser().parseFromString(r,"application/xml").getElementsByTagName("parsererror").length===0}catch{return!1}},getJsonValue=(r,e,t)=>{try{return r&&Object.prototype.hasOwnProperty.call(r,e)?r[e]:(console.warn(`Key '${e}' not found in JSON object. Returning default value.`),t)}catch(s){return console.error(`Error getting JSON value for key '${e}':`,s),t}},getJsonArray=(r,e)=>{try{return r&&Object.prototype.hasOwnProperty.call(r,e)&&Array.isArray(r[e])?r[e]:(console.warn(`Key '${e}' not found or is not an array in JSON object. Returning empty array.`),[])}catch(t){return console.error(`Error getting JSON array for key '${e}':`,t),[]}},parseFeedData$2=(r,e)=>{const t=getJsonArray(r,"items"),s=[];return t.forEach((n,i)=>{const o={id:`${e}-${i}`,name:"JSON Feed",url:e,title:getJsonValue(n,"title","No title"),link:getJsonValue(n,"link",e),pubDate:new Date(getJsonValue(n,"pubDate",new Date().toISOString())).toISOString(),description:getJsonValue(n,"description",""),content:getJsonValue(n,"content",""),feedListId:"1",author:getJsonValue(n,"author",""),categories:getJsonArray(n,"categories"),media:getJsonArray(n,"media").map(a=>({url:getJsonValue(a,"url",""),type:getJsonValue(a,"type","")}))};s.push(o)}),s},isValidJSON=r=>{if(r.includes("export ")||r.includes("function ")||r.includes("import ")||r.includes("const ")||!r.trim().startsWith("{")&&!r.trim().startsWith("["))return!1;try{return JSON.parse(r),!0}catch{return!1}},parseTxtContent=r=>{const e=r.split(`
`),t=[];return e.forEach(s=>{const n=s.split("|");if(n.length>=5){const i={title:n[0],link:n[1],pubDate:n[2],description:n[3],content:n[4],author:n[5]||"",categories:n[6]?n[6].split(","):[],media:n[7]?n[7].split(",").map(o=>{const[a,l]=o.split(";");return{url:a,type:l}}):[]};t.push(i)}}),t},parseFeedData$1=(r,e)=>{const t=parseTxtContent(r),s=[];return t.forEach((n,i)=>{let o;try{if(n.pubDate){const l=new Date(n.pubDate);o=isNaN(l.getTime())?new Date().toISOString():l.toISOString()}else o=new Date().toISOString()}catch(l){console.warn("Date parsing error for TXT feed item:",l),o=new Date().toISOString()}const a={id:`${e}-${i}`,name:"TXT Feed",url:e,title:n.title||"No title",link:n.link||e,pubDate:o,description:n.description||"",content:n.content||"",feedListId:"1",author:n.author||"",categories:n.categories||[],media:n.media||[]};s.push(a)}),s},isValidTXT=r=>r.includes("export ")||r.includes("function ")||r.includes("</")||r.includes("<?xml")||r.includes("<rss")||r.includes("<feed")||r.includes("<html")?!1:r.trim().length>0,getTextContent=(r,e,t)=>{try{const s=r.querySelector(e);return s?s.textContent||t:(console.warn(`Element with tag name '${e}' not found in element '${r.tagName}'. Returning default value.`),t)}catch(s){return console.error(`Error getting text content for tag name '${e}' in element '${r.tagName}':`,s),t}},getAttributeValue=(r,e,t)=>{try{const s=r.getAttribute(e);return s||(console.warn(`Attribute '${e}' not found on element '${r.tagName}'. Returning default value.`),t)}catch(s){return console.error(`Error getting attribute value for attribute '${e}' in element '${r.tagName}':`,s),t}},getAllTextContents=(r,e)=>{const t=r.querySelectorAll(e),s=[];return t.forEach(n=>{n.textContent&&s.push(n.textContent)}),s},getTextContentWithFallback=(r,e,t,s)=>{const n=getTextContent(r,e,"");return n||getTextContent(r,t,s)},getElementsByTagName=(r,e)=>r.querySelectorAll(e),parseFeedData=(r,e,t)=>{const s=getElementsByTagName(r,"item"),n=[];return s.forEach((i,o)=>{try{const a={id:`${e}-${o}`,name:"HTML Feed",url:e,title:getTextContent(i,"title","No title"),link:getTextContent(i,"link",e),pubDate:getTextContent(i,"pubDate",new Date().toISOString()),description:getTextContent(i,"description",""),content:getTextContentWithFallback(i,"content:encoded","content",""),feedListId:t,author:getTextContent(i,"author",""),categories:getAllTextContents(i,"category"),media:extractMedia(i)};n.push(a)}catch(a){console.error(`Error parsing item at index ${o}:`,a)}}),n},extractMedia=r=>{const e=getElementsByTagName(r,"media\\:content"),t=[];return e.forEach(s=>{const n=getAttributeValue(s,"url",""),i=getAttributeValue(s,"type","unknown");n&&t.push({url:n,type:i})}),t},isValidHTML=r=>!new DOMParser().parseFromString(r,"text/html").querySelector("parsererror"),handleFetchError=(r,e)=>{r.name==="AbortError"?console.warn(`Fetch aborted for URL: ${e}`):r.message.includes("PR_END_OF_FILE_ERROR")?console.error(`PR_END_OF_FILE_ERROR encountered for URL: ${e}. This might be due to a network issue or server misconfiguration.`):r.message.includes("NetworkError")?console.error(`Network error encountered for URL: ${e}. Please check your internet connection.`):r.message.includes("Failed to fetch")?console.error(`Failed to fetch URL: ${e}. This might be due to a CORS issue or the server being down.`):r.message.includes("404")?console.error(`404 Not Found error for URL: ${e}. The requested resource could not be found.`):r.message.includes("500")?console.error(`500 Internal Server Error for URL: ${e}. The server encountered an unexpected condition.`):r.message.includes("502")?console.error(`502 Bad Gateway error for URL: ${e}. The server received an invalid response from the upstream server.`):r.message.includes("503")?console.error(`503 Service Unavailable error for URL: ${e}. The server is currently unable to handle the request.`):r.message.includes("504")?console.error(`504 Gateway Timeout error for URL: ${e}. The server did not receive a timely response from the upstream server.`):r.message.includes("TypeError")?console.error(`TypeError encountered for URL: ${e}. This might be due to an invalid response or a network issue.`):console.error(`Error fetching URL: ${e}`,r)},handleXMLParsingError=(r,e,t)=>{e.message.includes("mismatched tag")?console.warn(`Mismatched tag error in XML data fetched for URL: ${r}`):e.message.includes("invalid token")?console.warn(`Invalid token error in XML data fetched for URL: ${r}`):e.message.includes("unclosed token")?console.warn(`Unclosed token error in XML data fetched for URL: ${r}`):e.message.includes("unexpected end of input")?console.warn(`Unexpected end of input error in XML data fetched for URL: ${r}`):e.message.includes("entity not defined")?console.warn(`Entity not defined error in XML data fetched for URL: ${r}`):e.message.includes("invalid character")?console.warn(`Invalid character error in XML data fetched for URL: ${r}`):e.message.includes("attribute without value")?console.warn(`Attribute without value error in XML data fetched for URL: ${r}`):e.message.includes("duplicate attribute")?console.warn(`Duplicate attribute error in XML data fetched for URL: ${r}`):e.message.includes("invalid attribute name")?console.warn(`Invalid attribute name error in XML data fetched for URL: ${r}`):e.message.includes("invalid element name")?console.warn(`Invalid element name error in XML data fetched for URL: ${r}`):e.message.includes("namespace error")?console.warn(`Namespace error in XML data fetched for URL: ${r}`):e.message.includes("parsererror")?(console.warn(`Parser error in XML data fetched for URL: ${r}`),console.warn(`XML Content: ${t}`)):(console.warn(`Unknown XML parsing error for URL: ${r}`,e),console.warn(`XML Content: ${t}`))},handleJSONParsingError=(r,e,t)=>{e.message.includes("Unexpected token")?console.warn(`Unexpected token error in JSON data fetched for URL: ${r}`):e.message.includes("Unexpected end of JSON input")?console.warn(`Unexpected end of JSON input error in JSON data fetched for URL: ${r}`):e.message.includes("Unexpected string in JSON")?console.warn(`Unexpected string error in JSON data fetched for URL: ${r}`):e.message.includes("Unexpected number in JSON")?console.warn(`Unexpected number error in JSON data fetched for URL: ${r}`):e.message.includes("Unexpected boolean in JSON")?console.warn(`Unexpected boolean error in JSON data fetched for URL: ${r}`):e.message.includes("Unexpected null in JSON")?console.warn(`Unexpected null error in JSON data fetched for URL: ${r}`):e.message.includes("Unexpected character in JSON")?console.warn(`Unexpected character error in JSON data fetched for URL: ${r}`):console.warn(`Unknown JSON parsing error for URL: ${r}`,e),console.warn(`JSON Content: ${t}`)},handleTXTParsingError=(r,e,t)=>{e.message.includes("Unexpected token")?console.warn(`Unexpected token error in TXT data fetched for URL: ${r}`):e.message.includes("Unexpected end of input")?console.warn(`Unexpected end of input error in TXT data fetched for URL: ${r}`):e.message.includes("Invalid character")?console.warn(`Invalid character error in TXT data fetched for URL: ${r}`):e.message.includes("Encoding error")?console.warn(`Encoding error in TXT data fetched for URL: ${r}`):console.warn(`Unknown TXT parsing error for URL: ${r}`,e),console.warn(`TXT Content: ${t}`)},handleHTMLParsingError=(r,e,t)=>{e.message.includes("Unexpected token")?console.warn(`Unexpected token error in HTML data fetched for URL: ${r}`):e.message.includes("Unexpected end of input")?console.warn(`Unexpected end of input error in HTML data fetched for URL: ${r}`):e.message.includes("Invalid character")?console.warn(`Invalid character error in HTML data fetched for URL: ${r}`):e.message.includes("Encoding error")?console.warn(`Encoding error in HTML data fetched for URL: ${r}`):e.message.includes("Unclosed tag")?console.warn(`Unclosed tag error in HTML data fetched for URL: ${r}`):e.message.includes("Mismatched tag")?console.warn(`Mismatched tag error in HTML data fetched for URL: ${r}`):console.warn(`Unknown HTML parsing error for URL: ${r}`,e),console.warn(`HTML Content: ${t}`)},LEGACY_PROXY_CONFIG={vercel:"/api/proxy-feed?url=",fallback:["https://api.allorigins.win/get?url=","https://api.codetabs.com/v1/proxy?quest=","https://cors-anywhere.herokuapp.com/"]},getProxyUrl=r=>{try{const e=SettingsIntegrationService.getCORSStrategy(),t=SettingsIntegrationService.getProxyUrl(r);if(t!==r)return t;if(e===CORSStrategy.DIRECT)return r}catch(e){console.warn("Failed to get CORS settings, falling back to legacy configuration:",e)}return`${LEGACY_PROXY_CONFIG.vercel}${encodeURIComponent(r)}`},handleCORSError=(r,e)=>{console.error(`CORS error fetching feed from ${r}:`,e)},fetchWithRetry=async(r,e,t=3,s=300)=>{for(let n=1;n<=t;n++){try{const i=await fetch(r,e);if(i.ok)return i;console.warn(`Attempt ${n} failed: ${i.statusText}`)}catch(i){i instanceof TypeError&&i.message.includes("NetworkError")?handleCORSError(r,i):handleFetchError(i,r)}await new Promise(i=>setTimeout(i,s*n))}throw new Error(`Failed to fetch ${r} after ${t} attempts`)},fetchWithFallback=async(r,e)=>{const t=getProxyUrl(r);try{console.log(`Attempting to fetch via primary proxy: ${t}`);const s=await fetchWithRetry(t,e);if(s.ok)return s;throw new Error(`Primary proxy failed: ${s.status} ${s.statusText}`)}catch(s){console.warn("Primary proxy failed, trying fallbacks:",s);let n=[];try{n=SettingsIntegrationService.getCORSProxyChain()}catch{n=LEGACY_PROXY_CONFIG.fallback.map(o=>`${o}`)}for(let i=0;i<n.length;i++)try{const o=n[i],a=o===""?r:`${o}${encodeURIComponent(r)}`;console.log(`Attempting fallback proxy ${i+1}: ${a}`);const l=await fetchWithRetry(a,{...e,headers:{...e.headers,"X-Requested-With":"XMLHttpRequest"}});if(l.ok)return console.log(`Fallback proxy ${i+1} succeeded`),l}catch(o){console.warn(`Fallback proxy ${i+1} failed:`,o);continue}throw new Error(`All proxy attempts failed for URL: ${r}`)}},fetchFeed=async r=>{console.log(`Starting to fetch feed from URL: ${r}`);try{const e=await fetchWithFallback(r,{headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});if(!e.ok)throw new Error(`Failed to fetch feed: ${e.statusText}`);const t=e.headers.get("content-type"),s=await e.text();console.log(`Feed data fetched for URL: ${r}`,s);let n=[];if(t&&(t.includes("application/xml")||t.includes("text/xml"))){if(!isValidXML(s))return handleXMLParsingError(r,new Error("Invalid XML"),s),null;const a=new DOMParser().parseFromString(s,"application/xml");if(a.getElementsByTagName("parsererror").length>0)return handleXMLParsingError(r,new Error("Parser error"),s),null;n=parseFeedData$3(a,r)}else if(t&&t.includes("application/json")){if(!isValidJSON(s))return handleJSONParsingError(r,new Error("Invalid JSON"),s),null;const o=JSON.parse(s);n=parseFeedData$2(o,r)}else if(t&&t.includes("text/plain")){if(!isValidTXT(s))return handleTXTParsingError(r,new Error("Invalid TXT"),s),null;n=parseFeedData$1(s,r)}else if(t&&t.includes("text/html")){if(!isValidHTML(s))return handleHTMLParsingError(r,new Error("Invalid HTML"),s),null;const a=new DOMParser().parseFromString(s,"text/html");n=parseFeedData(a.documentElement,r,"1")}else throw new Error(`Unsupported content type: ${t}`);return{feeds:convertFeedsToFeedItems(n),fetchedAt:new Date().toISOString()}}catch(e){return e instanceof TypeError&&e.message.includes("NetworkError")?handleCORSError(r,e):(console.error("Error fetching feed:",e),handleFetchError(e,r)),null}};let FeedService$2=class{constructor(){O(this,"feeds",[]);O(this,"feedLists",[]);O(this,"feedsStorageKey","feeds");O(this,"feedListsStorageKey","feedLists");this.loadFeeds(),this.loadFeedLists(),this.updateFeedsFromServer()}loadFeeds(){try{log.debug("FeedService","Loading feeds from local storage");const e=LocalStorageUtil.getItem(this.feedsStorageKey);e&&e.length>0?this.feeds=e:this.feeds=this.getDefaultFeeds()}catch(e){log.error("FeedService","Failed to load feeds:",e),this.feeds=this.getDefaultFeeds(),this.saveFeeds(),log.debug("FeedService","Default feeds loaded due to error:",this.feeds)}}loadFeedLists(){try{log.debug("FeedService","Loading feed lists from local storage");const e=LocalStorageUtil.getItem(this.feedListsStorageKey);e&&e.length>0?this.feedLists=e:this.feedLists=this.getDefaultFeedLists()}catch(e){log.error("FeedService","Failed to load feed lists:",e),this.feedLists=this.getDefaultFeedLists(),this.saveFeedLists(),log.debug("FeedService","Default feed lists loaded due to error:",this.feedLists)}}saveFeeds(){try{log.debug("FeedService","Saving feeds to local storage"),LocalStorageUtil.setItem(this.feedsStorageKey,this.feeds),log.debug("FeedService","Feeds saved to local storage")}catch(e){log.error("FeedService","Failed to save feeds:",e)}}saveFeedLists(){try{log.debug("FeedService","Saving feed lists to local storage"),LocalStorageUtil.setItem(this.feedListsStorageKey,this.feedLists),log.debug("FeedService","Feed lists saved to local storage")}catch(e){log.error("FeedService","Failed to save feed lists:",e)}}getDefaultFeeds(){return convertFeedItemsToFeeds(DefaultFeeds)}resetToDefault(){log.debug("FeedService","Resetting feeds and feed lists to default"),this.feeds=this.getDefaultFeeds(),this.feedLists=this.getDefaultFeedLists(),this.saveFeeds(),this.saveFeedLists(),this.updateFeedsFromServer()}getDefaultFeedLists(){return[{id:"1",name:"Default List"}]}getFeeds(){return log.debug("FeedService","Getting all feeds"),this.feeds}getFeedLists(){log.debug("FeedService","Getting all feed lists");try{const e=this.feedLists;return log.debug("FeedService","Feed lists retrieved:",e),e}catch(e){return log.error("FeedService","Failed to get feed lists:",e),[]}}getFeedsByList(e){log.debug("FeedService",`Getting feeds for list ID: ${e}`);try{const t=this.feeds.filter(s=>s.feedListId===e);return log.debug("FeedService",`Feeds for list ID ${e}:`,t),t}catch(t){return log.error("FeedService",`Failed to get feeds for list ID ${e}:`,t),[]}}getFeedById(e){log.debug("FeedService",`Getting feed by ID: ${e}`);try{const t=this.feeds.find(s=>s.id===e);return log.debug("FeedService","Feed found:",t),t}catch(t){log.error("FeedService",`Failed to get feed by ID ${e}:`,t);return}}addFeed(e){try{log.debug("FeedService","Adding new feed:",e),this.feeds.push(e),this.saveFeeds()}catch(t){log.error("FeedService","Failed to add feed:",t)}}addFeedToList(e,t){try{log.debug("FeedService",`Adding feed to list ID: ${e}`,t),t.feedListId=e,this.addFeed(t)}catch(s){log.error("FeedService","Failed to add feed to list:",s)}}removeFeed(e){try{log.debug("FeedService",`Removing feed ID: ${e}`),this.feeds=this.feeds.filter(t=>t.id!==e),this.saveFeeds()}catch(t){log.error("FeedService","Failed to remove feed:",t)}}removeFeedFromList(e,t){try{log.debug("FeedService",`Removing feed ID: ${t} from list ID: ${e}`),this.feeds=this.feeds.filter(s=>s.id!==t||s.feedListId!==e),this.saveFeeds()}catch(s){log.error("FeedService","Failed to remove feed from list:",s)}}addFeedList(e){try{log.debug("FeedService","Adding new feed list:",e),this.feedLists.push(e),this.saveFeedLists()}catch(t){log.error("FeedService","Failed to add feed list:",t)}}removeFeedList(e){try{log.debug("FeedService",`Removing feed list ID: ${e}`),this.feedLists=this.feedLists.filter(t=>t.id!==e),this.saveFeedLists()}catch(t){log.error("FeedService","Failed to remove feed list:",t)}}async updateFeedsFromServer(){log.debug("FeedService","Updating feeds from server"),log.debug("FeedService","Current feeds:",this.feeds);const e=[];for(const t of this.feeds)try{const s=await fetchFeed(t.url);if(s){const n={...t,...s.feeds[0]};e.push(n)}else log.error("FeedService",`Failed to fetch feed from ${t.url}`),e.push(t)}catch(s){log.error("FeedService",`Error fetching feed from ${t.url}:`,s),e.push(t)}this.feeds=e,this.saveFeeds(),log.debug("FeedService","Feeds updated from server:",this.feeds)}getFeedResults(e){return FeedController$1.getFeedResults(e)}enrichFeedWithMetadata(e){return{...e,priority:this.determinePriority(e),contentType:this.determineContentType(e),region:this.determineRegion(e),tags:this.extractTags(e),timestamp:e.pubDate,source:e.name}}determinePriority(e){const t=[e.title,e.description,e.content].filter(Boolean).join(" ").toLowerCase();return t.includes("urgent")||t.includes("breaking")||t.includes("critical")||t.includes("emergency")||t.includes("immediate")?"CRITICAL":t.includes("important")||t.includes("alert")||t.includes("warning")||t.includes("security")||t.includes("threat")?"HIGH":t.includes("update")||t.includes("notice")||t.includes("announcement")||t.includes("report")?"MEDIUM":"LOW"}determineContentType(e){const t=[e.title,e.description,e.content,e.name].filter(Boolean).join(" ").toLowerCase();return t.includes("threat")||t.includes("attack")||t.includes("cyber")||t.includes("malware")||t.includes("vulnerability")||t.includes("exploit")?"THREAT":t.includes("intelligence")||t.includes("intel")||t.includes("classified")||t.includes("analysis")||t.includes("assessment")||t.includes("briefing")?"INTEL":t.includes("alert")||t.includes("warning")||t.includes("emergency")||t.includes("urgent")||t.includes("critical")?"ALERT":"NEWS"}determineRegion(e){const t=[e.title,e.description,e.content,e.name,e.url].filter(Boolean).join(" ").toLowerCase();return t.includes("usa")||t.includes("america")||t.includes("canada")||t.includes("mexico")||t.includes("brazil")||t.includes("us ")||t.includes(".us")||t.includes("washington")||t.includes("pentagon")?"AMERICAS":t.includes("europe")||t.includes("uk")||t.includes("britain")||t.includes("germany")||t.includes("france")||t.includes("nato")||t.includes("eu ")||t.includes("brexit")||t.includes("london")||t.includes("brussels")?"EUROPE":t.includes("china")||t.includes("japan")||t.includes("korea")||t.includes("india")||t.includes("asia")||t.includes("pacific")||t.includes("beijing")||t.includes("tokyo")||t.includes("seoul")||t.includes("sydney")?"ASIA_PACIFIC":"GLOBAL"}extractTags(e){const t=[];e.categories&&e.categories.length>0&&t.push(...e.categories);const s=[e.title,e.description,e.content].filter(Boolean).join(" ").toLowerCase();return["cybersecurity","malware","ransomware","phishing","breach","vulnerability","exploit","apt","nation-state","hacker","trojan","virus","backdoor","zero-day","mitigation","incident","response","forensics","detection","prevention"].forEach(i=>{s.includes(i)&&t.push(i.toUpperCase())}),[...new Set(t)]}};const FeedService$3=new FeedService$2,Skeleton=({width:r="100%",height:e="20px",borderRadius:t="4px",className:s=""})=>jsxRuntimeExports.jsx("div",{className:`skeleton ${s}`,style:{width:r,height:e,borderRadius:t}}),FeedItemSkeleton=()=>jsxRuntimeExports.jsxs("div",{className:"feed-item-skeleton",children:[jsxRuntimeExports.jsxs("div",{className:"skeleton-header",children:[jsxRuntimeExports.jsx(Skeleton,{width:"60%",height:"24px"}),jsxRuntimeExports.jsx(Skeleton,{width:"80px",height:"16px"})]}),jsxRuntimeExports.jsx(Skeleton,{width:"100%",height:"16px",className:"skeleton-description"}),jsxRuntimeExports.jsx(Skeleton,{width:"90%",height:"16px",className:"skeleton-description"}),jsxRuntimeExports.jsx(Skeleton,{width:"70%",height:"16px",className:"skeleton-description"}),jsxRuntimeExports.jsxs("div",{className:"skeleton-footer",children:[jsxRuntimeExports.jsx(Skeleton,{width:"120px",height:"14px"}),jsxRuntimeExports.jsx(Skeleton,{width:"80px",height:"14px"})]})]}),FeedListSkeleton=({count:r=5})=>jsxRuntimeExports.jsx("div",{className:"feed-list-skeleton",children:Array.from({length:r}).map((e,t)=>jsxRuntimeExports.jsx(FeedItemSkeleton,{},t))}),LoadingSpinner=({size:r="medium",color:e="#00bfff",text:t})=>jsxRuntimeExports.jsxs("div",{className:`loading-spinner ${r}`,children:[jsxRuntimeExports.jsx("div",{className:"spinner",style:{borderTopColor:e}}),t&&jsxRuntimeExports.jsx("span",{className:"spinner-text",children:t})]}),FeedVisualizerSkeleton=()=>jsxRuntimeExports.jsxs("div",{className:"feed-visualizer-skeleton",children:[jsxRuntimeExports.jsxs("div",{className:"feed-controls-skeleton",children:[jsxRuntimeExports.jsxs("div",{className:"status-bar-skeleton",children:[jsxRuntimeExports.jsx(Skeleton,{width:"120px",height:"20px"}),jsxRuntimeExports.jsx(Skeleton,{width:"140px",height:"16px"}),jsxRuntimeExports.jsx(Skeleton,{width:"160px",height:"16px"})]}),jsxRuntimeExports.jsxs("div",{className:"control-buttons-skeleton",children:[jsxRuntimeExports.jsx(Skeleton,{width:"80px",height:"32px",borderRadius:"6px"}),jsxRuntimeExports.jsx(Skeleton,{width:"100px",height:"32px",borderRadius:"6px"})]})]}),jsxRuntimeExports.jsxs("div",{className:"search-filter-skeleton",children:[jsxRuntimeExports.jsxs("div",{className:"filter-header-skeleton",children:[jsxRuntimeExports.jsx(Skeleton,{width:"150px",height:"24px"}),jsxRuntimeExports.jsx(Skeleton,{width:"60px",height:"20px"})]}),jsxRuntimeExports.jsx("div",{className:"search-section-skeleton",children:jsxRuntimeExports.jsx(Skeleton,{width:"100%",height:"40px",borderRadius:"6px"})}),jsxRuntimeExports.jsxs("div",{className:"filter-controls-skeleton",children:[jsxRuntimeExports.jsx(Skeleton,{width:"120px",height:"36px",borderRadius:"6px"}),jsxRuntimeExports.jsx(Skeleton,{width:"120px",height:"36px",borderRadius:"6px"}),jsxRuntimeExports.jsx(Skeleton,{width:"120px",height:"36px",borderRadius:"6px"})]}),jsxRuntimeExports.jsxs("div",{className:"filter-results-skeleton",children:[jsxRuntimeExports.jsx(Skeleton,{width:"100px",height:"16px"}),jsxRuntimeExports.jsx(Skeleton,{width:"80px",height:"16px"})]})]}),jsxRuntimeExports.jsx(FeedListSkeleton,{count:6})]}),ErrorOverlay=({title:r,message:e,onRetry:t,suggestions:s=[]})=>jsxRuntimeExports.jsx("div",{className:"error-overlay",children:jsxRuntimeExports.jsxs("div",{className:"error-content",children:[jsxRuntimeExports.jsx("h3",{className:"error-title",children:r}),jsxRuntimeExports.jsx("p",{className:"error-message",children:e}),s.length>0&&jsxRuntimeExports.jsxs("div",{className:"error-suggestions",children:[jsxRuntimeExports.jsx("h4",{children:"💡 Suggestions:"}),jsxRuntimeExports.jsx("ul",{children:s.map((n,i)=>jsxRuntimeExports.jsx("li",{children:n},i))})]}),t&&jsxRuntimeExports.jsx("button",{onClick:t,className:"error-retry-btn",children:"🔄 Try Again"})]})}),SourceManager=({onClose:r,onSourceAdded:e})=>{const[t,s]=reactExports.useState({name:"",url:"",endpoint:"",category:EarthAllianceCategory.INDEPENDENT_INVESTIGATIVE_JOURNALISM,protocol:SourceProtocol.RSS,trustRating:75,accessMethod:"direct",verificationMethod:"source-documentation",format:"news"}),n=i=>{i.preventDefault();const o={id:`custom-${Date.now()}`,name:t.name},a={id:`feed-${Date.now()}`,name:t.name,url:t.endpoint,title:t.name,link:t.url,pubDate:new Date().toISOString(),description:`Earth Alliance aligned source: ${t.category}`,content:`Trust rating: ${t.trustRating}%`,feedListId:o.id,categories:[t.category],tags:[t.format,`trust-${t.trustRating}`,t.protocol]};FeedService$3.addFeedList(o),FeedService$3.addFeedToList(o.id,a),e(),r()};return jsxRuntimeExports.jsxs("div",{className:"source-manager-modal",children:[jsxRuntimeExports.jsx("div",{className:"modal-overlay",onClick:r}),jsxRuntimeExports.jsxs("div",{className:"modal-content",children:[jsxRuntimeExports.jsxs("div",{className:"modal-header",children:[jsxRuntimeExports.jsx("h3",{children:"Add New Intel Source"}),jsxRuntimeExports.jsx("button",{className:"close-btn",onClick:r,children:"×"})]}),jsxRuntimeExports.jsxs("form",{onSubmit:n,className:"source-form",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Source Name"}),jsxRuntimeExports.jsx("input",{type:"text",value:t.name,onChange:i=>s({...t,name:i.target.value}),placeholder:"Enter source name",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Website URL"}),jsxRuntimeExports.jsx("input",{type:"url",value:t.url,onChange:i=>s({...t,url:i.target.value}),placeholder:"https://example.com",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Feed Endpoint"}),jsxRuntimeExports.jsx("input",{type:"url",value:t.endpoint,onChange:i=>s({...t,endpoint:i.target.value}),placeholder:"https://example.com/feed",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Category"}),jsxRuntimeExports.jsx("select",{value:t.category,onChange:i=>s({...t,category:i.target.value}),children:Object.values(EarthAllianceCategory).map(i=>jsxRuntimeExports.jsx("option",{value:i,children:i.replace(/_/g," ")},i))})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Protocol"}),jsxRuntimeExports.jsx("select",{value:t.protocol,onChange:i=>s({...t,protocol:i.target.value}),children:Object.values(SourceProtocol).map(i=>jsxRuntimeExports.jsx("option",{value:i,children:i.toUpperCase()},i))})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Trust Rating (0-100)"}),jsxRuntimeExports.jsx("input",{type:"number",min:"0",max:"100",value:t.trustRating,onChange:i=>s({...t,trustRating:parseInt(i.target.value)})})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Access Method"}),jsxRuntimeExports.jsxs("select",{value:t.accessMethod,onChange:i=>s({...t,accessMethod:i.target.value}),children:[jsxRuntimeExports.jsx("option",{value:"direct",children:"Direct"}),jsxRuntimeExports.jsx("option",{value:"account-required",children:"Account Required"}),jsxRuntimeExports.jsx("option",{value:"restricted",children:"Restricted"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:r,className:"btn-cancel",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"btn-submit",children:"Add Source"})]})]})]})]})},TACTICAL_INTEL_SOURCES=[{id:"stratfor-worldview",name:"Stratfor Worldview",url:"https://worldview.stratfor.com",category:"OSINT",reliability:9,classification:"CONFIDENTIAL",updateFrequency:15,requiresAuth:!0,authType:"API_KEY",cost:"premium",region:["GLOBAL"],tags:["geopolitical","strategic-intelligence","global-analysis"],healthStatus:"operational",verificationRequired:!0,minimumClearance:"CONFIDENTIAL",needToKnow:["strategic-intelligence"],endpoint:"https://api.stratfor.com/feeds/intelligence",protocol:"API",format:"json"},{id:"janes-defence",name:"Jane's Defence Intelligence",url:"https://www.janes.com",category:"TECHINT",reliability:9,classification:"CONFIDENTIAL",updateFrequency:30,requiresAuth:!0,authType:"API_KEY",cost:"premium",region:["GLOBAL"],tags:["defence-technology","weapons-systems","military-capabilities"],healthStatus:"operational",verificationRequired:!0,minimumClearance:"CONFIDENTIAL",needToKnow:["defence-intelligence"],endpoint:"https://api.janes.com/feeds/defence",protocol:"API",format:"json"},{id:"recorded-future-threat",name:"Recorded Future Threat Intelligence",url:"https://www.recordedfuture.com",category:"CYBINT",reliability:8,classification:"CONFIDENTIAL",updateFrequency:10,requiresAuth:!0,authType:"API_KEY",cost:"premium",region:["GLOBAL"],tags:["cyber-threats","threat-intelligence","indicators"],healthStatus:"operational",verificationRequired:!0,minimumClearance:"CONFIDENTIAL",needToKnow:["cyber-intelligence"],endpoint:"https://api.recordedfuture.com/feeds/threat",protocol:"API",format:"json"},{id:"maxar-satellite",name:"Maxar Satellite Intelligence",url:"https://www.maxar.com",category:"GEOINT",reliability:9,classification:"SECRET",updateFrequency:60,requiresAuth:!0,authType:"API_KEY",cost:"premium",region:["GLOBAL"],tags:["satellite-imagery","geospatial-analysis","change-detection"],healthStatus:"operational",verificationRequired:!0,minimumClearance:"SECRET",needToKnow:["geospatial-intelligence"],endpoint:"https://api.maxar.com/feeds/intelligence",protocol:"API",format:"json"},{id:"us-state-alerts",name:"US State Department Security Alerts",url:"https://travel.state.gov",category:"HUMINT",reliability:10,classification:"UNCLASSIFIED",updateFrequency:60,requiresAuth:!1,cost:"free",region:["GLOBAL"],tags:["travel-security","country-conditions","threat-warnings"],healthStatus:"operational",verificationRequired:!1,minimumClearance:"UNCLASSIFIED",endpoint:"https://travel.state.gov/content/travel/en/traveladvisories/api/feed",protocol:"RSS",format:"rss"},{id:"dhs-cybersecurity",name:"DHS Cybersecurity Advisories",url:"https://www.cisa.gov",category:"CYBINT",reliability:10,classification:"UNCLASSIFIED",updateFrequency:30,requiresAuth:!1,cost:"free",region:["US"],tags:["cybersecurity","vulnerabilities","threat-advisories"],healthStatus:"operational",verificationRequired:!1,minimumClearance:"UNCLASSIFIED",endpoint:"https://www.cisa.gov/cybersecurity-advisories/rss",protocol:"RSS",format:"rss"},{id:"fbi-ic3-alerts",name:"FBI IC3 Cyber Alerts",url:"https://www.ic3.gov",category:"CYBINT",reliability:10,classification:"UNCLASSIFIED",updateFrequency:120,requiresAuth:!1,cost:"free",region:["US"],tags:["cyber-crime","fraud-alerts","threat-warnings"],healthStatus:"operational",verificationRequired:!1,minimumClearance:"UNCLASSIFIED",endpoint:"https://www.ic3.gov/Media/RSS",protocol:"RSS",format:"rss"},{id:"flightradar24-military",name:"FlightRadar24 Military Tracking",url:"https://www.flightradar24.com",category:"SIGINT",reliability:7,classification:"UNCLASSIFIED",updateFrequency:5,requiresAuth:!0,authType:"API_KEY",cost:"premium",region:["GLOBAL"],tags:["aircraft-tracking","military-flights","air-traffic"],healthStatus:"operational",verificationRequired:!0,minimumClearance:"UNCLASSIFIED",needToKnow:["air-intelligence"],endpoint:"https://api.flightradar24.com/feeds/military",protocol:"API",format:"json"},{id:"marine-traffic-security",name:"MarineTraffic Security Feed",url:"https://www.marinetraffic.com",category:"MASINT",reliability:8,classification:"UNCLASSIFIED",updateFrequency:15,requiresAuth:!0,authType:"API_KEY",cost:"premium",region:["GLOBAL"],tags:["maritime-tracking","vessel-intelligence","port-security"],healthStatus:"operational",verificationRequired:!0,minimumClearance:"UNCLASSIFIED",needToKnow:["maritime-intelligence"],endpoint:"https://api.marinetraffic.com/feeds/security",protocol:"API",format:"json"},{id:"defense-news",name:"Defense News Intelligence",url:"https://www.defensenews.com",category:"MILINT",reliability:7,classification:"UNCLASSIFIED",updateFrequency:60,requiresAuth:!1,cost:"free",region:["GLOBAL"],tags:["defense-industry","military-procurement","defense-policy"],healthStatus:"operational",verificationRequired:!1,minimumClearance:"UNCLASSIFIED",endpoint:"https://www.defensenews.com/arc/outboundfeeds/rss/",protocol:"RSS",format:"rss"},{id:"janes-360",name:"Jane's 360 Intelligence",url:"https://www.janes.com",category:"MILINT",reliability:8,classification:"UNCLASSIFIED",updateFrequency:30,requiresAuth:!0,authType:"API_KEY",cost:"premium",region:["GLOBAL"],tags:["military-analysis","defence-intelligence","threat-assessment"],healthStatus:"operational",verificationRequired:!0,minimumClearance:"UNCLASSIFIED",needToKnow:["military-intelligence"],endpoint:"https://api.janes.com/feeds/360",protocol:"API",format:"json"},{id:"nist-cybersecurity",name:"NIST Cybersecurity Framework",url:"https://www.nist.gov",category:"TECHINT",reliability:10,classification:"UNCLASSIFIED",updateFrequency:240,requiresAuth:!1,cost:"free",region:["US"],tags:["cybersecurity-framework","standards","technical-guidance"],healthStatus:"operational",verificationRequired:!1,minimumClearance:"UNCLASSIFIED",endpoint:"https://www.nist.gov/news/rss",protocol:"RSS",format:"rss"},{id:"nato-intelligence",name:"NATO Intelligence Sharing",url:"https://www.nato.int",category:"MILINT",reliability:10,classification:"SECRET",updateFrequency:30,requiresAuth:!0,authType:"CERTIFICATE",cost:"restricted",region:["NATO"],tags:["alliance-intelligence","collective-defense","threat-sharing"],healthStatus:"operational",verificationRequired:!0,minimumClearance:"SECRET",needToKnow:["nato-intelligence"],endpoint:"https://api.nato.int/feeds/intelligence",protocol:"API",format:"json"},{id:"europol-threat",name:"Europol Threat Assessment",url:"https://www.europol.europa.eu",category:"HUMINT",reliability:9,classification:"CONFIDENTIAL",updateFrequency:120,requiresAuth:!0,authType:"API_KEY",cost:"restricted",region:["EU"],tags:["organized-crime","terrorism","threat-assessment"],healthStatus:"operational",verificationRequired:!0,minimumClearance:"CONFIDENTIAL",needToKnow:["law-enforcement"],endpoint:"https://api.europol.europa.eu/feeds/threat",protocol:"API",format:"json"}],INTELLIGENCE_CATEGORIES={OSINT:{name:"Open Source Intelligence",description:"Publicly available information",color:"#28a745",icon:"globe"},HUMINT:{name:"Human Intelligence",description:"Information from human sources",color:"#6f42c1",icon:"users"},SIGINT:{name:"Signals Intelligence",description:"Electronic signals and communications",color:"#fd7e14",icon:"radio"},GEOINT:{name:"Geospatial Intelligence",description:"Geographic and imagery intelligence",color:"#20c997",icon:"map"},TECHINT:{name:"Technical Intelligence",description:"Technical capabilities and systems",color:"#6610f2",icon:"cog"},CYBINT:{name:"Cyber Intelligence",description:"Cyber threats and digital intelligence",color:"#dc3545",icon:"shield"},MILINT:{name:"Military Intelligence",description:"Military capabilities and operations",color:"#495057",icon:"star"},MASINT:{name:"Measurement and Signature Intelligence",description:"Technical measurements and signatures",color:"#e83e8c",icon:"chart-line"}},IntelSources=({setSelectedFeedList:r,displayMode:e="operational",showClassificationLevels:t=!0,enableRealTimeAlerts:s=!0})=>{const{state:n,actions:i}=useIntelligence(),[o,a]=reactExports.useState([]),[l,p]=reactExports.useState(!0),[g,x]=reactExports.useState(null),[b,E]=reactExports.useState(null),[f,j]=reactExports.useState("grid"),[C,S]=reactExports.useState("category"),[R,I]=reactExports.useState(!1),[A,$]=reactExports.useState([]),[N,k]=reactExports.useState(!0),[P,D]=reactExports.useState(!0),[M,L]=reactExports.useState(!1),[q,K]=reactExports.useState([]);reactExports.useEffect(()=>{(async()=>{p(!0),x(null);try{let X=n.sources;if(X.length===0){const ce=TACTICAL_INTEL_SOURCES.filter(le=>le.cost==="free"||le.classification==="UNCLASSIFIED");X=ce,ce.forEach(le=>i.addSource(le))}K(X);const Z=await FeedService$3.getFeedLists();a(Z)}catch(X){console.error("Failed to load tactical sources:",X),x("Failed to load intelligence sources")}finally{p(!1)}})()},[n.sources,i]),reactExports.useEffect(()=>{if(P){const U=setInterval(()=>{q.forEach(X=>{const Z=Math.random()>.1?"operational":"degraded";X.healthStatus!==Z&&i.updateSource(X.id,{healthStatus:Z,lastUpdated:new Date})})},3e4);return()=>clearInterval(U)}},[P,q,i]);const H=U=>{E(U),r(U)},ee=()=>[...A.length>0?q.filter(X=>A.includes(X.category)):q].sort((X,Z)=>{switch(C){case"reliability":return Z.reliability-X.reliability;case"category":return X.category.localeCompare(Z.category);case"priority":const ce=le=>{let fe=le.reliability;return le.healthStatus==="operational"&&(fe+=2),le.healthStatus==="down"&&(fe-=5),le.cost==="free"&&(fe+=1),fe};return ce(Z)-ce(X);default:return X.name.localeCompare(Z.name)}}),B=()=>{const U=[...o].sort((X,Z)=>{var ce;switch(C){case"reliability":return Z.reliability||5-X.reliability||5;case"category":return((ce=X.category)==null?void 0:ce.localeCompare(Z.category))||0;case"priority":return Z.priority||0-X.priority||0;default:return X.name.localeCompare(Z.name)}});return R?U.filter(X=>X.isActive!==!1):U},G=U=>U.healthStatus||"operational",Q=U=>{switch(U){case"operational":return"#00ff41";case"degraded":return"#ff9500";case"down":return"#ff0040";case"maintenance":return"#00aaff";default:return"#666666"}},z=U=>U>=9?"#00ff41":U>=7?"#ff9500":U>=5?"#ffc107":"#ff0040",J=U=>{switch(U){case"UNCLASSIFIED":return"#28a745";case"CONFIDENTIAL":return"#ffc107";case"SECRET":return"#fd7e14";case"TOP_SECRET":return"#dc3545";default:return"#6c757d"}},W=U=>{switch(U){case"UNCLASSIFIED":return"UNCLASSIFIED - Information that can be released to the public";case"CONFIDENTIAL":return"CONFIDENTIAL - Information that could damage national security if disclosed";case"SECRET":return"SECRET - Information that could cause serious damage to national security";case"TOP_SECRET":return"TOP SECRET - Information that could cause exceptionally grave damage to national security";default:return"Classification level unknown"}},te=U=>{const X=U>=9?"A":U>=8?"B":U>=7?"C":U>=6?"D":U>=3?"E":"F",Z=U>=9?"Completely reliable":U>=8?"Usually reliable":U>=7?"Fairly reliable":U>=6?"Not usually reliable":U>=3?"Unreliable":"Cannot be judged";return`Grade ${X} - ${Z} (${U}/10)`},xe=U=>{const X=INTELLIGENCE_CATEGORIES[U];return X?`${X.name} - ${X.description||"Intelligence category"}`:"Unknown category"},me=U=>{const X=U.lastActivity||0,ce=Date.now()-X;return ce<3e5?"active":ce<18e5?"idle":"stale"},ye=U=>{switch(U){case"active":return"#00ff41";case"idle":return"#ff9500";case"stale":return"#ff0040";default:return"#666666"}},$e=()=>{L(!0)},Te=async()=>{try{const U=await FeedService$3.getFeedLists();a(U)}catch(U){console.error("Failed to refresh feed lists:",U)}};return l?jsxRuntimeExports.jsxs("div",{className:"tactical-module module-intelligence animate-slide-in-left",children:[jsxRuntimeExports.jsxs("div",{className:"tactical-header-enhanced",children:[jsxRuntimeExports.jsxs("div",{className:"header-primary",children:[jsxRuntimeExports.jsx("span",{className:"module-icon",children:"📡"}),jsxRuntimeExports.jsx("h3",{children:"INTEL SOURCES"})]}),jsxRuntimeExports.jsxs("div",{className:"header-status",children:[jsxRuntimeExports.jsx("span",{className:"status-dot scanning"}),jsxRuntimeExports.jsx("span",{className:"status-text",children:"SCANNING"})]})]}),jsxRuntimeExports.jsx("div",{className:"tactical-content",children:jsxRuntimeExports.jsxs("div",{className:"intel-loading-state",children:[jsxRuntimeExports.jsx(LoadingSpinner,{size:"medium",color:"#00ffaa"}),jsxRuntimeExports.jsx("span",{className:"loading-message",children:"ESTABLISHING CONNECTIONS..."})]})})]}):g?jsxRuntimeExports.jsxs("div",{className:"tactical-module module-intelligence animate-slide-in-left",children:[jsxRuntimeExports.jsxs("div",{className:"tactical-header-enhanced",children:[jsxRuntimeExports.jsxs("div",{className:"header-primary",children:[jsxRuntimeExports.jsx("span",{className:"module-icon",children:"📡"}),jsxRuntimeExports.jsx("h3",{children:"INTEL SOURCES"})]}),jsxRuntimeExports.jsxs("div",{className:"header-status",children:[jsxRuntimeExports.jsx("span",{className:"status-dot error"}),jsxRuntimeExports.jsx("span",{className:"status-text",children:"ERROR"})]})]}),jsxRuntimeExports.jsx("div",{className:"tactical-content",children:jsxRuntimeExports.jsx("div",{className:"intel-error-state",children:jsxRuntimeExports.jsxs("div",{className:"error-content",children:[jsxRuntimeExports.jsx("span",{className:"error-icon",children:"⚠"}),jsxRuntimeExports.jsx("span",{className:"error-message",children:g}),jsxRuntimeExports.jsxs("button",{className:"error-retry-btn",onClick:()=>window.location.reload(),children:[jsxRuntimeExports.jsx("span",{className:"btn-icon",children:"↻"}),jsxRuntimeExports.jsx("span",{className:"btn-text",children:"RETRY CONNECTION"})]})]})})})]}):jsxRuntimeExports.jsxs("div",{className:"tactical-module module-intelligence animate-slide-in-left",children:[jsxRuntimeExports.jsxs("div",{className:"tactical-header-enhanced",children:[jsxRuntimeExports.jsxs("div",{className:"header-primary",children:[jsxRuntimeExports.jsx("span",{className:"module-icon",children:"📡"}),jsxRuntimeExports.jsx("h3",{children:"INTEL SOURCES"})]}),jsxRuntimeExports.jsxs("div",{className:"header-status",children:[jsxRuntimeExports.jsx("span",{className:`status-dot ${P?"active":"idle"}`}),jsxRuntimeExports.jsx("span",{className:"status-text",children:P?"LIVE":"STANDBY"})]})]}),jsxRuntimeExports.jsxs("div",{className:"tactical-content",children:[jsxRuntimeExports.jsxs("div",{className:"intel-controls-section",children:[jsxRuntimeExports.jsxs("div",{className:"controls-row",children:[jsxRuntimeExports.jsxs("div",{className:"view-controls",children:[jsxRuntimeExports.jsx("span",{className:"control-label",children:"VIEW:"}),jsxRuntimeExports.jsxs("select",{value:f,onChange:U=>j(U.target.value),className:"intel-select",title:"View Mode",children:[jsxRuntimeExports.jsx("option",{value:"list",children:"LIST"}),jsxRuntimeExports.jsx("option",{value:"grid",children:"GRID"}),jsxRuntimeExports.jsx("option",{value:"compact",children:"COMPACT"})]})]}),jsxRuntimeExports.jsxs("div",{className:"sort-controls",children:[jsxRuntimeExports.jsx("span",{className:"control-label",children:"SORT:"}),jsxRuntimeExports.jsxs("select",{value:C,onChange:U=>S(U.target.value),className:"intel-select",title:"Sort By",children:[jsxRuntimeExports.jsx("option",{value:"name",children:"NAME"}),jsxRuntimeExports.jsx("option",{value:"category",children:"CATEGORY"}),jsxRuntimeExports.jsx("option",{value:"reliability",children:"RELIABILITY"}),jsxRuntimeExports.jsx("option",{value:"priority",children:"PRIORITY"})]})]}),t&&jsxRuntimeExports.jsxs("div",{className:"category-controls",children:[jsxRuntimeExports.jsx("span",{className:"control-label",children:"FILTER:"}),jsxRuntimeExports.jsxs("select",{value:A.length===1?A[0]:"",onChange:U=>{const X=U.target.value;$(X?[X]:[])},className:"intel-select",title:"Filter by Category",children:[jsxRuntimeExports.jsx("option",{value:"",children:"ALL CATEGORIES"}),Object.entries(INTELLIGENCE_CATEGORIES).map(([U,X])=>jsxRuntimeExports.jsx("option",{value:U,children:X.name},U))]})]})]}),jsxRuntimeExports.jsxs("div",{className:"toggle-controls",children:[jsxRuntimeExports.jsxs("button",{className:`intel-toggle ${R?"active":""}`,onClick:()=>I(!R),title:"Filter Active Only",children:[jsxRuntimeExports.jsx("span",{className:"toggle-icon",children:"⚡"}),jsxRuntimeExports.jsx("span",{className:"toggle-label",children:"ACTIVE"})]}),jsxRuntimeExports.jsxs("button",{className:`intel-toggle ${P?"active":""}`,onClick:()=>D(!P),title:"Auto Refresh",children:[jsxRuntimeExports.jsx("span",{className:"toggle-icon",children:"⟲"}),jsxRuntimeExports.jsx("span",{className:"toggle-label",children:"REFRESH"})]}),jsxRuntimeExports.jsxs("button",{className:`intel-toggle ${N?"active":""}`,onClick:()=>k(!N),title:"Show Metrics",children:[jsxRuntimeExports.jsx("span",{className:"toggle-icon",children:"📊"}),jsxRuntimeExports.jsx("span",{className:"toggle-label",children:"METRICS"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"add-source-section",children:jsxRuntimeExports.jsxs("button",{className:"add-source-btn",onClick:$e,children:[jsxRuntimeExports.jsx("span",{className:"btn-icon",children:"+"}),jsxRuntimeExports.jsx("span",{className:"btn-text",children:"ADD INTELLIGENCE SOURCE"})]})}),N&&jsxRuntimeExports.jsx("div",{className:"intel-metrics-panel",children:jsxRuntimeExports.jsxs("div",{className:"metrics-grid",children:[jsxRuntimeExports.jsxs("div",{className:"metric-card",children:[jsxRuntimeExports.jsx("div",{className:"metric-icon",children:"📊"}),jsxRuntimeExports.jsxs("div",{className:"metric-info",children:[jsxRuntimeExports.jsx("div",{className:"metric-value",children:q.length+o.length}),jsxRuntimeExports.jsx("div",{className:"metric-label",children:"TOTAL SOURCES"})]})]}),jsxRuntimeExports.jsxs("div",{className:"metric-card",children:[jsxRuntimeExports.jsx("div",{className:"metric-icon",children:"⚡"}),jsxRuntimeExports.jsxs("div",{className:"metric-info",children:[jsxRuntimeExports.jsx("div",{className:"metric-value",children:q.filter(U=>U.healthStatus==="operational").length+o.filter(U=>me(U)==="active").length}),jsxRuntimeExports.jsx("div",{className:"metric-label",children:"OPERATIONAL"})]})]}),jsxRuntimeExports.jsxs("div",{className:"metric-card",children:[jsxRuntimeExports.jsx("div",{className:"metric-icon",children:"🛡️"}),jsxRuntimeExports.jsxs("div",{className:"metric-info",children:[jsxRuntimeExports.jsx("div",{className:"metric-value",children:q.filter(U=>U.classification!=="UNCLASSIFIED").length}),jsxRuntimeExports.jsx("div",{className:"metric-label",children:"CLASSIFIED"})]})]}),jsxRuntimeExports.jsxs("div",{className:"metric-card",children:[jsxRuntimeExports.jsx("div",{className:"metric-icon",children:"⟲"}),jsxRuntimeExports.jsxs("div",{className:"metric-info",children:[jsxRuntimeExports.jsx("div",{className:"metric-value",children:P?"LIVE":"STANDBY"}),jsxRuntimeExports.jsx("div",{className:"metric-label",children:"STATUS"})]})]})]})}),jsxRuntimeExports.jsx("div",{className:"intel-sources-section",children:q.length===0&&o.length===0?jsxRuntimeExports.jsx("div",{className:"intel-empty-state",children:jsxRuntimeExports.jsxs("div",{className:"empty-content",children:[jsxRuntimeExports.jsx("div",{className:"empty-icon",children:"📭"}),jsxRuntimeExports.jsx("div",{className:"empty-title",children:"NO INTELLIGENCE SOURCES"}),jsxRuntimeExports.jsx("div",{className:"empty-description",children:"Configure tactical intelligence feeds to begin monitoring"}),jsxRuntimeExports.jsxs("button",{className:"empty-action-btn",onClick:$e,children:[jsxRuntimeExports.jsx("span",{className:"btn-icon",children:"+"}),jsxRuntimeExports.jsx("span",{className:"btn-text",children:"ADD SOURCE"})]})]})}):jsxRuntimeExports.jsxs("div",{className:`intel-sources-list view-mode-${f}`,children:[ee().map((U,X)=>{var Ee,Ne;const Z=G(U),ce=Q(Z),le=z(U.reliability),fe=J(U.classification);return jsxRuntimeExports.jsxs("div",{className:`intel-source-item tactical-source status-${Z}`,style:{animationDelay:`${X*.05}s`},children:[jsxRuntimeExports.jsxs("div",{className:"source-item-header",children:[jsxRuntimeExports.jsxs("div",{className:"source-info",children:[jsxRuntimeExports.jsx("div",{className:"source-name",children:U.name}),jsxRuntimeExports.jsxs("div",{className:"source-meta",children:[jsxRuntimeExports.jsx("span",{className:"category-badge",style:{"--category-color":(Ee=INTELLIGENCE_CATEGORIES[U.category])==null?void 0:Ee.color,borderColor:(Ne=INTELLIGENCE_CATEGORIES[U.category])==null?void 0:Ne.color},title:xe(U.category),children:U.category}),t&&jsxRuntimeExports.jsx("span",{className:"classification-badge",style:{"--classification-color":fe,borderColor:fe},title:W(U.classification),children:U.classification}),jsxRuntimeExports.jsx("span",{className:"reliability-badge",style:{"--reliability-color":le,borderColor:le},title:te(U.reliability),children:U.reliability>=9?"A":U.reliability>=8?"B":U.reliability>=7?"C":U.reliability>=6?"D":U.reliability>=3?"E":"F"})]})]}),jsxRuntimeExports.jsx("div",{className:"source-controls",children:jsxRuntimeExports.jsx("span",{className:"source-type",children:"TACTICAL"})})]}),f!=="compact"&&jsxRuntimeExports.jsxs("div",{className:"source-details",children:[jsxRuntimeExports.jsxs("div",{className:"status-text",children:[jsxRuntimeExports.jsx("span",{className:"status-dot",style:{backgroundColor:ce},title:`Health: ${Z.toUpperCase()}`}),Z==="operational"?"OPERATIONAL":Z==="degraded"?"DEGRADED":Z==="maintenance"?"MAINTENANCE":"DOWN"]}),f==="grid"&&jsxRuntimeExports.jsxs("div",{className:"source-stats",children:[jsxRuntimeExports.jsxs("span",{className:"stat-item",children:[jsxRuntimeExports.jsx("span",{className:"stat-icon",children:"🔄"}),jsxRuntimeExports.jsxs("span",{className:"stat-value",children:[U.updateFrequency,"m"]})]}),jsxRuntimeExports.jsxs("span",{className:"stat-item",children:[jsxRuntimeExports.jsx("span",{className:"stat-icon",children:"💰"}),jsxRuntimeExports.jsx("span",{className:"stat-value",children:U.cost.toUpperCase()})]}),U.requiresAuth&&jsxRuntimeExports.jsxs("span",{className:"stat-item",children:[jsxRuntimeExports.jsx("span",{className:"stat-icon",children:"🔐"}),jsxRuntimeExports.jsx("span",{className:"stat-value",children:"AUTH"})]})]})]})]},U.id)}),B().map((U,X)=>{const Z=me(U),ce=ye(Z),le=X+q.length;return jsxRuntimeExports.jsxs("button",{onClick:()=>H(U.id),className:`intel-source-item legacy-source ${b===U.id?"selected":""} status-${Z}`,style:{animationDelay:`${le*.05}s`},children:[jsxRuntimeExports.jsxs("div",{className:"source-item-header",children:[jsxRuntimeExports.jsxs("div",{className:"source-info",children:[jsxRuntimeExports.jsx("div",{className:"source-name",children:U.name}),jsxRuntimeExports.jsxs("div",{className:"source-meta",children:[jsxRuntimeExports.jsxs("span",{className:"feed-count",children:[U.feedCount||0," feeds"]}),jsxRuntimeExports.jsxs("span",{className:"priority-badge",children:["P",U.priority||1]}),jsxRuntimeExports.jsx("span",{className:"source-type-badge legacy",children:"LEGACY"})]})]}),jsxRuntimeExports.jsx("div",{className:"source-controls",children:b===U.id&&jsxRuntimeExports.jsx("span",{className:"selected-arrow",children:"▶"})})]}),f!=="compact"&&jsxRuntimeExports.jsxs("div",{className:"source-details",children:[jsxRuntimeExports.jsxs("div",{className:"status-text",children:[jsxRuntimeExports.jsx("span",{className:"status-dot",style:{backgroundColor:ce},title:`Status: ${Z.toUpperCase()}`}),Z==="active"?"LIVE FEED":Z==="idle"?"IDLE":"STALE"]}),f==="grid"&&jsxRuntimeExports.jsxs("div",{className:"source-stats",children:[jsxRuntimeExports.jsxs("span",{className:"stat-item",children:[jsxRuntimeExports.jsx("span",{className:"stat-icon",children:"↑"}),jsxRuntimeExports.jsx("span",{className:"stat-value",children:U.uptime||"99%"})]}),jsxRuntimeExports.jsxs("span",{className:"stat-item",children:[jsxRuntimeExports.jsx("span",{className:"stat-icon",children:"⚡"}),jsxRuntimeExports.jsx("span",{className:"stat-value",children:U.bandwidth||"LOW"})]})]})]})]},U.id)})]})})]}),M&&jsxRuntimeExports.jsx(SourceManager,{onClose:()=>L(!1),onSourceAdded:Te})]})},LeftSidebar=({setSelectedFeedList:r})=>jsxRuntimeExports.jsx(IntelSources,{setSelectedFeedList:r});class FeedHealthService{static getFeedHealth(e){return this.getAllFeedHealth()[e]||null}static getAllFeedHealth(){const e=localStorage.getItem(this.STORAGE_KEY);return e?JSON.parse(e):{}}static updateFeedHealth(e,t,s,n,i){const o=this.getAllFeedHealth(),a=o[e],l=new Date;if(s)o[e]={feedId:e,feedUrl:t,status:n&&n>this.WARNING_THRESHOLD?"warning":"healthy",lastSuccessfulFetch:l,lastError:null,responseTime:n||null,uptime:this.calculateUptime(a,!0),errorCount:0,lastChecked:l};else{const p=((a==null?void 0:a.errorCount)||0)+1;o[e]={feedId:e,feedUrl:t,status:p>=this.ERROR_THRESHOLD?"error":"warning",lastSuccessfulFetch:(a==null?void 0:a.lastSuccessfulFetch)||null,lastError:i||"Unknown error",responseTime:(a==null?void 0:a.responseTime)||null,uptime:this.calculateUptime(a,!1),errorCount:p,lastChecked:l}}localStorage.setItem(this.STORAGE_KEY,JSON.stringify(o))}static getFeedHealthMetrics(){const e=this.getAllFeedHealth(),t=Object.values(e),s=t.length,n=t.filter(g=>g.status==="healthy").length,i=t.filter(g=>g.status==="warning").length,o=t.filter(g=>g.status==="error").length,a=t.map(g=>g.responseTime).filter(g=>g!==null),l=a.length>0?a.reduce((g,x)=>g+x,0)/a.length:0,p=t.length>0?t.reduce((g,x)=>g+x.uptime,0)/t.length:100;return{totalFeeds:s,healthyFeeds:n,warningFeeds:i,errorFeeds:o,averageResponseTime:l,overallUptime:p}}static calculateUptime(e,t){if(!e)return t?100:0;const s=10,n=t?0:e.errorCount;return Math.max(0,100-n/s*100)}static getFeedHealthIcon(e){switch(e){case"healthy":return"🟢";case"warning":return"🟡";case"error":return"🔴";default:return"⚪"}}static clearHealthData(){localStorage.removeItem(this.STORAGE_KEY)}}O(FeedHealthService,"STORAGE_KEY","feed_health_data"),O(FeedHealthService,"WARNING_THRESHOLD",5e3),O(FeedHealthService,"ERROR_THRESHOLD",3);class FeedService{constructor(){O(this,"feeds",[]);O(this,"feedLists",[]);O(this,"feedsStorageKey","feeds");O(this,"feedListsStorageKey","feedLists");this.loadFeeds(),this.loadFeedLists(),this.updateFeedsFromServer()}loadFeeds(){try{log.debug("Component","Loading feeds from local storage");const e=LocalStorageUtil.getItem(this.feedsStorageKey);e&&e.length>0?this.feeds=e:this.feeds=this.getDefaultFeeds()}catch(e){console.error("Failed to load feeds:",e),this.feeds=this.getDefaultFeeds(),this.saveFeeds(),log.debug("Component","Default feeds loaded due to error:",this.feeds)}}loadFeedLists(){try{log.debug("Component","Loading feed lists from local storage");const e=LocalStorageUtil.getItem(this.feedListsStorageKey);e&&e.length>0?this.feedLists=e:this.feedLists=this.getDefaultFeedLists()}catch(e){console.error("Failed to load feed lists:",e),this.feedLists=this.getDefaultFeedLists(),this.saveFeedLists(),log.debug("Component","Default feed lists loaded due to error:",this.feedLists)}}saveFeeds(){try{log.debug("Component","Saving feeds to local storage"),LocalStorageUtil.setItem(this.feedsStorageKey,this.feeds),log.debug("Component","Feeds saved to local storage")}catch(e){console.error("Failed to save feeds:",e)}}saveFeedLists(){try{log.debug("Component","Saving feed lists to local storage"),LocalStorageUtil.setItem(this.feedListsStorageKey,this.feedLists),log.debug("Component","Feed lists saved to local storage")}catch(e){console.error("Failed to save feed lists:",e)}}getDefaultFeeds(){return convertFeedItemsToFeeds(DefaultFeeds)}resetToDefault(){log.debug("Component","Resetting feeds and feed lists to default"),this.feeds=this.getDefaultFeeds(),this.feedLists=this.getDefaultFeedLists(),this.saveFeeds(),this.saveFeedLists(),this.updateFeedsFromServer()}getDefaultFeedLists(){return[{id:"1",name:"Default List"}]}getFeeds(){return log.debug("Component","Getting all feeds"),this.feeds}getFeedLists(){log.debug("Component","Getting all feed lists");try{const e=this.feedLists;return log.debug("Component","Feed lists retrieved:",e),e}catch(e){return console.error("Failed to get feed lists:",e),[]}}getFeedsByList(e){log.debug("Component",`Getting feeds for list ID: ${e}`);try{const t=this.feeds.filter(s=>s.feedListId===e);return log.debug("Component",`Feeds for list ID ${e}:`,t),t}catch(t){return console.error(`Failed to get feeds for list ID ${e}:`,t),[]}}getFeedById(e){log.debug("Component",`Getting feed by ID: ${e}`);try{const t=this.feeds.find(s=>s.id===e);return log.debug("Component","Feed found:",t),t}catch(t){console.error(`Failed to get feed by ID ${e}:`,t);return}}addFeed(e){try{log.debug("Component","Adding new feed:",e),this.feeds.push(e),this.saveFeeds()}catch(t){console.error("Failed to add feed:",t)}}addFeedToList(e,t){try{log.debug("Component",`Adding feed to list ID: ${e}`,t),t.feedListId=e,this.addFeed(t)}catch(s){console.error("Failed to add feed to list:",s)}}removeFeed(e){try{log.debug("Component",`Removing feed ID: ${e}`),this.feeds=this.feeds.filter(t=>t.id!==e),this.saveFeeds()}catch(t){console.error("Failed to remove feed:",t)}}removeFeedFromList(e,t){try{log.debug("Component",`Removing feed ID: ${t} from list ID: ${e}`),this.feeds=this.feeds.filter(s=>s.id!==t||s.feedListId!==e),this.saveFeeds()}catch(s){console.error("Failed to remove feed from list:",s)}}addFeedList(e){try{log.debug("Component","Adding new feed list:",e),this.feedLists.push(e),this.saveFeedLists()}catch(t){console.error("Failed to add feed list:",t)}}removeFeedList(e){try{log.debug("Component",`Removing feed list ID: ${e}`),this.feedLists=this.feedLists.filter(t=>t.id!==e),this.saveFeedLists()}catch(t){console.error("Failed to remove feed list:",t)}}async updateFeedsFromServer(){log.debug("Component","Updating feeds from server"),log.debug("Component","Current feeds:",this.feeds);const e=[];for(const t of this.feeds){const s=Date.now();try{const n=await fetchFeed(t.url),i=Date.now()-s;if(n){const o={...t,...n.feeds[0]};e.push(o),FeedHealthService.updateFeedHealth(t.id,t.url,!0,i)}else console.error(`Failed to fetch feed from ${t.url}`),e.push(t),FeedHealthService.updateFeedHealth(t.id,t.url,!1,void 0,"Feed fetch returned null")}catch(n){const i=Date.now()-s;console.error(`Error fetching feed from ${t.url}:`,n),e.push(t),FeedHealthService.updateFeedHealth(t.id,t.url,!1,i,n instanceof Error?n.message:"Unknown error")}}this.feeds=e,this.saveFeeds(),log.debug("Component","Feeds updated from server:",this.feeds)}getFeedResults(e){return FeedController$1.getFeedResults(e)}}const FeedService$1=new FeedService,SystemControl=reactExports.memo(({onThemeChange:r,onCompactModeChange:e,onRealTimeUpdatesChange:t,onHealthAlertsChange:s,onAutoExportChange:n})=>{var I,A,$,N,k;const{theme:i,compactMode:o,setTheme:a,setCompactMode:l}=useTheme(),{settings:p,updateSettings:g}=useSettings(),x=reactExports.useCallback(P=>{a(P),g({display:{...p.display,theme:P}}),r==null||r(P)},[a,p.display,g,r]),b=reactExports.useCallback(()=>{const P=!o;l(P),g({display:{...p.display,density:P?"compact":"comfortable"}}),e==null||e(P)},[o,l,p.display,g,e]),E=reactExports.useCallback(()=>{var M,L,q,K;const D=(((M=p.general)==null?void 0:M.refreshInterval)??3e5)===3e5?6e4:3e5;g({general:{refreshInterval:D,cacheSettings:((L=p.general)==null?void 0:L.cacheSettings)??{enabled:!0,duration:3e5},notifications:((q=p.general)==null?void 0:q.notifications)??{enabled:!0,sound:!1},export:((K=p.general)==null?void 0:K.export)??{format:"json",autoExport:!1,includeMetadata:!0,compress:!1,encrypt:!0}}}),t==null||t(D===6e4)},[p.general,g,t]),f=reactExports.useCallback(()=>{var D,M,L,q,K,H,ee;const P=((M=(D=p.general)==null?void 0:D.notifications)==null?void 0:M.enabled)??!0;g({general:{refreshInterval:((L=p.general)==null?void 0:L.refreshInterval)??3e5,cacheSettings:((q=p.general)==null?void 0:q.cacheSettings)??{enabled:!0,duration:3e5},notifications:{enabled:!P,sound:((H=(K=p.general)==null?void 0:K.notifications)==null?void 0:H.sound)??!1},export:((ee=p.general)==null?void 0:ee.export)??{format:"json",autoExport:!1,includeMetadata:!0,compress:!1,encrypt:!0}}}),s==null||s(!P)},[p.general,g,s]),j=reactExports.useCallback(()=>{var D,M,L,q,K,H,ee,B,G,Q,z,J,W;const P=((M=(D=p.general)==null?void 0:D.export)==null?void 0:M.autoExport)??!1;g({general:{refreshInterval:((L=p.general)==null?void 0:L.refreshInterval)??3e5,cacheSettings:((q=p.general)==null?void 0:q.cacheSettings)??{enabled:!0,duration:3e5},notifications:((K=p.general)==null?void 0:K.notifications)??{enabled:!0,sound:!1},export:{format:((ee=(H=p.general)==null?void 0:H.export)==null?void 0:ee.format)??"json",autoExport:!P,includeMetadata:((G=(B=p.general)==null?void 0:B.export)==null?void 0:G.includeMetadata)??!0,compress:((z=(Q=p.general)==null?void 0:Q.export)==null?void 0:z.compress)??!1,encrypt:((W=(J=p.general)==null?void 0:J.export)==null?void 0:W.encrypt)??!0}}}),n==null||n(!P)},[p.general,g,n]);if(!p)return jsxRuntimeExports.jsx("div",{className:"tactical-module module-system-control",children:"Loading..."});const C=(((I=p.general)==null?void 0:I.refreshInterval)??3e5)===6e4,S=(($=(A=p.general)==null?void 0:A.notifications)==null?void 0:$.enabled)??!0,R=((k=(N=p.general)==null?void 0:N.export)==null?void 0:k.autoExport)??!1;return jsxRuntimeExports.jsxs("div",{className:"tactical-module module-system-control",children:[jsxRuntimeExports.jsxs("div",{className:"tactical-header-enhanced",children:[jsxRuntimeExports.jsxs("div",{className:"header-primary",children:[jsxRuntimeExports.jsx("span",{className:"module-icon",children:"⚙"}),jsxRuntimeExports.jsx("h3",{children:"SYSTEM CONTROL"})]}),jsxRuntimeExports.jsxs("div",{className:"header-controls-micro",children:[jsxRuntimeExports.jsxs("select",{value:i,onChange:P=>x(P.target.value),className:"micro-select",title:"Theme",children:[jsxRuntimeExports.jsx("option",{value:"dark",children:"DARK"}),jsxRuntimeExports.jsx("option",{value:"night",children:"NIGHT"}),jsxRuntimeExports.jsx("option",{value:"combat",children:"COMBAT"})]}),jsxRuntimeExports.jsx("button",{className:`micro-btn ${o?"active":""}`,onClick:b,title:"Compact Mode",children:"▣"}),jsxRuntimeExports.jsx("button",{className:`micro-btn ${C?"active":""}`,onClick:E,title:"Real-time Updates",children:"⟲"})]})]}),jsxRuntimeExports.jsx("div",{className:"tactical-content",children:jsxRuntimeExports.jsxs("div",{className:"system-controls-grid",children:[jsxRuntimeExports.jsxs("div",{className:"control-group",children:[jsxRuntimeExports.jsx("label",{className:"control-label",children:"ALERTS"}),jsxRuntimeExports.jsx("button",{className:`control-toggle ${S?"active":""}`,onClick:f,children:S?"◉":"○"})]}),jsxRuntimeExports.jsxs("div",{className:"control-group",children:[jsxRuntimeExports.jsx("label",{className:"control-label",children:"AUTO-EXPORT"}),jsxRuntimeExports.jsx("button",{className:`control-toggle ${R?"active":""}`,onClick:j,children:R?"◉":"○"})]})]})})]})}),TacticalFilters=({onFiltersChange:r,onApplyFilters:e,onSavePreset:t,onTimeRangeChange:s,filterPresets:n=["CRITICAL","INTEL","THREAT"]})=>{const{filterState:i,addFilter:o,removeFilter:a,isFilterActive:l,clearAllFilters:p,hasActiveFilters:g}=useFilters(),{applyPreset:x,applyCustomRange:b}=useTimeRangePresets(),[E,f]=reactExports.useState(!1),[j,C]=reactExports.useState(""),[S,R]=reactExports.useState(""),I=[{key:"1H",label:"1H",hours:1},{key:"6H",label:"6H",hours:6},{key:"24H",label:"24H",hours:24},{key:"7D",label:"7D",hours:168},{key:"30D",label:"30D",hours:720},{key:"CUSTOM",label:"CUSTOM",hours:0}],A=L=>{l(L)?a(L):o(L),r==null||r(i.activeFilters)},$=L=>{var q;if(L==="CUSTOM"){f(!0);return}if(f(!1),x(L),s){const K={start:new Date(Date.now()-(((q=I.find(H=>H.key===L))==null?void 0:q.hours)||24)*60*60*1e3),end:new Date,label:L};s(K)}},N=()=>{if(j&&S){const L=new Date(j),q=new Date(S);b(L,q,"CUSTOM"),f(!1),s==null||s({start:L,end:q,label:"CUSTOM"})}},k=()=>{p(),n.forEach(L=>o(L))},P=()=>{e==null||e(i.activeFilters)},D=()=>{t==null||t(i.activeFilters)},M=()=>i.timeRange?i.timeRange.label:"ALL";return jsxRuntimeExports.jsxs("div",{className:"tactical-module module-filters",children:[jsxRuntimeExports.jsxs("div",{className:"tactical-header-enhanced",children:[jsxRuntimeExports.jsxs("div",{className:"header-primary",children:[jsxRuntimeExports.jsx("span",{className:"module-icon",children:"🎛"}),jsxRuntimeExports.jsx("h3",{children:"TACTICAL FILTERS"})]}),jsxRuntimeExports.jsxs("div",{className:"header-status",children:[jsxRuntimeExports.jsx("span",{className:`status-dot ${g?"active":"idle"}`}),jsxRuntimeExports.jsx("span",{className:"status-text",children:g?"FILTERING":"STANDBY"})]})]}),jsxRuntimeExports.jsxs("div",{className:"tactical-content",children:[jsxRuntimeExports.jsx("div",{className:"filter-controls-section",children:jsxRuntimeExports.jsxs("div",{className:"filter-quick-actions",children:[jsxRuntimeExports.jsxs("button",{className:"filter-action-btn clear",onClick:p,title:"Clear All Filters",children:[jsxRuntimeExports.jsx("span",{className:"btn-icon",children:"✕"}),jsxRuntimeExports.jsx("span",{className:"btn-text",children:"CLEAR ALL"})]}),jsxRuntimeExports.jsxs("button",{className:"filter-action-btn preset",onClick:k,title:"Load Preset Filters",children:[jsxRuntimeExports.jsx("span",{className:"btn-icon",children:"⚡"}),jsxRuntimeExports.jsx("span",{className:"btn-text",children:"PRESET"})]}),jsxRuntimeExports.jsxs("button",{className:"filter-action-btn save",onClick:D,title:"Save Current Configuration",children:[jsxRuntimeExports.jsx("span",{className:"btn-icon",children:"💾"}),jsxRuntimeExports.jsx("span",{className:"btn-text",children:"SAVE"})]})]})}),jsxRuntimeExports.jsxs("div",{className:"filter-categories-section",children:[jsxRuntimeExports.jsxs("div",{className:"filter-category-card",children:[jsxRuntimeExports.jsxs("div",{className:"category-header",children:[jsxRuntimeExports.jsx("span",{className:"category-icon",children:"🚨"}),jsxRuntimeExports.jsx("span",{className:"category-title",children:"PRIORITY LEVELS"})]}),jsxRuntimeExports.jsx("div",{className:"filter-grid",children:[{key:"CRITICAL",label:"CRITICAL",color:"#ff0040"},{key:"HIGH",label:"HIGH",color:"#ff9500"},{key:"MEDIUM",label:"MEDIUM",color:"#ffd700"},{key:"LOW",label:"LOW",color:"#00ff41"}].map(L=>jsxRuntimeExports.jsxs("button",{className:`filter-tag ${l(L.key)?"active":""}`,onClick:()=>A(L.key),style:{"--filter-color":L.color},children:[jsxRuntimeExports.jsx("span",{className:"filter-indicator"}),jsxRuntimeExports.jsx("span",{className:"filter-label",children:L.label})]},L.key))})]}),jsxRuntimeExports.jsxs("div",{className:"filter-category-card",children:[jsxRuntimeExports.jsxs("div",{className:"category-header",children:[jsxRuntimeExports.jsx("span",{className:"category-icon",children:"📡"}),jsxRuntimeExports.jsx("span",{className:"category-title",children:"CONTENT TYPE"})]}),jsxRuntimeExports.jsx("div",{className:"filter-grid",children:[{key:"INTEL",label:"INTELLIGENCE",color:"#00ffaa"},{key:"NEWS",label:"NEWS",color:"#0099ff"},{key:"ALERT",label:"ALERT",color:"#ff6600"},{key:"THREAT",label:"THREAT",color:"#ff0040"}].map(L=>jsxRuntimeExports.jsxs("button",{className:`filter-tag ${l(L.key)?"active":""}`,onClick:()=>A(L.key),style:{"--filter-color":L.color},children:[jsxRuntimeExports.jsx("span",{className:"filter-indicator"}),jsxRuntimeExports.jsx("span",{className:"filter-label",children:L.label})]},L.key))})]}),jsxRuntimeExports.jsxs("div",{className:"filter-category-card",children:[jsxRuntimeExports.jsxs("div",{className:"category-header",children:[jsxRuntimeExports.jsx("span",{className:"category-icon",children:"🌍"}),jsxRuntimeExports.jsx("span",{className:"category-title",children:"GEOGRAPHIC REGION"})]}),jsxRuntimeExports.jsx("div",{className:"filter-grid",children:[{key:"GLOBAL",label:"GLOBAL",color:"#ffffff"},{key:"AMERICAS",label:"AMERICAS",color:"#00ffaa"},{key:"EUROPE",label:"EUROPE",color:"#0099ff"},{key:"ASIA_PACIFIC",label:"ASIA-PAC",color:"#ff9500"}].map(L=>jsxRuntimeExports.jsxs("button",{className:`filter-tag ${l(L.key)?"active":""}`,onClick:()=>A(L.key),style:{"--filter-color":L.color},children:[jsxRuntimeExports.jsx("span",{className:"filter-indicator"}),jsxRuntimeExports.jsx("span",{className:"filter-label",children:L.label})]},L.key))})]})]}),jsxRuntimeExports.jsx("div",{className:"filter-advanced-section",children:jsxRuntimeExports.jsxs("div",{className:"time-range-panel",children:[jsxRuntimeExports.jsxs("div",{className:"panel-header",children:[jsxRuntimeExports.jsx("span",{className:"panel-icon",children:"⏰"}),jsxRuntimeExports.jsx("span",{className:"panel-title",children:"TIME RANGE"}),jsxRuntimeExports.jsx("span",{className:"active-range-indicator",children:M()})]}),jsxRuntimeExports.jsx("div",{className:"time-range-grid",children:I.map(L=>jsxRuntimeExports.jsx("button",{className:`time-range-btn ${M()===L.key?"active":""}`,onClick:()=>$(L.key),children:L.label},L.key))}),E&&jsxRuntimeExports.jsxs("div",{className:"custom-time-range",children:[jsxRuntimeExports.jsxs("div",{className:"custom-range-inputs",children:[jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{className:"input-label",children:"START"}),jsxRuntimeExports.jsx("input",{type:"datetime-local",value:j,onChange:L=>C(L.target.value),className:"time-input"})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{className:"input-label",children:"END"}),jsxRuntimeExports.jsx("input",{type:"datetime-local",value:S,onChange:L=>R(L.target.value),className:"time-input"})]})]}),jsxRuntimeExports.jsxs("div",{className:"custom-range-actions",children:[jsxRuntimeExports.jsx("button",{className:"custom-range-btn apply",onClick:N,disabled:!j||!S,children:"APPLY"}),jsxRuntimeExports.jsx("button",{className:"custom-range-btn cancel",onClick:()=>f(!1),children:"CANCEL"})]})]})]})}),jsxRuntimeExports.jsxs("div",{className:"filter-summary-section",children:[jsxRuntimeExports.jsxs("div",{className:"active-filters-display",children:[jsxRuntimeExports.jsxs("div",{className:"summary-header",children:[jsxRuntimeExports.jsx("span",{className:"summary-icon",children:"🎯"}),jsxRuntimeExports.jsx("span",{className:"summary-title",children:"ACTIVE FILTERS"}),jsxRuntimeExports.jsx("span",{className:"filter-count",children:i.activeFilters.size})]}),i.activeFilters.size>0?jsxRuntimeExports.jsx("div",{className:"active-filters-list",children:Array.from(i.activeFilters).map(L=>jsxRuntimeExports.jsxs("span",{className:"active-filter-tag",children:[L,jsxRuntimeExports.jsx("button",{className:"remove-filter-btn",onClick:()=>A(L),children:"✕"})]},L))}):jsxRuntimeExports.jsx("div",{className:"no-filters-message",children:"No filters active - showing all content"})]}),jsxRuntimeExports.jsxs("div",{className:"filter-execution-panel",children:[jsxRuntimeExports.jsxs("button",{className:"apply-filters-btn",onClick:P,children:[jsxRuntimeExports.jsx("span",{className:"btn-icon",children:"▶"}),jsxRuntimeExports.jsx("span",{className:"btn-text",children:"APPLY FILTERS"})]}),jsxRuntimeExports.jsxs("button",{className:"save-preset-btn",onClick:D,children:[jsxRuntimeExports.jsx("span",{className:"btn-icon",children:"📌"}),jsxRuntimeExports.jsx("span",{className:"btn-text",children:"SAVE PRESET"})]})]})]})]})]})},Export=({onAutoExportChange:r,onExportSettingsOpen:e,onFormatSelect:t,onOptionsChange:s,onExecuteExport:n,initialAutoExport:i=!1,initialOptions:o={}})=>{var A,$,N,k,P,D,M;const{settings:a,updateSettings:l}=useSettings(),[p,g]=reactExports.useState(()=>{var L,q;return((q=(L=a==null?void 0:a.general)==null?void 0:L.export)==null?void 0:q.autoExport)??i}),[x,b]=reactExports.useState(()=>{var L,q;return((q=(L=a==null?void 0:a.general)==null?void 0:L.export)==null?void 0:q.format)??null}),[E,f]=reactExports.useState({includeMetadata:(($=(A=a==null?void 0:a.general)==null?void 0:A.export)==null?void 0:$.includeMetadata)??!0,compress:((k=(N=a==null?void 0:a.general)==null?void 0:N.export)==null?void 0:k.compress)??!1,encrypt:((D=(P=a==null?void 0:a.general)==null?void 0:P.export)==null?void 0:D.encrypt)??!0,...o});reactExports.useEffect(()=>{var L;if((L=a==null?void 0:a.general)!=null&&L.export){const q=a.general.export;g(q.autoExport??!1),b(q.format??null),f(K=>({...K,includeMetadata:q.includeMetadata??K.includeMetadata,compress:q.compress??K.compress,encrypt:q.encrypt??K.encrypt}))}},[(M=a==null?void 0:a.general)==null?void 0:M.export]);const j=()=>{var q,K,H,ee,B,G,Q,z,J,W,te;const L=!p;g(L),l({general:{refreshInterval:((q=a.general)==null?void 0:q.refreshInterval)??3e5,cacheSettings:((K=a.general)==null?void 0:K.cacheSettings)??{enabled:!0,duration:3e5},notifications:((H=a.general)==null?void 0:H.notifications)??{enabled:!0,sound:!1},export:{format:((B=(ee=a.general)==null?void 0:ee.export)==null?void 0:B.format)??"json",autoExport:L,includeMetadata:((Q=(G=a.general)==null?void 0:G.export)==null?void 0:Q.includeMetadata)??!0,compress:((J=(z=a.general)==null?void 0:z.export)==null?void 0:J.compress)??!1,encrypt:((te=(W=a.general)==null?void 0:W.export)==null?void 0:te.encrypt)??!0}}}),r==null||r(L)},C=()=>{e==null||e()},S=L=>{var q,K,H,ee,B,G,Q,z,J,W,te;b(L),l({general:{refreshInterval:((q=a.general)==null?void 0:q.refreshInterval)??3e5,cacheSettings:((K=a.general)==null?void 0:K.cacheSettings)??{enabled:!0,duration:3e5},notifications:((H=a.general)==null?void 0:H.notifications)??{enabled:!0,sound:!1},export:{format:L,autoExport:((B=(ee=a.general)==null?void 0:ee.export)==null?void 0:B.autoExport)??!1,includeMetadata:((Q=(G=a.general)==null?void 0:G.export)==null?void 0:Q.includeMetadata)??!0,compress:((J=(z=a.general)==null?void 0:z.export)==null?void 0:J.compress)??!1,encrypt:((te=(W=a.general)==null?void 0:W.export)==null?void 0:te.encrypt)??!0}}}),t==null||t(L)},R=L=>{var K,H,ee,B,G,Q,z,J,W,te,xe,me,ye;const q={...E,[L]:!E[L]};f(q),l({general:{refreshInterval:((K=a.general)==null?void 0:K.refreshInterval)??3e5,cacheSettings:((H=a.general)==null?void 0:H.cacheSettings)??{enabled:!0,duration:3e5},notifications:((ee=a.general)==null?void 0:ee.notifications)??{enabled:!0,sound:!1},export:{format:((G=(B=a.general)==null?void 0:B.export)==null?void 0:G.format)??"json",autoExport:((z=(Q=a.general)==null?void 0:Q.export)==null?void 0:z.autoExport)??!1,includeMetadata:L==="includeMetadata"?q.includeMetadata:((W=(J=a.general)==null?void 0:J.export)==null?void 0:W.includeMetadata)??!0,compress:L==="compress"?q.compress:((xe=(te=a.general)==null?void 0:te.export)==null?void 0:xe.compress)??!1,encrypt:L==="encrypt"?q.encrypt:((ye=(me=a.general)==null?void 0:me.export)==null?void 0:ye.encrypt)??!0}}}),s==null||s(q)},I=()=>{n==null||n(x,E)};return jsxRuntimeExports.jsxs("div",{className:"tactical-module module-export",children:[jsxRuntimeExports.jsxs("div",{className:"tactical-header-enhanced",children:[jsxRuntimeExports.jsxs("div",{className:"header-primary",children:[jsxRuntimeExports.jsx("span",{className:"module-icon",children:"📦"}),jsxRuntimeExports.jsx("h3",{children:"EXPORT"})]}),jsxRuntimeExports.jsxs("div",{className:"header-controls-micro",children:[jsxRuntimeExports.jsx("button",{className:`micro-btn ${p?"active":""}`,onClick:j,title:"Auto Export",children:"⏰"}),jsxRuntimeExports.jsx("button",{className:"micro-btn",onClick:C,title:"Export Settings",children:"⚙"})]})]}),jsxRuntimeExports.jsxs("div",{className:"tactical-content",children:[jsxRuntimeExports.jsxs("div",{className:"export-quick-grid",children:[jsxRuntimeExports.jsx("button",{className:`export-btn-micro json ${x==="json"?"selected":""}`,onClick:()=>S("json"),children:"JSON"}),jsxRuntimeExports.jsx("button",{className:`export-btn-micro csv ${x==="csv"?"selected":""}`,onClick:()=>S("csv"),children:"CSV"}),jsxRuntimeExports.jsx("button",{className:`export-btn-micro xml ${x==="xml"?"selected":""}`,onClick:()=>S("xml"),children:"XML"}),jsxRuntimeExports.jsx("button",{className:`export-btn-micro pdf ${x==="pdf"?"selected":""}`,onClick:()=>S("pdf"),children:"PDF"})]}),jsxRuntimeExports.jsxs("div",{className:"export-options-micro",children:[jsxRuntimeExports.jsxs("div",{className:"option-row",children:[jsxRuntimeExports.jsx("span",{className:"option-label",children:"INCLUDE METADATA"}),jsxRuntimeExports.jsx("button",{className:`option-toggle ${E.includeMetadata?"active":""}`,onClick:()=>R("includeMetadata"),children:E.includeMetadata?"◉":"○"})]}),jsxRuntimeExports.jsxs("div",{className:"option-row",children:[jsxRuntimeExports.jsx("span",{className:"option-label",children:"COMPRESS"}),jsxRuntimeExports.jsx("button",{className:`option-toggle ${E.compress?"active":""}`,onClick:()=>R("compress"),children:E.compress?"◉":"○"})]}),jsxRuntimeExports.jsxs("div",{className:"option-row",children:[jsxRuntimeExports.jsx("span",{className:"option-label",children:"ENCRYPT"}),jsxRuntimeExports.jsx("button",{className:`option-toggle ${E.encrypt?"active":""}`,onClick:()=>R("encrypt"),children:E.encrypt?"◉":"○"})]})]}),jsxRuntimeExports.jsx("button",{className:"export-execute-btn",onClick:I,disabled:!x,children:"↓ EXECUTE EXPORT"})]})]})},Health=({feedCount:r=0,onScan:e,onClean:t,onRepair:s})=>{const{healthState:n,performScan:i,performClean:o,performRepair:a,isOperationInProgress:l}=useHealth(),[,p]=reactExports.useState(""),[g,x]=reactExports.useState(null),b=n.connectionStatus,E=n.securityStatus,f=n.overallStatus,j=n.issues,C=n.metrics,S=reactExports.useCallback(async()=>{p("scan");try{const N=await i();x(N),e==null||e()}catch(N){console.error("Scan failed:",N)}},[i,e]),R=reactExports.useCallback(async()=>{p("clean");try{const N=await o();x(N),t==null||t()}catch(N){console.error("Clean failed:",N)}},[o,t]),I=reactExports.useCallback(async()=>{p("repair");try{const N=await a();x(N),s==null||s()}catch(N){console.error("Repair failed:",N)}},[a,s]),A=N=>{switch(N){case"OPTIMAL":case"ONLINE":case"SECURE":return"#00ff41";case"WARNING":case"CONNECTING":return"#ffa500";case"CRITICAL":case"OFFLINE":case"COMPROMISED":return"#ff0000";default:return"#ffffff"}},$=N=>{switch(N){case"ONLINE":return"online";case"SECURE":return"secure";case"ACTIVE":return"active";default:return""}};return jsxRuntimeExports.jsxs("div",{className:"tactical-module module-health",children:[jsxRuntimeExports.jsxs("div",{className:"tactical-header-enhanced",children:[jsxRuntimeExports.jsxs("div",{className:"header-primary",children:[jsxRuntimeExports.jsx("span",{className:"module-icon",children:"💚"}),jsxRuntimeExports.jsx("h3",{children:"HEALTH"})]}),jsxRuntimeExports.jsxs("div",{className:"header-status",children:[jsxRuntimeExports.jsx("span",{className:"status-dot",style:{background:A(f)}}),jsxRuntimeExports.jsx("span",{className:"status-text",children:f})]})]}),jsxRuntimeExports.jsxs("div",{className:"tactical-content",children:[jsxRuntimeExports.jsxs("div",{className:"health-indicators-micro",children:[jsxRuntimeExports.jsxs("div",{className:"health-item",children:[jsxRuntimeExports.jsx("span",{className:"health-icon",children:"🔗"}),jsxRuntimeExports.jsx("span",{className:"health-label",children:"CONNECTIONS"}),jsxRuntimeExports.jsx("span",{className:`health-status ${$(b)}`,children:b})]}),jsxRuntimeExports.jsxs("div",{className:"health-item",children:[jsxRuntimeExports.jsx("span",{className:"health-icon",children:"🛡"}),jsxRuntimeExports.jsx("span",{className:"health-label",children:"SECURITY"}),jsxRuntimeExports.jsx("span",{className:`health-status ${$(E)}`,children:E})]}),jsxRuntimeExports.jsxs("div",{className:"health-item",children:[jsxRuntimeExports.jsx("span",{className:"health-icon",children:"📊"}),jsxRuntimeExports.jsx("span",{className:"health-label",children:"FEEDS"}),jsxRuntimeExports.jsxs("span",{className:`health-status ${$("ACTIVE")}`,children:[r," ACTIVE"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"diagnostic-actions",children:[jsxRuntimeExports.jsx("button",{className:`diagnostic-btn scan ${n.isScanning?"scanning":""}`,onClick:S,disabled:l,children:n.isScanning?"⏳ SCANNING...":"🔍 SCAN"}),jsxRuntimeExports.jsx("button",{className:`diagnostic-btn clean ${n.isCleaning?"cleaning":""}`,onClick:R,disabled:l,children:n.isCleaning?"⏳ CLEANING...":"🧹 CLEAN"}),jsxRuntimeExports.jsx("button",{className:`diagnostic-btn repair ${n.isRepairing?"repairing":""}`,onClick:I,disabled:l,children:n.isRepairing?"⏳ REPAIRING...":"🔧 REPAIR"})]}),j.length>0&&jsxRuntimeExports.jsxs("div",{className:"health-issues",children:[jsxRuntimeExports.jsxs("div",{className:"issues-header",children:[jsxRuntimeExports.jsxs("span",{className:"issues-count",children:[j.length," Issue",j.length!==1?"s":""]}),jsxRuntimeExports.jsxs("span",{className:"issues-critical",children:[j.filter(N=>N.severity==="critical").length," Critical"]})]}),jsxRuntimeExports.jsxs("div",{className:"issues-summary",children:[j.slice(0,3).map(N=>jsxRuntimeExports.jsxs("div",{className:`issue-item ${N.severity}`,children:[jsxRuntimeExports.jsx("span",{className:"issue-severity",children:N.severity.toUpperCase()}),jsxRuntimeExports.jsx("span",{className:"issue-title",children:N.title})]},N.id)),j.length>3&&jsxRuntimeExports.jsx("div",{className:"issue-item more",children:jsxRuntimeExports.jsxs("span",{className:"more-count",children:["+",j.length-3," more"]})})]})]}),g&&jsxRuntimeExports.jsxs("div",{className:`operation-result ${g.status}`,children:[jsxRuntimeExports.jsxs("div",{className:"result-header",children:[jsxRuntimeExports.jsx("span",{className:"result-type",children:g.type.toUpperCase()}),jsxRuntimeExports.jsx("span",{className:"result-status",children:g.status.toUpperCase()})]}),jsxRuntimeExports.jsxs("div",{className:"result-details",children:[jsxRuntimeExports.jsxs("span",{className:"result-duration",children:[g.duration,"ms"]}),g.itemsFixed!==void 0&&jsxRuntimeExports.jsxs("span",{className:"result-fixed",children:[g.itemsFixed," fixed"]})]}),g.recommendations.length>0&&jsxRuntimeExports.jsx("div",{className:"result-recommendations",children:g.recommendations.slice(0,2).map((N,k)=>jsxRuntimeExports.jsx("div",{className:"recommendation",children:N},k))})]}),jsxRuntimeExports.jsxs("div",{className:"health-metrics",children:[jsxRuntimeExports.jsxs("div",{className:"metric-item",children:[jsxRuntimeExports.jsx("span",{className:"metric-label",children:"RESPONSE"}),jsxRuntimeExports.jsxs("span",{className:"metric-value",children:[C.responseTime,"ms"]})]}),jsxRuntimeExports.jsxs("div",{className:"metric-item",children:[jsxRuntimeExports.jsx("span",{className:"metric-label",children:"MEMORY"}),jsxRuntimeExports.jsxs("span",{className:"metric-value",children:[C.memoryUsage,"%"]})]}),jsxRuntimeExports.jsxs("div",{className:"metric-item",children:[jsxRuntimeExports.jsx("span",{className:"metric-label",children:"UPTIME"}),jsxRuntimeExports.jsxs("span",{className:"metric-value",children:[Math.floor(C.uptime/60),"m"]})]})]})]})]})},RightSidebar=()=>{const[r,e]=reactExports.useState([]);reactExports.useEffect(()=>{(async()=>{try{const f=await FeedService$1.getFeeds();e(f)}catch(f){console.error("Failed to load feeds for export:",f)}})()},[]);const t=E=>{log.debug("Component","Filters changed:",E)},s=E=>{log.debug("Component","Applying filters:",E)},n=E=>{log.debug("Component","Saving preset:",E)},i=E=>{log.debug("Component","Auto export changed:",E)},o=()=>{log.debug("Component","Export settings opened")},a=E=>{log.debug("Component","Export format selected:",E)},l=E=>{log.debug("Component","Export options changed:",E)},p=(E,f)=>{log.debug("Component","Executing export:",{format:E,options:f,feedCount:r.length})},g=()=>{log.debug("Component","Health scan initiated")},x=()=>{log.debug("Component","System clean initiated")},b=()=>{log.debug("Component","System repair initiated")};return jsxRuntimeExports.jsxs("div",{className:"tactical-sidebar-container animate-slide-in-right",children:[jsxRuntimeExports.jsx(SystemControl,{}),jsxRuntimeExports.jsx(TacticalFilters,{onFiltersChange:t,onApplyFilters:s,onSavePreset:n,filterPresets:["CRITICAL","INTEL","THREAT"]}),jsxRuntimeExports.jsx(Export,{onAutoExportChange:i,onExportSettingsOpen:o,onFormatSelect:a,onOptionsChange:l,onExecuteExport:p}),jsxRuntimeExports.jsx(Health,{feedCount:r.length,onScan:g,onClean:x,onRepair:b,connectionStatus:"ONLINE",securityStatus:"SECURE",overallStatus:"OPTIMAL"})]})},FeedItem=({feed:r})=>{const[e,t]=reactExports.useState(!1),[s,n]=reactExports.useState(!1);reactExports.useEffect(()=>{const p=setTimeout(()=>n(!0),100);return()=>clearTimeout(p)},[]);const i=p=>{try{return new Date(p).toLocaleString()}catch{return p}},o=(p,g=150)=>!p||p.length<=g?p:p.substring(0,g)+"...",a=()=>{t(!e)},l=p=>{try{return new URL(p).hostname.replace("www.","").split(".")[0].toUpperCase()}catch{return"UNKNOWN"}};return jsxRuntimeExports.jsxs("div",{className:`feed-item ${e?"expanded":""} ${s?"visible":"mounting"}`,children:[jsxRuntimeExports.jsxs("div",{className:"feed-item-header",children:[jsxRuntimeExports.jsx("div",{className:"feed-source-badge",children:l(r.link)}),jsxRuntimeExports.jsx("div",{className:"feed-timestamp",children:i(r.pubDate)})]}),jsxRuntimeExports.jsx("h3",{className:"feed-title",children:jsxRuntimeExports.jsx("a",{href:r.link,target:"_blank",rel:"noopener noreferrer",className:"feed-link",children:r.title})}),r.description&&jsxRuntimeExports.jsxs("div",{className:"feed-description",children:[jsxRuntimeExports.jsx("p",{children:e?r.description:o(r.description)}),r.description.length>150&&jsxRuntimeExports.jsx("button",{onClick:a,className:"expand-button",children:e?"📜 Show Less":"📋 Read More"})]}),jsxRuntimeExports.jsxs("div",{className:"feed-actions",children:[jsxRuntimeExports.jsx("button",{onClick:()=>window.open(r.link,"_blank"),className:"action-button primary",children:"🔗 Open"}),jsxRuntimeExports.jsx("button",{onClick:()=>{var p;return(p=navigator.clipboard)==null?void 0:p.writeText(r.link)},className:"action-button",children:"📋 Copy"}),jsxRuntimeExports.jsx("button",{onClick:()=>{log.debug("Component","Bookmark:",r.title)},className:"action-button",children:"⭐ Bookmark"})]})]})},Se=class Se{constructor(){O(this,"alerts",[]);O(this,"alertHistory",[]);O(this,"isMonitoring",!1);O(this,"notificationPermission","default");O(this,"subscribers",[]);this.loadAlerts(),this.requestNotificationPermission()}static getInstance(){return Se.instance||(Se.instance=new Se),Se.instance}async initialize(){await this.requestNotificationPermission(),this.startMonitoring()}async requestNotificationPermission(){"Notification"in window&&(this.notificationPermission=await Notification.requestPermission())}loadAlerts(){try{const e=localStorage.getItem("tactical-intel-alerts");if(e){const t=JSON.parse(e);this.alerts=t.map(s=>({...s,createdAt:new Date(s.createdAt),lastTriggered:s.lastTriggered?new Date(s.lastTriggered):void 0}))}}catch(e){console.error("Failed to load alerts from localStorage:",e),this.alerts=[]}}saveAlerts(){try{localStorage.setItem("tactical-intel-alerts",JSON.stringify(this.alerts))}catch(e){console.error("Failed to save alerts to localStorage:",e)}}loadAlertHistory(){try{const e=localStorage.getItem("tactical-intel-alert-history");if(e){const t=JSON.parse(e);this.alertHistory=t.map(s=>({...s,triggeredAt:new Date(s.triggeredAt)}))}}catch(e){console.error("Failed to load alert history from localStorage:",e),this.alertHistory=[]}}saveAlertHistory(){try{const e=this.alertHistory.sort((t,s)=>s.triggeredAt.getTime()-t.triggeredAt.getTime()).slice(0,1e3);localStorage.setItem("tactical-intel-alert-history",JSON.stringify(e))}catch(e){console.error("Failed to save alert history to localStorage:",e)}}createAlert(e){const t={...e,id:this.generateAlertId(),createdAt:new Date,triggerCount:0};return this.alerts.push(t),this.saveAlerts(),t.id}updateAlert(e,t){const s=this.alerts.findIndex(n=>n.id===e);return s===-1?!1:(this.alerts[s]={...this.alerts[s],...t},this.saveAlerts(),!0)}deleteAlert(e){const t=this.alerts.findIndex(s=>s.id===e);return t===-1?!1:(this.alerts.splice(t,1),this.saveAlerts(),!0)}getAlerts(){return[...this.alerts]}getAlert(e){return this.alerts.find(t=>t.id===e)}toggleAlert(e){const t=this.alerts.find(s=>s.id===e);return t?(t.active=!t.active,this.saveAlerts(),!0):!1}checkFeedItems(e){const t=[],s=this.alerts.filter(n=>n.active);for(const n of s)if(this.isAlertScheduleActive(n))for(const i of e){const o=this.checkKeywordMatches(n.keywords,i);if(o.length>0){if(n.sources&&n.sources.length>0){const l=this.extractFeedSource(i);if(!n.sources.includes(l))continue}const a={id:this.generateTriggerId(),alertId:n.id,triggeredAt:new Date,feedItem:{title:i.title||"",description:i.description||i.summary||"",link:i.link||i.url||"",source:this.extractFeedSource(i),pubDate:i.pubDate||i.published||new Date().toISOString()},matchedKeywords:o,priority:n.priority,acknowledged:!1};t.push(a),this.updateAlertTriggerStats(n.id),this.sendNotification(n,a)}}return t.length>0&&(this.alertHistory.push(...t),this.saveAlertHistory()),t}isAlertScheduleActive(e){const t=new Date;if(e.scheduling.snoozeUntil&&t<e.scheduling.snoozeUntil)return!1;if(e.scheduling.activeDays&&e.scheduling.activeDays.length>0){const s=t.getDay();if(!e.scheduling.activeDays.includes(s))return!1}if(e.scheduling.activeHours){const s=t.getHours()*60+t.getMinutes(),[n,i]=e.scheduling.activeHours.start.split(":").map(Number),[o,a]=e.scheduling.activeHours.end.split(":").map(Number),l=n*60+i,p=o*60+a;if(l<=p){if(s<l||s>p)return!1}else if(s<l&&s>p)return!1}return!0}checkKeywordMatches(e,t){const s=[t.title||"",t.description||t.summary||"",t.content||""].join(" ").toLowerCase();return e.filter(n=>{const i=n.toLowerCase().trim();if(i.includes(" and "))return i.split(" and ").every(a=>s.includes(a.trim()));if(i.includes(" or "))return i.split(" or ").some(a=>s.includes(a.trim()));if(i.startsWith("not ")){const o=i.substring(4);return!s.includes(o)}return s.includes(i)})}extractFeedSource(e){return e.source||e.feedTitle||e.feed||"Unknown Source"}updateAlertTriggerStats(e){const t=this.alerts.find(s=>s.id===e);t&&(t.triggerCount++,t.lastTriggered=new Date,this.saveAlerts())}sendNotification(e,t){const{notifications:s}=e;if(s.browser&&this.notificationPermission==="granted"){const n=`🚨 ${e.name}`,i=s.customMessage||`Alert triggered: ${t.feedItem.title.substring(0,100)}...`,o=new Notification(n,{body:i,icon:"/favicon.ico",badge:"/favicon.ico",tag:`alert-${e.id}`,requireInteraction:e.priority==="critical",data:{alertId:e.id,triggerId:t.id,link:t.feedItem.link}});o.onclick=()=>{window.focus(),window.open(t.feedItem.link,"_blank"),o.close()}}s.sound&&this.playAlertSound(s.soundFile||this.getDefaultSoundForPriority(e.priority))}playAlertSound(e){try{const t=new Audio(e);t.volume=.5,t.play().catch(console.error)}catch(t){console.error("Failed to play alert sound:",t)}}getDefaultSoundForPriority(e){const t={low:"/sounds/alert-low.mp3",medium:"/sounds/alert-medium.mp3",high:"/sounds/alert-high.mp3",critical:"/sounds/alert-critical.mp3"};return t[e]||t.medium}startMonitoring(){this.isMonitoring=!0}stopMonitoring(){this.isMonitoring=!1}isCurrentlyMonitoring(){return this.isMonitoring}getAlertHistory(e,t){this.loadAlertHistory();let s=e?this.alertHistory.filter(n=>n.alertId===e):this.alertHistory;return s=s.sort((n,i)=>i.triggeredAt.getTime()-n.triggeredAt.getTime()),t?s.slice(0,t):s}clearAlertHistory(e){e?this.alertHistory=this.alertHistory.filter(t=>t.alertId!==e):this.alertHistory=[],this.saveAlertHistory()}snoozeAlert(e,t){const s=this.alerts.find(i=>i.id===e);if(!s)return!1;const n=new Date;return n.setMinutes(n.getMinutes()+t),s.scheduling.snoozeUntil=n,this.saveAlerts(),!0}generateAlertId(){return`alert_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}generateTriggerId(){return`trigger_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}addAlert(e){const t={name:e.name,keywords:e.keywords||[],priority:e.level,active:e.enabled,sources:e.feedSources,notifications:{browser:e.notificationEnabled,sound:!1},scheduling:{activeDays:e.schedule==="weekdays"?[1,2,3,4,5]:void 0,activeHours:e.schedule==="business_hours"?{start:"09:00",end:"17:00"}:void 0}},s=this.createAlert(t),n=this.getAlert(s);return{id:n.id,name:n.name,keywords:n.keywords,level:n.priority,enabled:n.active,schedule:"always",feedSources:n.sources||[],notificationEnabled:n.notifications.browser,createdAt:n.createdAt,triggeredAt:n.lastTriggered}}updateAlertLegacy(e,t){if(!this.updateAlert(e,t))return null;const n=this.getAlert(e);return n?{id:n.id,name:n.name,keywords:n.keywords,level:n.priority,enabled:n.active,schedule:"always",feedSources:n.sources||[],notificationEnabled:n.notifications.browser,createdAt:n.createdAt,triggeredAt:n.lastTriggered}:null}clearAlerts(){this.alerts=[],this.saveAlerts()}clearSubscribers(){this.subscribers=[]}subscribe(e){return this.subscribers.push(e),()=>{const t=this.subscribers.indexOf(e);t>-1&&this.subscribers.splice(t,1)}}checkForMatches(e){const t=this.checkFeedItems(e),s=[];for(const n of t){const i=this.getAlert(n.alertId);if(!i)continue;const o={id:i.id,name:i.name,keywords:i.keywords,level:i.priority,enabled:i.active,schedule:"always",feedSources:i.sources||[],notificationEnabled:i.notifications.browser,createdAt:i.createdAt,triggeredAt:i.lastTriggered};s.push({alert:o,feedItem:n.feedItem,matchedKeywords:n.matchedKeywords})}return s.length>0&&this.subscribers.forEach(n=>{try{n(s)}catch(i){console.error("Error in alert subscriber callback:",i)}}),s}};O(Se,"instance");let AlertService=Se;const useAlerts=()=>{const[r,e]=reactExports.useState([]),[t,s]=reactExports.useState([]),[n,i]=reactExports.useState(!1),[o]=reactExports.useState({totalAlerts:0,activeAlerts:0,totalTriggers:0,triggersToday:0}),[a,l]=reactExports.useState(!0),[p,g]=reactExports.useState(null),x=AlertService.getInstance();reactExports.useEffect(()=>{(async()=>{try{l(!0),await x.initialize(),b(),i(x.isCurrentlyMonitoring())}catch(D){g(D instanceof Error?D.message:"Failed to initialize alerts")}finally{l(!1)}})()},[]);const b=reactExports.useCallback(()=>{try{e(x.getAlerts()),s(x.getAlertHistory()),g(null)}catch(P){g(P instanceof Error?P.message:"Failed to refresh alert data")}},[x]),E=reactExports.useCallback(P=>{try{const D=x.createAlert(P);return b(),D}catch(D){throw g(D instanceof Error?D.message:"Failed to create alert"),D}},[x,b]),f=reactExports.useCallback((P,D)=>{try{const M=x.updateAlert(P,D);return M&&b(),M}catch(M){return g(M instanceof Error?M.message:"Failed to update alert"),!1}},[x,b]),j=reactExports.useCallback(P=>{try{const D=x.deleteAlert(P);return D&&b(),D}catch(D){return g(D instanceof Error?D.message:"Failed to delete alert"),!1}},[x,b]),C=reactExports.useCallback(P=>{try{const D=x.toggleAlert(P);return D&&b(),D}catch(D){return g(D instanceof Error?D.message:"Failed to toggle alert"),!1}},[x,b]),S=reactExports.useCallback(()=>{try{x.startMonitoring(),i(!0)}catch(P){g(P instanceof Error?P.message:"Failed to start monitoring")}},[x]),R=reactExports.useCallback(()=>{try{x.stopMonitoring(),i(!1)}catch(P){g(P instanceof Error?P.message:"Failed to stop monitoring")}},[x]),I=reactExports.useCallback((P,D)=>{try{return x.getAlertHistory(P,D)}catch(M){return g(M instanceof Error?M.message:"Failed to get alert history"),[]}},[x]),A=reactExports.useCallback(P=>{try{x.clearAlertHistory(P),b()}catch(D){g(D instanceof Error?D.message:"Failed to clear alert history")}},[x,b]),$=reactExports.useCallback((P,D)=>{try{const M=x.snoozeAlert(P,D);return M&&b(),M}catch(M){return g(M instanceof Error?M.message:"Failed to snooze alert"),!1}},[x,b]),N=reactExports.useCallback(P=>{try{const D=t.map(M=>M.id===P?{...M,acknowledged:!0}:M);s(D)}catch(D){g(D instanceof Error?D.message:"Failed to acknowledge alert")}},[t]),k=reactExports.useCallback(P=>{try{const D=x.checkFeedItems(P);return D.length>0&&b(),D}catch(D){return g(D instanceof Error?D.message:"Failed to check feed items"),[]}},[x,b]);return{alerts:r,createAlert:E,updateAlert:f,deleteAlert:j,toggleAlert:C,isMonitoring:n,startMonitoring:S,stopMonitoring:R,alertHistory:t,getAlertHistory:I,clearAlertHistory:A,snoozeAlert:$,acknowledgeAlert:N,alertStats:o,checkFeedItems:k,loading:a,error:p}},useLoading=(r={})=>{const{initialMessage:e="Loading...",trackProgress:t=!1,minLoadingTime:s=500,onStart:n,onComplete:i,onError:o}=r,[a,l]=reactExports.useState({isLoading:!1,progress:t?0:void 0,message:e,error:null}),p=reactExports.useRef(null),g=reactExports.useRef(null),x=reactExports.useCallback((S,R)=>{if(S)p.current=Date.now(),l(I=>({...I,isLoading:!0,message:R||e,error:null,progress:t?0:void 0})),n==null||n();else{const I=p.current?Date.now()-p.current:0,A=Math.max(0,s-I);A>0?g.current=setTimeout(()=>{l($=>({...$,isLoading:!1,progress:t?100:void 0})),i==null||i()},A):(l($=>({...$,isLoading:!1,progress:t?100:void 0})),i==null||i())}},[e,t,s,n,i]),b=reactExports.useCallback((S,R)=>{l(I=>({...I,progress:Math.min(100,Math.max(0,S)),message:R||I.message}))},[]),E=reactExports.useCallback(S=>{l(R=>({...R,message:S}))},[]),f=reactExports.useCallback(S=>{l(R=>({...R,error:S,isLoading:!1})),S&&(o==null||o(S))},[o]),j=reactExports.useCallback(async(S,R)=>{try{x(!0,R);const I=await S();return x(!1),I}catch(I){const A=I instanceof Error?I.message:"An error occurred";throw f(A),I}},[x,f]),C=reactExports.useCallback(async(S,R)=>{try{x(!0,R);const I=await S(b);return x(!1),I}catch(I){const A=I instanceof Error?I.message:"An error occurred";throw f(A),I}},[x,f,b]);return reactExports.useEffect(()=>()=>{g.current&&clearTimeout(g.current)},[]),{...a,setLoading:x,setProgress:b,setMessage:E,setError:f,withLoading:j,withProgressLoading:C}},je=class je{constructor(){O(this,"config");O(this,"refreshTimers",new Map);O(this,"cache",new Map);O(this,"isLowPowerMode",!1);O(this,"performanceObserver");O(this,"memoryMonitor");this.config=this.getOptimalConfig(),this.detectSystemCapabilities(),this.initializeMonitoring()}static getInstance(){return je.instance||(je.instance=new je),je.instance}getOptimalConfig(){const e=this.isLowEndDevice();return{refreshIntervals:{feeds:e?10*60*1e3:5*60*1e3,health:e?60*1e3:30*1e3,alerts:e?5*60*1e3:2*60*1e3,search:e?1e3:500},caching:{feedCache:!0,healthCache:!0,searchCache:!0,maxCacheSize:e?50:100,cacheExpiry:e?5*60*1e3:2*60*1e3},throttling:{searchDelay:e?800:300,scrollThrottle:e?100:50,resizeThrottle:e?250:100},batching:{feedRequests:!0,healthChecks:!0,maxBatchSize:e?3:5},monitoring:{trackMemory:!0,trackPerformance:!0,alertThreshold:e?70:85}}}isLowEndDevice(){const e=navigator.hardwareConcurrency||1,t=navigator.deviceMemory||1,s=navigator.connection;return e<=2||t<=2||s&&s.effectiveType==="slow-2g"||s&&s.effectiveType==="2g"}detectSystemCapabilities(){if("memory"in performance){const e=performance.memory,t=e.usedJSHeapSize/1024/1024,s=e.totalJSHeapSize/1024/1024;t/s>.8&&this.enableLowPowerMode()}}initializeMonitoring(){this.config.monitoring.trackPerformance&&("PerformanceObserver"in window&&(this.performanceObserver=new PerformanceObserver(e=>{for(const t of e.getEntries())t.name==="first-contentful-paint"&&t.startTime>3e3&&(console.warn("Slow FCP detected, enabling performance mode"),this.enableLowPowerMode())}),this.performanceObserver.observe({entryTypes:["paint","navigation"]})),this.config.monitoring.trackMemory&&(this.memoryMonitor=setInterval(()=>{this.checkMemoryUsage()},3e4)))}checkMemoryUsage(){if("memory"in performance){const e=performance.memory,t=e.usedJSHeapSize/1024/1024,s=e.jsHeapSizeLimit/1024/1024,n=t/s*100;n>this.config.monitoring.alertThreshold&&(console.warn(`High memory usage: ${n.toFixed(1)}%`),this.enableLowPowerMode(),this.cleanupCache())}}enableLowPowerMode(){this.isLowPowerMode||(logger.debug("Component","🔋 Enabling low power mode for better performance"),this.isLowPowerMode=!0,this.config.refreshIntervals.feeds*=2,this.config.refreshIntervals.health*=2,this.config.refreshIntervals.alerts*=2,this.config.caching.maxCacheSize=Math.floor(this.config.caching.maxCacheSize/2),this.cleanupCache(.5),window.dispatchEvent(new CustomEvent("performance:lowPowerMode",{detail:{enabled:!0}})))}disableLowPowerMode(){this.isLowPowerMode&&(logger.debug("Component","⚡ Disabling low power mode"),this.isLowPowerMode=!1,this.config=this.getOptimalConfig(),window.dispatchEvent(new CustomEvent("performance:lowPowerMode",{detail:{enabled:!1}})))}setCache(e,t,s){if(!this.config.caching.feedCache)return;const n=Date.now(),i=s||this.config.caching.cacheExpiry;this.cache.size>=this.config.caching.maxCacheSize&&this.cleanupCache(.2),this.cache.set(e,{data:t,timestamp:n,ttl:i})}getCache(e){const t=this.cache.get(e);return t?Date.now()-t.timestamp>t.ttl?(this.cache.delete(e),null):t.data:null}cleanupCache(e=1){if(e>=1){this.cache.clear();return}const t=Array.from(this.cache.entries());t.sort((n,i)=>n[1].timestamp-i[1].timestamp);const s=Math.floor(t.length*e);for(let n=0;n<s;n++)this.cache.delete(t[n][0])}createTimer(e,t,s){this.clearTimer(e);const n=setInterval(t,s);this.refreshTimers.set(e,n)}clearTimer(e){const t=this.refreshTimers.get(e);t&&(clearInterval(t),this.refreshTimers.delete(e))}clearAllTimers(){this.refreshTimers.forEach(e=>clearInterval(e)),this.refreshTimers.clear()}throttle(e,t){let s=null,n=0;return(...i)=>{const o=Date.now(),a=t-(o-n);a<=0||a>t?(s&&(clearTimeout(s),s=null),n=o,e.apply(null,i)):s||(s=setTimeout(()=>{n=Date.now(),s=null,e.apply(null,i)},a))}}debounce(e,t){let s;return(...n)=>{clearTimeout(s),s=setTimeout(()=>e.apply(null,n),t)}}getRefreshInterval(e){return this.config.refreshIntervals[e]}getThrottleDelay(e){return this.config.throttling[e]}isCachingEnabled(){return this.config.caching.feedCache}isLowPower(){return this.isLowPowerMode}cleanup(){this.clearAllTimers(),this.cleanupCache(),this.performanceObserver&&this.performanceObserver.disconnect(),this.memoryMonitor&&clearInterval(this.memoryMonitor)}getMetrics(){return{cacheSize:this.cache.size,activeTimers:this.refreshTimers.size,isLowPowerMode:this.isLowPowerMode,config:this.config,memory:"memory"in performance?performance.memory:null}}};O(je,"instance");let PerformanceManager=je;const PerformanceManager$1=PerformanceManager.getInstance(),FeedVisualizer=reactExports.memo(({selectedFeedList:r})=>{const[e,t]=reactExports.useState([]),[s,n]=reactExports.useState(null),[i,o]=reactExports.useState(()=>SettingsIntegrationService.getGeneralSettings().autoRefresh),[a,l]=reactExports.useState(0),{getFilteredFeeds:p}=useFilters(),g=reactExports.useMemo(()=>{const $=`filtered-feeds-${r}-${e.length}`,N=PerformanceManager$1.getCache($);if(N)return N;const k=e.map(D=>FeedService$3.enrichFeedWithMetadata(D)),P=p(k);return PerformanceManager$1.setCache($,P,3e4),P},[e,p,r]),{isLoading:x,error:b,setLoading:E,setError:f}=useLoading({minLoadingTime:800,initialMessage:"Loading intelligence feeds..."}),{checkFeedItems:j,isMonitoring:C,alertStats:S}=useAlerts(),R=reactExports.useCallback(async($=!0)=>{if(!r){t([]),E(!1);return}$&&(E(!0,"Loading intelligence feeds..."),f(null));try{log.debug("Component",`Loading feeds for list: ${r}`);const N=await FeedService$3.getFeedsByList(r);if(log.debug("Component",`Loaded ${N.length} feeds`),C&&N.length>0){log.debug("Component",`🚨 Checking ${N.length} feed items for alerts...`);const k=N.map(D=>({title:D.title,description:D.description||"",content:D.content||"",link:D.link,url:D.url,source:D.name,feedTitle:D.name,pubDate:D.pubDate,author:D.author,categories:D.categories})),P=j(k);P.length>0&&(log.debug("Component",`🚨 ${P.length} alert(s) triggered!`),l(P.length),setTimeout(()=>l(0),3e4))}t(N),n(new Date)}catch(N){console.error("Failed to load feeds:",N),f(`Failed to load feeds: ${N instanceof Error?N.message:"Unknown error"}`)}finally{E(!1)}},[r,C,j,E,f]);reactExports.useEffect(()=>{if(!i||!r)return;const $=SettingsIntegrationService.getGeneralSettings(),N=$.refreshInterval*1e3,k=setInterval(()=>{log.debug("Component",`Auto-refreshing feeds every ${$.refreshInterval} seconds...`),R(!1)},N);return()=>clearInterval(k)},[i,r,R]),reactExports.useEffect(()=>{R()},[R]);const I=()=>{R(!0)},A=()=>{o(!i)};return x?jsxRuntimeExports.jsx(FeedVisualizerSkeleton,{}):b?jsxRuntimeExports.jsx("div",{className:"feed-visualizer",children:jsxRuntimeExports.jsx(ErrorOverlay,{title:"⚠️ Feed Load Error",message:b,onRetry:()=>R(!0),suggestions:["Check your internet connection","Verify the feed source is available","Try selecting a different feed list"]})}):jsxRuntimeExports.jsxs("div",{className:"feed-visualizer-container",children:[jsxRuntimeExports.jsxs("div",{className:"feed-controls tactical-header",style:{borderBottom:"1px solid rgba(0, 255, 170, 0.2)"},children:[jsxRuntimeExports.jsxs("div",{className:"status-bar",children:[jsxRuntimeExports.jsxs("span",{className:"feed-count text-accent font-semibold",children:["📡 ",g.length>0?g.length:e.length," FEEDS LOADED"]}),s&&jsxRuntimeExports.jsxs("span",{className:"last-updated text-secondary text-sm",children:["🕐 UPDATED: ",s.toLocaleTimeString()]}),jsxRuntimeExports.jsx("span",{className:`alert-status text-sm ${C?"text-accent":"text-muted"}`,children:C?"🚨 ALERT MONITOR: ON":"⚪ ALERT MONITOR: OFF"}),a>0&&jsxRuntimeExports.jsxs("span",{className:"recent-alerts animate-pulse text-accent font-bold",children:["🔥 ",a," ALERT",a>1?"S":""," TRIGGERED!"]}),S.activeAlerts>0&&jsxRuntimeExports.jsxs("span",{className:"active-alerts-count text-secondary text-sm",children:["📋 ",S.activeAlerts," ACTIVE ALERT",S.activeAlerts>1?"S":""]})]}),jsxRuntimeExports.jsxs("div",{className:"control-buttons",children:[jsxRuntimeExports.jsxs("button",{onClick:I,className:"filter-action-btn refresh",title:"Refresh feeds",children:[jsxRuntimeExports.jsx("span",{className:"btn-icon",children:"🔄"}),jsxRuntimeExports.jsx("span",{className:"btn-text",children:"REFRESH"})]}),jsxRuntimeExports.jsxs("button",{onClick:A,className:`filter-action-btn ${i?"active":""}`,title:`Auto-refresh: ${i?"ON":"OFF"}`,children:[jsxRuntimeExports.jsx("span",{className:"btn-icon",children:i?"🔴":"⚪"}),jsxRuntimeExports.jsx("span",{className:"btn-text",children:"AUTO-REFRESH"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"feed-content",children:e.length===0?jsxRuntimeExports.jsxs("div",{className:"no-feeds empty-state",children:[jsxRuntimeExports.jsx("div",{className:"empty-icon",children:"📋"}),jsxRuntimeExports.jsx("div",{className:"empty-title text-lg font-semibold text-muted",children:"NO INTELLIGENCE AVAILABLE"}),jsxRuntimeExports.jsx("div",{className:"empty-description text-secondary",children:"Select a feed list from the sidebar to begin monitoring intelligence sources."})]}):jsxRuntimeExports.jsx("div",{className:"feed-scroll-container",children:g.map($=>jsxRuntimeExports.jsx(FeedItem,{feed:$},$.id))})})]})}),CentralView=({selectedFeedList:r})=>jsxRuntimeExports.jsx("div",{className:"tactical-main",children:jsxRuntimeExports.jsxs("div",{className:"tactical-module module-intelligence animate-fade-in-up",children:[jsxRuntimeExports.jsxs("div",{className:"tactical-header-enhanced",children:[jsxRuntimeExports.jsxs("div",{className:"header-primary",children:[jsxRuntimeExports.jsx("span",{className:"module-icon",children:"📡"}),jsxRuntimeExports.jsx("h3",{children:"INTELLIGENCE FEED"})]}),jsxRuntimeExports.jsxs("div",{className:"header-status",children:[jsxRuntimeExports.jsx("span",{className:`status-dot ${r?"active":"idle"}`}),jsxRuntimeExports.jsx("span",{className:"status-text",children:r?"ACTIVE":"STANDBY"})]})]}),jsxRuntimeExports.jsx("div",{className:"tactical-content",style:{padding:0},children:jsxRuntimeExports.jsx(FeedVisualizer,{selectedFeedList:r})})]})}),QuickActions=({selectedFeedList:r,onRefreshAll:e,onExportData:t})=>{const[s,n]=reactExports.useState(!1),p=[{icon:"🔄",label:"Refresh All",action:e,className:"refresh-action"},{icon:"➕",label:"Add Feed",action:()=>{const g=prompt("🔗 Enter RSS Feed URL:");g&&(log.debug("Component","Adding feed:",g),alert("Feed addition functionality coming soon!"))},className:"add-action"},{icon:"💾",label:"Export",action:()=>{t()},className:"export-action"},{icon:"⚙️",label:"Settings",action:()=>{log.debug("Component","Opening settings..."),alert("Settings page coming soon!")},className:"settings-action"},{icon:"⛶",label:"Fullscreen",action:()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen().catch(g=>{console.error("Error entering fullscreen:",g)})},className:"fullscreen-action"}];return jsxRuntimeExports.jsxs("div",{className:`quick-actions ${s?"expanded":""}`,children:[jsxRuntimeExports.jsxs("button",{className:"quick-actions-toggle",onClick:()=>n(!s),title:"Quick Actions",children:[jsxRuntimeExports.jsx("span",{className:"toggle-icon",children:"⚡"}),s?"HIDE":"ACTIONS"]}),s&&jsxRuntimeExports.jsxs("div",{className:"quick-actions-panel",children:[jsxRuntimeExports.jsxs("div",{className:"panel-header",children:[jsxRuntimeExports.jsx("h4",{children:"🎯 Mission Control"}),r&&jsxRuntimeExports.jsxs("span",{className:"active-feed-info",children:["📡 ",r]})]}),jsxRuntimeExports.jsx("div",{className:"actions-grid",children:p.map((g,x)=>jsxRuntimeExports.jsxs("button",{className:`action-btn ${g.className}`,onClick:g.action,title:g.label,children:[jsxRuntimeExports.jsx("span",{className:"action-icon",children:g.icon}),jsxRuntimeExports.jsx("span",{className:"action-label",children:g.label})]},x))}),jsxRuntimeExports.jsxs("div",{className:"panel-footer",children:[jsxRuntimeExports.jsxs("div",{className:"system-status",children:[jsxRuntimeExports.jsx("span",{className:"status-indicator online",children:"🟢"}),jsxRuntimeExports.jsx("span",{className:"status-text",children:"System Online"})]}),jsxRuntimeExports.jsxs("div",{className:"last-sync",children:["Last Sync: ",new Date().toLocaleTimeString()]})]})]})]})},AlertNotificationPanel=({className:r=""})=>{const[e,t]=reactExports.useState([]),[s,n]=reactExports.useState(!1),{alertHistory:i,acknowledgeAlert:o,alertStats:a}=useAlerts();reactExports.useEffect(()=>{const E=i.filter(f=>!f.acknowledged).sort((f,j)=>j.triggeredAt.getTime()-f.triggeredAt.getTime()).slice(0,5);t(E)},[i]);const l=E=>{o(E)},p=()=>{e.forEach(E=>o(E.id))},g=E=>({low:"🟢",medium:"🟡",high:"🟠",critical:"🔴"})[E]||"⚪",x=E=>`priority-${E}`,b=E=>{const j=new Date().getTime()-E.getTime(),C=Math.floor(j/6e4),S=Math.floor(C/60);return S>0?`${S}h ago`:C>0?`${C}m ago`:"Just now"};return e.length===0?null:jsxRuntimeExports.jsxs("div",{className:`alert-notification-panel ${r} ${s?"collapsed":""}`,children:[jsxRuntimeExports.jsxs("div",{className:"panel-header",children:[jsxRuntimeExports.jsxs("div",{className:"header-content",children:[jsxRuntimeExports.jsxs("span",{className:"panel-title",children:["🚨 Active Alerts (",e.length,")"]}),jsxRuntimeExports.jsxs("div",{className:"header-stats",children:[jsxRuntimeExports.jsxs("span",{className:"stat",children:["Today: ",a.triggersToday]}),jsxRuntimeExports.jsxs("span",{className:"stat",children:["Total: ",a.totalTriggers]})]})]}),jsxRuntimeExports.jsxs("div",{className:"panel-controls",children:[e.length>1&&jsxRuntimeExports.jsx("button",{className:"acknowledge-all-btn",onClick:p,title:"Acknowledge all alerts",children:"✅ All"}),jsxRuntimeExports.jsx("button",{className:"collapse-btn",onClick:()=>n(!s),title:s?"Expand alerts":"Collapse alerts",children:s?"⬆️":"⬇️"})]})]}),!s&&jsxRuntimeExports.jsx("div",{className:"panel-content",children:jsxRuntimeExports.jsx("div",{className:"alert-list",children:e.map(E=>jsxRuntimeExports.jsxs("div",{className:`alert-notification ${x(E.priority)}`,children:[jsxRuntimeExports.jsxs("div",{className:"alert-header",children:[jsxRuntimeExports.jsx("span",{className:"priority-icon",children:g(E.priority)}),jsxRuntimeExports.jsx("span",{className:"alert-time",children:b(E.triggeredAt)}),jsxRuntimeExports.jsx("button",{className:"acknowledge-btn",onClick:()=>l(E.id),title:"Acknowledge this alert",children:"✓"})]}),jsxRuntimeExports.jsxs("div",{className:"alert-content",children:[jsxRuntimeExports.jsx("h4",{className:"alert-title",children:E.feedItem.title}),jsxRuntimeExports.jsxs("p",{className:"alert-source",children:["📡 ",E.feedItem.source]}),jsxRuntimeExports.jsxs("div",{className:"matched-keywords",children:[jsxRuntimeExports.jsx("span",{className:"keywords-label",children:"Keywords:"}),E.matchedKeywords.map((f,j)=>jsxRuntimeExports.jsx("span",{className:"keyword-tag",children:f},j))]})]}),jsxRuntimeExports.jsx("div",{className:"alert-actions",children:jsxRuntimeExports.jsx("button",{className:"view-source-btn",onClick:()=>window.open(E.feedItem.link,"_blank"),title:"View source article",children:"🔗 View"})})]},E.id))})})]})},HomePage=()=>{const[r,e]=reactExports.useState(null),t=()=>{window.location.reload()},s=()=>{const n={timestamp:new Date().toISOString(),selectedFeedList:r,exportedAt:new Date().toLocaleString()},i=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),o=URL.createObjectURL(i),a=document.createElement("a");a.href=o,a.download=`tactical-intel-export-${Date.now()}.json`,a.click(),URL.revokeObjectURL(o)};return jsxRuntimeExports.jsxs("div",{className:"home-page-container",children:[jsxRuntimeExports.jsx("div",{className:"tactical-sidebar-left",children:jsxRuntimeExports.jsx(LeftSidebar,{setSelectedFeedList:e})}),jsxRuntimeExports.jsx("div",{className:"tactical-main",children:jsxRuntimeExports.jsx(CentralView,{selectedFeedList:r})}),jsxRuntimeExports.jsx("div",{className:"tactical-sidebar-right",children:jsxRuntimeExports.jsx(RightSidebar,{})}),jsxRuntimeExports.jsxs("div",{className:"tactical-footer",children:[jsxRuntimeExports.jsx(QuickActions,{selectedFeedList:r,onRefreshAll:t,onExportData:s}),jsxRuntimeExports.jsx(AlertNotificationPanel,{})]})]})},SettingsError=({message:r="Settings content could not be loaded",details:e,code:t})=>{const s=useLocation();return jsxRuntimeExports.jsxs("div",{className:"settings-error",children:[jsxRuntimeExports.jsxs("div",{className:"error-header",children:[jsxRuntimeExports.jsx("span",{className:"error-icon",children:"⚠️"}),jsxRuntimeExports.jsx("h2",{children:r})]}),jsxRuntimeExports.jsxs("div",{className:"error-details",children:[jsxRuntimeExports.jsx("p",{children:e||"There was a problem loading the requested settings screen."}),jsxRuntimeExports.jsxs("div",{className:"technical-details",children:[jsxRuntimeExports.jsx("h3",{children:"Technical Information"}),jsxRuntimeExports.jsxs("ul",{children:[jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Current Path:"})," ",s.pathname]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Route Parameters:"})," ",JSON.stringify(s.state||{})]}),t&&jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Error Code:"})," ",jsxRuntimeExports.jsx("code",{children:t})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"troubleshooting",children:[jsxRuntimeExports.jsx("h3",{children:"Troubleshooting"}),jsxRuntimeExports.jsxs("ol",{children:[jsxRuntimeExports.jsx("li",{children:"Check that the tab component for this route exists and is properly exported"}),jsxRuntimeExports.jsx("li",{children:"Verify route configuration in AppRoutes.tsx matches the SettingsTab enum values"}),jsxRuntimeExports.jsx("li",{children:"Ensure all required context providers are available"}),jsxRuntimeExports.jsx("li",{children:"Check browser console for JavaScript errors"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"error-actions",children:[jsxRuntimeExports.jsx("button",{className:"btn-secondary",onClick:()=>window.location.href="/settings/general",children:"Go to General Settings"}),jsxRuntimeExports.jsx("button",{className:"btn-primary",onClick:()=>window.location.reload(),children:"Reload Page"})]})]})};class SettingsErrorBoundary extends reactExports.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e,errorInfo:null}}componentDidCatch(e,t){console.error("Settings component error:",e),console.error("Component stack:",t.componentStack),this.setState({errorInfo:t})}render(){var e,t;if(this.state.hasError){const s=((e=this.state.error)==null?void 0:e.message)||"Unknown error",n=((t=this.state.errorInfo)==null?void 0:t.componentStack)||"";return jsxRuntimeExports.jsx(SettingsError,{message:"Settings Component Error",details:s,code:n})}return this.props.children}}const SettingsDebug=()=>{const{tab:r}=useParams(),t=useLocation().pathname.split("/");return t.length>=3&&t[2],null},SettingsPage=()=>{const r=useNavigate(),e=useLocation(),{tab:t}=useParams(),{settings:s,updateSettings:n}=useSettings(),i=e.pathname.split("/"),o=i.length>=3?i[2]:null,a=t||o||SettingsTab.GENERAL;reactExports.useEffect(()=>{!t&&!o&&(console.log("[SettingsPage] No tab in URL, redirecting to general"),r("/settings/general",{replace:!0}))},[t,o,r]),reactExports.useEffect(()=>{a&&Object.values(SettingsTab).includes(a)&&s.lastTab!==a&&(console.log(`[SettingsPage] Updating last active tab to: ${a}`),n({lastTab:a}))},[a,s.lastTab,n]);const l=x=>{console.log(`[SettingsPage] Tab click: ${x}`);const b=`/settings/${x}`;r(b)},p=()=>{r("/")},g=x=>{switch(x){case SettingsTab.GENERAL:return"⚙️";case SettingsTab.CORS:return"🔄";case SettingsTab.PROTOCOLS:return"📡";case SettingsTab.VERIFICATION:return"🔐";case SettingsTab.DISPLAY:return"🖥️";case SettingsTab.ADVANCED:return"⚡";default:return"•"}};return jsxRuntimeExports.jsxs("div",{className:"settings-page",children:[jsxRuntimeExports.jsx(SettingsDebug,{}),jsxRuntimeExports.jsxs("div",{className:"settings-sidebar",children:[jsxRuntimeExports.jsxs("div",{className:"sidebar-header",children:[jsxRuntimeExports.jsx("h3",{children:"Settings"}),jsxRuntimeExports.jsxs("p",{children:["v",s.version]})]}),jsxRuntimeExports.jsx("div",{className:"settings-sidebar-nav",children:Object.values(SettingsTab).map(x=>jsxRuntimeExports.jsxs("button",{className:`settings-tab ${a===x?"active":""}`,onClick:()=>l(x),children:[jsxRuntimeExports.jsx("span",{className:"tab-icon",children:g(x)}),x.charAt(0).toUpperCase()+x.slice(1)]},x))})]}),jsxRuntimeExports.jsxs("div",{className:"settings-main-content",children:[jsxRuntimeExports.jsxs("div",{className:"settings-page-header",children:[jsxRuntimeExports.jsx("button",{className:"back-button",onClick:p,children:"← Back to Dashboard"}),jsxRuntimeExports.jsx("h1",{children:"Tactical Control Settings"}),jsxRuntimeExports.jsxs("p",{children:["Configure system parameters and operational preferences ",t&&`• ${t.charAt(0).toUpperCase()+t.slice(1)}`]})]}),jsxRuntimeExports.jsx("div",{className:"settings-tabs",children:Object.values(SettingsTab).map(x=>jsxRuntimeExports.jsx("button",{className:`settings-tab ${a===x?"active":""}`,onClick:()=>l(x),children:x.charAt(0).toUpperCase()+x.slice(1)},x))}),jsxRuntimeExports.jsx("div",{className:"settings-content",children:jsxRuntimeExports.jsx(SettingsErrorBoundary,{children:jsxRuntimeExports.jsx(Outlet,{})})})]})]})},Web3LoginPanel=()=>{const{isConnected:r,walletAddress:e,networkName:t,balance:s,ensName:n,accessLevel:i,connectWallet:o,disconnectWallet:a,switchNetwork:l}=useWeb3(),[p,g]=reactExports.useState(!1),x=async()=>{g(!0);try{await o()}catch(j){console.error("Failed to connect wallet:",j)}finally{g(!1)}},b=()=>{a()},E=j=>{switch(j){case AccessLevel.DIRECTOR:return"Director";case AccessLevel.COMMANDER:return"Commander";case AccessLevel.ANALYST:return"Analyst";case AccessLevel.FIELD_OPERATIVE:return"Field Operative";case AccessLevel.PUBLIC:default:return"Public User"}},f=j=>{switch(j){case AccessLevel.DIRECTOR:return"#ff3333";case AccessLevel.COMMANDER:return"#ff6600";case AccessLevel.ANALYST:return"#0099ff";case AccessLevel.FIELD_OPERATIVE:return"#00ff41";case AccessLevel.PUBLIC:default:return"#666666"}};return r?jsxRuntimeExports.jsx("div",{className:"web3-login-panel",children:jsxRuntimeExports.jsxs("div",{className:"connected-card tactical-module",children:[jsxRuntimeExports.jsx("div",{className:"tactical-header",children:jsxRuntimeExports.jsxs("h3",{children:[jsxRuntimeExports.jsx("span",{className:"tactical-icon",children:"🔐"}),"Tactical Authentication"]})}),jsxRuntimeExports.jsxs("div",{className:"tactical-content",children:[jsxRuntimeExports.jsxs("div",{className:"connection-status",children:[jsxRuntimeExports.jsx("div",{className:"status-indicator"}),jsxRuntimeExports.jsx("span",{children:"Authenticated"})]}),jsxRuntimeExports.jsxs("div",{className:"wallet-info",children:[jsxRuntimeExports.jsx("div",{className:"wallet-avatar",children:n?n.charAt(0).toUpperCase():e.substring(2,4).toUpperCase()}),jsxRuntimeExports.jsxs("div",{className:"wallet-details",children:[jsxRuntimeExports.jsx("div",{className:"wallet-name",children:n||"Tactical Operator"}),jsxRuntimeExports.jsxs("div",{className:"wallet-address",children:[e.substring(0,6),"...",e.substring(-4)]}),jsxRuntimeExports.jsxs("div",{className:"wallet-network",children:[jsxRuntimeExports.jsx("span",{className:"network-dot","data-network":t.toLowerCase()}),t]})]}),jsxRuntimeExports.jsxs("div",{className:"wallet-balance",children:[jsxRuntimeExports.jsx("div",{className:"balance-value",children:s}),jsxRuntimeExports.jsx("div",{className:"balance-currency",children:t.split(" ")[0]})]})]}),jsxRuntimeExports.jsx("div",{className:"access-level-indicator",children:jsxRuntimeExports.jsxs("div",{className:"access-badge",style:{color:f(i)},children:[jsxRuntimeExports.jsx("span",{className:"access-icon",children:"⭐"}),E(i)]})}),jsxRuntimeExports.jsxs("div",{className:"wallet-actions",children:[jsxRuntimeExports.jsx("button",{className:"action-button secondary",onClick:()=>{navigator.clipboard.writeText(e)},children:"📋 Copy Address"}),jsxRuntimeExports.jsx("button",{className:"action-button secondary",onClick:()=>{const j=t.includes("Ethereum")?`https://etherscan.io/address/${e}`:`https://polygonscan.com/address/${e}`;window.open(j,"_blank")},children:"🔍 View Explorer"}),jsxRuntimeExports.jsx("button",{className:"action-button danger",onClick:b,children:"🚪 Disconnect"})]})]})]})}):jsxRuntimeExports.jsx("div",{className:"web3-login-panel",children:jsxRuntimeExports.jsxs("div",{className:"login-card tactical-module",children:[jsxRuntimeExports.jsxs("div",{className:"login-header tactical-header",children:[jsxRuntimeExports.jsxs("h2",{children:[jsxRuntimeExports.jsx("span",{className:"tactical-icon",children:"🔐"}),"Tactical Authentication"]}),jsxRuntimeExports.jsx("p",{children:"Connect your wallet to access secure intelligence networks"})]}),jsxRuntimeExports.jsxs("div",{className:"login-content tactical-content",children:[jsxRuntimeExports.jsx("button",{className:"connect-button btn-primary",onClick:x,disabled:p,children:p?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("span",{className:"loading-spinner"}),"Connecting..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("span",{className:"wallet-icon",children:"🚀"}),"Connect Wallet"]})}),jsxRuntimeExports.jsxs("div",{className:"supported-wallets",children:[jsxRuntimeExports.jsx("p",{children:"Supported:"}),jsxRuntimeExports.jsxs("div",{className:"wallet-icons",children:[jsxRuntimeExports.jsx("span",{title:"MetaMask",children:"🦊"}),jsxRuntimeExports.jsx("span",{title:"WalletConnect",children:"🔗"}),jsxRuntimeExports.jsx("span",{title:"Trust Wallet",children:"🛡️"})]})]})]})]})})},ProfilePageSimple=()=>{const r=useNavigate(),{isConnected:e,walletAddress:t,ensName:s,accessLevel:n}=useWeb3(),i=()=>{r("/")};return jsxRuntimeExports.jsxs("div",{className:"profile-page",children:[jsxRuntimeExports.jsxs("div",{className:"profile-page-header",children:[jsxRuntimeExports.jsx("button",{className:"back-button",onClick:i,children:"← Back to Dashboard"}),jsxRuntimeExports.jsx("h1",{children:"Tactical Authentication"}),jsxRuntimeExports.jsx("p",{children:"Secure access to tactical intelligence networks"})]}),jsxRuntimeExports.jsxs("div",{className:"profile-content-simple",children:[jsxRuntimeExports.jsx(Web3LoginPanel,{}),e&&jsxRuntimeExports.jsxs("div",{className:"authenticated-info",children:[jsxRuntimeExports.jsxs("div",{className:"info-card tactical-module",children:[jsxRuntimeExports.jsx("h3",{children:"🎯 Authentication Status"}),jsxRuntimeExports.jsx("div",{className:"info-card-content tactical-content",children:jsxRuntimeExports.jsxs("div",{className:"status-grid",children:[jsxRuntimeExports.jsxs("div",{className:"status-item",children:[jsxRuntimeExports.jsx("span",{className:"status-label",children:"Operator ID:"}),jsxRuntimeExports.jsx("span",{className:"status-value",children:s||"Tactical Operator"})]}),jsxRuntimeExports.jsxs("div",{className:"status-item",children:[jsxRuntimeExports.jsx("span",{className:"status-label",children:"Wallet Address:"}),jsxRuntimeExports.jsxs("span",{className:"status-value monospace",children:[t.substring(0,8),"...",t.substring(-6)]})]}),jsxRuntimeExports.jsxs("div",{className:"status-item",children:[jsxRuntimeExports.jsx("span",{className:"status-label",children:"Security Clearance:"}),jsxRuntimeExports.jsxs("span",{className:`status-value clearance-${n}`,children:["Level ",n]})]})]})})]}),jsxRuntimeExports.jsxs("div",{className:"capabilities-card tactical-module",children:[jsxRuntimeExports.jsx("h3",{children:"🚀 Enabled Capabilities"}),jsxRuntimeExports.jsx("div",{className:"capabilities-card-content tactical-content",children:jsxRuntimeExports.jsxs("ul",{className:"capabilities-list",children:[jsxRuntimeExports.jsx("li",{className:"capability-enabled",children:"✅ Secure Feed Access"}),jsxRuntimeExports.jsx("li",{className:"capability-enabled",children:"✅ Cryptographic Verification"}),jsxRuntimeExports.jsx("li",{className:"capability-enabled",children:"✅ Decentralized Authentication"}),n>=2&&jsxRuntimeExports.jsx("li",{className:"capability-enabled",children:"✅ Advanced Analytics"}),n>=3&&jsxRuntimeExports.jsx("li",{className:"capability-enabled",children:"✅ Command Authority"}),n>=4&&jsxRuntimeExports.jsx("li",{className:"capability-enabled",children:"✅ Director-Level Access"})]})})]})]})]})]})},Web3TestPageContent=()=>jsxRuntimeExports.jsxs("div",{className:"web3-test-page",children:[jsxRuntimeExports.jsxs("div",{className:"test-header",children:[jsxRuntimeExports.jsx("h1",{children:"🚀 Web3 TDD Integration Test"}),jsxRuntimeExports.jsx("p",{children:"Testing complete Web3 authentication flow with local smart contract"}),jsxRuntimeExports.jsxs("div",{className:"contract-info",children:[jsxRuntimeExports.jsxs("div",{children:["📋 Contract: ",jsxRuntimeExports.jsx("code",{children:"0x5FbDB2315678afecb367f032d93F642f64180aa3"})]}),jsxRuntimeExports.jsx("div",{children:"🌐 Network: Localhost (Chain ID: 1337)"}),jsxRuntimeExports.jsx("div",{children:"⚡ Status: Live & Ready"})]})]}),jsxRuntimeExports.jsxs("div",{className:"test-sections",children:[jsxRuntimeExports.jsxs("section",{className:"login-section",children:[jsxRuntimeExports.jsx("h2",{children:"🔐 Web3 Authentication"}),jsxRuntimeExports.jsx(Web3LoginPanel,{})]}),jsxRuntimeExports.jsxs("section",{className:"profile-section",children:[jsxRuntimeExports.jsx("h2",{children:"👤 User Profile"}),jsxRuntimeExports.jsx(ProfilePageSimple,{})]})]}),jsxRuntimeExports.jsxs("div",{className:"test-instructions",children:[jsxRuntimeExports.jsx("h3",{children:"🧪 Test Instructions"}),jsxRuntimeExports.jsxs("ol",{children:[jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Connect MetaMask:"})," Add localhost:8545 network if needed"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Import Test Account:"})," Use one of the Hardhat private keys"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Connect Wallet:"})," Click the connect button above"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Verify Integration:"})," Check address, balance, and access level display"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Test Contract Interaction:"})," Access level should be detected automatically"]})]}),jsxRuntimeExports.jsxs("div",{className:"test-accounts",children:[jsxRuntimeExports.jsx("h4",{children:"📱 Test Accounts Available"}),jsxRuntimeExports.jsxs("div",{className:"account-grid",children:[jsxRuntimeExports.jsxs("div",{className:"account-card",children:[jsxRuntimeExports.jsx("div",{className:"account-label",children:"Account #0 (Owner)"}),jsxRuntimeExports.jsx("div",{className:"account-address",children:"0xf39F...2266"}),jsxRuntimeExports.jsx("div",{className:"account-key",children:"0xac097...f80"}),jsxRuntimeExports.jsx("div",{className:"account-balance",children:"10,000 ETH"}),jsxRuntimeExports.jsx("div",{className:"account-level",children:"🎖️ DIRECTOR Level"})]}),jsxRuntimeExports.jsxs("div",{className:"account-card",children:[jsxRuntimeExports.jsx("div",{className:"account-label",children:"Account #1"}),jsxRuntimeExports.jsx("div",{className:"account-address",children:"0x7099...79C8"}),jsxRuntimeExports.jsx("div",{className:"account-key",children:"0x59c69...690d"}),jsxRuntimeExports.jsx("div",{className:"account-balance",children:"10,000 ETH"}),jsxRuntimeExports.jsx("div",{className:"account-level",children:"👤 PUBLIC Level"})]})]})]})]})]}),Web3TestPage=()=>jsxRuntimeExports.jsx(Web3Provider,{children:jsxRuntimeExports.jsx(Web3TestPageContent,{})}),FeedPage=()=>{const{id:r}=useParams(),e=useNavigate(),[t,s]=reactExports.useState(null),[n,i]=reactExports.useState(!0),[o,a]=reactExports.useState(null);reactExports.useEffect(()=>{(async()=>{i(!0),a(null);try{if(r){const g=await FeedService$3.getFeedById(r);g?s(g):a("Feed not found")}else a("Invalid feed ID")}catch(g){console.error("Failed to load feed:",g),a("Failed to load feed")}finally{i(!1)}})()},[r]);const l=()=>{e("/")};return n?jsxRuntimeExports.jsx("div",{className:"feed-page loading",children:"Loading..."}):o?jsxRuntimeExports.jsxs("div",{className:"feed-page error",children:[jsxRuntimeExports.jsx("div",{className:"error-message",children:o}),jsxRuntimeExports.jsx("button",{className:"back-button",onClick:l,children:"Return to Dashboard"})]}):t?jsxRuntimeExports.jsxs("div",{className:"feed-page",children:[jsxRuntimeExports.jsxs("div",{className:"feed-header",children:[jsxRuntimeExports.jsx("button",{className:"back-button",onClick:l,children:"← Back to Dashboard"}),jsxRuntimeExports.jsx("h1",{children:t.title}),jsxRuntimeExports.jsx("p",{className:"feed-date",children:t.pubDate})]}),t.description&&jsxRuntimeExports.jsx("p",{className:"feed-description",children:t.description}),jsxRuntimeExports.jsx("div",{className:"feed-content",children:t.content&&jsxRuntimeExports.jsx("div",{dangerouslySetInnerHTML:{__html:t.content}})})]}):jsxRuntimeExports.jsxs("div",{className:"feed-page not-found",children:[jsxRuntimeExports.jsx("div",{className:"not-found-message",children:"Feed not found"}),jsxRuntimeExports.jsx("button",{className:"back-button",onClick:l,children:"Return to Dashboard"})]})},Modal=({isOpen:r,onClose:e,title:t,children:s,size:n="large"})=>{if(!r)return null;const i=a=>{a.target===a.currentTarget&&e()},o=a=>{a.key==="Escape"&&e()};return jsxRuntimeExports.jsx("div",{className:"modal-backdrop",onClick:i,onKeyDown:o,tabIndex:-1,children:jsxRuntimeExports.jsxs("div",{className:`modal-container ${n}`,children:[jsxRuntimeExports.jsxs("div",{className:"modal-header",children:[jsxRuntimeExports.jsx("h2",{className:"modal-title",children:t}),jsxRuntimeExports.jsx("button",{className:"modal-close-button",onClick:e,"aria-label":"Close modal",children:"✖️"})]}),jsxRuntimeExports.jsx("div",{className:"modal-content",children:s})]})})},FeedHealthIndicator=({feedId:r,showDetails:e=!1})=>{const t=FeedHealthService.getFeedHealth(r);if(!t)return jsxRuntimeExports.jsxs("div",{className:"feed-health-indicator unknown",title:"Health status unknown",children:[jsxRuntimeExports.jsx("span",{className:"health-dot",children:"●"}),e&&jsxRuntimeExports.jsx("span",{className:"health-text",children:"Unknown"})]});const s=l=>{switch(l){case"healthy":return"#22c55e";case"warning":return"#f59e0b";case"error":return"#ef4444";default:return"#6b7280"}},n=l=>{switch(l){case"healthy":return"Healthy";case"warning":return"Warning";case"error":return"Error";default:return"Unknown"}},i=l=>`${l.toFixed(1)}%`,o=l=>l?l<1e3?`${l}ms`:`${(l/1e3).toFixed(1)}s`:"N/A",a=l=>{const g=new Date().getTime()-l.getTime(),x=Math.floor(g/(1e3*60));if(x<1)return"Just now";if(x<60)return`${x}m ago`;const b=Math.floor(x/60);return b<24?`${b}h ago`:`${Math.floor(b/24)}d ago`};return jsxRuntimeExports.jsxs("div",{className:`feed-health-indicator ${t.status}`,title:`Health: ${n(t.status)} | Uptime: ${i(t.uptime)} | Response: ${o(t.responseTime)} | Last checked: ${a(t.lastChecked)}`,children:[jsxRuntimeExports.jsx("span",{className:"health-dot",style:{color:s(t.status)},children:"●"}),e&&jsxRuntimeExports.jsxs("div",{className:"health-details",children:[jsxRuntimeExports.jsx("span",{className:"health-text",children:n(t.status)}),jsxRuntimeExports.jsx("span",{className:"health-uptime",children:i(t.uptime)}),t.responseTime&&jsxRuntimeExports.jsx("span",{className:"health-response-time",children:o(t.responseTime)})]})]})},FeedManager=()=>{const[r,e]=reactExports.useState([]),[t,s]=reactExports.useState([]),[n,i]=reactExports.useState(new Set),[o,a]=reactExports.useState(null),[l,p]=reactExports.useState(""),[g,x]=reactExports.useState(""),[b,E]=reactExports.useState(!1),[f,j]=reactExports.useState(!1),[C,S]=reactExports.useState(null),R=[{id:"news",name:"News & Current Events",color:"#22c55e",feeds:[]},{id:"tech",name:"Technology",color:"#3b82f6",feeds:[]},{id:"security",name:"Security Intelligence",color:"#ef4444",feeds:[]},{id:"uncategorized",name:"Uncategorized",color:"#6b7280",feeds:[]}];reactExports.useEffect(()=>{I(),A()},[]);const I=async()=>{try{const B=await FeedService$1.getFeeds();e(B)}catch(B){console.error("Failed to load feeds:",B)}},A=()=>{const B=localStorage.getItem("feed_categories");B?s(JSON.parse(B)):(s(R),$(R))},$=B=>{localStorage.setItem("feed_categories",JSON.stringify(B))},N=async()=>{if(l.trim()){E(!0);try{if(new URL(l),r.find(G=>G.url===l)){alert("This feed is already added");return}await FeedService$1.addFeed({id:Date.now().toString(),name:"New Feed",title:"Loading...",description:"Fetching feed details...",link:l,url:l,pubDate:new Date().toISOString(),author:"",feedListId:"default"}),await I(),p("")}catch(B){console.error("Failed to add feed:",B),alert("Invalid URL or failed to add feed")}finally{E(!1)}}},k=async B=>{if(confirm("Are you sure you want to remove this feed?"))try{await FeedService$1.removeFeed(B),await I();const G=t.map(Q=>({...Q,feeds:Q.feeds.filter(z=>z!==B)}));s(G),$(G)}catch(G){console.error("Failed to remove feed:",G)}},P=()=>{if(!g.trim())return;const B={id:Date.now().toString(),name:g,color:`#${Math.floor(Math.random()*16777215).toString(16)}`,feeds:[]},G=[...t,B];s(G),$(G),x(""),j(!1)},D=B=>{if(confirm("Remove this category? Feeds will be moved to Uncategorized.")){const G=t.find(J=>J.id===B),Q=t.find(J=>J.id==="uncategorized");G&&Q&&Q.feeds.push(...G.feeds);const z=t.filter(J=>J.id!==B);s(z),$(z)}},M=B=>{a(B)},L=B=>{if(!o)return;const G=t.map(Q=>{const z=Q.feeds.filter(J=>J!==o);return Q.id===B?{...Q,feeds:[...z,o]}:{...Q,feeds:z}});s(G),$(G),a(null)},q=B=>{const G=t.find(Q=>Q.id===B);return G?r.filter(Q=>G.feeds.includes(Q.id)):[]},K=()=>{const B=new Set(t.flatMap(G=>G.feeds));return r.filter(G=>!B.has(G.id))},H=B=>{const G=new Set(n);G.has(B)?G.delete(B):G.add(B),i(G)},ee=()=>{n.size!==0&&confirm(`Remove ${n.size} selected feeds?`)&&Promise.all(Array.from(n).map(B=>FeedService$1.removeFeed(B))).then(()=>{I(),i(new Set)}).catch(B=>{console.error("Bulk remove failed:",B)})};return jsxRuntimeExports.jsxs("div",{className:"feed-manager",children:[jsxRuntimeExports.jsxs("div",{className:"feed-manager-header",children:[jsxRuntimeExports.jsx("h2",{className:"manager-title",children:"🗂️ Feed Manager"}),jsxRuntimeExports.jsxs("div",{className:"manager-stats",children:[r.length," feeds in ",t.length," categories"]})]}),jsxRuntimeExports.jsxs("div",{className:"add-feed-section",children:[jsxRuntimeExports.jsxs("div",{className:"add-feed-form",children:[jsxRuntimeExports.jsx("input",{type:"url",value:l,onChange:B=>p(B.target.value),placeholder:"Enter RSS/Atom feed URL...",className:"feed-url-input",onKeyPress:B=>B.key==="Enter"&&N()}),jsxRuntimeExports.jsxs("button",{onClick:N,disabled:b||!l.trim(),className:"add-feed-button",children:[b?"⏳":"➕"," Add Feed"]})]}),n.size>0&&jsxRuntimeExports.jsxs("div",{className:"bulk-actions",children:[jsxRuntimeExports.jsxs("span",{className:"selection-count",children:[n.size," selected"]}),jsxRuntimeExports.jsx("button",{onClick:ee,className:"bulk-remove-button",children:"🗑️ Remove Selected"}),jsxRuntimeExports.jsx("button",{onClick:()=>i(new Set),className:"clear-selection-button",children:"✖️ Clear Selection"})]})]}),jsxRuntimeExports.jsxs("div",{className:"categories-container",children:[t.map(B=>{const G=B.id==="uncategorized"?K():q(B.id),Q=C===B.id;return jsxRuntimeExports.jsxs("div",{className:"category-section",onDragOver:z=>z.preventDefault(),onDrop:()=>L(B.id),children:[jsxRuntimeExports.jsxs("div",{className:"category-header",children:[jsxRuntimeExports.jsx("button",{className:"category-toggle",onClick:()=>S(Q?null:B.id),children:Q?"📂":"📁"}),jsxRuntimeExports.jsx("div",{className:"category-indicator",style:{backgroundColor:B.color}}),jsxRuntimeExports.jsx("span",{className:"category-name",children:B.name}),jsxRuntimeExports.jsxs("span",{className:"category-count",children:["(",G.length,")"]}),B.id!=="uncategorized"&&jsxRuntimeExports.jsx("button",{className:"remove-category-button",onClick:()=>D(B.id),children:"✖️"})]}),Q&&jsxRuntimeExports.jsxs("div",{className:"category-feeds",children:[G.map(z=>jsxRuntimeExports.jsxs("div",{className:"feed-item-manager",draggable:!0,onDragStart:()=>M(z.id),children:[jsxRuntimeExports.jsx("label",{className:"feed-checkbox",children:jsxRuntimeExports.jsx("input",{type:"checkbox",checked:n.has(z.id),onChange:()=>H(z.id)})}),jsxRuntimeExports.jsx(FeedHealthIndicator,{feedId:z.id}),jsxRuntimeExports.jsxs("div",{className:"feed-info",children:[jsxRuntimeExports.jsx("div",{className:"feed-title-manager",children:z.title}),jsxRuntimeExports.jsx("div",{className:"feed-url",children:z.url})]}),jsxRuntimeExports.jsx("button",{className:"remove-feed-button",onClick:()=>k(z.id),children:"🗑️"})]},z.id)),G.length===0&&jsxRuntimeExports.jsx("div",{className:"empty-category",children:"Drag feeds here or they'll appear automatically"})]})]},B.id)}),jsxRuntimeExports.jsx("div",{className:"add-category-section",children:f?jsxRuntimeExports.jsxs("div",{className:"add-category-form",children:[jsxRuntimeExports.jsx("input",{type:"text",value:g,onChange:B=>x(B.target.value),placeholder:"Category name...",className:"category-name-input",onKeyPress:B=>B.key==="Enter"&&P(),autoFocus:!0}),jsxRuntimeExports.jsx("button",{onClick:P,className:"save-category-button",children:"✅ Save"}),jsxRuntimeExports.jsx("button",{onClick:()=>j(!1),className:"cancel-category-button",children:"❌ Cancel"})]}):jsxRuntimeExports.jsx("button",{onClick:()=>j(!0),className:"add-category-button",children:"➕ Add Category"})})]})]})},WingCommanderLogo="/assets/WingCommanderLogo-288x162-Dr7UFZxN.gif",Web3Button=()=>{const r=useNavigate(),{isConnected:e,walletAddress:t,networkName:s,ensName:n}=useWeb3(),i=()=>{r("/profile")},a=n||(l=>l?`${l.substring(0,4)}...${l.substring(l.length-4)}`:"")(t);return jsxRuntimeExports.jsxs("button",{className:`control-btn-micro web3-button ${e?"connected":""}`,onClick:i,"aria-label":e?"Wallet Connected":"Connect Wallet",title:e?`Connected: ${a} on ${s}`:"User Profile",children:[e?"🔐":"👤",e&&jsxRuntimeExports.jsx("span",{className:"connected-indicator","data-network":s.toLowerCase().split(" ")[0]}),e&&jsxRuntimeExports.jsx("span",{className:"wallet-preview",children:a})]})},NavigationButtons=()=>{const r=useNavigate(),e=useLocation(),t=s=>!!(s==="/"&&e.pathname==="/"||s!=="/"&&e.pathname.startsWith(s));return jsxRuntimeExports.jsxs("div",{className:"navigation-buttons",children:[jsxRuntimeExports.jsx("button",{className:`control-btn-micro ${t("/")?"active":""}`,onClick:()=>r("/"),title:"Tactical Dashboard",children:"📡"}),jsxRuntimeExports.jsx("button",{className:`control-btn-micro ${t("/settings")?"active":""}`,onClick:()=>r("/settings"),title:"Settings",children:"⚙️"})]})},Header=()=>{const r=useNavigate(),{performSearch:e,isSearching:t}=useSearch(),[s,n]=reactExports.useState(""),[i,o]=reactExports.useState(!1),[a,l]=reactExports.useState(new Date);reactExports.useEffect(()=>{const x=setInterval(()=>{l(new Date)},1e3);return()=>clearInterval(x)},[]);const p=x=>{x.preventDefault(),s.trim()&&e({query:s.trim(),operators:"AND",caseSensitive:!1})},g=x=>{n(x.target.value)};return jsxRuntimeExports.jsxs("header",{className:"tactical-header-enhanced tactical-header-compact",children:[jsxRuntimeExports.jsxs("div",{className:"header-primary-bar",children:[jsxRuntimeExports.jsxs("div",{className:"brand-micro",children:[jsxRuntimeExports.jsx("img",{src:WingCommanderLogo,alt:"TC",className:"brand-icon-micro",onClick:()=>r("/"),style:{cursor:"pointer"}}),jsxRuntimeExports.jsx("div",{className:"brand-text-micro",children:jsxRuntimeExports.jsx("span",{className:"brand-code",children:"TACTICAL INTEL DASHBOARD"})})]}),jsxRuntimeExports.jsxs("div",{className:"status-micro-grid",children:[jsxRuntimeExports.jsx("div",{className:"clock-display",title:"System Time",children:a.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}),jsxRuntimeExports.jsx("div",{className:"status-indicator status-online",title:"Connection Status",children:"● ONLINE"})]}),jsxRuntimeExports.jsx("div",{className:"search-micro",children:jsxRuntimeExports.jsxs("form",{onSubmit:p,className:"search-form-micro",children:[jsxRuntimeExports.jsx("input",{type:"text",value:s,onChange:g,placeholder:"SEARCH INTEL...",className:"search-input-micro",disabled:t}),jsxRuntimeExports.jsx("button",{type:"submit",className:"search-btn-micro",disabled:t||!s.trim(),title:"Search",children:t?"⟳":"→"})]})}),jsxRuntimeExports.jsxs("div",{className:"controls-micro",children:[jsxRuntimeExports.jsx(NavigationButtons,{}),jsxRuntimeExports.jsx(Web3Button,{}),jsxRuntimeExports.jsx("button",{className:"control-btn-micro",onClick:()=>{document.documentElement.requestFullscreen().catch(x=>{console.error(`Error attempting to enable fullscreen: ${x.message}`)})},title:"Toggle Fullscreen",children:"⛶"})]})]}),jsxRuntimeExports.jsx(Modal,{isOpen:i,onClose:()=>o(!1),title:"FEED MANAGEMENT CONSOLE",size:"fullscreen",children:jsxRuntimeExports.jsx(FeedManager,{})})]})},MainLayout=()=>jsxRuntimeExports.jsxs("div",{className:"tactical-dashboard",children:[jsxRuntimeExports.jsx("div",{className:"tactical-header-main",children:jsxRuntimeExports.jsx(Header,{})}),jsxRuntimeExports.jsx("div",{className:"tactical-main-content",children:jsxRuntimeExports.jsx(Outlet,{})})]}),NotFoundPage=()=>{const r=useNavigate(),e=()=>{r("/")};return jsxRuntimeExports.jsx("div",{className:"not-found-page",children:jsxRuntimeExports.jsxs("div",{className:"not-found-content",children:[jsxRuntimeExports.jsx("h1",{children:"404 - Page Not Found"}),jsxRuntimeExports.jsx("p",{children:"The page you're looking for doesn't exist or has been moved."}),jsxRuntimeExports.jsx("button",{className:"tactical-button primary-button",onClick:e,children:"Return to Dashboard"})]})})},DebugInfo=({componentName:r})=>null,SettingsChangeIndicator=React.memo(({hasChanges:r,isApplying:e=!1,onApply:t,onDiscard:s,className:n=""})=>{const i=reactExports.useCallback(()=>{t&&t()},[t]),o=reactExports.useCallback(()=>{s&&s()},[s]);return!r&&!e?null:jsxRuntimeExports.jsxs("div",{className:`settings-change-indicator ${n}`,children:[jsxRuntimeExports.jsx("div",{className:"change-status",children:e?jsxRuntimeExports.jsxs("div",{className:"applying-indicator",children:[jsxRuntimeExports.jsx("span",{className:"spinner"}),jsxRuntimeExports.jsx("span",{className:"status-text",children:"Applying changes..."})]}):jsxRuntimeExports.jsxs("div",{className:"unsaved-indicator",children:[jsxRuntimeExports.jsx("span",{className:"status-icon",children:"●"}),jsxRuntimeExports.jsx("span",{className:"status-text",children:"You have unsaved changes"})]})}),r&&!e&&jsxRuntimeExports.jsxs("div",{className:"change-actions",children:[t&&jsxRuntimeExports.jsx("button",{className:"apply-button",onClick:i,title:"Apply changes",children:"Apply"}),s&&jsxRuntimeExports.jsx("button",{className:"discard-button",onClick:o,title:"Discard changes",children:"Discard"})]})]})}),ConfirmationDialog=React.memo(({isOpen:r,title:e,message:t,confirmText:s="Confirm",cancelText:n="Cancel",type:i="warning",onConfirm:o,onCancel:a})=>{const l=reactExports.useCallback(b=>{b.target===b.currentTarget&&a()},[a]),p=reactExports.useCallback(()=>{o()},[o]),g=reactExports.useCallback(()=>{a()},[a]);if(!r)return null;const x=()=>{switch(i){case"danger":return"⚠️";case"warning":return"⚡";case"info":return"ℹ️";default:return"⚡"}};return jsxRuntimeExports.jsx("div",{className:"confirmation-overlay",onClick:l,children:jsxRuntimeExports.jsxs("div",{className:`confirmation-dialog ${i}`,children:[jsxRuntimeExports.jsxs("div",{className:"dialog-header",children:[jsxRuntimeExports.jsx("span",{className:"dialog-icon",children:x()}),jsxRuntimeExports.jsx("h3",{className:"dialog-title",children:e})]}),jsxRuntimeExports.jsx("div",{className:"dialog-content",children:jsxRuntimeExports.jsx("p",{className:"dialog-message",children:t})}),jsxRuntimeExports.jsxs("div",{className:"dialog-actions",children:[jsxRuntimeExports.jsx("button",{className:"cancel-button",onClick:g,autoFocus:!0,children:n}),jsxRuntimeExports.jsx("button",{className:`confirm-button ${i}`,onClick:p,children:s})]})]})})}),GeneralSettings=reactExports.memo(()=>{const{settings:r,resetSettings:e}=useSettings(),[t,s]=reactExports.useState(!1),[n,i]=reactExports.useState(!0),[o,a]=reactExports.useState(300),[l,p]=reactExports.useState(!0),[g,x]=reactExports.useState(!1),[b,E]=reactExports.useState("ping"),[f,j]=reactExports.useState(!0),[C,S]=reactExports.useState(1800),[R,I]=reactExports.useState(50),[A,$]=reactExports.useState("default"),[N,k]=reactExports.useState(!1),[P,D]=reactExports.useState(!1);reactExports.useEffect(()=>{const H=SettingsIntegrationService.getGeneralSettings();i(H.autoRefresh),a(H.refreshInterval),p(H.preserveHistory),x(H.notifications),E(H.notificationSound),j(H.showNotificationCount),S(H.cacheDuration),I(H.storageLimit),"Notification"in window&&$(Notification.permission)},[]),reactExports.useEffect(()=>{if(!r)throw new Error("Settings context is not available. Make sure SettingsProvider is properly configured.")},[r]);const M=async()=>{if("Notification"in window){const H=await Notification.requestPermission();$(H),H==="granted"&&(x(!0),s(!0))}},L=()=>{A==="granted"&&new Notification("Tactical Intel Dashboard",{body:"Test notification - your dashboard is working correctly!",icon:"/favicon.ico"})},q=reactExports.useCallback(()=>{Object.keys(localStorage).forEach(B=>{B.startsWith("feed_")&&localStorage.removeItem(B)});const ee=document.querySelector(".settings-content");if(ee){const B=document.createElement("div");B.className="settings-feedback success",B.textContent="Cache cleared successfully!",ee.appendChild(B),setTimeout(()=>{B.remove()},3e3)}k(!1)},[]),K=reactExports.useCallback(async()=>{D(!0);try{const H={autoRefresh:n,refreshInterval:o,preserveHistory:l,notifications:g,notificationSound:b,showNotificationCount:f,cacheDuration:C,storageLimit:R};localStorage.setItem("generalSettings",JSON.stringify(H)),s(!1),SettingsIntegrationService.resetCache();const ee=document.querySelector(".settings-content");if(ee){const B=document.createElement("div");B.className="settings-feedback success",B.textContent="General settings saved successfully!",ee.appendChild(B),setTimeout(()=>{B.remove()},3e3)}}finally{D(!1)}},[n,o,l,g,b,f,C,R]);return jsxRuntimeExports.jsxs("div",{className:"settings-form",children:[jsxRuntimeExports.jsx(DebugInfo,{componentName:"GeneralSettings"}),jsxRuntimeExports.jsx("h2",{children:"General Dashboard Configuration"}),jsxRuntimeExports.jsx(SettingsChangeIndicator,{hasChanges:t,isApplying:P,onApply:K,onDiscard:()=>s(!1)}),jsxRuntimeExports.jsxs("div",{className:"settings-grid",children:[jsxRuntimeExports.jsxs("div",{className:"settings-section",children:[jsxRuntimeExports.jsx("h3",{children:"Application Information"}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Tactical Intel Dashboard Version"}),jsxRuntimeExports.jsx("div",{className:"static-field",children:r.version}),jsxRuntimeExports.jsx("p",{className:"settings-description",children:"Current software version of your tactical intelligence platform."})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"System Status"}),jsxRuntimeExports.jsx("div",{className:"status-indicator online",children:"● OPERATIONAL"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Notification Permission"}),jsxRuntimeExports.jsx("div",{className:`status-indicator ${A==="granted"?"online":"offline"}`,children:A==="granted"?"● GRANTED":A==="denied"?"● DENIED":"● NOT REQUESTED"}),A!=="granted"&&jsxRuntimeExports.jsx("button",{className:"btn-secondary",onClick:M,children:"Request Permission"})]})]}),jsxRuntimeExports.jsxs("div",{className:"settings-section",children:[jsxRuntimeExports.jsx("h3",{children:"Dashboard Behavior"}),jsxRuntimeExports.jsx("div",{className:"form-group",children:jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:n,onChange:H=>{i(H.target.checked),s(!0)}}),"Auto-refresh feeds in background"]})}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Refresh Interval"}),jsxRuntimeExports.jsxs("select",{className:"form-control",value:o,onChange:H=>{a(parseInt(H.target.value,10)),s(!0)},children:[jsxRuntimeExports.jsx("option",{value:30,children:"30 seconds"}),jsxRuntimeExports.jsx("option",{value:60,children:"1 minute"}),jsxRuntimeExports.jsx("option",{value:300,children:"5 minutes"}),jsxRuntimeExports.jsx("option",{value:600,children:"10 minutes"}),jsxRuntimeExports.jsx("option",{value:1800,children:"30 minutes"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:l,onChange:H=>{p(H.target.checked),s(!0)}}),"Preserve feed history"]}),jsxRuntimeExports.jsx("p",{className:"settings-description",children:"Keeps track of previously viewed items across sessions"})]})]}),jsxRuntimeExports.jsxs("div",{className:"settings-section",children:[jsxRuntimeExports.jsx("h3",{children:"Notifications"}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:g,disabled:A!=="granted",onChange:H=>{x(H.target.checked),s(!0)}}),"Enable desktop notifications"]}),A!=="granted"&&jsxRuntimeExports.jsx("p",{className:"settings-description warning",children:"Notification permission required"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Notification Sound"}),jsxRuntimeExports.jsxs("select",{className:"form-control",value:b,onChange:H=>{E(H.target.value),s(!0)},children:[jsxRuntimeExports.jsx("option",{value:"none",children:"None"}),jsxRuntimeExports.jsx("option",{value:"ping",children:"Ping"}),jsxRuntimeExports.jsx("option",{value:"alert",children:"Alert"}),jsxRuntimeExports.jsx("option",{value:"tactical",children:"Tactical Alert"})]})]}),jsxRuntimeExports.jsx("div",{className:"form-group",children:jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:f,onChange:H=>{j(H.target.checked),s(!0)}}),"Show notification count in title"]})}),A==="granted"&&jsxRuntimeExports.jsx("div",{className:"form-group",children:jsxRuntimeExports.jsx("button",{className:"btn-secondary",onClick:L,children:"Test Notification"})})]}),jsxRuntimeExports.jsxs("div",{className:"settings-section",children:[jsxRuntimeExports.jsx("h3",{children:"Data Management"}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Cache Duration"}),jsxRuntimeExports.jsxs("select",{className:"form-control",value:C,onChange:H=>{S(parseInt(H.target.value,10)),s(!0)},children:[jsxRuntimeExports.jsx("option",{value:300,children:"5 minutes"}),jsxRuntimeExports.jsx("option",{value:600,children:"10 minutes"}),jsxRuntimeExports.jsx("option",{value:1800,children:"30 minutes"}),jsxRuntimeExports.jsx("option",{value:3600,children:"1 hour"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Storage Limit"}),jsxRuntimeExports.jsxs("select",{className:"form-control",value:R,onChange:H=>{I(parseInt(H.target.value,10)),s(!0)},children:[jsxRuntimeExports.jsx("option",{value:10,children:"10 MB"}),jsxRuntimeExports.jsx("option",{value:50,children:"50 MB"}),jsxRuntimeExports.jsx("option",{value:100,children:"100 MB"}),jsxRuntimeExports.jsx("option",{value:200,children:"200 MB"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("button",{className:"btn-secondary btn-destructive",onClick:()=>k(!0),children:"Clear All Cache"}),jsxRuntimeExports.jsx("p",{className:"settings-description",children:"This will remove all cached feed data and force fresh downloads."})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"settings-actions",children:[jsxRuntimeExports.jsx("button",{className:"btn-primary",onClick:K,disabled:!t,children:"Apply General Settings"}),jsxRuntimeExports.jsx("button",{className:"btn-secondary",onClick:()=>e(SettingsTab.GENERAL),children:"Reset to Defaults"})]}),jsxRuntimeExports.jsx(ConfirmationDialog,{isOpen:N,title:"Clear All Cache",message:"This will permanently delete all cached feed data. Fresh data will be downloaded on the next request. This action cannot be undone.",confirmText:"Clear Cache",cancelText:"Cancel",type:"warning",onConfirm:q,onCancel:()=>k(!1)})]})});GeneralSettings.displayName="GeneralSettings";const CORSSettings=reactExports.memo(()=>{const{settings:r,updateSettings:e,resetSettings:t}=useSettings(),[s,n]=reactExports.useState("https://rss.nytimes.com/services/xml/rss/nyt/World.xml"),[i,o]=reactExports.useState("idle"),[a,l]=reactExports.useState(""),[p,g]=reactExports.useState(!1),[x,b]=reactExports.useState(Object.values(CORSStrategy).reduce((D,M)=>(D[M]={status:"untested"},D),{})),[E,f]=reactExports.useState(""),[j,C]=reactExports.useState("");reactExports.useEffect(()=>{g(!0)},[r.cors]);const S=reactExports.useCallback(D=>{e({cors:{...r.cors,defaultStrategy:D.target.value}}),g(!0),SettingsIntegrationService.resetCache()},[r.cors,e]),R=reactExports.useCallback((D,M)=>{const L={...r.cors.protocolStrategies};M==="DEFAULT"?delete L[D]:L[D]=M,e({cors:{...r.cors,protocolStrategies:L}}),g(!0),SettingsIntegrationService.resetCache()},[r.cors,e]),I=async D=>{try{b(K=>({...K,[D]:{status:"testing"}}));const M=SettingsIntegrationService.getCORSStrategy();e({cors:{...r.cors,defaultStrategy:D}}),SettingsIntegrationService.resetCache();const L=performance.now();await FetchService.testCORSStrategy(s,D);const q=Math.round(performance.now()-L);return e({cors:{...r.cors,defaultStrategy:M}}),SettingsIntegrationService.resetCache(),b(K=>({...K,[D]:{status:"success",time:q}})),!0}catch(M){return b(L=>({...L,[D]:{status:"error",message:M instanceof Error?M.message:"Unknown error"}})),!1}},A=async()=>{o("testing"),l("Testing all CORS strategies...");const D=[];for(const M of Object.values(CORSStrategy))D.push(await I(M));D.some(M=>M)?(o("success"),l("At least one CORS strategy works for this URL")):(o("error"),l("All CORS strategies failed. Please check your network or the URL."))},$=()=>{j&&!r.cors.services.rss2json.includes(j)&&(e({cors:{...r.cors,services:{...r.cors.services,rss2json:[...r.cors.services.rss2json,j]}}}),C(""),g(!0),SettingsIntegrationService.resetCache())},N=()=>{E&&!r.cors.services.corsProxies.includes(E)&&(e({cors:{...r.cors,services:{...r.cors.services,corsProxies:[...r.cors.services.corsProxies,E]}}}),f(""),g(!0),SettingsIntegrationService.resetCache())},k=(D,M)=>{e({cors:{...r.cors,services:{...r.cors.services,[D]:r.cors.services[D].filter(L=>L!==M)}}}),g(!0),SettingsIntegrationService.resetCache()},P=()=>{SettingsIntegrationService.resetCache(),g(!1);const D=document.querySelector(".settings-content");if(D){const M=document.createElement("div");M.className="settings-feedback success",M.textContent="CORS settings applied successfully!",D.appendChild(M),setTimeout(()=>{M.remove()},3e3)}};return jsxRuntimeExports.jsxs("div",{className:"settings-form",children:[jsxRuntimeExports.jsx(DebugInfo,{componentName:"CORSSettings"}),jsxRuntimeExports.jsx("h2",{children:"CORS Management"}),jsxRuntimeExports.jsxs("div",{className:"settings-section",children:[jsxRuntimeExports.jsx("h3",{children:"CORS Strategy Selection"}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"default-cors-strategy",children:"Default CORS Strategy"}),jsxRuntimeExports.jsxs("select",{id:"default-cors-strategy",value:r.cors.defaultStrategy,onChange:S,children:[jsxRuntimeExports.jsx("option",{value:CORSStrategy.RSS2JSON,children:"RSS2JSON Services (Recommended)"}),jsxRuntimeExports.jsx("option",{value:CORSStrategy.JSONP,children:"JSONP Approach"}),jsxRuntimeExports.jsx("option",{value:CORSStrategy.SERVICE_WORKER,children:"Browser Service Worker Proxy"}),jsxRuntimeExports.jsx("option",{value:CORSStrategy.DIRECT,children:"Direct Fetch (CORS-Friendly Only)"}),jsxRuntimeExports.jsx("option",{value:CORSStrategy.EXTENSION,children:"Browser Extension"})]}),jsxRuntimeExports.jsx("p",{className:"settings-description",children:"The primary method used to bypass CORS restrictions when fetching feeds."})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("h4",{children:"Protocol-Specific Strategies"}),["RSS","JSON","API","IPFS","MASTODON","SSB"].map(D=>jsxRuntimeExports.jsxs("div",{className:"protocol-strategy form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:`${D}-strategy`,children:D}),jsxRuntimeExports.jsxs("select",{id:`${D}-strategy`,value:r.cors.protocolStrategies[D]||"DEFAULT",onChange:M=>R(D,M.target.value),children:[jsxRuntimeExports.jsx("option",{value:"DEFAULT",children:"Use Default Strategy"}),jsxRuntimeExports.jsx("option",{value:CORSStrategy.RSS2JSON,children:"RSS2JSON Services"}),jsxRuntimeExports.jsx("option",{value:CORSStrategy.JSONP,children:"JSONP Approach"}),jsxRuntimeExports.jsx("option",{value:CORSStrategy.SERVICE_WORKER,children:"Browser Service Worker Proxy"}),jsxRuntimeExports.jsx("option",{value:CORSStrategy.DIRECT,children:"Direct Fetch"}),jsxRuntimeExports.jsx("option",{value:CORSStrategy.EXTENSION,children:"Browser Extension"})]})]},D))]})]}),jsxRuntimeExports.jsxs("div",{className:"settings-section",children:[jsxRuntimeExports.jsx("h3",{children:"RSS2JSON Service Configuration"}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("h4",{children:"Available Services:"}),r.cors.services.rss2json.map(D=>jsxRuntimeExports.jsxs("div",{className:"service-item",children:[jsxRuntimeExports.jsx("div",{className:"service-url",children:D}),jsxRuntimeExports.jsx("button",{className:"btn-icon remove-service",onClick:()=>k("rss2json",D),title:"Remove service",children:"✕"})]},D)),jsxRuntimeExports.jsxs("div",{className:"add-service-form",children:[jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Enter new RSS2JSON service URL",value:j,onChange:D=>C(D.target.value)}),jsxRuntimeExports.jsx("button",{className:"btn-primary",onClick:$,children:"Add Service"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("h4",{children:"CORS Proxies:"}),r.cors.services.corsProxies.map(D=>jsxRuntimeExports.jsxs("div",{className:"service-item",children:[jsxRuntimeExports.jsx("div",{className:"service-url",children:D}),jsxRuntimeExports.jsx("button",{className:"btn-icon remove-service",onClick:()=>k("corsProxies",D),title:"Remove proxy",children:"✕"})]},D)),jsxRuntimeExports.jsxs("div",{className:"add-service-form",children:[jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Enter new CORS proxy URL",value:E,onChange:D=>f(D.target.value)}),jsxRuntimeExports.jsx("button",{className:"btn-primary",onClick:N,children:"Add Proxy"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"settings-section",children:[jsxRuntimeExports.jsx("h3",{children:"CORS Test Utility"}),jsxRuntimeExports.jsxs("div",{className:"cors-test-form",children:[jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Enter URL to test CORS strategies",value:s,onChange:D=>n(D.target.value)}),jsxRuntimeExports.jsx("button",{className:`btn-primary ${i==="testing"?"loading":""}`,onClick:A,disabled:i==="testing",children:i==="testing"?"Testing...":"Test CORS Strategies"})]}),i!=="idle"&&jsxRuntimeExports.jsxs("div",{className:`test-results ${i}`,children:[jsxRuntimeExports.jsx("p",{className:"test-message",children:a}),jsxRuntimeExports.jsx("div",{className:"strategy-results",children:Object.entries(x).map(([D,M])=>jsxRuntimeExports.jsxs("div",{className:`strategy-result ${M.status}`,children:[jsxRuntimeExports.jsx("div",{className:"strategy-name",children:D}),jsxRuntimeExports.jsx("div",{className:"strategy-status",children:M.status==="success"?`✓ Success (${M.time}ms)`:M.status==="testing"?"⟳ Testing...":M.status==="error"?`✕ Failed${M.message?`: ${M.message}`:""}`:"◯ Not tested"})]},D))})]})]}),jsxRuntimeExports.jsxs("div",{className:"settings-actions",children:[jsxRuntimeExports.jsx("button",{className:"btn-primary",onClick:P,disabled:!p,children:"Apply CORS Settings"}),jsxRuntimeExports.jsx("button",{className:"btn-secondary",onClick:()=>t(SettingsTab.CORS),children:"Reset CORS Settings"})]}),p&&jsxRuntimeExports.jsx("div",{className:"settings-feedback",children:jsxRuntimeExports.jsx("p",{children:"You have unsaved changes to your CORS settings."})})]})});CORSSettings.displayName="CORSSettings";const DraggableProtocolItem=({protocol:r,index:e,moveProtocol:t})=>{const[s,n]=reactExports.useState(!1),i=p=>{p.dataTransfer.setData("text/plain",e.toString()),n(!0)},o=p=>{p.preventDefault()},a=p=>{p.preventDefault();const g=parseInt(p.dataTransfer.getData("text/plain"));t(g,e),n(!1)},l=()=>{n(!1)};return jsxRuntimeExports.jsxs("div",{className:`protocol-item ${s?"dragging":""}`,draggable:!0,onDragStart:i,onDragOver:o,onDrop:a,onDragEnd:l,children:[jsxRuntimeExports.jsx("span",{className:"protocol-drag-handle",children:"≡"}),jsxRuntimeExports.jsx("span",{className:"protocol-name",children:r.toUpperCase()}),jsxRuntimeExports.jsxs("span",{className:"protocol-priority-badge",children:["Priority ",e+1]})]})},ProtocolSettings=reactExports.memo(()=>{const{settings:r,updateSettings:e,resetSettings:t}=useSettings(),[s,n]=reactExports.useState(r.protocols.priority[0]),[i,o]=reactExports.useState(!1),[a,l]=reactExports.useState(r.protocols.priority),[p,g]=reactExports.useState(r.protocols.settings||{});reactExports.useEffect(()=>{const S={...p};r.protocols.priority.forEach(R=>{S[R]||(S[R]={enabled:!0,fetchLimit:50,contentParsing:"full",extractMedia:!0})}),g(S)},[]),reactExports.useEffect(()=>{l(r.protocols.priority),g(r.protocols.settings||{}),o(!1)},[r]);const x=(S,R)=>{const I=a[S],A=[...a];A.splice(S,1),A.splice(R,0,I),l(A),o(!0)},b=(S,R)=>{g({...p,[S]:{...p[S],enabled:R}}),o(!0)},E=(S,R)=>{g({...p,[S]:{...p[S],fetchLimit:R}}),o(!0)},f=(S,R)=>{g({...p,[S]:{...p[S],contentParsing:R}}),o(!0)},j=(S,R)=>{g({...p,[S]:{...p[S],extractMedia:R}}),o(!0)},C=()=>{e({protocols:{priority:a,settings:p,autoDetect:r.protocols.autoDetect!==!1,fallbackEnabled:r.protocols.fallbackEnabled!==!1}}),o(!1),SettingsIntegrationService.resetCache();const S=document.querySelector(".settings-content");if(S){const R=document.createElement("div");R.className="settings-feedback success",R.textContent="Protocol settings applied successfully!",S.appendChild(R),setTimeout(()=>{R.remove()},3e3)}};return jsxRuntimeExports.jsxs("div",{className:"settings-form",children:[jsxRuntimeExports.jsx("h2",{children:"Protocol Configuration"}),jsxRuntimeExports.jsxs("div",{className:"settings-section",children:[jsxRuntimeExports.jsx("h3",{children:"Intelligence Protocol Priority"}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("p",{className:"settings-description",children:"Drag to reorder protocols by priority. Higher priority protocols will be used first."}),jsxRuntimeExports.jsx("div",{className:"protocol-list",children:a.map((S,R)=>jsxRuntimeExports.jsx(DraggableProtocolItem,{protocol:S,index:R,moveProtocol:x},S))})]})]}),jsxRuntimeExports.jsxs("div",{className:"settings-section",children:[jsxRuntimeExports.jsx("h3",{children:"Protocol-Specific Settings"}),jsxRuntimeExports.jsx("div",{className:"protocol-settings-tabs",children:a.map(S=>jsxRuntimeExports.jsx("button",{className:`protocol-tab ${S===s?"active":""}`,onClick:()=>n(S),children:S.toUpperCase()},S))}),jsxRuntimeExports.jsx("div",{className:"protocol-settings-content",children:a.map(S=>{var R,I,A,$;return jsxRuntimeExports.jsxs("div",{className:`protocol-settings-panel ${S===s?"active":"hidden"}`,children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Protocol Status"}),jsxRuntimeExports.jsxs("select",{className:"form-control",value:(R=p[S])!=null&&R.enabled?"enabled":"disabled",onChange:N=>b(S,N.target.value==="enabled"),children:[jsxRuntimeExports.jsx("option",{value:"enabled",children:"Enabled"}),jsxRuntimeExports.jsx("option",{value:"disabled",children:"Disabled"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Fetch Limit"}),jsxRuntimeExports.jsx("input",{type:"number",className:"form-control",value:((I=p[S])==null?void 0:I.fetchLimit)||50,min:"1",max:"100",onChange:N=>E(S,parseInt(N.target.value,10))}),jsxRuntimeExports.jsx("p",{className:"settings-description",children:"Maximum number of items to fetch per feed"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Content Parsing"}),jsxRuntimeExports.jsxs("select",{className:"form-control",value:((A=p[S])==null?void 0:A.contentParsing)||"full",onChange:N=>f(S,N.target.value),children:[jsxRuntimeExports.jsx("option",{value:"full",children:"Full Content"}),jsxRuntimeExports.jsx("option",{value:"summary",children:"Summary Only"}),jsxRuntimeExports.jsx("option",{value:"metadata",children:"Metadata Only"})]})]}),jsxRuntimeExports.jsx("div",{className:"form-group",children:jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:(($=p[S])==null?void 0:$.extractMedia)||!1,onChange:N=>j(S,N.target.checked)}),"Enable content media extraction"]})})]},S)})})]}),jsxRuntimeExports.jsxs("div",{className:"settings-section",children:[jsxRuntimeExports.jsx("h3",{children:"Protocol Auto-Detection"}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:r.protocols.autoDetect!==!1,onChange:S=>{e({protocols:{...r.protocols,autoDetect:S.target.checked}}),o(!0)}}),"Automatically detect and use optimal protocol for feeds"]}),jsxRuntimeExports.jsx("p",{className:"settings-description",children:"When enabled, the system will attempt to determine the best protocol for each feed"})]}),jsxRuntimeExports.jsx("div",{className:"form-group",children:jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:r.protocols.fallbackEnabled!==!1,onChange:S=>{e({protocols:{...r.protocols,fallbackEnabled:S.target.checked}}),o(!0)}}),"Fallback to alternative protocols on failure"]})})]}),jsxRuntimeExports.jsxs("div",{className:"settings-actions",children:[jsxRuntimeExports.jsx("button",{className:"btn-primary",onClick:C,disabled:!i,children:"Apply Protocol Settings"}),jsxRuntimeExports.jsx("button",{className:"btn-secondary",onClick:()=>t(SettingsTab.PROTOCOLS),children:"Reset to Defaults"})]}),i&&jsxRuntimeExports.jsx("div",{className:"settings-feedback",children:jsxRuntimeExports.jsx("p",{children:"You have unsaved changes to your protocol settings."})})]})}),VerificationIndicator=({trustRating:r=0,source:e,compact:t=!1,showLabel:s=!0})=>{const{trusted:n,warning:i,status:o}=SettingsIntegrationService.getTrustStatus(r),a=SettingsIntegrationService.getVerificationSettings().preferredMethods,l=()=>n?"Verified":i?"Low Trust":"Unverified",p=()=>{let g=`Trust rating: ${r}%`;return e&&(g+=` | Source: ${e}`),a.length>0&&(g+=` | Verification: ${a.join(", ")}`),g};return jsxRuntimeExports.jsxs("div",{className:`verification-indicator ${o} ${t?"compact":""}`,title:p(),children:[jsxRuntimeExports.jsx("span",{className:"indicator-icon",children:o==="trusted"?"✓":o==="warning"?"!":"?"}),s&&jsxRuntimeExports.jsx("span",{className:"indicator-label",children:l()})]})},VerificationSettings=React.memo(()=>{const{settings:r,updateSettings:e,resetSettings:t}=useSettings(),[s,n]=reactExports.useState(!1),[i,o]=reactExports.useState(75),[a,l]=reactExports.useState(r.verification.preferredMethods),[p,g]=reactExports.useState(2),[x,b]=reactExports.useState({crossReference:!0,machineLearning:!0,highlightUnverified:!0});reactExports.useEffect(()=>{l(r.verification.preferredMethods),n(!1)},[r]);const E=reactExports.useCallback(R=>{e({verification:{...r.verification,minimumTrustRating:parseInt(R.target.value,10)}}),n(!0),SettingsIntegrationService.resetCache()},[r.verification,e]),f=reactExports.useCallback(R=>{e({verification:{...r.verification,warningThreshold:parseInt(R.target.value,10)}}),n(!0),SettingsIntegrationService.resetCache()},[r.verification,e]),j=reactExports.useCallback(R=>{const I=[...a],A=I.indexOf(R);A>=0?I.splice(A,1):I.push(R),l(I),e({verification:{...r.verification,preferredMethods:I}}),n(!0),SettingsIntegrationService.resetCache()},[a,r.verification,e]),C=(R,I)=>{const A=[...a],$=A.indexOf(R);$<0||(I==="up"&&$>0?[A[$-1],A[$]]=[A[$],A[$-1]]:I==="down"&&$<A.length-1&&([A[$],A[$+1]]=[A[$+1],A[$]]),l(A),e({verification:{...r.verification,preferredMethods:A}}),n(!0),SettingsIntegrationService.resetCache())},S=()=>{e({verification:{...r.verification,advancedSettings:{crossReference:x.crossReference,machineLearning:x.machineLearning,highlightUnverified:x.highlightUnverified,crossReferenceCount:p}}}),n(!1),SettingsIntegrationService.resetCache();const R=document.querySelector(".settings-content");if(R){const I=document.createElement("div");I.className="settings-feedback success",I.textContent="Verification settings applied successfully!",R.appendChild(I),setTimeout(()=>{I.remove()},3e3)}};return jsxRuntimeExports.jsxs("div",{className:"settings-form",children:[jsxRuntimeExports.jsx("h2",{children:"Intelligence Verification Parameters"}),jsxRuntimeExports.jsxs("div",{className:"settings-section",children:[jsxRuntimeExports.jsx("h3",{children:"Trust Rating Configuration"}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"min-trust-rating",children:["Minimum Trust Rating: ",r.verification.minimumTrustRating,"%"]}),jsxRuntimeExports.jsx("input",{id:"min-trust-rating",type:"range",min:"0",max:"100",step:"5",value:r.verification.minimumTrustRating,onChange:E}),jsxRuntimeExports.jsx("p",{className:"settings-description",children:"Intelligence sources below this rating will be flagged as potentially unreliable"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"warning-threshold",children:["Warning Threshold: ",r.verification.warningThreshold,"%"]}),jsxRuntimeExports.jsx("input",{id:"warning-threshold",type:"range",min:"0",max:"100",step:"5",value:r.verification.warningThreshold,onChange:f}),jsxRuntimeExports.jsx("p",{className:"settings-description",children:"Sources between minimum trust and this value will show warnings"})]}),jsxRuntimeExports.jsxs("div",{className:"verification-preview",children:[jsxRuntimeExports.jsx("h4",{children:"Verification Preview"}),jsxRuntimeExports.jsxs("div",{className:"preview-controls",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"preview-trust-rating",children:["Preview Trust Rating: ",i,"%"]}),jsxRuntimeExports.jsx("input",{id:"preview-trust-rating",type:"range",min:"0",max:"100",step:"5",value:i,onChange:R=>o(parseInt(R.target.value,10))})]}),jsxRuntimeExports.jsxs("div",{className:"preview-indicators",children:[jsxRuntimeExports.jsxs("div",{className:"preview-item",children:[jsxRuntimeExports.jsx(VerificationIndicator,{trustRating:i,source:"Example Source"}),jsxRuntimeExports.jsx("span",{className:"preview-label",children:"Standard Indicator"})]}),jsxRuntimeExports.jsxs("div",{className:"preview-item",children:[jsxRuntimeExports.jsx(VerificationIndicator,{trustRating:i,source:"Example Source",compact:!0}),jsxRuntimeExports.jsx("span",{className:"preview-label",children:"Compact Indicator"})]}),jsxRuntimeExports.jsxs("div",{className:"preview-item",children:[jsxRuntimeExports.jsx(VerificationIndicator,{trustRating:i,source:"Example Source",showLabel:!1}),jsxRuntimeExports.jsx("span",{className:"preview-label",children:"Icon Only"})]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"settings-section",children:[jsxRuntimeExports.jsx("h3",{children:"Verification Methods"}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("p",{className:"settings-description",children:"Select and prioritize verification methods to validate intelligence sources"}),jsxRuntimeExports.jsx("div",{className:"verification-methods-list",children:["official","community","automated","alliance","independent"].map(R=>jsxRuntimeExports.jsxs("div",{className:"verification-method",children:[jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:a.includes(R),onChange:()=>j(R)}),R.charAt(0).toUpperCase()+R.slice(1)]}),jsxRuntimeExports.jsxs("div",{className:"method-controls",children:[jsxRuntimeExports.jsxs("span",{className:"method-priority",children:["Priority: ",a.indexOf(R)+1]}),jsxRuntimeExports.jsx("button",{className:"method-move-up",onClick:()=>C(R,"up"),disabled:!a.includes(R)||a.indexOf(R)===0,children:"▲"}),jsxRuntimeExports.jsx("button",{className:"method-move-down",onClick:()=>C(R,"down"),disabled:!a.includes(R)||a.indexOf(R)===a.length-1,children:"▼"})]})]},R))})]})]}),jsxRuntimeExports.jsxs("div",{className:"settings-section",children:[jsxRuntimeExports.jsx("h3",{children:"Advanced Verification"}),jsxRuntimeExports.jsx("div",{className:"form-group",children:jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:x.crossReference,onChange:R=>b({...x,crossReference:R.target.checked})}),"Cross-reference intelligence against multiple sources"]})}),jsxRuntimeExports.jsx("div",{className:"form-group",children:jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:x.machineLearning,onChange:R=>b({...x,machineLearning:R.target.checked})}),"Apply machine learning verification algorithms"]})}),jsxRuntimeExports.jsx("div",{className:"form-group",children:jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:x.highlightUnverified,onChange:R=>b({...x,highlightUnverified:R.target.checked})}),"Highlight unverified intelligence in dashboard"]})}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Minimum Cross-References"}),jsxRuntimeExports.jsxs("select",{className:"form-control",value:p,onChange:R=>g(parseInt(R.target.value,10)),children:[jsxRuntimeExports.jsx("option",{value:1,children:"1 (Minimal)"}),jsxRuntimeExports.jsx("option",{value:2,children:"2 (Standard)"}),jsxRuntimeExports.jsx("option",{value:3,children:"3 (Enhanced)"}),jsxRuntimeExports.jsx("option",{value:5,children:"5 (Maximum)"})]}),jsxRuntimeExports.jsx("p",{className:"settings-description",children:"Number of independent sources required to mark intelligence as verified"})]})]}),jsxRuntimeExports.jsxs("div",{className:"settings-actions",children:[jsxRuntimeExports.jsx("button",{className:"btn-primary",onClick:S,disabled:!s,children:"Apply Verification Settings"}),jsxRuntimeExports.jsx("button",{className:"btn-secondary",onClick:()=>t(SettingsTab.VERIFICATION),children:"Reset to Defaults"})]}),s&&jsxRuntimeExports.jsx("div",{className:"settings-feedback",children:jsxRuntimeExports.jsx("p",{children:"You have unsaved changes to your verification settings."})})]})}),CSS_VARS={FONT_SIZE:"--base-font-size",DENSITY:"--ui-density",PRIMARY_COLOR:"--primary-color",SECONDARY_COLOR:"--secondary-color",BACKGROUND_COLOR:"--background-color",TEXT_COLOR:"--text-color",ACCENT_COLOR:"--accent-color"},THEME_COLORS={dark:{primary:"#1a1a1a",secondary:"#292929",background:"#141414",text:"#e0e0e0",accent:"#007acc"},night:{primary:"#101823",secondary:"#1c2636",background:"#0a121f",text:"#d0d7e2",accent:"#5277b4"},combat:{primary:"#2a2118",secondary:"#352a1e",background:"#1e1813",text:"#e5d6c5",accent:"#bf5b30"},alliance:{primary:"#1a2a42",secondary:"#27395e",background:"#131f30",text:"#d0dff0",accent:"#50b4e0"},light:{primary:"#f5f5f5",secondary:"#e0e0e0",background:"#ffffff",text:"#333333",accent:"#0066cc"},system:{primary:"var(--dynamic-primary)",secondary:"var(--dynamic-secondary)",background:"var(--dynamic-background)",text:"var(--dynamic-text)",accent:"var(--dynamic-accent)"}},DENSITY_VALUES={comfortable:{spacing:"1",padding:"16px",borderRadius:"8px"},compact:{spacing:"0.85",padding:"8px",borderRadius:"4px"},spacious:{spacing:"1.2",padding:"24px",borderRadius:"12px"}};class DisplaySettingsManager{static applyAllDisplaySettings(){this.applyTheme(),this.applyFontSize(),this.applyDensity()}static applyTheme(){const{theme:e}=SettingsIntegrationService.getThemeSettings(),t=document.documentElement;t.setAttribute("data-theme",e);const s=THEME_COLORS[e]||THEME_COLORS.alliance;t.style.setProperty(CSS_VARS.PRIMARY_COLOR,s.primary),t.style.setProperty(CSS_VARS.SECONDARY_COLOR,s.secondary),t.style.setProperty(CSS_VARS.BACKGROUND_COLOR,s.background),t.style.setProperty(CSS_VARS.TEXT_COLOR,s.text),t.style.setProperty(CSS_VARS.ACCENT_COLOR,s.accent),t.style.setProperty("--secondary-bg",s.secondary),t.style.setProperty("--tertiary-bg",s.primary),t.style.setProperty("--border-color",s.secondary),t.style.setProperty("--input-bg",s.secondary),t.style.setProperty("--hover-bg",s.accent+"20"),e==="system"&&this.setupSystemThemeListener(),console.log(`Applied theme: ${e}`)}static applyFontSize(){const{fontSize:e}=SettingsIntegrationService.getThemeSettings();document.documentElement.style.setProperty(CSS_VARS.FONT_SIZE,`${e}px`),console.log(`Applied font size: ${e}px`)}static applyDensity(){const{density:e}=SettingsIntegrationService.getThemeSettings(),t=document.documentElement;t.setAttribute("data-density",e);const s=DENSITY_VALUES[e]||DENSITY_VALUES.comfortable;t.style.setProperty(CSS_VARS.DENSITY,s.spacing),t.style.setProperty("--padding-base",s.padding),t.style.setProperty("--border-radius",s.borderRadius),t.setAttribute("data-compact",e==="compact"?"true":"false"),console.log(`Applied density: ${e}`)}static setupSystemThemeListener(){const e=window.matchMedia("(prefers-color-scheme: dark)"),t=s=>{const n=document.documentElement,i=s.matches;i?(n.style.setProperty("--dynamic-primary",THEME_COLORS.dark.primary),n.style.setProperty("--dynamic-secondary",THEME_COLORS.dark.secondary),n.style.setProperty("--dynamic-background",THEME_COLORS.dark.background),n.style.setProperty("--dynamic-text",THEME_COLORS.dark.text),n.style.setProperty("--dynamic-accent",THEME_COLORS.dark.accent)):(n.style.setProperty("--dynamic-primary",THEME_COLORS.light.primary),n.style.setProperty("--dynamic-secondary",THEME_COLORS.light.secondary),n.style.setProperty("--dynamic-background",THEME_COLORS.light.background),n.style.setProperty("--dynamic-text",THEME_COLORS.light.text),n.style.setProperty("--dynamic-accent",THEME_COLORS.light.accent)),console.log(`Applied system theme: ${i?"dark":"light"}`)};t(e),e.addEventListener("change",t)}}const displaySettings={apply:()=>DisplaySettingsManager.applyAllDisplaySettings(),applyTheme:()=>DisplaySettingsManager.applyTheme(),applyFontSize:()=>DisplaySettingsManager.applyFontSize(),applyDensity:()=>DisplaySettingsManager.applyDensity()},DisplaySettings=React.memo(()=>{const{settings:r,updateSettings:e,resetSettings:t}=useSettings(),[s,n]=reactExports.useState(!1),i=reactExports.useCallback(g=>{e({display:{...r.display,theme:g.target.value}}),n(!0)},[r.display,e]),o=reactExports.useCallback(g=>{e({display:{...r.display,density:g.target.value}}),n(!0)},[r.display,e]),a=g=>{e({display:{...r.display,fontSize:parseInt(g.target.value,10)}}),n(!0)};reactExports.useEffect(()=>{s&&displaySettings.apply()},[r.display,s]);const l=()=>{displaySettings.apply(),n(!1);const g=document.querySelector(".settings-content");if(g){const x=document.createElement("div");x.className="settings-feedback success",x.textContent="Display settings applied successfully!",g.appendChild(x),setTimeout(()=>{x.remove()},3e3)}},p=()=>{t(SettingsTab.DISPLAY),n(!0)};return jsxRuntimeExports.jsxs("div",{className:"settings-form",children:[jsxRuntimeExports.jsx("h2",{children:"Tactical Display Configuration"}),jsxRuntimeExports.jsxs("div",{className:"settings-section",children:[jsxRuntimeExports.jsx("h3",{children:"Visual Theme"}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"theme-select",children:"Interface Theme"}),jsxRuntimeExports.jsxs("select",{id:"theme-select",value:r.display.theme,onChange:i,children:[jsxRuntimeExports.jsx("option",{value:"dark",children:"Dark Ops (Default)"}),jsxRuntimeExports.jsx("option",{value:"night",children:"Night Operations"}),jsxRuntimeExports.jsx("option",{value:"combat",children:"Combat Mode"}),jsxRuntimeExports.jsx("option",{value:"light",children:"Daylight Operations"}),jsxRuntimeExports.jsx("option",{value:"system",children:"System-Matched"}),jsxRuntimeExports.jsx("option",{value:"alliance",children:"Earth Alliance Standard"})]}),jsxRuntimeExports.jsx("p",{className:"settings-description",children:"Select the visual theme for your tactical interface."})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"density-select",children:"Information Density"}),jsxRuntimeExports.jsxs("select",{id:"density-select",value:r.display.density,onChange:o,children:[jsxRuntimeExports.jsx("option",{value:"compact",children:"Compact (Maximum Intel)"}),jsxRuntimeExports.jsx("option",{value:"comfortable",children:"Comfortable (Balanced)"}),jsxRuntimeExports.jsx("option",{value:"spacious",children:"Spacious (Enhanced Readability)"})]}),jsxRuntimeExports.jsx("p",{className:"settings-description",children:"Controls how densely information is displayed on your dashboard."})]})]}),jsxRuntimeExports.jsxs("div",{className:"settings-section",children:[jsxRuntimeExports.jsx("h3",{children:"Text Configuration"}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"font-size-slider",children:["Base Font Size: ",r.display.fontSize,"px"]}),jsxRuntimeExports.jsx("input",{id:"font-size-slider",type:"range",min:"10",max:"20",step:"1",value:r.display.fontSize,onChange:a}),jsxRuntimeExports.jsx("div",{className:"font-size-example",style:{fontSize:`${r.display.fontSize}px`},children:"Sample text at current size"})]}),jsxRuntimeExports.jsx("div",{className:"form-group",children:jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",defaultChecked:!0}),"Use high-contrast text for critical data"]})})]}),jsxRuntimeExports.jsxs("div",{className:"settings-section",children:[jsxRuntimeExports.jsx("h3",{children:"Dashboard Layout"}),jsxRuntimeExports.jsx("div",{className:"form-group",children:jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",defaultChecked:!0}),"Show timestamp for all intelligence items"]})}),jsxRuntimeExports.jsx("div",{className:"form-group",children:jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",defaultChecked:!0}),"Show source indicator badges"]})}),jsxRuntimeExports.jsx("div",{className:"form-group",children:jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",defaultChecked:!0}),"Enable tactical animations"]})})]}),jsxRuntimeExports.jsxs("div",{className:"settings-actions",children:[jsxRuntimeExports.jsx("button",{className:"btn-primary",onClick:l,children:"Apply Display Settings"}),jsxRuntimeExports.jsx("button",{className:"btn-secondary",onClick:p,children:"Reset Display"})]}),s&&jsxRuntimeExports.jsx("div",{className:"settings-feedback",children:jsxRuntimeExports.jsx("p",{children:"You have unsaved changes to your display settings."})})]})}),AdvancedSettings=()=>{const{resetSettings:r}=useSettings();return jsxRuntimeExports.jsxs("div",{className:"settings-form",children:[jsxRuntimeExports.jsx("h2",{children:"Advanced System Configuration"}),jsxRuntimeExports.jsxs("div",{className:"settings-section",children:[jsxRuntimeExports.jsx("h3",{children:"Performance Optimization"}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",defaultChecked:!0}),"Enable hardware acceleration"]}),jsxRuntimeExports.jsx("p",{className:"settings-description",children:"Uses GPU for rendering when available (recommended for complex visualizations)"})]}),jsxRuntimeExports.jsx("div",{className:"form-group",children:jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",defaultChecked:!0}),"Background processing for intelligence analysis"]})}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Worker Threads"}),jsxRuntimeExports.jsxs("select",{className:"form-control",children:[jsxRuntimeExports.jsx("option",{value:"1",children:"1 (Minimal)"}),jsxRuntimeExports.jsx("option",{value:"2",selected:!0,children:"2 (Balanced)"}),jsxRuntimeExports.jsx("option",{value:"4",children:"4 (Performance)"}),jsxRuntimeExports.jsx("option",{value:"8",children:"8 (Maximum)"})]}),jsxRuntimeExports.jsx("p",{className:"settings-description",children:"Number of parallel processing threads for background operations"})]})]}),jsxRuntimeExports.jsxs("div",{className:"settings-section",children:[jsxRuntimeExports.jsx("h3",{children:"Advanced Data Management"}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Indexing Strategy"}),jsxRuntimeExports.jsxs("select",{className:"form-control",children:[jsxRuntimeExports.jsx("option",{value:"standard",selected:!0,children:"Standard (Balanced)"}),jsxRuntimeExports.jsx("option",{value:"aggressive",children:"Aggressive (Faster Search)"}),jsxRuntimeExports.jsx("option",{value:"minimal",children:"Minimal (Lower Resource Usage)"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",defaultChecked:!0}),"Enable enhanced content extraction"]}),jsxRuntimeExports.jsx("p",{className:"settings-description",children:"Deeper analysis of feed content (uses more processing power)"})]})]}),jsxRuntimeExports.jsxs("div",{className:"settings-section",children:[jsxRuntimeExports.jsx("h3",{children:"System Operations"}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Log Level"}),jsxRuntimeExports.jsxs("select",{className:"form-control",children:[jsxRuntimeExports.jsx("option",{value:"error",children:"Error Only"}),jsxRuntimeExports.jsx("option",{value:"warn",selected:!0,children:"Warning"}),jsxRuntimeExports.jsx("option",{value:"info",children:"Information"}),jsxRuntimeExports.jsx("option",{value:"debug",children:"Debug"}),jsxRuntimeExports.jsx("option",{value:"trace",children:"Trace (Verbose)"})]})]}),jsxRuntimeExports.jsx("div",{className:"form-group",children:jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox"}),"Enable telemetry (anonymous usage statistics)"]})}),jsxRuntimeExports.jsx("div",{className:"form-group",children:jsxRuntimeExports.jsx("button",{className:"btn-secondary",children:"Export Diagnostic Data"})}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("button",{className:"btn-danger",children:"Clear All Application Data"}),jsxRuntimeExports.jsx("p",{className:"settings-description warning-text",children:"Warning: This will reset all settings and clear cached intelligence data"})]})]}),jsxRuntimeExports.jsxs("div",{className:"settings-actions",children:[jsxRuntimeExports.jsx("button",{className:"btn-primary",children:"Save Advanced Settings"}),jsxRuntimeExports.jsx("button",{className:"btn-secondary",onClick:()=>r(SettingsTab.ADVANCED),children:"Reset to Defaults"})]})]})},SettingsTabContent=()=>{const{tab:r}=useParams();if(!r)return console.log("[SettingsTabContent] No tab specified, redirecting to general"),jsxRuntimeExports.jsx(Navigate,{to:"/settings/general",replace:!0});switch(console.log(`[SettingsTabContent] Rendering tab: ${r}`),r){case SettingsTab.GENERAL:return jsxRuntimeExports.jsx(GeneralSettings,{});case SettingsTab.CORS:return jsxRuntimeExports.jsx(CORSSettings,{});case SettingsTab.PROTOCOLS:return jsxRuntimeExports.jsx(ProtocolSettings,{});case SettingsTab.VERIFICATION:return jsxRuntimeExports.jsx(VerificationSettings,{});case SettingsTab.DISPLAY:return jsxRuntimeExports.jsx(DisplaySettings,{});case SettingsTab.ADVANCED:return jsxRuntimeExports.jsx(AdvancedSettings,{});default:return console.error(`[SettingsTabContent] Invalid tab: ${r}`),jsxRuntimeExports.jsx(SettingsError,{message:"Invalid Settings Tab",details:`The requested tab "${r}" does not exist.`,code:`Expected one of: ${Object.values(SettingsTab).join(", ")}`})}},AppRoutes=()=>jsxRuntimeExports.jsx(Routes,{children:jsxRuntimeExports.jsxs(Route,{element:jsxRuntimeExports.jsx(MainLayout,{}),children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(HomePage,{})}),jsxRuntimeExports.jsx(Route,{path:"/feed/:id",element:jsxRuntimeExports.jsx(FeedPage,{})}),jsxRuntimeExports.jsxs(Route,{path:"/settings",element:jsxRuntimeExports.jsx(SettingsPage,{}),children:[jsxRuntimeExports.jsx(Route,{index:!0,element:jsxRuntimeExports.jsx(Navigate,{to:"/settings/general",replace:!0})}),jsxRuntimeExports.jsx(Route,{path:":tab",element:jsxRuntimeExports.jsx(SettingsTabContent,{})}),jsxRuntimeExports.jsx(Route,{path:"*",element:jsxRuntimeExports.jsx(SettingsError,{message:"Invalid Settings Route",details:"The requested settings section does not exist.",code:"No matching route found for the current URL."})})]}),jsxRuntimeExports.jsx(Route,{path:"/profile",element:jsxRuntimeExports.jsx(ProfilePageSimple,{})}),jsxRuntimeExports.jsx(Route,{path:"/web3-test",element:jsxRuntimeExports.jsx(Web3TestPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/web3login",element:jsxRuntimeExports.jsx(Navigate,{to:"/profile",replace:!0})}),jsxRuntimeExports.jsx(Route,{path:"*",element:jsxRuntimeExports.jsx(NotFoundPage,{})})]})}),SearchResults=()=>{const{searchResults:r,isSearching:e,searchQuery:t,clearSearch:s}=useSearch();return!r&&!e?null:jsxRuntimeExports.jsx("div",{className:"search-results-overlay",children:jsxRuntimeExports.jsxs("div",{className:"search-results-container",children:[jsxRuntimeExports.jsxs("div",{className:"search-results-header",children:[jsxRuntimeExports.jsx("div",{className:"search-results-title",children:e?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("span",{className:"search-loading",children:"⏳"}),'Searching for "',t,'"...']}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:['Search Results for "',t,'"',r&&jsxRuntimeExports.jsxs("span",{className:"search-stats",children:[r.totalCount," results in ",r.searchTime,"ms"]})]})}),jsxRuntimeExports.jsx("button",{className:"search-close-button",onClick:s,"aria-label":"Close search results",children:"✕"})]}),jsxRuntimeExports.jsx("div",{className:"search-results-content",children:e?jsxRuntimeExports.jsxs("div",{className:"search-loading-state",children:[jsxRuntimeExports.jsx("div",{className:"loading-spinner"}),jsxRuntimeExports.jsx("p",{children:"Searching across all feeds..."})]}):(r==null?void 0:r.results.length)===0?jsxRuntimeExports.jsxs("div",{className:"search-no-results",children:[jsxRuntimeExports.jsx("div",{className:"no-results-icon",children:"🔍"}),jsxRuntimeExports.jsx("h3",{children:"No results found"}),jsxRuntimeExports.jsx("p",{children:"Try different keywords or check your spelling"}),r.suggestions.length>0&&jsxRuntimeExports.jsxs("div",{className:"search-suggestions",children:[jsxRuntimeExports.jsx("p",{children:"Suggestions:"}),jsxRuntimeExports.jsx("div",{className:"suggestion-tags",children:r.suggestions.map((n,i)=>jsxRuntimeExports.jsx("span",{className:"suggestion-tag",children:n},i))})]})]}):jsxRuntimeExports.jsx("div",{className:"search-results-list",children:r==null?void 0:r.results.map((n,i)=>jsxRuntimeExports.jsxs("div",{className:"search-result-item",children:[jsxRuntimeExports.jsxs("div",{className:"result-header",children:[jsxRuntimeExports.jsx("h3",{className:"result-title",children:jsxRuntimeExports.jsx("a",{href:n.feed.link,target:"_blank",rel:"noopener noreferrer",className:"result-link",children:n.feed.title})}),jsxRuntimeExports.jsxs("div",{className:"result-meta",children:[jsxRuntimeExports.jsx("span",{className:"result-source",children:n.feed.name}),jsxRuntimeExports.jsx("span",{className:"result-date",children:new Date(n.feed.pubDate).toLocaleDateString()}),jsxRuntimeExports.jsxs("span",{className:"result-score",children:["Relevance: ",Math.round(n.relevanceScore*10)/10]})]})]}),jsxRuntimeExports.jsx("div",{className:"result-snippet",children:n.snippet}),jsxRuntimeExports.jsxs("div",{className:"result-matched-fields",children:[jsxRuntimeExports.jsx("span",{className:"matched-label",children:"Found in:"}),n.matchedFields.map((o,a)=>jsxRuntimeExports.jsx("span",{className:"matched-field",children:o},a))]}),n.feed.author&&jsxRuntimeExports.jsxs("div",{className:"result-author",children:["By: ",n.feed.author]}),n.feed.categories&&n.feed.categories.length>0&&jsxRuntimeExports.jsx("div",{className:"result-categories",children:n.feed.categories.map((o,a)=>jsxRuntimeExports.jsx("span",{className:"result-category",children:o},a))})]},`${n.feed.id}-${i}`))})}),r&&r.results.length>0&&jsxRuntimeExports.jsx("div",{className:"search-results-footer",children:jsxRuntimeExports.jsxs("div",{className:"search-actions",children:[jsxRuntimeExports.jsx("button",{className:"search-action-button",onClick:()=>window.print(),children:"📄 Print Results"}),jsxRuntimeExports.jsx("button",{className:"search-action-button",onClick:()=>{const n=JSON.stringify(r,null,2),i=new Blob([n],{type:"application/json"}),o=URL.createObjectURL(i),a=document.createElement("a");a.href=o,a.download=`search-results-${t}-${new Date().toISOString().split("T")[0]}.json`,a.click(),URL.revokeObjectURL(o)},children:"💾 Export Results"})]})})]})})},DevelopmentNotice=()=>{const[r,e]=reactExports.useState(!1),[t,s]=reactExports.useState(!1);return reactExports.useEffect(()=>{s(!1)},[]),!t||!r?null:jsxRuntimeExports.jsx("div",{style:{position:"fixed",top:"20px",right:"20px",backgroundColor:"#1e40af",color:"white",padding:"16px",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",maxWidth:"400px",zIndex:1e3,fontSize:"14px",lineHeight:"1.5"},children:jsxRuntimeExports.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{style:{fontWeight:"bold",marginBottom:"8px"},children:"🔧 Development Mode"}),jsxRuntimeExports.jsx("div",{children:"RSS feeds are using validated sources from the Earth Alliance roster. All feeds have been tested and confirmed working."})]}),jsxRuntimeExports.jsx("button",{onClick:()=>e(!1),style:{background:"none",border:"none",color:"white",cursor:"pointer",fontSize:"18px",padding:"0",marginLeft:"12px"},"aria-label":"Close",children:"×"})]})})},RouteValidator=()=>{const r=useNavigate(),e=useLocation();return reactExports.useEffect(()=>{console.log("Route changed:",{pathname:e.pathname,search:e.search,hash:e.hash,state:e.state,key:e.key}),e.pathname.includes("/settings")&&!e.pathname.includes("/settings/")&&(console.warn("Incomplete settings route detected, redirecting to general"),r("/settings/general",{replace:!0}))},[e,r]),null},App=()=>(reactExports.useEffect(()=>()=>{PerformanceManager$1.cleanup()},[]),jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsx(SettingsProvider,{children:jsxRuntimeExports.jsx(ThemeProvider,{children:jsxRuntimeExports.jsx(IntelligenceProvider,{children:jsxRuntimeExports.jsx(Web3Provider,{children:jsxRuntimeExports.jsx(IPFSProvider,{children:jsxRuntimeExports.jsx(SearchProvider,{children:jsxRuntimeExports.jsx(FilterProvider,{children:jsxRuntimeExports.jsx(HealthProvider,{children:jsxRuntimeExports.jsx(FeedModeProvider,{children:jsxRuntimeExports.jsxs("div",{className:"App",children:[jsxRuntimeExports.jsx(DevelopmentNotice,{}),jsxRuntimeExports.jsx(RouteValidator,{}),jsxRuntimeExports.jsx(AppRoutes,{}),jsxRuntimeExports.jsx(SearchResults,{})]})})})})})})})})})})})),rootElement=document.getElementById("root");rootElement?ReactDOM.createRoot(rootElement).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(App,{})})):console.error("Failed to find the root element");
